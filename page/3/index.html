<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>苏弋的博客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="This is Hao Jiacheng&#39;s personal blog">
<meta property="og:type" content="website">
<meta property="og:title" content="苏弋的博客">
<meta property="og:url" content="https://suyiharris.github.io/page/3/index.html">
<meta property="og:site_name" content="苏弋的博客">
<meta property="og:description" content="This is Hao Jiacheng&#39;s personal blog">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="SuYi">
<meta property="article:tag" content="SuYi, Blog, Harris">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="苏弋的博客" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<meta name="generator" content="Hexo 6.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">苏弋的博客</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">There is no one around me who is you, but there is no one who is not you.</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/atom.xml" title="RSS 订阅"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="搜索"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="搜索"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://suyiharris.github.io"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-2023-10-24-SpringBoot：快速入门（续）" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/10/24/2023-10-24-SpringBoot%EF%BC%9A%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8%EF%BC%88%E7%BB%AD%EF%BC%89/" class="article-date">
  <time class="dt-published" datetime="2023-10-24T04:12:12.000Z" itemprop="datePublished">2023-10-24</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2023/10/24/2023-10-24-SpringBoot%EF%BC%9A%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8%EF%BC%88%E7%BB%AD%EF%BC%89/">SpringBoot：快速入门（续）</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="SpringBoot：快速入门（续）"><a href="#SpringBoot：快速入门（续）" class="headerlink" title="SpringBoot：快速入门（续）"></a>SpringBoot：快速入门（续）</h1><h2 id="异步任务："><a href="#异步任务：" class="headerlink" title="异步任务："></a>异步任务：</h2><p>目录结构</p>
<p><img src="/../assets/1620352285813.png" alt="1620352285813"></p>
<p>helloController：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sec.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sec.service.helloService;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.scheduling.annotation.EnableAsync;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@EnableAsync</span><span class="comment">//开启异步任务</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">helloController</span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Autowired</span></span><br><span class="line">helloService hs;</span><br><span class="line"><span class="meta">@RequestMapping(&quot;/hello&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">test</span><span class="params">()</span>&#123;</span><br><span class="line">    hs.hello();<span class="comment">//停止三秒</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;ok&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>helloService：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sec.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.scheduling.annotation.Async;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">helloService</span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Async</span><span class="comment">//告诉spring 这是一个异步方法</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">hello</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        Thread.sleep(<span class="number">3000</span>);<span class="comment">//睡眠三秒</span></span><br><span class="line">    &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    System.out.println(<span class="string">&quot;数据正在处理中&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>&#x3D;&#x3D;<strong>注意：</strong>&#x3D;&#x3D;</p>
<ul>
<li>首先要给方法前面写上注解@Async，告诉spring这是一个异步方法</li>
<li>然后要在controller类前开启异步任务 @EnableAsync</li>
</ul>
<h2 id="邮件发送："><a href="#邮件发送：" class="headerlink" title="邮件发送："></a>邮件发送：</h2><ol>
<li><p>导入依赖：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-mail<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>编写代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sec;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Test;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"><span class="keyword">import</span> org.springframework.mail.SimpleMailMessage;</span><br><span class="line"><span class="keyword">import</span> org.springframework.mail.javamail.JavaMailSenderImpl;</span><br><span class="line"><span class="keyword">import</span> org.springframework.mail.javamail.MimeMessageHelper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.mail.MessagingException;</span><br><span class="line"><span class="keyword">import</span> javax.mail.internet.MimeMessage;</span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.util.Random;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SpringBoot09AsyncApplicationTests</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    JavaMailSenderImpl jsi;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="comment">//一个简单的邮件发送</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">contextLoads</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">SimpleMailMessage</span> <span class="variable">mailMessage</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SimpleMailMessage</span>();</span><br><span class="line">        mailMessage.setSubject(<span class="string">&quot;郝嘉诚你好啊！&quot;</span>);</span><br><span class="line">        mailMessage.setText(<span class="string">&quot;感谢你的代码&quot;</span>);</span><br><span class="line">        mailMessage.setFrom(<span class="string">&quot;990784805@qq.com&quot;</span>);</span><br><span class="line">        mailMessage.setTo(<span class="string">&quot;990784805@qq.com&quot;</span>);</span><br><span class="line">        jsi.send(mailMessage);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">        <span class="comment">//一个复杂的邮件发送</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">contextLoads1</span><span class="params">()</span> <span class="keyword">throws</span> MessagingException &#123;</span><br><span class="line">        <span class="type">MimeMessage</span> <span class="variable">mimeMessage</span> <span class="operator">=</span> jsi.createMimeMessage();</span><br><span class="line">        <span class="comment">//组装</span></span><br><span class="line">        MimeMessageHelper messageHelper=<span class="keyword">new</span> <span class="title class_">MimeMessageHelper</span>(mimeMessage,<span class="literal">true</span>);</span><br><span class="line">        <span class="comment">//正文</span></span><br><span class="line">        messageHelper.setSubject(<span class="string">&quot;尊敬的苏弋您好！&quot;</span>);</span><br><span class="line">        <span class="type">Random</span> <span class="variable">random</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Random</span>();</span><br><span class="line">        <span class="type">int</span> <span class="variable">num</span> <span class="operator">=</span> random.nextInt(<span class="number">9000</span>) + <span class="number">1000</span>;</span><br><span class="line">        messageHelper.setText(<span class="string">&quot;&lt;p style=&#x27;color:red&#x27;&gt;您的验证码是：&quot;</span>+num+<span class="string">&quot;&lt;/p&gt;&quot;</span>,<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//附件</span></span><br><span class="line">        messageHelper.addAttachment(<span class="string">&quot;1.jpg&quot;</span>,<span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;C:\\Users\\飞驰的苏弋\\Pictures\\Camera Roll\\1.jpg&quot;</span>));</span><br><span class="line">        messageHelper.addAttachment(<span class="string">&quot;2.jpg&quot;</span>,<span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;C:\\Users\\飞驰的苏弋\\Pictures\\Camera Roll\\2.jpg&quot;</span>));</span><br><span class="line"></span><br><span class="line">        <span class="comment">//发送</span></span><br><span class="line">        messageHelper.setFrom(<span class="string">&quot;990784805@qq.com&quot;</span>);</span><br><span class="line">        messageHelper.setTo(<span class="string">&quot;3046865110@qq.com&quot;</span>);</span><br><span class="line"></span><br><span class="line">        jsi.send(mimeMessage);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//把发送邮件的代码编写成了一个工具，可调用</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sendMail</span><span class="params">(Boolean html,String title,String text,Boolean textHtml,String sendFrom,String sendTo,String fileName,File file)</span> <span class="keyword">throws</span> MessagingException&#123;</span><br><span class="line">        <span class="type">MimeMessage</span> <span class="variable">mimeMessage</span> <span class="operator">=</span> jsi.createMimeMessage();</span><br><span class="line">        <span class="comment">//组装</span></span><br><span class="line">        MimeMessageHelper messageHelper=<span class="keyword">new</span> <span class="title class_">MimeMessageHelper</span>(mimeMessage,html);</span><br><span class="line">        <span class="comment">//正文</span></span><br><span class="line">        messageHelper.setSubject(title);</span><br><span class="line"></span><br><span class="line">        messageHelper.setText(text,textHtml);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//附件</span></span><br><span class="line">        messageHelper.addAttachment(fileName,file);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//发送</span></span><br><span class="line">        messageHelper.setFrom(sendFrom);</span><br><span class="line">        messageHelper.setTo(sendTo);</span><br><span class="line"></span><br><span class="line">        jsi.send(mimeMessage);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="工具类调用法："><a href="#工具类调用法：" class="headerlink" title="工具类调用法："></a>工具类调用法：</h3><ul>
<li>发送邮件工具类：sendMail.java</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sec.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.mail.javamail.JavaMailSenderImpl;</span><br><span class="line"><span class="keyword">import</span> org.springframework.mail.javamail.MimeMessageHelper;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.mail.MessagingException;</span><br><span class="line"><span class="keyword">import</span> javax.mail.internet.MimeMessage;</span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.util.Random;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">sendMail</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    JavaMailSenderImpl jsi;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sendMail</span><span class="params">(Boolean html, String title, String text, Boolean textHtml, String sendFrom, String sendTo, String fileName, File file)</span> <span class="keyword">throws</span> MessagingException &#123;</span><br><span class="line">        <span class="type">MimeMessage</span> <span class="variable">mimeMessage</span> <span class="operator">=</span> jsi.createMimeMessage();</span><br><span class="line">        <span class="comment">//组装</span></span><br><span class="line">        MimeMessageHelper messageHelper=<span class="keyword">new</span> <span class="title class_">MimeMessageHelper</span>(mimeMessage,html);</span><br><span class="line">        <span class="comment">//正文</span></span><br><span class="line">        messageHelper.setSubject(title);</span><br><span class="line"></span><br><span class="line">        messageHelper.setText(text,textHtml);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//附件</span></span><br><span class="line">        messageHelper.addAttachment(fileName,file);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//发送</span></span><br><span class="line">        messageHelper.setFrom(sendFrom);</span><br><span class="line">        messageHelper.setTo(sendTo);</span><br><span class="line"></span><br><span class="line">        jsi.send(mimeMessage);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">hjc</span><span class="params">()</span> <span class="keyword">throws</span> MessagingException &#123;</span><br><span class="line">        <span class="type">MimeMessage</span> <span class="variable">mimeMessage</span> <span class="operator">=</span> jsi.createMimeMessage();</span><br><span class="line">        <span class="comment">//组装</span></span><br><span class="line">        MimeMessageHelper messageHelper=<span class="keyword">new</span> <span class="title class_">MimeMessageHelper</span>(mimeMessage,<span class="literal">true</span>);</span><br><span class="line">        <span class="comment">//正文</span></span><br><span class="line">        messageHelper.setSubject(<span class="string">&quot;尊敬的苏弋您好！&quot;</span>);</span><br><span class="line">        <span class="type">Random</span> <span class="variable">random</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Random</span>();</span><br><span class="line">        <span class="type">int</span> <span class="variable">num</span> <span class="operator">=</span> random.nextInt(<span class="number">9000</span>) + <span class="number">1000</span>;</span><br><span class="line">        messageHelper.setText(<span class="string">&quot;&lt;p style=&#x27;color:red&#x27;&gt;您的验证码是：&quot;</span>+num+<span class="string">&quot;&lt;/p&gt;&quot;</span>,<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//附件</span></span><br><span class="line">        messageHelper.addAttachment(<span class="string">&quot;1.jpg&quot;</span>,<span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;C:\\Users\\飞驰的苏弋\\Pictures\\Camera Roll\\1.jpg&quot;</span>));</span><br><span class="line">        messageHelper.addAttachment(<span class="string">&quot;2.jpg&quot;</span>,<span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;C:\\Users\\飞驰的苏弋\\Pictures\\Camera Roll\\2.jpg&quot;</span>));</span><br><span class="line"></span><br><span class="line">        <span class="comment">//发送</span></span><br><span class="line">        messageHelper.setFrom(<span class="string">&quot;990784805@qq.com&quot;</span>);</span><br><span class="line">        messageHelper.setTo(<span class="string">&quot;3046865110@qq.com&quot;</span>);</span><br><span class="line"></span><br><span class="line">        jsi.send(mimeMessage);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li><p>controller层调用：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sec.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sec.service.helloService;</span><br><span class="line"><span class="keyword">import</span> com.sec.service.sendMail;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.mail.javamail.JavaMailSenderImpl;</span><br><span class="line"><span class="keyword">import</span> org.springframework.mail.javamail.MimeMessageHelper;</span><br><span class="line"><span class="keyword">import</span> org.springframework.scheduling.annotation.EnableAsync;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.ui.Model;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.ResponseBody;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.mail.MessagingException;</span><br><span class="line"><span class="keyword">import</span> javax.mail.internet.MimeMessage;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpSession;</span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@EnableAsync</span><span class="comment">//开启异步任务</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">helloController</span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Autowired</span></span><br><span class="line">helloService hs;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Autowired</span></span><br><span class="line">sendMail sm;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RequestMapping(&#123;&quot;/&quot;,&quot;/index&quot;,&quot;/index.html&quot;&#125;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">index</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;/index&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/hello&quot;)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">test</span><span class="params">()</span>&#123;</span><br><span class="line">    hs.hello();<span class="comment">//停止三秒</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;ok&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/sendMail&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">sendMail</span><span class="params">(Model model)</span> <span class="keyword">throws</span> MessagingException &#123;</span><br><span class="line">    sm.sendMail(<span class="literal">true</span>,<span class="string">&quot;飞驰的苏弋你好！&quot;</span>,<span class="string">&quot;&lt;h2 style=&#x27;color:red&#x27;&gt;你好呀飞驰的苏弋&lt;/h2&gt;&quot;</span>,<span class="literal">true</span>,<span class="string">&quot;990784805@qq.com&quot;</span>,<span class="string">&quot;3046865110@qq.com&quot;</span>,<span class="string">&quot;5.png&quot;</span>,<span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;C:\\Users\\飞驰的苏弋\\Pictures\\Camera Roll\\5.png&quot;</span>));</span><br><span class="line">    model.addAttribute(<span class="string">&quot;msg&quot;</span>,<span class="string">&quot;发送成功&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;/index&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
<li><p>index.html页面编写一个按钮  结合Thymeleaf</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;msg&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/sendMail&#125;&quot;</span>&gt;</span>点击发送邮箱<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="定时任务："><a href="#定时任务：" class="headerlink" title="定时任务："></a>定时任务：</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">TaskScheduler	任务调度者</span><br><span class="line">TaskExecutor	任务执行者</span><br><span class="line"></span><br><span class="line">@EnableScheduling	//开启定时功能的注解</span><br><span class="line">@Scheduled	//什么时候执行</span><br></pre></td></tr></table></figure>



<ol>
<li><p>开启定时功能</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@EnableAsync</span><span class="comment">//开启异步任务</span></span><br><span class="line"><span class="meta">@EnableScheduling</span><span class="comment">//开启定时功能的注解</span></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringBoot09AsyncApplication</span> &#123;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">    SpringApplication.run(SpringBoot09AsyncApplication.class, args);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>编写定时任务的类<br>cron表达式：是一个字符串，字符串以5或6个空格隔开，分为6或7个域，每一个域代表一个含义 </p>
<p>corn从左到右（用空格隔开）：&#x3D;&#x3D;秒  分  时  日  月  周几  年&#x3D;&#x3D; </p>
<p>&#x3D;&#x3D;<strong>注意事项：</strong>&#x3D;&#x3D;</p>
<p>　　每一个域都使用数字，但还可以出现如下特殊字符，它们的含义是：</p>
<p>　　（1）✳：表示匹配该域的任意值。假如在Minutes域使用✳, 即表示每分钟都会触发事件。</p>
<p>　　（2）?：只能用在DayofMonth和DayofWeek两个域。它也匹配域的任意值，但实际不会。因为DayofMonth和DayofWeek会相互影响。例如想在每月的20日触发调度，不管20日到底是星期几，则只能使用如下写法： 13 13 15 20 * ?, 其中最后一位只能用？，而不能使用<em>，如果使用</em>表示不管星期几都会触发，实际上并不是这样。</p>
<p>　　（3）-：表示范围。例如在Minutes域使用5-20，表示从5分到20分钟每分钟触发一次 </p>
<p>　　（4）&#x2F;：表示起始时间开始触发，然后每隔固定时间触发一次。例如在Minutes域使用5&#x2F;20,则意味着5分钟触发一次，而25，45等分别触发一次. </p>
<p>　　（5）,：表示列出枚举值。例如：在Minutes域使用5,20，则意味着在5和20分每分钟触发一次。 </p>
<p>　　（6）L：表示最后，只能出现在DayofWeek和DayofMonth域。如果在DayofWeek域使用5L,意味着在最后的一个星期四触发。 </p>
<p>　　（7）W:表示有效工作日(周一到周五),只能出现在DayofMonth域，系统将在离指定日期的最近的有效工作日触发事件。例如：在 DayofMonth使用5W，如果5日是星期六，则将在最近的工作日：星期五，即4日触发。如果5日是星期天，则在6日(周一)触发；如果5日在星期一到星期五中的一天，则就在5日触发。另外一点，W的最近寻找不会跨过月份 。</p>
<p>　　（8）LW:这两个字符可以连用，表示在某个月最后一个工作日，即最后一个星期五。 </p>
<p>　　（9）#:用于确定每个月第几个星期几，只能出现在DayofMonth域。例如在4#2，表示某月的第二个星期三。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ScheduledService</span> &#123;</span><br><span class="line"><span class="comment">//在一个特定的时间执行这个方法  Timer</span></span><br><span class="line"><span class="comment">//cron表达式</span></span><br><span class="line"><span class="comment">//秒  分  时  日  月  周几</span></span><br><span class="line"><span class="meta">@Scheduled(cron = &quot;59 7 19 * * ?&quot;)</span><span class="comment">//每天的下午7点07分59秒执行</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">hello</span><span class="params">()</span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;hello，你被执行了&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="RPC"><a href="#RPC" class="headerlink" title="RPC"></a>RPC</h2><ul>
<li>简单的说，RPC就是从一台机器（客户端）上通过参数传递的方式调用另一台机器（服务器）上的一个函数或方法（可以统称为服务）并得到返回的结果。</li>
<li>RPC 会隐藏底层的通讯细节（不需要直接处理Socket通讯或Http通讯）</li>
<li>RPC 是一个请求响应模型。客户端发起请求，服务器返回响应（类似于Http的工作方式）</li>
<li>RPC 在使用形式上像调用本地函数（或方法）一样去调用远程的函数（或方法）。</li>
</ul>
<p><img src="/../assets/45366c44f775abfd0ac3b43bccc1abc3_b.jpg" alt="1620352285813"></p>
<h2 id="分布式Dubbo-Zookeeper-SpringBoot"><a href="#分布式Dubbo-Zookeeper-SpringBoot" class="headerlink" title="分布式Dubbo + Zookeeper + SpringBoot"></a>分布式Dubbo + Zookeeper + SpringBoot</h2><h3 id="什么是dubbo？"><a href="#什么是dubbo？" class="headerlink" title="什么是dubbo？"></a>什么是dubbo？</h3><p>Apache Dubbo 是一款高性能、轻量级的开源java RPC框架，它提供了三大核心能力：面向接口的远程方法调用，智能容错和负载均衡，以及服务自动注册和发现。</p>
<h4 id="dubbo的好处"><a href="#dubbo的好处" class="headerlink" title="dubbo的好处"></a>dubbo的好处</h4><ol>
<li>透明化的远程方法调用，就像调用本地方法一样调用远程方法，只需简单配置，没有任何API侵入。</li>
<li>软负载均衡及容错机制，可在内网替代F5等硬件负载均衡器，降低成本，减少单点。</li>
<li>服务自动注册与发现，不再需要写死服务提供方地址，注册中心基于接口名查询服务提供者的IP地址，并且能够平滑添加或删除服务提供者。Dubbo采用全Spring配置方式，透明化接入应用，对应用没有任何API侵入，只需用Spring加载Dubbo的配置即可，Dubbo基于Spring的Schema扩展进行加载。</li>
</ol>
<h4 id="dubbo基本概念"><a href="#dubbo基本概念" class="headerlink" title="dubbo基本概念"></a>dubbo基本概念</h4><p><img src="/../assets/1620390645693.png" alt="1620390645693"></p>
<p><strong>服务提供者（Provider）：</strong>暴露服务的服务提供方，服务提供者在启动时，向注册中心注册自己提供的服务。</p>
<p><strong>服务消费者（Consumer）：</strong>调用远程服务的服务消费方，服务消费者在启动时，向注册中心订阅自己所需的服务，服务消费者，从提供者地址列表中，基于软负载均衡算法，选一台提供者进行调用，如果调用失败，再选另一台调用。</p>
<p><strong>注册中心（Registry）：</strong>注册中心返回服务提供者地址列表给消费者，如果有变更，注册中心将基于长连接推送变更数据给消费者。</p>
<p><strong>监控中心（Monitor）：</strong>服务消费者和提供者，在内存中累计调用次数和调用时间，定时每分钟发送一次统计数据到监控中心。</p>
<p><strong>调用关系说明</strong></p>
<blockquote>
<p>服务容器负责启动，加载，运行服务提供者。</p>
<p>服务提供者在启动时，向注册中心注册自己提供的服务。</p>
<p>服务消费者在启动时，向注册中心订阅自己所需的服务。</p>
<p>注册中心返回服务提供者地址列表给消费者，如果有变更，注册中心将基于长连接推送变更数据给消费者。</p>
<p>服务消费者，从提供者地址列表中，基于软负载均衡算法，选一台提供者进行调用，如果调用失败，再选另一台调用。</p>
<p>服务消费者和提供者，在内存中累计调用次数和调用时间，定时每分钟发送一次统计数据到监控中心。</p>
</blockquote>
<h3 id="zookeeper"><a href="#zookeeper" class="headerlink" title="zookeeper"></a>zookeeper</h3><p>ZooKeeper是一个经典的分布式数据一致性解决方案，致力于为分布式应用提供一个高性能、高可用，且具有严格顺序访问控制能力的分布式协调服务。<br>分布式应用程序可以基于ZooKeeper实现数据发布与订阅、负载均衡、命名服务、分布式协调与通知、集群管理、Leader选举、分布式锁、分布式队列等功能。 </p>
<h3 id="dubbo-admin安装测试"><a href="#dubbo-admin安装测试" class="headerlink" title="dubbo-admin安装测试"></a>dubbo-admin安装测试</h3><ol>
<li><p>下载dubbo-admin<br>地址：<a target="_blank" rel="noopener" href="https://github.com/apache/dubbo-admin/tree/master">https://github.com/apache/dubbo-admin/tree/master</a></p>
</li>
<li><p>解压进入目录<br>修改dubbo-admin\src\main\resource\application.properties  指定zookeeper地址</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server.port</span>=<span class="string">7001</span></span><br><span class="line"><span class="attr">spring.velocity.cache</span>=<span class="string">false</span></span><br><span class="line"><span class="attr">spring.velocity.charset</span>=<span class="string">UTF-8</span></span><br><span class="line"><span class="attr">spring.velocity.layout-url</span>=<span class="string">/templates/default.vm</span></span><br><span class="line"><span class="attr">spring.messages.fallback-to-system-locale</span>=<span class="string">false</span></span><br><span class="line"><span class="attr">spring.messages.basename</span>=<span class="string">i18n/message</span></span><br><span class="line"><span class="attr">spring.root.password</span>=<span class="string">root</span></span><br><span class="line"><span class="attr">spring.guest.password</span>=<span class="string">guest</span></span><br><span class="line"></span><br><span class="line"><span class="attr">dubbo.registry.address</span>=<span class="string">zookeeper://127.0.0.1:2181</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>在项目目录下打包dubbo-admin</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mvn clean package -Dmaven.test.skip=true</span><br></pre></td></tr></table></figure>

<p>第一次打包比较慢，耐心等待</p>
</li>
<li><p>执行dubbo-admin\target下的dubbo-admin-SNAPSHOT.jar</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar dubbo-admin-SNAPSHOT.jar</span><br></pre></td></tr></table></figure>

<p>【注意：zookeeper的服务一定要打开】<br>执行完毕后，我们去访问<a target="_blank" rel="noopener" href="http://localhost:7001/">http://localhost:7001/</a> ,这时候我们需要输入账户和密码，我们都是默认的root-root；<br>登陆成功后，查看界面<br>zookeeper：是一个注册中心<br>dubbo-admin：是一个监控管理后台，查看我们注册了那些服务，消费了哪些服务<br>Dubbo：jar包<br><img src="/../assets/1620433176164.png" alt="1620433176164"></p>
</li>
</ol>
<p>安装完成！<br>SpringBoot+Dubbo+zookeeper</p>
<h3 id="服务注册发现实战"><a href="#服务注册发现实战" class="headerlink" title="服务注册发现实战"></a>服务注册发现实战</h3><p>导入依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--导入依赖  Dubbo  zookeeper--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.dubbo<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>dubbo-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.7.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.github.sgroschupf<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>zkclient<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--日志会冲突--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--引入zookeeper--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.curator<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>curator-framework<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.12.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.curator<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>curator-recipes<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.12.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.zookeeper<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>zookeeper<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.4.14<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--排除这个slf4j-log4j12--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.slf4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>slf4j-log4j12<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>框架搭建</p>
<ol>
<li><p>启动zookeeper！</p>
</li>
<li><p>IDEA创建一个空项目；</p>
</li>
<li><p>创建一个模块，实现服务提供者：provider-server，选择web依赖即可；</p>
</li>
<li><p>项目创建完毕，我们写一个服务，比如卖票的服务；</p>
<p>编写接口</p>
</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sec.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">TicketService</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getTicket</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>​	编写实现类</p>
<p>provider-server提供的服务添加注解    &#x3D;&#x3D;这里@service不要导错包&#x3D;&#x3D;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sec.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.dubbo.config.annotation.Service;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span>    <span class="comment">//可以被扫描到，在项目一启动就自动注册到注册中心</span></span><br><span class="line"><span class="meta">@Component</span>  <span class="comment">//使用了dubbo后尽量不要用service注解</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TicketServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">TicketService</span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getTicket</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&lt;苏弋&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>provider-server的&#x3D;&#x3D;application.properties:&#x3D;&#x3D;</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server.port</span>=<span class="string">8001</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">#服务应用名字</span></span><br><span class="line"><span class="attr">dubbo.application.name</span>=<span class="string">provider-server</span></span><br><span class="line"><span class="comment">#注册中心地址</span></span><br><span class="line"><span class="attr">dubbo.registry.address</span>=<span class="string">zookeeper://127.0.0.1:2181</span></span><br><span class="line"><span class="comment">#哪些服务要被注册</span></span><br><span class="line"><span class="attr">dubbo.scan.base-packages</span>=<span class="string">com.sec.service</span></span><br></pre></td></tr></table></figure>







<p>再创建一个模块，实现消费者：consumer-server，选择web依赖；</p>
<p>编写类，再把TicketService接口拿到这边的service包下</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sec.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.dubbo.config.annotation.Reference;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line">    <span class="comment">//想拿到provider-server提供的票  要去注册中心拿到服务</span></span><br><span class="line">    <span class="meta">@Reference</span>  <span class="comment">//引用   Pom坐标，可以定义路径相同的接口名</span></span><br><span class="line">    TicketService ticketService;</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">buyTicket</span><span class="params">()</span>&#123;</span><br><span class="line">        String ticket=ticketService.getTicket();</span><br><span class="line">        System.out.println(<span class="string">&quot;在注册中心拿到=&gt;&quot;</span>+ticket);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;在注册中心拿到=》&quot;</span>+ticket;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>consumer-server的&#x3D;&#x3D;application.properties&#x3D;&#x3D;</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server.port</span>=<span class="string">8002</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">#消费去哪里拿服务需要暴露自己的名字</span></span><br><span class="line"><span class="attr">dubbo.application.name</span>=<span class="string">consumer-server</span></span><br><span class="line"><span class="comment">#注册中心的地址</span></span><br><span class="line"><span class="attr">dubbo.registry.address</span>=<span class="string">zookeeper://127.0.0.1:2181</span></span><br></pre></td></tr></table></figure>

<p>controller调用buyTicket方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sec.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sec.service.UserService;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.ResponseBody;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">testController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    UserService userService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/test&quot;)</span></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">test</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">str</span> <span class="operator">=</span> userService.buyTicket();</span><br><span class="line">        <span class="keyword">return</span> str;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>







<p>代码编写完毕；</p>
<h4 id="测试运行"><a href="#测试运行" class="headerlink" title="测试运行"></a>测试运行</h4><ol>
<li><p>开启zookeeper服务，找到zkServer.cmd，双击运行。<br><img src="/../assets/1620439926319.png" alt="1620439926319"><br><img src="/../assets/1620439973214.png" alt="1620439973214"></p>
</li>
<li><p>到dubbo-admin-0.0.1-SNAPSHOT.jar的目录下，cmd运行 java -jar dubbo-admin-0.0.1-SNAPSHOT.jar。<br><img src="/../assets/1620439994543.png" alt="1620439994543"><br><img src="/../assets/1620440009406.png" alt="1620440009406"></p>
</li>
<li><p>开启提供者服务<br><img src="/../assets/1620440033742.png" alt="1620440033742"></p>
</li>
<li><p>访问<a target="_blank" rel="noopener" href="http://localhost:7001/">http://localhost:7001</a>  查看提供者服务有没有<br><img src="/../assets/1620440156252.png" alt="1620440156252"></p>
</li>
<li><p>访问<a target="_blank" rel="noopener" href="http://localhost:8002/test">http://localhost:8002/test</a><br><img src="/../assets/1620440245065.png" alt="1620440245065"></p>
</li>
<li><p>查看后台Dubbo Admin的消费者是否产生</p>
<p><img src="/../assets/1620440287811.png" alt="1620440287811"></p>
</li>
<li><p>完毕</p>
</li>
</ol>
<h4 id="总结步骤："><a href="#总结步骤：" class="headerlink" title="总结步骤："></a>总结步骤：</h4><p>前提：zookeeper服务已开启</p>
<ol>
<li>提供者提供服务<ol>
<li>导入依赖</li>
<li>配置注册中心的地址，以及服务发现名，和要扫描的包</li>
<li>在想要被注册的服务上面增加一个注解&#x3D;&#x3D;@Service&#x3D;&#x3D;  dubbo的注解</li>
</ol>
</li>
<li>消费者如何消费<ol>
<li>导入依赖</li>
<li>配置注册中心的地址，配置自己的服务名</li>
<li>从远程注入服务  @Reference</li>
</ol>
</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://suyiharris.github.io/2023/10/24/2023-10-24-SpringBoot%EF%BC%9A%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8%EF%BC%88%E7%BB%AD%EF%BC%89/" data-id="clo4h2l3t000mnso9bowzdhsm" data-title="SpringBoot：快速入门（续）" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-2023-10-24-springboot实现websocket实时通信" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/10/24/2023-10-24-springboot%E5%AE%9E%E7%8E%B0websocket%E5%AE%9E%E6%97%B6%E9%80%9A%E4%BF%A1/" class="article-date">
  <time class="dt-published" datetime="2023-10-24T04:12:12.000Z" itemprop="datePublished">2023-10-24</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2023/10/24/2023-10-24-springboot%E5%AE%9E%E7%8E%B0websocket%E5%AE%9E%E6%97%B6%E9%80%9A%E4%BF%A1/">springboot实现websocket实时通信</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="springboot实现websocket实时通信"><a href="#springboot实现websocket实时通信" class="headerlink" title="springboot实现websocket实时通信"></a>springboot实现websocket实时通信</h1><p>直接上代码</p>
<h3 id="1-创建springboot项目"><a href="#1-创建springboot项目" class="headerlink" title="1.创建springboot项目"></a>1.创建springboot项目</h3><p><img src="/../assets/1691150993767.png" alt="1691150993767"></p>
<h3 id="2-导入pom依赖"><a href="#2-导入pom依赖" class="headerlink" title="2.导入pom依赖"></a>2.导入pom依赖</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-thymeleaf<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-devtools<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>runtime<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-websocket<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>fastjson<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.76<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="3-创建pojo类"><a href="#3-创建pojo类" class="headerlink" title="3.创建pojo类"></a>3.创建pojo类</h3><h4 id="Message-java"><a href="#Message-java" class="headerlink" title="Message.java"></a>Message.java</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.hjc.mychat.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Message</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> String toName;</span><br><span class="line">    <span class="keyword">public</span> String message;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Message&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;toName=&#x27;&quot;</span> + toName + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, message=&#x27;&quot;</span> + message + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getToName</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> toName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setToName</span><span class="params">(String toName)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.toName = toName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getMessage</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> message;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setMessage</span><span class="params">(String message)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.message = message;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Message</span><span class="params">(String toName, String message)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.toName = toName;</span><br><span class="line">        <span class="built_in">this</span>.message = message;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Message</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="Result-java"><a href="#Result-java" class="headerlink" title="Result.java"></a>Result.java</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.hjc.mychat.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Result</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> flag;</span><br><span class="line">    <span class="keyword">private</span> String message;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Result</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Result</span><span class="params">(<span class="type">boolean</span> flag, String message)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.flag = flag;</span><br><span class="line">        <span class="built_in">this</span>.message = message;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Result&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;flag=&quot;</span> + flag +</span><br><span class="line">                <span class="string">&quot;, message=&#x27;&quot;</span> + message + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isFlag</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> flag;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setFlag</span><span class="params">(<span class="type">boolean</span> flag)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.flag = flag;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getMessage</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> message;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setMessage</span><span class="params">(String message)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.message = message;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="ResultMessage-java"><a href="#ResultMessage-java" class="headerlink" title="ResultMessage.java"></a>ResultMessage.java</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.hjc.mychat.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ResultMessage</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> isSystemMessage;</span><br><span class="line">    <span class="keyword">private</span> String fromName;</span><br><span class="line">    <span class="keyword">private</span> Object message;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;ResultMessage&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;isSystemMessage=&quot;</span> + isSystemMessage +</span><br><span class="line">                <span class="string">&quot;, fromName=&#x27;&quot;</span> + fromName + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, message=&quot;</span> + message +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isSystemMessage</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> isSystemMessage;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setSystemMessage</span><span class="params">(<span class="type">boolean</span> systemMessage)</span> &#123;</span><br><span class="line">        isSystemMessage = systemMessage;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getFromName</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> fromName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setFromName</span><span class="params">(String fromName)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.fromName = fromName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">getMessage</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> message;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setMessage</span><span class="params">(Object message)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.message = message;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">ResultMessage</span><span class="params">(<span class="type">boolean</span> isSystemMessage, String fromName, Object message)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.isSystemMessage = isSystemMessage;</span><br><span class="line">        <span class="built_in">this</span>.fromName = fromName;</span><br><span class="line">        <span class="built_in">this</span>.message = message;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">ResultMessage</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="4-utils工具类层"><a href="#4-utils工具类层" class="headerlink" title="4.utils工具类层"></a>4.utils工具类层</h3><p>MessageUtils.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.hjc.mychat.utils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.core.JsonProcessingException;</span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.databind.ObjectMapper;</span><br><span class="line"><span class="keyword">import</span> com.hjc.mychat.pojo.ResultMessage;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MessageUtils</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">getMessage</span><span class="params">(<span class="type">boolean</span> isSystemMessage,String fromName,Object message)</span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">ResultMessage</span> <span class="variable">result</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ResultMessage</span>();</span><br><span class="line">            result.setSystemMessage(isSystemMessage);</span><br><span class="line">            result.setMessage(message);</span><br><span class="line">            <span class="keyword">if</span> (fromName!=<span class="literal">null</span>)&#123;</span><br><span class="line">                result.setFromName(fromName);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//把字符串转成json格式的字符串</span></span><br><span class="line">            <span class="type">ObjectMapper</span> <span class="variable">mapper</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectMapper</span>();</span><br><span class="line">            <span class="keyword">return</span> mapper.writeValueAsString(result);</span><br><span class="line">        &#125;<span class="keyword">catch</span> (JsonProcessingException e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="5-controller层"><a href="#5-controller层" class="headerlink" title="5.controller层"></a>5.controller层</h3><h4 id="pageController-java"><a href="#pageController-java" class="headerlink" title="pageController.java"></a>pageController.java</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.hjc.mychat.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">pageController</span> &#123;</span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/login&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">login</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;login&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/main&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;main&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>userController.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.hjc.mychat.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.hjc.mychat.pojo.Result;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestParam;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpSession;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">userController</span> &#123;</span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/toLogin&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result <span class="title function_">tologin</span><span class="params">(<span class="meta">@RequestParam(&quot;user&quot;)</span> String user, <span class="meta">@RequestParam(&quot;pwd&quot;)</span> String pwd, HttpSession session)</span>&#123;</span><br><span class="line">        <span class="type">Result</span> <span class="variable">result</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Result</span>();</span><br><span class="line">        <span class="keyword">if</span> (user.equals(<span class="string">&quot;张三&quot;</span>)&amp;&amp;pwd.equals(<span class="string">&quot;123&quot;</span>))&#123;</span><br><span class="line">            result.setFlag(<span class="literal">true</span>);</span><br><span class="line">            session.setAttribute(<span class="string">&quot;user&quot;</span>,user);</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span> (user.equals(<span class="string">&quot;李四&quot;</span>)&amp;&amp;pwd.equals(<span class="string">&quot;123&quot;</span>))&#123;</span><br><span class="line">            result.setFlag(<span class="literal">true</span>);</span><br><span class="line">            session.setAttribute(<span class="string">&quot;user&quot;</span>,user);</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span> (user.equals(<span class="string">&quot;123&quot;</span>)&amp;&amp;pwd.equals(<span class="string">&quot;123&quot;</span>))&#123;</span><br><span class="line">            result.setFlag(<span class="literal">true</span>);</span><br><span class="line">            session.setAttribute(<span class="string">&quot;user&quot;</span>,user);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (user.equals(<span class="string">&quot;王五&quot;</span>)&amp;&amp;pwd.equals(<span class="string">&quot;123&quot;</span>))&#123;</span><br><span class="line">            result.setFlag(<span class="literal">true</span>);</span><br><span class="line">            session.setAttribute(<span class="string">&quot;user&quot;</span>,user);</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            result.setFlag(<span class="literal">false</span>);</span><br><span class="line">            result.setMessage(<span class="string">&quot;登录失败&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/getUsername&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getUsername</span><span class="params">(HttpSession session)</span>&#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">username</span> <span class="operator">=</span> (String) session.getAttribute(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> username;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="6-config层"><a href="#6-config层" class="headerlink" title="6.config层"></a>6.config层</h3><h4 id="WebsocketConfig-java"><a href="#WebsocketConfig-java" class="headerlink" title="WebsocketConfig.java"></a>WebsocketConfig.java</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.hjc.mychat.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.socket.server.standard.ServerEndpointExporter;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WebsocketConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> ServerEndpointExporter <span class="title function_">serverEndpointExporter</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ServerEndpointExporter</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="7-websocket层"><a href="#7-websocket层" class="headerlink" title="7.websocket层"></a>7.websocket层</h3><h4 id="ChatEndpoint-java"><a href="#ChatEndpoint-java" class="headerlink" title="ChatEndpoint.java"></a>ChatEndpoint.java</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.hjc.mychat.ws;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.databind.ObjectMapper;</span><br><span class="line"><span class="keyword">import</span> com.hjc.mychat.pojo.Message;</span><br><span class="line"><span class="keyword">import</span> com.hjc.mychat.utils.MessageUtils;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpSession;</span><br><span class="line"><span class="keyword">import</span> javax.websocket.*;</span><br><span class="line"><span class="keyword">import</span> javax.websocket.server.ServerEndpoint;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.ConcurrentHashMap;</span><br><span class="line"></span><br><span class="line"><span class="meta">@ServerEndpoint( value = &quot;/hjcchat&quot;,configurator = GetHttpSessionConfigurator.class)</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ChatEndpoint</span> &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//用来存储每个用户客户端对象的ChatEndpoint对象</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Map&lt;String,ChatEndpoint&gt; onlineUsers = <span class="keyword">new</span> <span class="title class_">ConcurrentHashMap</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//声明session对象，通过对象可以发送消息给指定的用户</span></span><br><span class="line">    <span class="keyword">private</span> Session session;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//声明HttpSession对象，我们之前在HttpSession对象中存储了用户名</span></span><br><span class="line">    <span class="keyword">private</span> HttpSession httpSession;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//连接建立</span></span><br><span class="line">    <span class="meta">@OnOpen</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onOpen</span><span class="params">(Session session, EndpointConfig config)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.session = session;</span><br><span class="line">        <span class="type">HttpSession</span> <span class="variable">httpSession</span> <span class="operator">=</span> (HttpSession) config.getUserProperties().get(HttpSession.class.getName());</span><br><span class="line">        <span class="built_in">this</span>.httpSession = httpSession;</span><br><span class="line">        <span class="comment">//存储登陆的对象</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">username</span> <span class="operator">=</span> (String)httpSession.getAttribute(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">        onlineUsers.put(username,<span class="built_in">this</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//将当前在线用户的用户名推送给所有的客户端</span></span><br><span class="line">        <span class="comment">//1 获取消息</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">message</span> <span class="operator">=</span> MessageUtils.getMessage(<span class="literal">true</span>, <span class="literal">null</span>, getNames());</span><br><span class="line">        <span class="comment">//2 调用方法进行系统消息的推送</span></span><br><span class="line">        broadcastAllUsers(message);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">broadcastAllUsers</span><span class="params">(String message)</span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//将消息推送给所有的客户端</span></span><br><span class="line">            Set&lt;String&gt; names = onlineUsers.keySet();</span><br><span class="line">            <span class="keyword">for</span> (String name : names) &#123;</span><br><span class="line">                <span class="type">ChatEndpoint</span> <span class="variable">chatEndpoint</span> <span class="operator">=</span> onlineUsers.get(name);</span><br><span class="line">                chatEndpoint.session.getBasicRemote().sendText(message);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//返回在线用户名</span></span><br><span class="line">    <span class="keyword">private</span> Set&lt;String&gt; <span class="title function_">getNames</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> onlineUsers.keySet();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//收到消息</span></span><br><span class="line">    <span class="meta">@OnMessage</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onMessage</span><span class="params">(String message,Session session)</span>&#123;</span><br><span class="line">        <span class="comment">//将数据转换成对象</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">ObjectMapper</span> <span class="variable">mapper</span> <span class="operator">=</span><span class="keyword">new</span> <span class="title class_">ObjectMapper</span>();</span><br><span class="line">            <span class="type">Message</span> <span class="variable">mess</span> <span class="operator">=</span> mapper.readValue(message, Message.class);</span><br><span class="line">            <span class="type">String</span> <span class="variable">toName</span> <span class="operator">=</span> mess.getToName();</span><br><span class="line">            <span class="type">String</span> <span class="variable">data</span> <span class="operator">=</span> mess.getMessage();</span><br><span class="line">            <span class="type">String</span> <span class="variable">username</span> <span class="operator">=</span> (String) httpSession.getAttribute(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">resultMessage</span> <span class="operator">=</span> MessageUtils.getMessage(<span class="literal">false</span>, username, data);</span><br><span class="line">            <span class="comment">//发送数据</span></span><br><span class="line">            onlineUsers.get(toName).session.getBasicRemote().sendText(resultMessage);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//关闭</span></span><br><span class="line">    <span class="meta">@OnClose</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClose</span><span class="params">(Session session)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">username</span> <span class="operator">=</span> (String) httpSession.getAttribute(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">        <span class="comment">//从容器中删除指定的用户</span></span><br><span class="line">        onlineUsers.remove(username);</span><br><span class="line">        <span class="type">String</span> <span class="variable">message</span> <span class="operator">=</span> MessageUtils.getMessage(<span class="literal">true</span>, <span class="literal">null</span>, getNames());</span><br><span class="line">        broadcastAllUsers(message);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="GetHttpSessionConfigurator-java"><a href="#GetHttpSessionConfigurator-java" class="headerlink" title="GetHttpSessionConfigurator.java"></a>GetHttpSessionConfigurator.java</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.hjc.mychat.ws;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpSession;</span><br><span class="line"><span class="keyword">import</span> javax.websocket.HandshakeResponse;</span><br><span class="line"><span class="keyword">import</span> javax.websocket.server.HandshakeRequest;</span><br><span class="line"><span class="keyword">import</span> javax.websocket.server.ServerEndpointConfig;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GetHttpSessionConfigurator</span> <span class="keyword">extends</span> <span class="title class_">ServerEndpointConfig</span>.Configurator &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">modifyHandshake</span><span class="params">(ServerEndpointConfig sec, HandshakeRequest request, HandshakeResponse response)</span> &#123;</span><br><span class="line">        <span class="comment">//获取HttpSession对象</span></span><br><span class="line">        <span class="type">HttpSession</span> <span class="variable">httpSession</span> <span class="operator">=</span> (HttpSession) request.getHttpSession();</span><br><span class="line">        sec.getUserProperties().put(HttpSession.class.getName(),httpSession);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="8-前端页面"><a href="#8-前端页面" class="headerlink" title="8.前端页面"></a>8.前端页面</h3><h4 id="login-html"><a href="#login-html" class="headerlink" title="login.html"></a>login.html</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>网络聊天室-登录<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--核心样式--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;css/style.css&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;container&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;card&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;card&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span> <span class="attr">class</span>=<span class="string">&quot;title&quot;</span>&gt;</span>用户登录<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">id</span>=<span class="string">&quot;loginForm&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;input-container&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&quot;user&quot;</span> <span class="attr">name</span>=<span class="string">&quot;user&quot;</span> <span class="attr">required</span>=<span class="string">&quot;required&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;user&quot;</span>&gt;</span>用户名<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;bar&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;input-container&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">id</span>=<span class="string">&quot;pwd&quot;</span> <span class="attr">name</span>=<span class="string">&quot;pwd&quot;</span> <span class="attr">required</span>=<span class="string">&quot;required&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;pwd&quot;</span>&gt;</span>密码<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;bar&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;button-container&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">id</span>=<span class="string">&quot;btn&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">span</span>&gt;</span>登录<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">p</span> <span class="attr">style</span>=<span class="string">&quot;color: red;text-align: center&quot;</span> <span class="attr">id</span>=<span class="string">&quot;err_msg&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  $(<span class="string">&quot;#btn&quot;</span>).<span class="title function_">click</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    $.<span class="title function_">get</span>(<span class="string">&quot;toLogin?&quot;</span>,$(<span class="string">&quot;#loginForm&quot;</span>).<span class="title function_">serialize</span>(),<span class="keyword">function</span>(<span class="params">res</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">if</span> (res.<span class="property">flag</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(res);</span></span><br><span class="line"><span class="language-javascript">        location.<span class="property">href</span> = <span class="string">&quot;main&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">      &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(res);</span></span><br><span class="line"><span class="language-javascript">        $(<span class="string">&quot;#err_msg&quot;</span>).<span class="title function_">html</span>(res.<span class="property">message</span>);</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;,<span class="string">&quot;json&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">  &#125;)</span></span><br><span class="line"><span class="language-javascript">  $(<span class="string">&quot;#pwd&quot;</span>).<span class="title function_">keypress</span>(<span class="keyword">function</span> (<span class="params">e</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">if</span>(e.<span class="property">keyCode</span>==<span class="number">13</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">      $.<span class="title function_">get</span>(<span class="string">&quot;toLogin?&quot;</span>,$(<span class="string">&quot;#loginForm&quot;</span>).<span class="title function_">serialize</span>(),<span class="keyword">function</span>(<span class="params">res</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (res.<span class="property">flag</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">console</span>.<span class="title function_">log</span>(res);</span></span><br><span class="line"><span class="language-javascript">          location.<span class="property">href</span> = <span class="string">&quot;main&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">        &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">console</span>.<span class="title function_">log</span>(res);</span></span><br><span class="line"><span class="language-javascript">          $(<span class="string">&quot;#err_msg&quot;</span>).<span class="title function_">html</span>(res.<span class="property">message</span>);</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">      &#125;,<span class="string">&quot;json&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  &#125;)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h4 id="main-html"><a href="#main-html" class="headerlink" title="main.html"></a>main.html</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/1999/html&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>网络聊天室<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;css/mycss.css&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span> = <span class="string">&quot;contains&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;username&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">h3</span> <span class="attr">style</span>=<span class="string">&quot;text-align: center;&quot;</span>&gt;</span>用户：张三<span class="tag">&lt;<span class="name">span</span>&gt;</span>-在线<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">h3</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;Inchat&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;left&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;content&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;input&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">textarea</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&quot;input_text&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 695px;height: 200px;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">style</span>=<span class="string">&quot;float: right;&quot;</span>&gt;</span>发送<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;right&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">&quot;hy&quot;</span> <span class="attr">style</span>=<span class="string">&quot;text-align: center;&quot;</span>&gt;</span>好友列表<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;hyList&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">&quot;xt&quot;</span> <span class="attr">style</span>=<span class="string">&quot;text-align: center&quot;</span>&gt;</span>系统消息<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;xtList&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> toName;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> username;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//点击好友名称展示相关消息</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">showChat</span>(<span class="params">name</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">        toName = name;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//现在聊天框</span></span></span><br><span class="line"><span class="language-javascript">        $(<span class="string">&quot;#content&quot;</span>).<span class="title function_">html</span>(<span class="string">&quot;&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">        $(<span class="string">&quot;#content&quot;</span>).<span class="title function_">css</span>(<span class="string">&quot;visibility&quot;</span>,<span class="string">&quot;visible&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">        $(<span class="string">&quot;#Inchat&quot;</span>).<span class="title function_">html</span>(<span class="string">&quot;当前正与&quot;</span>+toName+<span class="string">&quot;聊天&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//从sessionStorage中获取历史信息</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> chatData = <span class="variable language_">sessionStorage</span>.<span class="title function_">getItem</span>(toName);</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (chatData != <span class="literal">null</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">            $(<span class="string">&quot;#content&quot;</span>).<span class="title function_">html</span>(chatData);</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    $(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        $.<span class="title function_">ajax</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">url</span>:<span class="string">&quot;getUsername&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">success</span>:<span class="keyword">function</span> (<span class="params">res</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                username = res;</span></span><br><span class="line"><span class="language-javascript">            &#125;,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">async</span>:<span class="literal">false</span> <span class="comment">//同步请求，只有上面好了才会接着下面</span></span></span><br><span class="line"><span class="language-javascript">        &#125;);</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//建立websocket连接</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//获取host解决后端获取httpsession的空指针异常</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> host = <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">host</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> ws = <span class="keyword">new</span> <span class="title class_">WebSocket</span>(<span class="string">&quot;ws://&quot;</span>+host+<span class="string">&quot;/hjcchat&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">        ws.<span class="property">onopen</span> = <span class="keyword">function</span> (<span class="params">evt</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            $(<span class="string">&quot;#username&quot;</span>).<span class="title function_">html</span>(<span class="string">&quot;&lt;h3 style=\&quot;text-align: center;\&quot;&gt;用户：&quot;</span>+ username +<span class="string">&quot;&lt;span&gt;-在线&lt;/span&gt;&lt;/h3&gt;&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//接受消息</span></span></span><br><span class="line"><span class="language-javascript">        ws.<span class="property">onmessage</span> = <span class="keyword">function</span> (<span class="params">evt</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">//获取服务端推送的消息</span></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">var</span> dataStr = evt.<span class="property">data</span>;</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">//将dataStr转换为json对象</span></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">var</span> res = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(dataStr);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">console</span>.<span class="title function_">log</span>(res)</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">//判断是否是系统消息</span></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">if</span>(res.<span class="property">systemMessage</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="comment">//系统消息</span></span></span><br><span class="line"><span class="language-javascript">                <span class="comment">//1.好友列表展示</span></span></span><br><span class="line"><span class="language-javascript">                <span class="comment">//2.系统广播的展示</span></span></span><br><span class="line"><span class="language-javascript">                <span class="comment">//此处声明的变量是调试时命名的，可以直接合并</span></span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">var</span> names = res.<span class="property">message</span>;</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">var</span> userlistStr = <span class="string">&quot;&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">var</span> broadcastListStr = <span class="string">&quot;&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">var</span> temp01 = <span class="string">&quot;&lt;a style=\&quot;text-align: center; display: block;\&quot; onclick=&#x27;showChat(\&quot;&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">var</span> temp03 = <span class="string">&quot;\&quot;)&#x27;&gt;&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">var</span> temp04 = <span class="string">&quot;&lt;/a&gt;&lt;/br&gt;&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">var</span> temp = <span class="string">&quot;&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">for</span> (<span class="keyword">var</span> name <span class="keyword">of</span> names)&#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="keyword">if</span> (name != username)&#123;</span></span><br><span class="line"><span class="language-javascript">                        temp = temp01 + name + temp03 + name + temp04;</span></span><br><span class="line"><span class="language-javascript">                        userlistStr = userlistStr + temp;</span></span><br><span class="line"><span class="language-javascript">                        broadcastListStr += <span class="string">&quot;&lt;p style=&#x27;text-align: center&#x27;&gt;&quot;</span>+ name +<span class="string">&quot;上线了&lt;/p&gt;&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">                    &#125;</span></span><br><span class="line"><span class="language-javascript">                &#125;</span></span><br><span class="line"><span class="language-javascript">                <span class="comment">//渲染好友列表和系统广播</span></span></span><br><span class="line"><span class="language-javascript">                $(<span class="string">&quot;#hyList&quot;</span>).<span class="title function_">html</span>(userlistStr);</span></span><br><span class="line"><span class="language-javascript">                $(<span class="string">&quot;#xtList&quot;</span>).<span class="title function_">html</span>(broadcastListStr);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            &#125;<span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="comment">//不是系统消息</span></span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">var</span> str = <span class="string">&quot;&lt;span id=&#x27;mes_left&#x27;&gt;&quot;</span>+ res.<span class="property">message</span> +<span class="string">&quot;&lt;/span&gt;&lt;/br&gt;&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">if</span> (toName === res.<span class="property">fromName</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                    $(<span class="string">&quot;#content&quot;</span>).<span class="title function_">append</span>(str);</span></span><br><span class="line"><span class="language-javascript">                &#125;</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">var</span> chatData = <span class="variable language_">sessionStorage</span>.<span class="title function_">getItem</span>(res.<span class="property">fromName</span>);</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">if</span> (chatData != <span class="literal">null</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">                    str = chatData + str;</span></span><br><span class="line"><span class="language-javascript">                &#125;</span></span><br><span class="line"><span class="language-javascript">                <span class="comment">//保存聊天消息</span></span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">sessionStorage</span>.<span class="title function_">setItem</span>(res.<span class="property">fromName</span>,str);</span></span><br><span class="line"><span class="language-javascript">            &#125;;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">        ws.<span class="property">onclose</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            $(<span class="string">&quot;#username&quot;</span>).<span class="title function_">html</span>(<span class="string">&quot;&lt;h3 style=\&quot;text-align: center;\&quot;&gt;用户：&quot;</span>+ username +<span class="string">&quot;&lt;span&gt;-离线&lt;/span&gt;&lt;/h3&gt;&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//发送消息</span></span></span><br><span class="line"><span class="language-javascript">        $(<span class="string">&quot;#submit&quot;</span>).<span class="title function_">click</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="title function_">sendmessage</span>();</span></span><br><span class="line"><span class="language-javascript">        &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//监听回车发送</span></span></span><br><span class="line"><span class="language-javascript">        $(<span class="string">&quot;#input_text&quot;</span>).<span class="title function_">keypress</span>(<span class="keyword">function</span> (<span class="params">e</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">if</span>(e.<span class="property">keyCode</span>==<span class="number">13</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="title function_">sendmessage</span>();</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">function</span> <span class="title function_">sendmessage</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">//1.获取输入的内容</span></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">var</span> data = $(<span class="string">&quot;#input_text&quot;</span>).<span class="title function_">val</span>();</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">//2.清空发送框</span></span></span><br><span class="line"><span class="language-javascript">            $(<span class="string">&quot;#input_text&quot;</span>).<span class="title function_">val</span>(<span class="string">&quot;&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">var</span> json = &#123;<span class="string">&quot;toName&quot;</span>: toName ,<span class="string">&quot;message&quot;</span>: data&#125;;</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">//将数据展示在聊天区</span></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">var</span> str = <span class="string">&quot;&lt;span id=&#x27;mes_right&#x27;&gt;&quot;</span>+ data +<span class="string">&quot;&lt;/span&gt;&lt;/br&gt;&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">            $(<span class="string">&quot;#content&quot;</span>).<span class="title function_">append</span>(str);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">var</span> chatData = <span class="variable language_">sessionStorage</span>.<span class="title function_">getItem</span>(toName);</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">if</span> (chatData != <span class="literal">null</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">                str = chatData + str;</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">sessionStorage</span>.<span class="title function_">setItem</span>(toName,str);</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">//3.发送数据</span></span></span><br><span class="line"><span class="language-javascript">            ws.<span class="title function_">send</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(json));</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h3 id="9-css样式"><a href="#9-css样式" class="headerlink" title="9.css样式"></a>9.css样式</h3><h4 id="mycss-css"><a href="#mycss-css" class="headerlink" title="mycss.css"></a>mycss.css</h4><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#contains</span>&#123;</span><br><span class="line">    <span class="attribute">background-color</span>: pink;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">1000px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">700px</span>;</span><br><span class="line">    <span class="attribute">margin</span>: auto;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#username</span>&#123;</span><br><span class="line">    <span class="attribute">background-color</span>: powderblue;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">1000px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">30px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#Inchat</span>&#123;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="built_in">rgb</span>(<span class="number">5</span>, <span class="number">130</span>, <span class="number">146</span>);</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">1000px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">30px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#left</span>&#123;</span><br><span class="line">    <span class="attribute">background-color</span>: salmon;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">700px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">640px</span>;</span><br><span class="line">    <span class="attribute">float</span>: left;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#content</span>&#123;</span><br><span class="line">    <span class="attribute">background-color</span>: silver;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">700px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">400px</span>;</span><br><span class="line">    <span class="comment">/*display: none;*/</span></span><br><span class="line">    <span class="attribute">visibility</span>: hidden;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#right</span>&#123;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="built_in">rgb</span>(<span class="number">107</span>, <span class="number">3</span>, <span class="number">3</span>);</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">300px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">640px</span>;</span><br><span class="line">    <span class="attribute">float</span>: right;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#hyList</span>&#123;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">270px</span>;</span><br><span class="line">    <span class="attribute">overflow-y</span>: scroll;</span><br><span class="line">    <span class="attribute">background</span>: antiquewhite;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#xtList</span>&#123;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">270px</span>;</span><br><span class="line">    <span class="attribute">overflow-y</span>: scroll;</span><br><span class="line">    <span class="attribute">background</span>: antiquewhite;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#input</span>&#123;</span><br><span class="line">    <span class="attribute">margin-bottom</span>: <span class="number">0px</span>;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">bottom</span>: <span class="number">0px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#mes_left</span>&#123;</span><br><span class="line">    <span class="attribute">float</span>: left;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">2px</span> aqua;</span><br><span class="line">    <span class="attribute">max-width</span>: <span class="number">490px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#mes_right</span>&#123;</span><br><span class="line">    <span class="attribute">float</span>: right;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">2px</span> aqua;</span><br><span class="line">    <span class="attribute">max-width</span>: <span class="number">490px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#hy</span>&#123;</span><br><span class="line">    <span class="attribute">display</span>: block;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">300px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">textarea</span> &#123;</span><br><span class="line">    <span class="attribute">resize</span>: none;</span><br><span class="line">    <span class="attribute">border</span>: none;</span><br><span class="line">    <span class="attribute">outline</span>: none</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="style-css"><a href="#style-css" class="headerlink" title="style.css"></a>style.css</h4><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#e9e9e9</span>;</span><br><span class="line">  <span class="attribute">color</span>: deeppink;</span><br><span class="line">  <span class="attribute">font-family</span>: <span class="string">&quot;RobotoDraft&quot;</span>, <span class="string">&quot;Roboto&quot;</span>, sans-serif;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">justify-content</span>: center;</span><br><span class="line">  <span class="attribute">align-items</span>: center;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">14px</span>;</span><br><span class="line">  -webkit-<span class="attribute">font-smoothing</span>: antialiased;</span><br><span class="line">  -moz-osx-<span class="attribute">font-smoothing</span>: grayscale;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Pen Title */</span></span><br><span class="line"><span class="selector-class">.pen-title</span> &#123;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">50px</span> <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">  <span class="attribute">letter-spacing</span>: <span class="number">2px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.pen-title</span> <span class="selector-tag">h1</span> &#123;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">48px</span>;</span><br><span class="line">  <span class="attribute">font-weight</span>: <span class="number">300</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.pen-title</span> <span class="selector-tag">span</span> &#123;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">12px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.pen-title</span> <span class="selector-tag">span</span> <span class="selector-class">.fa</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#006a71</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.pen-title</span> <span class="selector-tag">span</span> <span class="selector-tag">a</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#006a71</span>;</span><br><span class="line">  <span class="attribute">font-weight</span>: <span class="number">600</span>;</span><br><span class="line">  <span class="attribute">text-decoration</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Container */</span></span><br><span class="line"><span class="selector-class">.container</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">  <span class="attribute">max-width</span>: <span class="number">460px</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span> auto <span class="number">100px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.container</span><span class="selector-class">.active</span> <span class="selector-class">.card</span><span class="selector-pseudo">:first</span>-child &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#f2f2f2</span>;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span> <span class="number">15px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.container</span><span class="selector-class">.active</span> <span class="selector-class">.card</span><span class="selector-pseudo">:nth-child</span>(<span class="number">2</span>) &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#fafafa</span>;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span> <span class="number">10px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.container</span><span class="selector-class">.active</span> <span class="selector-class">.card</span><span class="selector-class">.alt</span> &#123;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">right</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">min-width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">height</span>: auto;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">5px</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">60px</span> <span class="number">0</span> <span class="number">40px</span>;</span><br><span class="line">  <span class="attribute">overflow</span>: hidden;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.container</span><span class="selector-class">.active</span> <span class="selector-class">.card</span><span class="selector-class">.alt</span> <span class="selector-class">.toggle</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">40px</span>;</span><br><span class="line">  <span class="attribute">right</span>: -<span class="number">70px</span>;</span><br><span class="line">  <span class="attribute">box-shadow</span>: none;</span><br><span class="line">  -webkit-<span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">10</span>);</span><br><span class="line">  -moz-<span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">10</span>);</span><br><span class="line">  -ms-<span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">10</span>);</span><br><span class="line">  -o-<span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">10</span>);</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">10</span>);</span><br><span class="line">  <span class="attribute">transition</span>: transform <span class="number">0.3s</span> ease;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.container</span><span class="selector-class">.active</span> <span class="selector-class">.card</span><span class="selector-class">.alt</span> <span class="selector-class">.toggle</span><span class="selector-pseudo">:before</span> &#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&quot;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.container</span><span class="selector-class">.active</span> <span class="selector-class">.card</span><span class="selector-class">.alt</span> <span class="selector-class">.title</span>,</span><br><span class="line"><span class="selector-class">.container</span><span class="selector-class">.active</span> <span class="selector-class">.card</span><span class="selector-class">.alt</span> <span class="selector-class">.input-container</span>,</span><br><span class="line"><span class="selector-class">.container</span><span class="selector-class">.active</span> <span class="selector-class">.card</span><span class="selector-class">.alt</span> <span class="selector-class">.button-container</span> &#123;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">  <span class="attribute">visibility</span>: visible;</span><br><span class="line">  <span class="attribute">transition</span>: <span class="number">0.3s</span> ease;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.container</span><span class="selector-class">.active</span> <span class="selector-class">.card</span><span class="selector-class">.alt</span> <span class="selector-class">.title</span> &#123;</span><br><span class="line">  <span class="attribute">transition-delay</span>: <span class="number">0.3s</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.container</span><span class="selector-class">.active</span> <span class="selector-class">.card</span><span class="selector-class">.alt</span> <span class="selector-class">.input-container</span> &#123;</span><br><span class="line">  <span class="attribute">transition-delay</span>: <span class="number">0.4s</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.container</span><span class="selector-class">.active</span> <span class="selector-class">.card</span><span class="selector-class">.alt</span> <span class="selector-class">.input-container</span><span class="selector-pseudo">:nth-child</span>(<span class="number">2</span>) &#123;</span><br><span class="line">  <span class="attribute">transition-delay</span>: <span class="number">0.5s</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.container</span><span class="selector-class">.active</span> <span class="selector-class">.card</span><span class="selector-class">.alt</span> <span class="selector-class">.input-container</span><span class="selector-pseudo">:nth-child</span>(<span class="number">3</span>) &#123;</span><br><span class="line">  <span class="attribute">transition-delay</span>: <span class="number">0.6s</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.container</span><span class="selector-class">.active</span> <span class="selector-class">.card</span><span class="selector-class">.alt</span> <span class="selector-class">.button-container</span> &#123;</span><br><span class="line">  <span class="attribute">transition-delay</span>: <span class="number">0.7s</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Card */</span></span><br><span class="line"><span class="selector-class">.card</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#ffffff</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">5px</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">60px</span> <span class="number">0</span> <span class="number">40px</span> <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">1px</span> <span class="number">3px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.12</span>), <span class="number">0</span> <span class="number">1px</span> <span class="number">2px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.24</span>);</span><br><span class="line">  <span class="attribute">transition</span>: <span class="number">0.3s</span> ease;</span><br><span class="line">  <span class="comment">/* Title */</span></span><br><span class="line">  <span class="comment">/* Inputs */</span></span><br><span class="line">  <span class="comment">/* Button */</span></span><br><span class="line">  <span class="comment">/* Alt Card */</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.card</span><span class="selector-pseudo">:first</span>-child &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#fafafa</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">5px</span> <span class="number">5px</span> <span class="number">0</span> <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span> <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.card</span> <span class="selector-class">.title</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">  <span class="attribute">z-index</span>: <span class="number">1</span>;</span><br><span class="line">  <span class="attribute">border-left</span>: <span class="number">5px</span> solid <span class="number">#006a71</span>;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">35px</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">10px</span> <span class="number">0</span> <span class="number">10px</span> <span class="number">50px</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#006a71</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">32px</span>;</span><br><span class="line">  <span class="attribute">font-weight</span>: <span class="number">600</span>;</span><br><span class="line">  <span class="attribute">text-transform</span>: uppercase;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.card</span> <span class="selector-class">.input-container</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span> <span class="number">60px</span> <span class="number">50px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.card</span> <span class="selector-class">.input-container</span> <span class="selector-tag">input</span> &#123;</span><br><span class="line">  <span class="attribute">outline</span>: none;</span><br><span class="line">  <span class="attribute">z-index</span>: <span class="number">1</span>;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">  <span class="attribute">background</span>: none;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">60px</span>;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#212121</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">24px</span>;</span><br><span class="line">  <span class="attribute">font-weight</span>: <span class="number">400</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.card</span> <span class="selector-class">.input-container</span> <span class="selector-tag">input</span><span class="selector-pseudo">:focus</span> ~ <span class="selector-tag">label</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#9d9d9d</span>;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate</span>(-<span class="number">12%</span>, -<span class="number">50%</span>) <span class="built_in">scale</span>(<span class="number">0.75</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.card</span> <span class="selector-class">.input-container</span> <span class="selector-tag">input</span><span class="selector-pseudo">:focus</span> ~ <span class="selector-class">.bar</span><span class="selector-pseudo">:before</span>, <span class="selector-class">.card</span> <span class="selector-class">.input-container</span> <span class="selector-tag">input</span><span class="selector-pseudo">:focus</span> ~ <span class="selector-class">.bar</span><span class="selector-pseudo">:after</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">50%</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.card</span> <span class="selector-class">.input-container</span> <span class="selector-tag">input</span><span class="selector-pseudo">:valid</span> ~ <span class="selector-tag">label</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#9d9d9d</span>;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate</span>(-<span class="number">12%</span>, -<span class="number">50%</span>) <span class="built_in">scale</span>(<span class="number">0.75</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.card</span> <span class="selector-class">.input-container</span> <span class="selector-tag">label</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#757575</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">24px</span>;</span><br><span class="line">  <span class="attribute">font-weight</span>: <span class="number">300</span>;</span><br><span class="line">  <span class="attribute">line-height</span>: <span class="number">60px</span>;</span><br><span class="line">  -webkit-<span class="attribute">transition</span>: <span class="number">0.2s</span> ease;</span><br><span class="line">  -moz-<span class="attribute">transition</span>: <span class="number">0.2s</span> ease;</span><br><span class="line">  <span class="attribute">transition</span>: <span class="number">0.2s</span> ease;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.card</span> <span class="selector-class">.input-container</span> <span class="selector-class">.bar</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">bottom</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#757575</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">1px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.card</span> <span class="selector-class">.input-container</span> <span class="selector-class">.bar</span><span class="selector-pseudo">:before</span>, <span class="selector-class">.card</span> <span class="selector-class">.input-container</span> <span class="selector-class">.bar</span><span class="selector-pseudo">:after</span> &#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&quot;&quot;</span>;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#ff7e67</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">2px</span>;</span><br><span class="line">  <span class="attribute">transition</span>: <span class="number">0.2s</span> ease;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.card</span> <span class="selector-class">.input-container</span> <span class="selector-class">.bar</span><span class="selector-pseudo">:before</span> &#123;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">50%</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.card</span> <span class="selector-class">.input-container</span> <span class="selector-class">.bar</span><span class="selector-pseudo">:after</span> &#123;</span><br><span class="line">  <span class="attribute">right</span>: <span class="number">50%</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.card</span> <span class="selector-class">.button-container</span> &#123;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span> <span class="number">60px</span>;</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.card</span> <span class="selector-class">.button-container</span> <span class="selector-tag">button</span> &#123;</span><br><span class="line">  <span class="attribute">outline</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">cursor</span>: pointer;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">  <span class="attribute">display</span>: inline-block;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">240px</span>;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">2px</span> solid <span class="number">#e3e3e3</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">20px</span> <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">24px</span>;</span><br><span class="line">  <span class="attribute">font-weight</span>: <span class="number">600</span>;</span><br><span class="line">  <span class="attribute">line-height</span>: <span class="number">1</span>;</span><br><span class="line">  <span class="attribute">text-transform</span>: uppercase;</span><br><span class="line">  <span class="attribute">overflow</span>: hidden;</span><br><span class="line">  <span class="attribute">transition</span>: <span class="number">0.3s</span> ease;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.card</span> <span class="selector-class">.button-container</span> <span class="selector-tag">button</span> <span class="selector-tag">span</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">  <span class="attribute">z-index</span>: <span class="number">1</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#ddd</span>;</span><br><span class="line">  <span class="attribute">transition</span>: <span class="number">0.3s</span> ease;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.card</span> <span class="selector-class">.button-container</span> <span class="selector-tag">button</span><span class="selector-pseudo">:before</span> &#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&quot;&quot;</span>;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">50%</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">50%</span>;</span><br><span class="line">  <span class="attribute">display</span>: block;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#006a71</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">30px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">30px</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">margin</span>: -<span class="number">15px</span> <span class="number">0</span> <span class="number">0</span> -<span class="number">15px</span>;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">transition</span>: <span class="number">0.3s</span> ease;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.card</span> <span class="selector-class">.button-container</span> <span class="selector-tag">button</span><span class="selector-pseudo">:hover</span>, <span class="selector-class">.card</span> <span class="selector-class">.button-container</span> <span class="selector-tag">button</span><span class="selector-pseudo">:active</span>, <span class="selector-class">.card</span> <span class="selector-class">.button-container</span> <span class="selector-tag">button</span><span class="selector-pseudo">:focus</span> &#123;</span><br><span class="line">  <span class="attribute">border-color</span>: <span class="number">#68b0ab</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.card</span> <span class="selector-class">.button-container</span> <span class="selector-tag">button</span><span class="selector-pseudo">:hover</span> <span class="selector-tag">span</span>, <span class="selector-class">.card</span> <span class="selector-class">.button-container</span> <span class="selector-tag">button</span><span class="selector-pseudo">:active</span> <span class="selector-tag">span</span>, <span class="selector-class">.card</span> <span class="selector-class">.button-container</span> <span class="selector-tag">button</span><span class="selector-pseudo">:focus</span> <span class="selector-tag">span</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#68b0ab</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.card</span> <span class="selector-class">.button-container</span> <span class="selector-tag">button</span><span class="selector-pseudo">:active</span> <span class="selector-tag">span</span>, <span class="selector-class">.card</span> <span class="selector-class">.button-container</span> <span class="selector-tag">button</span><span class="selector-pseudo">:focus</span> <span class="selector-tag">span</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#68b0ab</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.card</span> <span class="selector-class">.button-container</span> <span class="selector-tag">button</span><span class="selector-pseudo">:active</span><span class="selector-pseudo">:before</span>, <span class="selector-class">.card</span> <span class="selector-class">.button-container</span> <span class="selector-tag">button</span><span class="selector-pseudo">:focus</span><span class="selector-pseudo">:before</span> &#123;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">  -webkit-<span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">10</span>);</span><br><span class="line">  -moz-<span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">10</span>);</span><br><span class="line">  -ms-<span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">10</span>);</span><br><span class="line">  -o-<span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">10</span>);</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">10</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.card</span><span class="selector-class">.alt</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">40px</span>;</span><br><span class="line">  <span class="attribute">right</span>: -<span class="number">70px</span>;</span><br><span class="line">  <span class="attribute">z-index</span>: <span class="number">10</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">140px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">140px</span>;</span><br><span class="line">  <span class="attribute">background</span>: none;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">box-shadow</span>: none;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">transition</span>: <span class="number">0.3s</span> ease;</span><br><span class="line">  <span class="comment">/* Toggle */</span></span><br><span class="line">  <span class="comment">/* Title */</span></span><br><span class="line">  <span class="comment">/* Input */</span></span><br><span class="line">  <span class="comment">/* Button */</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.card</span><span class="selector-class">.alt</span> <span class="selector-class">.toggle</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#006a71</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">140px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">140px</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">1px</span> <span class="number">3px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.12</span>), <span class="number">0</span> <span class="number">1px</span> <span class="number">2px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.24</span>);</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#ffffff</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">58px</span>;</span><br><span class="line">  <span class="attribute">line-height</span>: <span class="number">140px</span>;</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">  <span class="attribute">cursor</span>: pointer;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.card</span><span class="selector-class">.alt</span> <span class="selector-class">.toggle</span><span class="selector-pseudo">:before</span> &#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&quot;\f040&quot;</span>;</span><br><span class="line">  <span class="attribute">display</span>: inline-block;</span><br><span class="line">  <span class="attribute">font</span>: normal normal normal <span class="number">14px</span>/<span class="number">1</span> FontAwesome;</span><br><span class="line">  <span class="attribute">font-size</span>: inherit;</span><br><span class="line">  <span class="attribute">text-rendering</span>: auto;</span><br><span class="line">  -webkit-<span class="attribute">font-smoothing</span>: antialiased;</span><br><span class="line">  -moz-osx-<span class="attribute">font-smoothing</span>: grayscale;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate</span>(<span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.card</span><span class="selector-class">.alt</span> <span class="selector-class">.title</span>,</span><br><span class="line"><span class="selector-class">.card</span><span class="selector-class">.alt</span> <span class="selector-class">.input-container</span>,</span><br><span class="line"><span class="selector-class">.card</span><span class="selector-class">.alt</span> <span class="selector-class">.button-container</span> &#123;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">visibility</span>: hidden;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.card</span><span class="selector-class">.alt</span> <span class="selector-class">.title</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">  <span class="attribute">border-color</span>: <span class="number">#ffffff</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#ffffff</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.card</span><span class="selector-class">.alt</span> <span class="selector-class">.title</span> <span class="selector-class">.close</span> &#123;</span><br><span class="line">  <span class="attribute">cursor</span>: pointer;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">right</span>: <span class="number">60px</span>;</span><br><span class="line">  <span class="attribute">display</span>: inline;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#ffffff</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">58px</span>;</span><br><span class="line">  <span class="attribute">font-weight</span>: <span class="number">400</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.card</span><span class="selector-class">.alt</span> <span class="selector-class">.title</span> <span class="selector-class">.close</span><span class="selector-pseudo">:before</span> &#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&quot;\00d7&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.card</span><span class="selector-class">.alt</span> <span class="selector-class">.input-container</span> <span class="selector-tag">input</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#ffffff</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.card</span><span class="selector-class">.alt</span> <span class="selector-class">.input-container</span> <span class="selector-tag">input</span><span class="selector-pseudo">:focus</span> ~ <span class="selector-tag">label</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#ffffff</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.card</span><span class="selector-class">.alt</span> <span class="selector-class">.input-container</span> <span class="selector-tag">input</span><span class="selector-pseudo">:focus</span> ~ <span class="selector-class">.bar</span><span class="selector-pseudo">:before</span>, <span class="selector-class">.card</span><span class="selector-class">.alt</span> <span class="selector-class">.input-container</span> <span class="selector-tag">input</span><span class="selector-pseudo">:focus</span> ~ <span class="selector-class">.bar</span><span class="selector-pseudo">:after</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#ff7e67</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.card</span><span class="selector-class">.alt</span> <span class="selector-class">.input-container</span> <span class="selector-tag">input</span><span class="selector-pseudo">:valid</span> ~ <span class="selector-tag">label</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#ffffff</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.card</span><span class="selector-class">.alt</span> <span class="selector-class">.input-container</span> <span class="selector-tag">label</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.8</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.card</span><span class="selector-class">.alt</span> <span class="selector-class">.input-container</span> <span class="selector-class">.bar</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.8</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.card</span><span class="selector-class">.alt</span> <span class="selector-class">.button-container</span> <span class="selector-tag">button</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#ffffff</span>;</span><br><span class="line">  <span class="attribute">border-color</span>: <span class="number">#ffffff</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.card</span><span class="selector-class">.alt</span> <span class="selector-class">.button-container</span> <span class="selector-tag">button</span> <span class="selector-tag">span</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#006a71</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.card</span><span class="selector-class">.alt</span> <span class="selector-class">.button-container</span> <span class="selector-tag">button</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.9</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.card</span><span class="selector-class">.alt</span> <span class="selector-class">.button-container</span> <span class="selector-tag">button</span><span class="selector-pseudo">:active</span><span class="selector-pseudo">:before</span>, <span class="selector-class">.card</span><span class="selector-class">.alt</span> <span class="selector-class">.button-container</span> <span class="selector-tag">button</span><span class="selector-pseudo">:focus</span><span class="selector-pseudo">:before</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Keyframes */</span></span><br><span class="line"><span class="keyword">@-webkit-keyframes</span> buttonFadeInUp &#123;</span><br><span class="line">  <span class="number">0%</span> &#123;</span><br><span class="line">    <span class="attribute">bottom</span>: <span class="number">30px</span>;</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@-moz-keyframes</span> buttonFadeInUp &#123;</span><br><span class="line">  <span class="number">0%</span> &#123;</span><br><span class="line">    <span class="attribute">bottom</span>: <span class="number">30px</span>;</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@keyframes</span> buttonFadeInUp &#123;</span><br><span class="line">  <span class="number">0%</span> &#123;</span><br><span class="line">    <span class="attribute">bottom</span>: <span class="number">30px</span>;</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>








      
    </div>
    <footer class="article-footer">
      <a data-url="https://suyiharris.github.io/2023/10/24/2023-10-24-springboot%E5%AE%9E%E7%8E%B0websocket%E5%AE%9E%E6%97%B6%E9%80%9A%E4%BF%A1/" data-id="clo4h2l3u000nnso9e61j1377" data-title="springboot实现websocket实时通信" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-2023-10-24-web前端开发技术考前复习" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/10/24/2023-10-24-web%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91%E6%8A%80%E6%9C%AF%E8%80%83%E5%89%8D%E5%A4%8D%E4%B9%A0/" class="article-date">
  <time class="dt-published" datetime="2023-10-24T04:12:12.000Z" itemprop="datePublished">2023-10-24</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2023/10/24/2023-10-24-web%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91%E6%8A%80%E6%9C%AF%E8%80%83%E5%89%8D%E5%A4%8D%E4%B9%A0/">web前端开发技术考前复习</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="web前端开发技术考前复习"><a href="#web前端开发技术考前复习" class="headerlink" title="web前端开发技术考前复习"></a>web前端开发技术考前复习</h1><h2 id="B-S和C-S的区别"><a href="#B-S和C-S的区别" class="headerlink" title="B&#x2F;S和C&#x2F;S的区别"></a>B&#x2F;S和C&#x2F;S的区别</h2><p>B&#x2F;S（Browser&#x2F;Server）和C&#x2F;S（Client&#x2F;Server）是两种常见的应用程序架构模式。</p>
<p>B&#x2F;S指基于浏览器和服务器的应用程序，其中所有的处理都在服务器上完成，用户通过浏览器作为客户端来访问应用程序。这种架构模式的好处是用户不需要安装任何客户端软件，只需要通过浏览器就可以访问应用程序，从而降低了维护成本和更新难度。</p>
<p>C&#x2F;S指基于客户端和服务器的应用程序，其中客户端和服务器之间通过网络连接进行通信。在这种模式下，客户端负责一部分应用程序的逻辑处理，而服务器则负责另一部分逻辑处理。C&#x2F;S应用程序通常需要在客户端上安装专门的客户端软件，因此对维护和更新的要求较高。</p>
<p>总体而言，B&#x2F;S架构更加灵活，易于维护和升级，而C&#x2F;S架构则可以提供更高的性能和更丰富的用户体验。具体选择哪种架构模式要根据实际需求和业务情况进行综合考虑。</p>
<h2 id="H5和C3的新特性"><a href="#H5和C3的新特性" class="headerlink" title="H5和C3的新特性"></a>H5和C3的新特性</h2><p>我认为您指的是HTML5（或简写为H5）和CSS3（或简写为C3），它们是Web开发中最常用的技术之一。以下是它们的一些新特性：</p>
<p>HTML5：</p>
<ol>
<li>语义化标签，如<code>&lt;header&gt;</code>,<code>&lt;footer&gt;</code>, <code>&lt;article&gt;</code>等。</li>
<li>新增表单元素，如日期选择器、搜索框、邮件地址输入框等。</li>
<li>视频和音频支持，无需插件即可播放媒体文件。</li>
<li>本地存储，可以在客户端保存数据。</li>
</ol>
<p>CSS3：</p>
<ol>
<li>强大的2D&#x2F;3D变换和动画效果，如旋转、平移、缩放、倾斜等。</li>
<li>多列布局和弹性盒子布局，使得页面布局更加灵活。</li>
<li>自定义字体、渐变和阴影等效果。</li>
<li>媒体查询，根据设备屏幕大小调整CSS样式。</li>
</ol>
<p>需要注意的是，这只是HTML5和CSS3中的一些新特性，并不是全部。同时，这些技术正在不断更新和完善，因此还有很多其他特性和功能。</p>
<h2 id="JS事件处理有几种方式"><a href="#JS事件处理有几种方式" class="headerlink" title="JS事件处理有几种方式"></a>JS事件处理有几种方式</h2><p>在JavaScript中，事件处理有三种主要的方式：</p>
<ol>
<li>HTML事件处理：通过在HTML元素上使用内联事件处理器来指定处理函数。</li>
<li>DOM级别事件处理：使用JavaScript代码将事件处理程序附加到DOM元素上，可以使用addEventListener()方法来添加事件监听器，或者使用on*属性（如onclick）将事件处理程序分配给元素。</li>
<li>对象级别事件处理：在JavaScript中创建自定义对象时，可以使用事件模型为该对象定义自定义事件并指定相应的事件处理程序。可以使用EventTarget接口中定义的addEventListener()、removeEventListener()和dispatchEvent()方法来处理这些自定义事件。</li>
</ol>
<h2 id="DOM和BOM的区别"><a href="#DOM和BOM的区别" class="headerlink" title="DOM和BOM的区别"></a>DOM和BOM的区别</h2><p>DOM（文档对象模型）和BOM（浏览器对象模型）都是JavaScript与Web交互的重要部分，但它们有不同的作用：</p>
<ol>
<li><p>DOM描述了网页内容（如HTML、XML等），并定义了一种访问和操作这些内容的方法和接口。DOM的核心是一棵树形结构，由节点和对象组成，它表示了网页中所有的元素和标签以及它们之间的关系。</p>
</li>
<li><p>BOM则提供了与浏览器窗口交互的对象和方法，例如window对象、location对象、history对象、navigator对象、screen对象等。BOM使得JavaScript能够控制浏览器的行为，例如打开新窗口、改变URL、导航历史记录等。</p>
</li>
</ol>
<p>因此，DOM和BOM是JavaScript语言的两个最重要的API，而它们的主要区别在于它们所处理的对象和任务的不同。</p>
<h2 id="JS消息对话框"><a href="#JS消息对话框" class="headerlink" title="JS消息对话框"></a>JS消息对话框</h2><p>JavaScript中的消息对话框是一种弹出式窗口，用于向用户显示一条消息并等待用户响应。它包括以下三种类型：</p>
<ul>
<li>alert()：用于向用户显示一条消息，并要求用户点击“确定”按钮来关闭对话框。</li>
<li>prompt()：用于向用户显示一条消息和一个文本输入字段，并等待用户在该字段中输入文本以及点击“确定”或“取消”按钮。</li>
<li>confirm()：用于向用户显示一条消息和两个按钮：“确定”和“取消”，并等待用户选择其中一个按钮。</li>
</ul>
<h2 id="CSS选择器有哪些，写出名称"><a href="#CSS选择器有哪些，写出名称" class="headerlink" title="CSS选择器有哪些，写出名称"></a>CSS选择器有哪些，写出名称</h2><p>CSS选择器用于选择要应用样式的元素。以下是一些常见的CSS选择器名称：</p>
<ul>
<li>标签选择器（tag selector）</li>
<li>类选择器（class selector）</li>
<li>ID选择器（id selector）</li>
<li>子元素选择器（child selector）</li>
<li>后代选择器（descendant selector）</li>
<li>相邻兄弟选择器（adjacent sibling selector）</li>
<li>通用选择器（universal selector）</li>
<li>属性选择器（attribute selector）</li>
<li>伪类选择器（pseudo-class selector）</li>
<li>伪元素选择器（pseudo-element selector）</li>
</ul>
<p>还有一些其他的选择器，如组合选择器、否定伪类选择器等。</p>
<h2 id="String字符串"><a href="#String字符串" class="headerlink" title="String字符串"></a>String字符串</h2><h3 id="String-对象方法"><a href="#String-对象方法" class="headerlink" title="String 对象方法"></a>String 对象方法</h3><table>
<thead>
<tr>
<th>方法</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/jsref-charat.html">charAt()</a></td>
<td>返回在指定位置的字符。</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/jsref-charcodeat.html">charCodeAt()</a></td>
<td>返回在指定的位置的字符的 Unicode 编码。</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/jsref-concat-string.html">concat()</a></td>
<td>连接两个或更多字符串，并返回新的字符串。</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/jsref-endswith.html">endsWith()</a></td>
<td>判断当前字符串是否是以指定的子字符串结尾的（区分大小写）。</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/jsref-fromcharcode.html">fromCharCode()</a></td>
<td>将 Unicode 编码转为字符。</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/jsref-indexof.html">indexOf()</a></td>
<td>返回某个指定的字符串值在字符串中首次出现的位置。</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/jsref-string-includes.html">includes()</a></td>
<td>查找字符串中是否包含指定的子字符串。</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/jsref-lastindexof.html">lastIndexOf()</a></td>
<td>从后向前搜索字符串，并从起始位置（0）开始计算返回字符串最后出现的位置。</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/jsref-match.html">match()</a></td>
<td>查找找到一个或多个正则表达式的匹配。</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/jsref-repeat.html">repeat()</a></td>
<td>复制字符串指定次数，并将它们连接在一起返回。</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/jsref-replace.html">replace()</a></td>
<td>在字符串中查找匹配的子串，并替换与正则表达式匹配的子串。</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/jsref-replaceall.html">replaceAll()</a></td>
<td>在字符串中查找匹配的子串，并替换与正则表达式匹配的所有子串。</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/jsref-search.html">search()</a></td>
<td>查找与正则表达式相匹配的值。</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/jsref-slice-string.html">slice()</a></td>
<td>提取字符串的片断，并在新的字符串中返回被提取的部分。</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/jsref-split.html">split()</a></td>
<td>把字符串分割为字符串数组。</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/jsref-startswith.html">startsWith()</a></td>
<td>查看字符串是否以指定的子字符串开头。</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/jsref-substr.html">substr()</a></td>
<td>从起始索引号提取字符串中指定数目的字符。</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/jsref-substring.html">substring()</a></td>
<td>提取字符串中两个指定的索引号之间的字符。</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/jsref-tolowercase.html">toLowerCase()</a></td>
<td>把字符串转换为小写。</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/jsref-touppercase.html">toUpperCase()</a></td>
<td>把字符串转换为大写。</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/jsref-trim.html">trim()</a></td>
<td>去除字符串两边的空白。</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/jsref-tolocalelowercase.html">toLocaleLowerCase()</a></td>
<td>根据本地主机的语言环境把字符串转换为小写。</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/jsref-tolocaleuppercase.html">toLocaleUpperCase()</a></td>
<td>根据本地主机的语言环境把字符串转换为大写。</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/jsref-valueof-string.html">valueOf()</a></td>
<td>返回某个字符串对象的原始值。</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/jsref-tostring.html">toString()</a></td>
<td>返回一个字符串。</td>
</tr>
</tbody></table>
<h2 id="简述web工作原理"><a href="#简述web工作原理" class="headerlink" title="简述web工作原理"></a>简述web工作原理</h2><p>Web 的工作原理涉及多个组件和协议，包括客户端浏览器、服务器、HTTP 协议以及 HTML&#x2F;CSS&#x2F;JavaScript 等技术。</p>
<ol>
<li>客户端浏览器向服务器发送 HTTP 请求，请求包括所需资源的 URL 和其他相关信息。</li>
<li>服务器接收到请求后，根据 URL 找到对应的资源并生成 HTTP 响应，响应包括状态码、消息头和消息体。</li>
<li>响应被传输回客户端浏览器，浏览器解析响应并渲染页面。如果响应是 HTML 页面，则浏览器会解析 HTML 标记，并使用 CSS 样式和 JavaScript 脚本来渲染和交互。</li>
<li>在页面渲染期间，浏览器可能会发起其他 HTTP 请求获取页面中引用的其他资源，如图片、样式表、JavaScript 文件等。</li>
<li>服务器再次响应这些请求，浏览器将这些资源嵌入到页面中或者执行对应的代码。</li>
</ol>
<p>以上是 Web 工作原理的简要流程，其中还有许多细节和复杂性，包括缓存、Cookie、会话管理、HTTPS 等。</p>
<h2 id="js常用函数"><a href="#js常用函数" class="headerlink" title="js常用函数"></a>js常用函数</h2><p>JavaScript中常用的函数包括：</p>
<ol>
<li><code>console.log()</code>：将消息打印到浏览器控制台。</li>
<li><code>alert()</code>：在浏览器中弹出一个警告框，显示指定消息。</li>
<li><code>prompt()</code>：在浏览器中弹出一个对话框，提示用户输入值，并返回该值。</li>
<li><code>parseInt()</code>和<code>parseFloat()</code>：将字符串转换为整数或浮点数。</li>
<li><code>String()</code>：将变量转换为字符串。</li>
<li><code>Array()</code>：创建一个新数组。</li>
<li><code>push()</code>和<code>pop()</code>：向数组末尾添加元素或从末尾删除元素。</li>
<li><code>shift()</code>和<code>unshift()</code>：从数组开头删除或添加元素。</li>
<li><code>splice()</code>：从数组中删除、替换或插入元素。</li>
<li><code>slice()</code>：从数组中提取一部分元素，返回一个新数组。</li>
<li><code>indexOf()</code>和<code>lastIndexOf()</code>：查找数组中特定元素的位置。</li>
<li><code>join()</code>和<code>toString()</code>：将数组转换为字符串。</li>
<li><code>Math.random()</code>：生成一个0到1之间的随机数。</li>
<li><code>Math.floor()</code>和<code>Math.ceil()</code>：向下和向上取整。</li>
<li><code>setInterval()</code>：每隔指定时间就执行一次函数。 </li>
<li><code>setTimeout()</code>：在指定时间后执行一次函数。</li>
<li><code>typeof()</code>：返回数据类型。</li>
<li><code>confirm()</code>：弹出一个确认对话框，让用户选择“确定”或“取消”。</li>
<li><code>isNaN()</code>：检查给定的值是否是数字。</li>
</ol>
<h2 id="js中String字符串常用的方法"><a href="#js中String字符串常用的方法" class="headerlink" title="js中String字符串常用的方法"></a>js中String字符串常用的方法</h2><p>以下是 JavaScript 中 String 字符串常用的方法：</p>
<ol>
<li><code>length</code>：获取字符串长度。</li>
<li><code>charAt()</code>：返回指定索引位置的字符。</li>
<li><code>concat()</code>：连接两个或多个字符串。</li>
<li><code>indexOf()</code>：返回某个指定的字符串值在字符串中首次出现的位置。</li>
<li><code>lastIndexOf()</code>：返回某个指定的字符串值在字符串中最后出现的位置。</li>
<li><code>slice()</code>：提取字符串的一部分，并返回一个新的字符串。</li>
<li><code>substring()</code>：提取字符串的一部分，并返回一个新的字符串。</li>
<li><code>substr()</code>：从起始索引号提取字符串中指定数目的字符。</li>
<li><code>replace()</code>：在字符串中用一些字符替换另一些字符。</li>
<li><code>toUpperCase()</code>：将字符串转换为大写字母。</li>
<li><code>toLowerCase()</code>：将字符串转换为小写字母。</li>
<li><code>trim()</code>：去掉字符串两端的空格。</li>
<li><code>split()</code>：将字符串分割成子字符串，并将结果存储到数组中。</li>
<li><code>match()</code>：在字符串中搜索一个与正则表达式匹配的值。</li>
</ol>
<h2 id="js特点"><a href="#js特点" class="headerlink" title="js特点"></a>js特点</h2><p>以下是JavaScript的一些特点：</p>
<ol>
<li>基于对象：JavaScript是一种基于对象的语言，它使用对象作为其编程模型的核心。</li>
<li>弱类型：JavaScript是一种弱类型语言，变量可以自动转换为所需的类型。</li>
<li>解释型：JavaScript是一种解释型语言，代码在运行时被逐行解析和执行。</li>
<li>跨平台：JavaScript可以在多种不同的环境中运行，包括浏览器、服务器和移动设备等。</li>
<li>事件驱动：JavaScript中的交互性主要是通过事件来实现的，例如鼠标点击、键盘输入等。</li>
<li>函数式编程：JavaScript中函数是一等公民，支持函数式编程范式。</li>
<li>动态性：JavaScript的动态性使得它能够在运行时修改程序的结构和行为。</li>
<li>简单易用：JavaScript相对于其他语言而言，学习曲线较低，易上手。</li>
</ol>
<h2 id="CSS动画animation"><a href="#CSS动画animation" class="headerlink" title="CSS动画animation"></a>CSS动画animation</h2><p>​	CSS3动画(animation)是一种利用CSS3技术实现的动画效果，通过定义关键帧(keyframes)和动画属性(animation properties)来描述元素的动画过程。它可以实现多种复杂的动画效果，如渐变、旋转、缩放、移动、透明度等，并且可以控制动画的速度、延迟、重复次数等。CSS3动画可以使网页更加生动有趣，提高用户体验。</p>
<p>以下是一个简单的CSS3动画(animation)的用法示例，具体实现效果可以在浏览器中查看：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!doctype <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="comment">/* 定义动画关键帧 */</span></span></span><br><span class="line"><span class="language-css">    <span class="keyword">@keyframes</span> example &#123;</span></span><br><span class="line"><span class="language-css">      <span class="selector-tag">from</span> &#123;<span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">0deg</span>);&#125;</span></span><br><span class="line"><span class="language-css">      <span class="selector-tag">to</span> &#123;<span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">360deg</span>);&#125;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">    </span></span><br><span class="line"><span class="language-css">    <span class="comment">/* 应用动画属性 */</span></span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.box</span> &#123;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">width</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">height</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">background-color</span>: red;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">animation-name</span>: example;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">animation-duration</span>: <span class="number">2s</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">animation-timing-function</span>: linear;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">animation-iteration-count</span>: infinite;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">  </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 创建一个需要应用动画的元素 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>这个示例中，我们创建了一个红色的正方形元素(box)，并定义了一个名为example的动画关键帧，该动画会让元素以线性方式不断旋转360度。然后通过将animation-name、animation-duration、animation-timing-function和animation-iteration-count属性应用到.box元素上，来控制动画的名称、时长、速度曲线和重复次数。最终呈现出来的效果就是一个不停旋转的红色正方形。</p>
<h2 id="js变量、常量及其用法"><a href="#js变量、常量及其用法" class="headerlink" title="js变量、常量及其用法"></a>js变量、常量及其用法</h2><p>在JavaScript中，变量和常量都用于存储数据值。变量是可更改的数据存储选项，而常量则是不可更改的。</p>
<p>声明变量时使用 “let” 关键字，例如：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> age = <span class="number">25</span>;</span><br></pre></td></tr></table></figure>

<p>在上面的例子中，我们声明了一个名为 “age” 的变量，并将其初始化为 25。</p>
<p>声明常量时使用 “const” 关键字，例如：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="variable constant_">PI</span> = <span class="number">3.14</span>;</span><br></pre></td></tr></table></figure>

<p>在上面的例子中，我们声明了一个名为 “PI” 的常量，并将其初始化为 3.14。一旦常量被赋值，就无法更改它的值。如果尝试更改常量的值，将会产生错误。</p>
<p>在JavaScript中，变量和常量可以用于存储各种类型的数据，包括数字、字符串、数组、对象等。例如：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> name = <span class="string">&#x27;Alice&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> daysInWeek = [<span class="string">&#x27;Monday&#x27;</span>, <span class="string">&#x27;Tuesday&#x27;</span>, <span class="string">&#x27;Wednesday&#x27;</span>, <span class="string">&#x27;Thursday&#x27;</span>, <span class="string">&#x27;Friday&#x27;</span>, <span class="string">&#x27;Saturday&#x27;</span>, <span class="string">&#x27;Sunday&#x27;</span>];</span><br></pre></td></tr></table></figure>

<p>在上面的例子中，我们声明了一个 “name” 变量并将其初始化为字符串类型的 “Alice”，以及一个 “daysInWeek” 常量，其中包含一个字符串数组。</p>
<h2 id="JS中的关键字"><a href="#JS中的关键字" class="headerlink" title="JS中的关键字"></a>JS中的关键字</h2><p>以下是 JavaScript 中的关键字：</p>
<ul>
<li><code>break</code></li>
<li><code>case</code></li>
<li><code>catch</code></li>
<li><code>class</code></li>
<li><code>const</code></li>
<li><code>continue</code></li>
<li><code>debugger</code></li>
<li><code>default</code></li>
<li><code>delete</code></li>
<li><code>do</code></li>
<li><code>else</code></li>
<li><code>export</code></li>
<li><code>extends</code></li>
<li><code>false</code></li>
<li><code>finally</code></li>
<li><code>for</code></li>
<li><code>function</code></li>
<li><code>if</code></li>
<li><code>import</code></li>
<li><code>in</code></li>
<li><code>instanceof</code></li>
<li><code>new</code></li>
<li><code>null</code></li>
<li><code>return</code></li>
<li><code>super</code></li>
<li><code>switch</code></li>
<li><code>this</code></li>
<li><code>throw</code></li>
<li><code>true</code></li>
<li><code>try</code></li>
<li><code>typeof</code></li>
<li><code>var</code></li>
<li><code>void</code></li>
<li><code>while</code></li>
<li><code>with</code></li>
<li><code>yield</code></li>
</ul>
<p>注意，这个列表并不包括一些 JavaScript 的保留字（如 <code>let</code> 和 <code>async</code>），因为它们被视为关键字的扩展。</p>
<h2 id="JS中的表达式及其例子"><a href="#JS中的表达式及其例子" class="headerlink" title="JS中的表达式及其例子"></a>JS中的表达式及其例子</h2><ol>
<li><p>算术表达式：用于计算数值的表达式，包括加、减、乘、除等操作。 </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">例子：<span class="keyword">var</span> sum = <span class="number">10</span> + <span class="number">20</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>字符串表达式：用于处理字符串的表达式，包括字符串连接等操作。 </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">例子：<span class="keyword">var</span> greeting = <span class="string">&quot;Hello, &quot;</span> + <span class="string">&quot;World!&quot;</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>逻辑表达式：用于处理布尔值的表达式，包括与、或、非等操作。 </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">例子：<span class="keyword">var</span> isTrue = (<span class="number">10</span> &gt; <span class="number">5</span>) &amp;&amp; (<span class="number">5</span> &lt; <span class="number">10</span>);</span><br></pre></td></tr></table></figure>
</li>
<li><p>赋值表达式：用于给变量赋值的表达式。</p>
 <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">例子：<span class="keyword">var</span> x = <span class="number">10</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>比较表达式：用于比较两个值的表达式，包括等于、不等于、大于、小于等操作。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">例子：<span class="keyword">var</span> isEqual = (<span class="number">10</span> == <span class="number">10</span>);</span><br></pre></td></tr></table></figure>
</li>
<li><p>条件（三元）表达式：用于根据条件选择一个值的表达式。</p>
 <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">例子：<span class="keyword">var</span> max = (<span class="number">10</span> &gt; <span class="number">5</span>) ? <span class="number">10</span> : <span class="number">5</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>函数表达式：用于定义一个函数的表达式。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">例子：<span class="keyword">var</span> square = <span class="keyword">function</span>(<span class="params">x</span>) &#123; <span class="keyword">return</span> x * x; &#125;;</span><br></pre></td></tr></table></figure>
</li>
<li><p>对象表达式：用于创建一个对象的表达式。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">例子：<span class="keyword">var</span> person = &#123; <span class="attr">name</span>: <span class="string">&quot;John&quot;</span>, <span class="attr">age</span>: <span class="number">30</span> &#125;;</span><br></pre></td></tr></table></figure>
</li>
<li><p>数组表达式：用于创建一个数组的表达式。</p>
 <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">例子：<span class="keyword">var</span> numbers = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br></pre></td></tr></table></figure>
</li>
<li><p>正则表达式：用于处理正则表达式的表达式。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">例子：<span class="keyword">var</span> pattern = <span class="regexp">/hello/i</span>;</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="JS内置对象及其案例"><a href="#JS内置对象及其案例" class="headerlink" title="JS内置对象及其案例"></a>JS内置对象及其案例</h2><p>JavaScript 有许多内置对象，这些对象可以在任何时候使用。以下是一些常用的内置对象及其使用案例：</p>
<ol>
<li>Object：Object 是 JavaScript 中所有对象的基类。你可以使用它来创建一个新的对象，或者访问和操作已有对象的属性和方法。</li>
</ol>
<p>使用案例：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> person = <span class="keyword">new</span> <span class="title class_">Object</span>();</span><br><span class="line">person.<span class="property">name</span> = <span class="string">&quot;Tom&quot;</span>;</span><br><span class="line">person.<span class="property">age</span> = <span class="number">25</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(person.<span class="property">name</span>); <span class="comment">// 输出 &quot;Tom&quot;</span></span><br></pre></td></tr></table></figure>

<ol>
<li>Array：Array 对象用于在单个变量中存储多个值。你可以使用它来创建和操作数组。</li>
</ol>
<p>使用案例：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> fruits = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="string">&quot;apple&quot;</span>, <span class="string">&quot;banana&quot;</span>, <span class="string">&quot;cherry&quot;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(fruits[<span class="number">0</span>]); <span class="comment">// 输出 &quot;apple&quot;</span></span><br><span class="line">fruits.<span class="title function_">push</span>(<span class="string">&quot;orange&quot;</span>); <span class="comment">// 在数组末尾添加一个新元素</span></span><br></pre></td></tr></table></figure>

<ol>
<li>String：String 对象表示文本数据。你可以使用它来处理字符串。</li>
</ol>
<p>使用案例：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> str = <span class="keyword">new</span> <span class="title class_">String</span>(<span class="string">&quot;Hello, world!&quot;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(str.<span class="property">length</span>); <span class="comment">// 输出 13</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(str.<span class="title function_">toUpperCase</span>()); <span class="comment">// 输出 &quot;HELLO, WORLD!&quot;</span></span><br></pre></td></tr></table></figure>

<ol>
<li>Number：Number 对象表示数字值。你可以使用它来处理数字和进行数学运算。</li>
</ol>
<p>使用案例：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> num = <span class="keyword">new</span> <span class="title class_">Number</span>(<span class="number">42</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(num.<span class="title function_">toString</span>(<span class="number">16</span>)); <span class="comment">// 输出 &quot;2a&quot;（将数字转换为十六进制字符串）</span></span><br></pre></td></tr></table></figure>

<ol>
<li>Math：Math 对象提供了一组用于执行数学运算的方法和常量。</li>
</ol>
<p>使用案例：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Math</span>.<span class="property">PI</span>); <span class="comment">// 输出 3.141592653589793</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Math</span>.<span class="title function_">sqrt</span>(<span class="number">16</span>)); <span class="comment">// 输出 4（计算平方根）</span></span><br></pre></td></tr></table></figure>

<ol>
<li>Date：Date 对象表示日期和时间。你可以使用它来获取和设置日期、时间等。</li>
</ol>
<p>使用案例：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> now = <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(now.<span class="title function_">getFullYear</span>()); <span class="comment">// 输出当前年份</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(now.<span class="title function_">getMonth</span>() + <span class="number">1</span>); <span class="comment">// 输出当前月份（注意：月份从 0 开始，所以需要加 1）</span></span><br></pre></td></tr></table></figure>

<ol>
<li>JSON：JSON 对象用于处理 JSON 数据。你可以使用它来将 JavaScript 对象转换为 JSON 字符串，或将 JSON 字符串解析为 JavaScript 对象。</li>
</ol>
<p>使用案例：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> obj = &#123;<span class="attr">name</span>: <span class="string">&quot;Tom&quot;</span>, <span class="attr">age</span>: <span class="number">25</span>&#125;;</span><br><span class="line"><span class="keyword">let</span> jsonString = <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(obj); <span class="comment">// 将对象转换为 JSON 字符串</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(jsonString); <span class="comment">// 输出 &#x27;&#123;&quot;name&quot;:&quot;Tom&quot;,&quot;age&quot;:25&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> parsedObj = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(jsonString); <span class="comment">// 将 JSON 字符串解析为对象</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(parsedObj.<span class="property">name</span>); <span class="comment">// 输出 &quot;Tom&quot;</span></span><br></pre></td></tr></table></figure>

<ol>
<li>RegExp：RegExp 对象表示正则表达式。你可以使用它来进行字符串的模式匹配和替换操作。</li>
</ol>
<p>使用案例：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> regex = <span class="keyword">new</span> <span class="title class_">RegExp</span>(<span class="string">&quot;\\d+&quot;</span>, <span class="string">&quot;g&quot;</span>); <span class="comment">// 匹配一个或多个数字字符</span></span><br><span class="line"><span class="keyword">let</span> str = <span class="string">&quot;There are 25 cats and 42 dogs.&quot;</span>;</span><br><span class="line"><span class="keyword">let</span> result = str.<span class="title function_">match</span>(regex); <span class="comment">// 使用正则表达式匹配字符串</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(result); <span class="comment">// 输出 [&quot;25&quot;, &quot;42&quot;]</span></span><br></pre></td></tr></table></figure>

<ol>
<li>Function：Function 对象表示 JavaScript 函数。你可以使用它来创建和调用函数。</li>
</ol>
<p>使用案例：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> add = <span class="keyword">new</span> <span class="title class_">Function</span>(<span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>, <span class="string">&quot;return a + b;&quot;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">add</span>(<span class="number">1</span>, <span class="number">2</span>)); <span class="comment">// 输出 3</span></span><br></pre></td></tr></table></figure>

<ol>
<li>Promise：Promise 对象表示一个异步操作的最终结果。你可以使用它来处理异步操作，例如 AJAX 请求、定时器等。</li>
</ol>
<p>使用案例：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> promise = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">resolve</span>(<span class="string">&quot;Hello, world!&quot;</span>);</span><br><span class="line">  &#125;, <span class="number">1000</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">promise.<span class="title function_">then</span>(<span class="function">(<span class="params">value</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(value); <span class="comment">// 输出 &quot;Hello, world!&quot;（在 1 秒后）</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>这些内置对象为 JavaScript 提供了丰富的功能，使得开发者能够更方便地处理各种任务。</p>
<h2 id="JS本地对象"><a href="#JS本地对象" class="headerlink" title="JS本地对象"></a>JS本地对象</h2><p>在JavaScript中，本地对象是指那些内置于JavaScript语言中的对象。这些对象在任何时候都可以在代码中使用，无需额外的引用或导入。以下是一些常见的JavaScript本地对象：</p>
<ol>
<li>Object：这是所有对象的基类，包含了一些通用的属性和方法，如toString()、valueOf()等。</li>
<li>Array：表示数组类型的对象，提供了一系列操作数组的方法，如push()、pop()、splice()等。</li>
<li>String：表示字符串类型的对象，提供了一系列操作字符串的方法，如charAt()、substring()、trim()等。</li>
<li>Number：表示数字类型的对象，提供了一系列操作数字的方法，如toFixed()、toExponential()等。</li>
<li>Boolean：表示布尔类型的对象，提供了一系列操作布尔值的方法，如valueOf()等。</li>
<li>Date：表示日期和时间的对象，提供了一系列操作日期和时间的方法，如getFullYear()、getMonth()、getDate()等。</li>
<li>RegExp：表示正则表达式的对象，提供了一系列操作正则表达式的方法，如exec()、test()等。</li>
<li>Function：表示函数类型的对象，提供了一系列操作函数的方法，如call()、apply()、bind()等。</li>
<li>Error：表示错误类型的对象，提供了一系列操作错误的方法，如message、name等。</li>
<li>Math：提供了一系列数学计算的方法，如abs()、ceil()、floor()、random()等。</li>
<li>JSON：提供了一系列操作JSON数据的方法，如parse()、stringify()等。</li>
<li>Promise：表示异步操作的对象，提供了一系列操作异步操作的方法，如then()、catch()、finally()等。</li>
</ol>
<p>这些本地对象为开发者提供了丰富的功能，使得JavaScript编程更加方便和高效。</p>
<h2 id="JS中的事件及其案例"><a href="#JS中的事件及其案例" class="headerlink" title="JS中的事件及其案例"></a>JS中的事件及其案例</h2><p>JavaScript中的事件是指在浏览器或者用户操作过程中发生的一些特定交互行为，例如点击、滚动、按键等。通过在JavaScript代码中监听和处理这些事件，我们可以实现对用户操作的响应，从而提高网页的交互性。</p>
<p>以下是一些常见的JavaScript事件及其使用案例：</p>
<ol>
<li>click事件：当用户点击某个元素时触发。</li>
</ol>
<p>案例：点击按钮显示&#x2F;隐藏一个div元素。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;toggleButton&quot;</span>&gt;</span>显示/隐藏<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;content&quot;</span> <span class="attr">style</span>=<span class="string">&quot;display:none;&quot;</span>&gt;</span>这是一个隐藏的内容。<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> toggleButton = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;toggleButton&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> content = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;content&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  toggleButton.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    content.<span class="property">style</span>.<span class="property">display</span> = content.<span class="property">style</span>.<span class="property">display</span> === <span class="string">&#x27;none&#x27;</span> ? <span class="string">&#x27;block&#x27;</span> : <span class="string">&#x27;none&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ol>
<li>mouseover和mouseout事件：当鼠标指针移动到元素上方或离开元素时触发。</li>
</ol>
<p>案例：鼠标悬停在图片上时放大，离开时恢复原大小。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">id</span>=<span class="string">&quot;image&quot;</span> <span class="attr">src</span>=<span class="string">&quot;example.jpg&quot;</span> <span class="attr">width</span>=<span class="string">&quot;200&quot;</span> <span class="attr">height</span>=<span class="string">&quot;200&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> image = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;image&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  image.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mouseover&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    image.<span class="property">width</span> = <span class="number">300</span>;</span></span><br><span class="line"><span class="language-javascript">    image.<span class="property">height</span> = <span class="number">300</span>;</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  image.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mouseout&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    image.<span class="property">width</span> = <span class="number">200</span>;</span></span><br><span class="line"><span class="language-javascript">    image.<span class="property">height</span> = <span class="number">200</span>;</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ol>
<li>keyup和keydown事件：当用户按下或松开某个键盘按键时触发。</li>
</ol>
<p>案例：实现一个简单的搜索框，当用户输入内容时，实时显示搜索结果。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&quot;searchInput&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;输入关键词搜索&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;searchResult&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> searchInput = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;searchInput&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> searchResult = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;searchResult&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  searchInput.<span class="title function_">addEventListener</span>(<span class="string">&#x27;keyup&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> keyword = searchInput.<span class="property">value</span>;</span></span><br><span class="line"><span class="language-javascript">    searchResult.<span class="property">innerHTML</span> = <span class="string">`搜索结果：<span class="subst">$&#123;keyword&#125;</span>`</span>;</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ol>
<li>scroll事件：当用户滚动页面时触发。</li>
</ol>
<p>案例：当页面滚动到一定距离时，显示一个返回顶部的按钮。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;backToTop&quot;</span> <span class="attr">style</span>=<span class="string">&quot;display:none;position:fixed;bottom:20px;right:20px;&quot;</span>&gt;</span>返回顶部<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> backToTop = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;backToTop&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;scroll&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">if</span> (<span class="variable language_">window</span>.<span class="property">scrollY</span> &gt; <span class="number">200</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      backToTop.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&#x27;block&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">    &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">      backToTop.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&#x27;none&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  backToTop.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">window</span>.<span class="title function_">scrollTo</span>(&#123; <span class="attr">top</span>: <span class="number">0</span>, <span class="attr">behavior</span>: <span class="string">&#x27;smooth&#x27;</span> &#125;);</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>这些只是JavaScript事件的一些简单示例，实际应用中可能会涉及到更多的事件类型和更复杂的交互逻辑。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://suyiharris.github.io/2023/10/24/2023-10-24-web%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91%E6%8A%80%E6%9C%AF%E8%80%83%E5%89%8D%E5%A4%8D%E4%B9%A0/" data-id="clo4h2l3u000onso9e0056fhr" data-title="web前端开发技术考前复习" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-2023-10-24-web答疑" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/10/24/2023-10-24-web%E7%AD%94%E7%96%91/" class="article-date">
  <time class="dt-published" datetime="2023-10-24T04:12:12.000Z" itemprop="datePublished">2023-10-24</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2023/10/24/2023-10-24-web%E7%AD%94%E7%96%91/">web答疑</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="一、选择"><a href="#一、选择" class="headerlink" title="一、选择"></a>一、选择</h2><h3 id="1-html结构样式：行内、块常见元素，按常见元素，滚动文字"><a href="#1-html结构样式：行内、块常见元素，按常见元素，滚动文字" class="headerlink" title="1.html结构样式：行内、块常见元素，按常见元素，滚动文字"></a>1.html结构样式：行内、块常见元素，按常见元素，滚动文字</h3><p>行内元素：a、span、img、input、label、select、textarea、button、abbr、acronym、cite、code、dfn、em、kbd、q、samp、strong、sub、sup、time、var等 ； </p>
<p>块状元素：div、p、h1~h6、ul、ol、li、dl、dt、dd、blockquote、hr、pre、address、fieldset、form等。 </p>
<h3 id="2-样式：选择器6个"><a href="#2-样式：选择器6个" class="headerlink" title="2.样式：选择器6个"></a>2.样式：选择器6个</h3><p>标签选择器、id选择器、类选择器、伪类选择器、后代选择器、属性选择器</p>
<h3 id="3-盒子模型（结构图）外边距，内边距内容等，外边距四个属性值顺序（顺-逆）"><a href="#3-盒子模型（结构图）外边距，内边距内容等，外边距四个属性值顺序（顺-逆）" class="headerlink" title="3.盒子模型（结构图）	外边距，内边距内容等，外边距四个属性值顺序（顺&#x2F;逆）"></a>3.盒子模型（结构图）	外边距，内边距内容等，外边距四个属性值顺序（顺&#x2F;逆）</h3><p>HTML 盒子模型（结构图）包括四个部分：</p>
<ol>
<li>Content（内容区）：指 HTML 元素的具体内容，如文本、图片等。</li>
<li>Padding（内边距）：指 Content 与 Border 之间的距离，可以用来设置元素内部空间。</li>
<li>Border（边框）：指围绕 Content 和 Padding 的边框线，可以用来设置元素边框样式、宽度、颜色等。</li>
<li>Margin（外边距）：指 Border 与相邻元素之间的距离，可以用来设置元素与其他元素之间的间距。</li>
</ol>
<p>下面是 HTML 盒子模型的结构图：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">+----------------------------------------+</span><br><span class="line">|                 Margin                 |</span><br><span class="line">|                                        |</span><br><span class="line">|    +---------------------------+       |</span><br><span class="line">|    |         Border            |       |</span><br><span class="line">|    |                            |      |</span><br><span class="line">|    |   +--------------------+   |      |</span><br><span class="line">|    |   |     Padding        |   |      |</span><br><span class="line">|    |   |                    |   |      |</span><br><span class="line">|    |   |     Content        |   |      |</span><br><span class="line">|    |   |                    |   |      |</span><br><span class="line">|    |   +--------------------+   |      |</span><br><span class="line">|    |                            |      |</span><br><span class="line">|    +---------------------------+      |</span><br><span class="line">|                                        |</span><br><span class="line">+----------------------------------------+</span><br></pre></td></tr></table></figure>
<p>外边距顺序：上、右、下、左；上下、左右；上下左右；</p>
<h3 id="4-CSS3新的属性：拉伸，旋转，动画"><a href="#4-CSS3新的属性：拉伸，旋转，动画" class="headerlink" title="4.CSS3新的属性：拉伸，旋转，动画"></a>4.CSS3新的属性：拉伸，旋转，动画</h3><p>CSS3引入了许多新的属性，其中包括了拉伸、旋转和动画等。</p>
<ol>
<li><p>拉伸（scale）：通过scale()函数可以实现对元素进行缩放，可以缩小或放大元素。例如：transform: scale(0.5, 0.5); 可以让元素的大小缩小到原来的一半。</p>
</li>
<li><p>旋转（rotate）：通过rotate()函数可以实现对元素进行旋转，可以顺时针或逆时针旋转。例如：transform: rotate(45deg); 可以让元素按照顺时针方向旋转45度。</p>
</li>
<li><p>动画（animation）：通过animation属性可以实现对元素进行动画效果的控制。可以设置动画的持续时间、延迟时间、重复次数、动画类型等。例如：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">.box &#123;</span><br><span class="line">  animation: myanimation 2s ease-in-out infinite;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@keyframes myanimation &#123;</span><br><span class="line">  0% &#123; background-color: red; &#125;</span><br><span class="line">  50% &#123; background-color: green; &#125;</span><br><span class="line">  100% &#123; background-color: blue; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这段代码可以让一个名为“box”的元素，按照myanimation动画效果进行无限循环播放。其中@keyframes定义了动画的关键帧，从开始到50%时背景色渐变为绿色，从50%到结束时背景色渐变为蓝色。</p>
</li>
</ol>
<h3 id="5-js：表达式，运算符"><a href="#5-js：表达式，运算符" class="headerlink" title="5.js：表达式，运算符"></a>5.js：表达式，运算符</h3><p><strong>表达式：</strong></p>
<ol>
<li>算数表达式：</li>
</ol>
<p><code>2 + 3</code>：加法运算符，返回 5。</p>
<p><code>5 - 2</code>：减法运算符，返回 3。</p>
<p><code>7 * 4</code>：乘法运算符，返回 28。</p>
<p><code>10 / 2</code>：除法运算符，返回 5。</p>
<p><code>9 % 2</code>：取模运算符，返回 1。</p>
<ol start="2">
<li>字符串表达式：</li>
</ol>
<p><code>&quot;Hello&quot; + &quot; &quot; + &quot;World&quot;</code>：加法运算符，返回 “Hello World”。</p>
<p><code>&quot;My name is &quot; + name</code>：变量 name 存储了一个字符串，加法运算符，返回 “My name is John”。</p>
<ol start="3">
<li>布尔表达式：</li>
</ol>
<p><code>5 &gt; 3</code>：大于运算符，返回 true。</p>
<p><code>10 &lt;= 5</code>：小于等于运算符，返回 false。</p>
<p><code>true &amp;&amp; false</code>：逻辑与运算符，返回 false。</p>
<p><code>!(x &gt; y)</code>：逻辑非运算符，如果 x 大于 y 返回 false，否则返回 true。</p>
<ol start="4">
<li>条件表达式：</li>
</ol>
<p><code>age &gt;= 18 ? &quot;成年人&quot; : &quot;未成年人&quot;</code>：如果 age 大于等于 18，返回 “成年人”，否则返回 “未成年人”。</p>
<ol start="5">
<li>赋值表达式：</li>
</ol>
<p><code>x = 5</code>：将 5 赋值给变量 x。</p>
<p><code>y += 2</code>：将 y 的值加上 2，并将结果赋值给 y。</p>
<ol start="6">
<li>函数调用表达式：</li>
</ol>
<p><code>Math.max(2, 5, 8)</code>：调用 Math.max 函数，返回最大值 8。</p>
<p><strong>运算符：</strong></p>
<ol>
<li>算数运算符：加号、减号、乘号、除号、取模（%）等。</li>
<li>比较运算符：大于号、小于号、等于号、不等于号、大于等于号、小于等于号等。</li>
<li>逻辑运算符：与（&amp;&amp;）、或（||）、非（!）等。</li>
<li>位运算符：按位与（&amp;）、按位或（|）、按位非（~）、按位异或（^）等。</li>
<li>赋值运算符：等号、加等于（+&#x3D;）、减等于（-&#x3D;）、乘等于（*&#x3D;）、除等于（&#x2F;&#x3D;）等。</li>
<li>条件运算符：问号（？）和冒号（：），用于条件判断。例：2&gt;3?true:flase;</li>
<li>其他运算符：typeof（返回变量类型）、instanceof（判断对象是否属于某个类）等。</li>
</ol>
<h3 id="6-消息框：警告框，提示框，确认框"><a href="#6-消息框：警告框，提示框，确认框" class="headerlink" title="6.消息框：警告框，提示框，确认框"></a>6.消息框：警告框，提示框，确认框</h3><p>JavaScript 提供了三种常见的消息框：警告框、提示框和确认框。</p>
<ol>
<li>警告框</li>
</ol>
<p>警告框用于向用户显示一条警告消息。它只有一个“确定”按钮，点击后警告框就会消失。警告框的语法如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">alert</span>(<span class="string">&quot;消息内容&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>其中，消息内容是要向用户显示的消息字符串。例如：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">alert</span>(<span class="string">&quot;请注意，这是一条警告消息！&quot;</span>);</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>提示框</li>
</ol>
<p>提示框用于向用户显示一条消息，并接受用户输入数据。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">prompt</span>(<span class="string">&quot;消息内容&quot;</span>, <span class="string">&quot;默认值&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>其中，消息内容是要向用户显示的消息字符串，而默认值则是一个可选的参数，用于指定用户输入框的默认值。例如：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> name = <span class="title function_">prompt</span>(<span class="string">&quot;请输入您的姓名：&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line"><span class="title function_">alert</span>(<span class="string">&quot;您好，&quot;</span> + name + <span class="string">&quot;！&quot;</span>);</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>确认框</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">confirm</span>(<span class="string">&quot;消息内容&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>其中，消息内容是要向用户显示的消息字符串。例如：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="title function_">confirm</span>(<span class="string">&quot;您确定要删除这个文件吗？&quot;</span>)) &#123;</span><br><span class="line">  <span class="comment">// 用户点击了“确定”按钮</span></span><br><span class="line">  <span class="title function_">deleteFile</span>();</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="comment">// 用户点击了“取消”按钮</span></span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="7-document对象属性方法"><a href="#7-document对象属性方法" class="headerlink" title="7.document对象属性方法"></a>7.document对象属性方法</h3><p>属性：</p>
<ul>
<li><code>document.getElementById(id)</code>：根据元素的 <code>id</code> 属性获取元素对象。</li>
<li><code>document.getElementsByClassName() </code>：根据元素的<code>class</code>属性获取元素对象。</li>
<li><code>document.getElementsByTagName(tagname)</code> ：根据元素的标签名获取元素对象。 </li>
<li><code>document.body</code>：获取 <code>body</code> 元素对象。</li>
<li><code>document.head</code>：获取 <code>head</code> 元素对象。</li>
<li><code>document.title</code>：获取或设置文档的标题。</li>
<li><code>document.URL</code>：获取文档的URL。</li>
</ul>
<p>方法：</p>
<ul>
<li><code>document.createElement(tagName)</code>：创建一个 HTML 元素。</li>
<li><code>document.createTextNode(data)</code>：创建一个包含指定文本内容的文本节点。</li>
<li><code>document.querySelector(selector)</code>：根据 CSS 选择器获取第一个匹配的元素。</li>
<li><code>document.querySelectorAll(selector)</code>：根据 CSS 选择器获取所有匹配的元素。</li>
<li><code>document.write(content)</code>：向文档写入 HTML 内容（会覆盖整个文档）。</li>
<li><code>document.writeln(content)</code>：向文档写入 HTML 内容并换行（会覆盖整个文档）。</li>
</ul>
<h2 id="二、填空："><a href="#二、填空：" class="headerlink" title="二、填空："></a>二、填空：</h2><h3 id="1-标记的概念"><a href="#1-标记的概念" class="headerlink" title="1.标记的概念"></a>1.标记的概念</h3><p>HTML 中的标记是用来描述文档结构和内容的符号，也称为标签（tag）。标记由一对尖括号（&lt;&gt;）包围，包括起始标记和结束标记，例如：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>这是一个段落。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>其中，<code>&lt;p&gt;</code> 是起始标记，用于表示一个段落的开始，<code>&lt;/p&gt;</code> 是结束标记，用于表示该段落的结束。标记中间的文本是该标记所描述的内容。</p>
<p>HTML 标记可以分为两类：块级标记和内联标记。</p>
<h4 id="1-块级标记"><a href="#1-块级标记" class="headerlink" title="1.块级标记"></a>1.块级标记</h4><p>块级标记用于组织文档的结构，通常表示文档中的一个大块内容，如段落、标题、列表、表格等。块级标记会在页面中单独占据一行，可以设置宽度、高度、边距、内边距等样式。常用的块级标记包括：</p>
<ul>
<li><code>&lt;h1&gt;</code> 到 <code>&lt;h6&gt;</code>：表示六级标题。</li>
<li><code>&lt;p&gt;</code>：表示段落。</li>
<li><code>&lt;div&gt;</code>：表示文档中的一个分割区域，可用于布局、包裹块级元素等。</li>
<li><code>&lt;ul&gt;</code> 和 <code>&lt;ol&gt;</code>：表示无序列表和有序列表。</li>
<li><code>&lt;li&gt;</code>：表示列表项。</li>
<li><code>&lt;table&gt;</code>：表示表格。</li>
<li><code>&lt;tr&gt;</code>：表示表格中的行。</li>
<li><code>&lt;td&gt;</code>：表示表格中的单元格。</li>
</ul>
<h4 id="2-内联标记"><a href="#2-内联标记" class="headerlink" title="2.内联标记"></a>2.内联标记</h4><p>内联标记用于标记文本中的一部分内容，通常表示文本中的一个小段落或一个词语，如加粗、斜体、链接等。内联标记不会独占一行，不能设置宽度、高度等样式。常用的内联标记包括：</p>
<ul>
<li><code>&lt;b&gt;</code> 和 <code>&lt;strong&gt;</code>：表示加粗。</li>
<li><code>&lt;i&gt;</code> 和 <code>&lt;em&gt;</code>：表示斜体。</li>
<li><code>&lt;u&gt;</code> 和 <code>&lt;ins&gt;</code>：表示下划线。</li>
<li><code>&lt;a&gt;</code>：表示链接。</li>
<li><code>&lt;span&gt;</code>：表示文档中的一个小的分割区域，可用于包裹内联元素等。</li>
</ul>
<p>除了这些常用的标记外，还有其他许多标记，可以根据需要灵活使用。</p>
<h3 id="2-列表的概念。常见列表，有序，无序"><a href="#2-列表的概念。常见列表，有序，无序" class="headerlink" title="2.列表的概念。常见列表，有序，无序"></a>2.列表的概念。常见列表，有序，无序</h3><p>列表是一种在网页中展示内容的方式，常见的列表类型包括有序列表和无序列表。</p>
<h4 id="1-无序列表"><a href="#1-无序列表" class="headerlink" title="1.无序列表"></a>1.无序列表</h4><p>无序列表是一种用于展示信息的列表类型，其列表项通常以特定符号（如圆点、方块等）开头。在 HTML 中，无序列表使用 <code>&lt;ul&gt;</code> 标签来定义，每个列表项使用 <code>&lt;li&gt;</code> 标签来表示。例如：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>苹果<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>香蕉<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>橙子<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>上面的例子中，<code>&lt;ul&gt;</code> 标签定义了一个无序列表，其中包含三个列表项，分别是苹果、香蕉和橙子。</p>
<h4 id="2-有序列表"><a href="#2-有序列表" class="headerlink" title="2.有序列表"></a>2.有序列表</h4><p>有序列表是一种用于展示有序信息的列表类型，其列表项通常以数字或字母开头。在 HTML 中，有序列表使用 <code>&lt;ol&gt;</code> 标签来定义，每个列表项使用 <code>&lt;li&gt;</code> 标签来表示。例如：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ol</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>第一步<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>第二步<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>第三步<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>上面的例子中，<code>&lt;ol&gt;</code> 标签定义了一个有序列表，其中包含三个列表项，分别是第一步、第二步和第三步。</p>
<p>需要注意的是，有序列表的列表项默认以数字开头，可以通过 <code>type</code> 属性来指定列表项的开头类型。例如：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ol</span> <span class="attr">type</span>=<span class="string">&quot;A&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>第一步<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>第二步<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>第三步<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>上面的例子中，<code>type=&quot;A&quot;</code> 表示列表项以大写字母（A、B、C…）开头。</p>
<p>除了 <code>type</code> 属性外，还可以使用 <code>start</code> 属性来指定列表项的起始值，以及 <code>reversed</code> 属性来倒序显示列表项。例如：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ol</span> <span class="attr">start</span>=<span class="string">&quot;4&quot;</span> <span class="attr">reversed</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>第一步<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>第二步<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>第三步<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>上面的例子中，<code>start=&quot;4&quot;</code> 表示列表项从 4 开始，<code>reversed</code> 表示列表项倒序显示。</p>
<h3 id="3-js的引入方式，内部和外部"><a href="#3-js的引入方式，内部和外部" class="headerlink" title="3.js的引入方式，内部和外部"></a>3.js的引入方式，内部和外部</h3><p>内部引入是指 JavaScript 代码写在 HTML 文件中，可以通过 <code>script</code> 标签来实现。例如：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>内部引入示例<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>这是一个内部引入示例<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// JavaScript 代码写在这里</span></span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">alert</span>(<span class="string">&quot;Hello, World!&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>外部引入是指 JavaScript 代码写在一个单独的 .js 文件中，通过 <code>script</code> 标签的 <code>src</code> 属性来引入。例如：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>外部引入示例<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 在 head 标签中引入外部 js 文件 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;main.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>这是一个外部引入示例<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>在 <code>main.js</code> 文件中输出 “Hello, World!”：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="string">&quot;Hello, World!&quot;</span>);</span><br></pre></td></tr></table></figure>

<h3 id="4-表格：元素，属性，跨行跨列，表头，标题"><a href="#4-表格：元素，属性，跨行跨列，表头，标题" class="headerlink" title="4.表格：元素，属性，跨行跨列，表头，标题"></a>4.表格：元素，属性，跨行跨列，表头，标题</h3><p>表格是网页中常用的展示数据的一种方式，可以使用 HTML 标签 <code>&lt;table&gt;</code>、<code>&lt;thead&gt;</code>、<code>&lt;tbody&gt;</code>、<code>&lt;tfoot&gt;</code>、<code>&lt;tr&gt;</code>、<code>&lt;th&gt;</code>、<code>&lt;td&gt;</code> 来创建。</p>
<h4 id="元素"><a href="#元素" class="headerlink" title="元素"></a>元素</h4><ul>
<li><code>&lt;table&gt;</code>：定义一个表格。</li>
<li><code>&lt;thead&gt;</code>：定义表格的表头。</li>
<li><code>&lt;tbody&gt;</code>：定义表格的主体部分。</li>
<li><code>&lt;tfoot&gt;</code>：定义表格的页脚部分。</li>
<li><code>&lt;tr&gt;</code>：定义表格中的一行。</li>
<li><code>&lt;th&gt;</code>：定义表格中的表头单元格。</li>
<li><code>&lt;td&gt;</code>：定义表格中的数据单元格。</li>
</ul>
<h4 id="属性"><a href="#属性" class="headerlink" title="属性"></a>属性</h4><ul>
<li><code>border</code>：定义表格边框的宽度。</li>
<li><code>cellspacing</code>：定义单元格之间的空白距离。</li>
<li><code>cellpadding</code>：定义单元格内容与单元格边框之间的空白距离。</li>
<li><code>colspan</code>：定义单元格要跨越的列数。</li>
<li><code>rowspan</code>：定义单元格要跨越的行数。</li>
</ul>
<h4 id="跨行跨列"><a href="#跨行跨列" class="headerlink" title="跨行跨列"></a>跨行跨列</h4><p>使用 <code>colspan</code> 和 <code>rowspan</code> 属性可以让单元格跨越多行或多列。例如：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">border</span>=<span class="string">&quot;1&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">th</span>&gt;</span>姓名<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">th</span>&gt;</span>年龄<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">th</span> <span class="attr">colspan</span>=<span class="string">&quot;2&quot;</span>&gt;</span>联系方式<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>张三<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>20<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>电话<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>邮箱<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span> <span class="attr">rowspan</span>=<span class="string">&quot;2&quot;</span>&gt;</span>李四<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>21<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>电话<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>邮箱<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>地址<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>邮编<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>上面的例子中，第一行的第三、四个单元格使用了 <code>colspan=&quot;2&quot;</code>，表示要跨越两个列；第三行的第一列使用了 <code>rowspan=&quot;2&quot;</code>，表示要跨越两个行。</p>
<h4 id="表头和标题"><a href="#表头和标题" class="headerlink" title="表头和标题"></a>表头和标题</h4><p>使用 <code>&lt;thead&gt;</code> 可以定义表格的表头，使用 <code>&lt;caption&gt;</code> 可以定义表格的标题。例如：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">border</span>=<span class="string">&quot;1&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">caption</span>&gt;</span>学生信息表<span class="tag">&lt;/<span class="name">caption</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">thead</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">th</span>&gt;</span>姓名<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">th</span>&gt;</span>年龄<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">th</span>&gt;</span>性别<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">thead</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">tbody</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>张三<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>20<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>男<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>李四<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>21<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>女<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="三、简答"><a href="#三、简答" class="headerlink" title="三、简答"></a>三、简答</h2><h3 id="1-js的标识符，什么是标识符，定义时需要注意什么问题"><a href="#1-js的标识符，什么是标识符，定义时需要注意什么问题" class="headerlink" title="1.js的标识符，什么是标识符，定义时需要注意什么问题"></a>1.js的标识符，什么是标识符，定义时需要注意什么问题</h3><p><strong>JavaScript 中标识符是指</strong>：用于命名变量、函数或属性的字符序列。标识符可以包含字母、数字、下划线和美元符号，但不能以数字开头。JavaScript 中的标识符是区分大小写的。</p>
<p>例如，以下是合法的标识符：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> myVariable = <span class="number">123</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">myFunction</span>(<span class="params"></span>) &#123; ... &#125;</span><br><span class="line"><span class="keyword">var</span> $myVar = <span class="string">&quot;abc&quot;</span>;</span><br><span class="line"><span class="keyword">var</span> _myVar = <span class="string">&quot;xyz&quot;</span>;</span><br></pre></td></tr></table></figure>

<p><strong>定义标识符时需要注意以下几个问题：</strong></p>
<ol>
<li>标识符不能以数字开头，只能以字母、下划线或美元符号开头。</li>
<li>标识符不能包含空格和标点符号，只能包含字母、数字、下划线和美元符号。</li>
<li>标识符应该使用有意义的名称，以便于代码的可读性和维护性。</li>
<li>标识符应该采用一致的命名规范，如驼峰命名法等。</li>
</ol>
<p>总之，在 JavaScript 中定义标识符时需要注意遵守语法规范和命名规范，以便于编写出易于维护和阅读的代码。</p>
<h3 id="2-dom，bom的区别，优点缺点。"><a href="#2-dom，bom的区别，优点缺点。" class="headerlink" title="2.dom，bom的区别，优点缺点。"></a>2.dom，bom的区别，优点缺点。</h3><p><strong>区别：</strong></p>
<ol>
<li>DOM描述了网页内容（如HTML、XML等），并定义了一种访问和操作这些内容的方法和接口。DOM的核心是一棵树形结构，由节点和对象组成，它表示了网页中所有的元素和标签以及它们之间的关系。</li>
<li>BOM则提供了与浏览器窗口交互的对象和方法，例如window对象、location对象、history对象、navigator对象、screen对象等。BOM使得JavaScript能够控制浏览器的行为，例如打开新窗口、改变URL、导航历史记录等。</li>
</ol>
<p><strong>优缺点：</strong></p>
<p>DOM优：</p>
<ul>
<li>构建标准统一，不同浏览器的 DOM API 基本一致，开发者可以很方便地编写跨浏览器兼容的代码。</li>
<li>可扩展性好，开发者可以通过自定义 DOM 元素和事件来扩展 HTML 的功能。</li>
<li>操作简单、灵活，开发者可以通过 DOM API 快速地访问和修改 HTML 元素和文本内容。</li>
</ul>
<p>DOM缺：</p>
<ul>
<li>操作 DOM 元素可能会导致浏览器重新渲染整个页面，性能较低。</li>
<li>在大型和复杂的页面中，DOM 的树形结构可能会变得非常庞大，导致内存占用过高。</li>
</ul>
<p>BOM优：</p>
<ul>
<li>提供了对浏览器窗口和页面的完整访问和操作，使得开发者可以更好地管理浏览器状态和行为。</li>
<li>可以实现浏览器级别的功能，例如打开新窗口、弹出对话框、控制浏览器历史记录等。</li>
</ul>
<p>BOM缺：</p>
<ul>
<li>不同浏览器之间的 BOM API 实现可能不同，开发者需要进行兼容性处理。</li>
<li>BOM 带来了一些安全隐患，例如可能会被用于实现恶意弹窗等行为。</li>
</ul>
<h3 id="3-div的用法"><a href="#3-div的用法" class="headerlink" title="3.div的用法"></a>3.div的用法</h3><ol>
<li>页面布局：通过 div 可以将页面划分为多个区块，每个区块可以对应不同的页面部分，例如头部、导航、侧边栏、主体内容、页脚等。</li>
<li>包裹内容：使用 div 可以将一组相关元素包裹起来，便于在样式表中对其进行统一的样式设置，或者使用 JavaScript 对其进行统一的操作。</li>
<li>容器元素：通过 div 可以创建一个空白的容器元素，用于在其中动态添加其他元素。</li>
<li>响应式布局：在响应式设计中，使用 div 可以对不同的屏幕大小进行布局调整，使得页面在不同的设备上都可以得到良好的展示效果。</li>
</ol>
<h3 id="4-Web的工作原理"><a href="#4-Web的工作原理" class="headerlink" title="4.Web的工作原理"></a>4.Web的工作原理</h3><ol>
<li>客户端浏览器向服务器发送 HTTP 请求，请求包括所需资源的 URL 和其他相关信息。</li>
<li>服务器接收到请求后，根据 URL 找到对应的资源并生成 HTTP 响应，响应包括状态码、消息头和消息体。</li>
<li>响应被传输回客户端浏览器，浏览器解析响应并渲染页面。如果响应是 HTML 页面，则浏览器会解析 HTML 标记，并使用 CSS 样式和 JavaScript 脚本来渲染和交互。</li>
<li>在页面渲染期间，浏览器可能会发起其他 HTTP 请求获取页面中引用的其他资源，如图片、样式表、JavaScript 文件等。</li>
<li>服务器再次响应这些请求，浏览器将这些资源嵌入到页面中或者执行对应的代码。</li>
</ol>
<h3 id="5-html、js-css在web中的各自的作用"><a href="#5-html、js-css在web中的各自的作用" class="headerlink" title="5.html、js\css在web中的各自的作用"></a>5.html、js\css在web中的各自的作用</h3><ol>
<li><p>HTML（超文本标记语言）：负责页面的内容展示和结构，包括文字、图片、链接、表单等元素的定义和布局。</p>
</li>
<li><p>CSS（层叠样式表）：负责页面的样式设计，包括字体、颜色、大小、布局、动画等多个方面，使页面呈现出美观的视觉效果。</p>
</li>
<li><p>JS（JavaScript）：负责页面的交互和动态效果，包括用户输入与响应、数据处理、动态操作 DOM、AJAX 等功能。</p>
</li>
</ol>
<h2 id="四、课后题、bs和cs的区别，优缺点"><a href="#四、课后题、bs和cs的区别，优缺点" class="headerlink" title="四、课后题、bs和cs的区别，优缺点"></a>四、课后题、bs和cs的区别，优缺点</h2><p><strong>区别：</strong></p>
<ol>
<li><p>应用场景不同</p>
<p>BS 架构模式主要应用于 Web 应用程序的开发，客户端通过浏览器访问服务器的 Web 应用，而 CS 架构模式主要应用于桌面应用程序和移动应用程序的开发，客户端通过本地安装的软件连接服务器进行交互。</p>
</li>
<li><p>数据处理方式不同</p>
<p>BS 架构模式的数据处理主要在服务器端进行，客户端只负责展示和传输数据，而 CS 架构模式的数据处理则主要在客户端进行，服务器只负责存储和提供数据。</p>
</li>
<li><p>安全性不同</p>
<p>BS 架构模式相对于 CS 架构模式来说更加安全，因为所有的数据都存储在服务器端，客户端只是通过浏览器访问数据，不会直接接触到数据。而 CS 架构模式需要在客户端本地存储数据，容易受到恶意攻击。</p>
</li>
<li><p>维护成本和易用性不同</p>
<p>BS 架构模式相对于 CS 架构模式来说维护成本更低，因为只需要维护服务器端的应用程序，而客户端的浏览器可以自动升级。而 CS 架构模式需要在客户端安装软件，对于用户来说不太友好，还需要不断升级维护。</p>
</li>
</ol>
<p><strong>B&#x2F;S优缺点</strong></p>
<ul>
<li><p>优点：安全性高、维护成本低、易于升级和扩展</p>
</li>
<li><p>缺点：客户端的交互体验和响应速度较慢</p>
</li>
</ul>
<p><strong>C&#x2F;S优缺点</strong></p>
<ul>
<li>优点：交互体验好、响应速度快</li>
<li>缺点：安全性低、维护成本高、易受攻击。</li>
</ul>
<h2 id="五、程序"><a href="#五、程序" class="headerlink" title="五、程序"></a>五、程序</h2><h3 id="1-html，css有序列表无序列表嵌套，通过css列表样式前面项目类型的符号修改上级实验"><a href="#1-html，css有序列表无序列表嵌套，通过css列表样式前面项目类型的符号修改上级实验" class="headerlink" title="1.html，css有序列表无序列表嵌套，通过css列表样式前面项目类型的符号修改上级实验"></a>1.html，css有序列表无序列表嵌套，通过css列表样式前面项目类型的符号修改上级实验</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">			*&#123;</span></span><br><span class="line"><span class="language-css">				<span class="attribute">padding</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">				<span class="attribute">margin</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">			&#125;</span></span><br><span class="line"><span class="language-css">			<span class="selector-class">.box</span>&#123;</span></span><br><span class="line"><span class="language-css">				<span class="attribute">width</span>: <span class="number">1200px</span>;</span></span><br><span class="line"><span class="language-css">				<span class="attribute">height</span>: <span class="number">40px</span>;</span></span><br><span class="line"><span class="language-css">				<span class="attribute">margin</span>: <span class="number">0</span> auto;</span></span><br><span class="line"><span class="language-css">				<span class="attribute">background-color</span>: <span class="number">#ffaaff</span>;</span></span><br><span class="line"><span class="language-css">				<span class="attribute">border</span>: <span class="number">4px</span> solid palegreen;</span></span><br><span class="line"><span class="language-css">			&#125;</span></span><br><span class="line"><span class="language-css">			<span class="selector-class">.abc</span> <span class="selector-class">.myol</span>&#123;</span></span><br><span class="line"><span class="language-css">				<span class="attribute">width</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="language-css">				<span class="attribute">height</span>: <span class="number">32px</span>;</span></span><br><span class="line"><span class="language-css">				<span class="attribute">text-align</span>: center;</span></span><br><span class="line"><span class="language-css">				<span class="attribute">list-style</span>: none;</span></span><br><span class="line"><span class="language-css">				<span class="attribute">float</span>: left;</span></span><br><span class="line"><span class="language-css">				<span class="comment">/* padding: 0 auto; */</span></span></span><br><span class="line"><span class="language-css">				<span class="attribute">border</span>: <span class="number">1px</span> solid red;</span></span><br><span class="line"><span class="language-css">				</span></span><br><span class="line"><span class="language-css">			&#125;</span></span><br><span class="line"><span class="language-css">			<span class="selector-tag">ol</span>&#123;</span></span><br><span class="line"><span class="language-css">				<span class="attribute">display</span>: none;</span></span><br><span class="line"><span class="language-css">				<span class="attribute">margin-top</span>: <span class="number">12px</span>;</span></span><br><span class="line"><span class="language-css">			&#125;</span></span><br><span class="line"><span class="language-css">			<span class="selector-tag">ol</span> <span class="selector-tag">li</span>&#123;</span></span><br><span class="line"><span class="language-css">				<span class="attribute">width</span>: <span class="number">160px</span>;</span></span><br><span class="line"><span class="language-css">				<span class="attribute">height</span>: <span class="number">20px</span>;</span></span><br><span class="line"><span class="language-css">				<span class="attribute">text-align</span>: center;</span></span><br><span class="line"><span class="language-css">				<span class="attribute">color</span>: orange;</span></span><br><span class="line"><span class="language-css">				<span class="comment">/* list-style-type: disc; */</span></span></span><br><span class="line"><span class="language-css">				<span class="attribute">border</span>: <span class="number">1px</span> dashed black;</span></span><br><span class="line"><span class="language-css">				<span class="attribute">padding</span>: <span class="number">20px</span>;</span></span><br><span class="line"><span class="language-css">			&#125;</span></span><br><span class="line"><span class="language-css">			<span class="selector-class">.abc</span> <span class="selector-tag">li</span><span class="selector-pseudo">:hover</span> <span class="selector-tag">ol</span>&#123;</span></span><br><span class="line"><span class="language-css">				<span class="attribute">display</span>: block;</span></span><br><span class="line"><span class="language-css">			&#125;</span></span><br><span class="line"><span class="language-css">		</span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">marquee</span> <span class="attr">width</span>=<span class="string">&quot;1400px&quot;</span> <span class="attr">height</span>=<span class="string">&quot;40px&quot;</span> <span class="attr">direction</span>=<span class="string">&quot;right&quot;</span> <span class="attr">scrollamount</span>=<span class="string">&quot;25&quot;</span> <span class="attr">scrolldelay</span>=<span class="string">&quot;1&quot;</span> &gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">span</span>&gt;</span>欢迎来到实力至上主义的教室<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">marquee</span>&gt;</span></span><br><span class="line">			</span><br><span class="line">			<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">&quot;abc&quot;</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">&quot;myol&quot;</span>&gt;</span>Java<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">&quot;myol&quot;</span>&gt;</span>Web<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">&quot;myol&quot;</span>&gt;</span>Spring<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">&quot;myol&quot;</span>&gt;</span>SpringMvc</span><br><span class="line">						<span class="tag">&lt;<span class="name">ol</span>&gt;</span></span><br><span class="line">							<span class="tag">&lt;<span class="name">li</span> <span class="attr">type</span>=<span class="string">&quot;none&quot;</span>&gt;</span>前端控制器<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">							<span class="tag">&lt;<span class="name">li</span> <span class="attr">type</span>=<span class="string">&quot;circle&quot;</span>&gt;</span>controller<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">							<span class="tag">&lt;<span class="name">li</span> <span class="attr">type</span>=<span class="string">&quot;disc&quot;</span>&gt;</span>dispatchServlet<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">						<span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">&quot;myol&quot;</span>&gt;</span>myBatis</span><br><span class="line">						<span class="tag">&lt;<span class="name">ol</span> <span class="attr">start</span>=<span class="string">&quot;5&quot;</span>&gt;</span></span><br><span class="line">							<span class="tag">&lt;<span class="name">li</span> <span class="attr">type</span>=<span class="string">&quot;A&quot;</span>&gt;</span>持久层<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">							<span class="tag">&lt;<span class="name">li</span>&gt;</span>动态sql<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">							<span class="tag">&lt;<span class="name">li</span>&gt;</span>连接简单<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">						<span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="2-注册的页面，里面js加上校验，长度的校验（实验10）"><a href="#2-注册的页面，里面js加上校验，长度的校验（实验10）" class="headerlink" title="2.注册的页面，里面js加上校验，长度的校验（实验10）"></a>2.注册的页面，里面js加上校验，长度的校验（实验10）</h3><p><strong>长度校验</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">checkReg</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">let</span> myname=f.<span class="property">yhm</span>.<span class="property">value</span>;</span><br><span class="line">    <span class="keyword">let</span> mypwd=f.<span class="property">pwd</span>.<span class="property">value</span>;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(myname.<span class="property">length</span>);</span><br><span class="line">    <span class="keyword">if</span>(myname==<span class="string">&quot;&quot;</span> || myname.<span class="property">length</span>&lt;<span class="number">6</span>||myname.<span class="property">length</span>&gt;<span class="number">10</span>)&#123;</span><br><span class="line">        <span class="title function_">alert</span>(<span class="string">&quot;用户名长度应是6-10个字符&quot;</span>);</span><br><span class="line">        f.<span class="property">yhm</span>.<span class="title function_">focus</span>();</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(mypwd==<span class="string">&quot;&quot;</span> || mypwd.<span class="property">length</span>&lt;<span class="number">6</span>||mypwd.<span class="property">length</span>&gt;<span class="number">10</span>)&#123;</span><br><span class="line">        <span class="title function_">alert</span>(<span class="string">&quot;密码长度应是6-10个字符&quot;</span>);</span><br><span class="line">        f.<span class="property">pwd</span>.<span class="title function_">focus</span>();</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>正则表达式校验操作</strong>，例如校验邮箱、手机号、身份证号码等。</p>
<p>下面是几个常见的校验示例：</p>
<ol>
<li>校验邮箱地址</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">function validateEmail(email) &#123;</span><br><span class="line">  var reg = /^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+\.([a-zA-Z])+$/;</span><br><span class="line">  return reg.test(email);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">console.log(validateEmail(&quot;example@example.com&quot;)); // true</span><br><span class="line">console.log(validateEmail(&quot;example@.com&quot;)); // false</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>校验手机号码</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">function validatePhone(phone) &#123;</span><br><span class="line">  var reg = /^1[3456789]\d&#123;9&#125;$/;</span><br><span class="line">  return reg.test(phone);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">console.log(validatePhone(&quot;13812345678&quot;)); // true</span><br><span class="line">console.log(validatePhone(&quot;12345678901&quot;)); // false</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>校验身份证号码</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">function validateIdCard(idCard) &#123;</span><br><span class="line">  var reg = /(^\d&#123;15&#125;$)|(^\d&#123;18&#125;$)|(^\d&#123;17&#125;(\d|X|x)$)/;</span><br><span class="line">  return reg.test(idCard);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">console.log(validateIdCard(&quot;510722199012123456&quot;)); // true</span><br><span class="line">console.log(validateIdCard(&quot;51072219901212345X&quot;)); // true</span><br><span class="line">console.log(validateIdCard(&quot;51072219901212345&quot;)); // false</span><br></pre></td></tr></table></figure>

<h3 id="3-函数，嵌套，自定义函数，递归调用。"><a href="#3-函数，嵌套，自定义函数，递归调用。" class="headerlink" title="3.函数，嵌套，自定义函数，递归调用。"></a>3.函数，嵌套，自定义函数，递归调用。</h3><p><strong>函数</strong></p>
<p>JavaScript 内置的常用函数有很多，以下列举一些常用的函数：</p>
<ol>
<li>字符串相关函数</li>
</ol>
<ul>
<li><code>charAt()</code>：返回指定位置的字符。</li>
<li><code>substr()</code>：返回指定长度的子字符串。</li>
<li><code>slice()</code>：返回指定位置的子字符串。</li>
<li><code>concat()</code>：将两个或多个字符串拼接起来。</li>
<li><code>toLowerCase()</code>：将字符串转换为小写。</li>
<li><code>toUpperCase()</code>：将字符串转换为大写。</li>
<li><code>indexOf()</code>：返回字符串中指定字符或子字符串的位置。</li>
<li><code>lastIndexOf()</code>：返回字符串中最后一个指定字符或子字符串的位置。</li>
<li><code>replace()</code>：替换指定字符或子字符串。</li>
<li><code>split()</code>：将字符串按照指定字符分割成数组。</li>
</ul>
<ol start="2">
<li>数组相关函数</li>
</ol>
<ul>
<li><code>push()</code>：在数组末尾添加一个或多个元素。</li>
<li><code>pop()</code>：删除数组末尾的元素并返回该元素。</li>
<li><code>shift()</code>：删除数组第一个元素并返回该元素。</li>
<li><code>unshift()</code>：在数组开头添加一个或多个元素。</li>
<li><code>concat()</code>：将两个或多个数组合并成一个新数组。</li>
<li><code>slice()</code>：返回指定位置的子数组。</li>
<li><code>splice()</code>：删除或插入数组元素。</li>
<li><code>reverse()</code>：颠倒数组元素顺序。</li>
<li><code>sort()</code>：按照指定顺序排序数组元素。</li>
<li><code>join()</code>：将数组元素转换为字符串并连接起来。</li>
</ul>
<ol start="3">
<li>数字相关函数</li>
</ol>
<ul>
<li><code>parseInt()</code>：将字符串转换为整数。</li>
<li><code>parseFloat()</code>：将字符串转换为浮点数。</li>
<li><code>toFixed()</code>：将数字保留指定小数位数并返回字符串。</li>
<li><code>toExponential()</code>：将数字转换为指数形式并返回字符串。</li>
<li><code>toString()</code>：将数字转换为字符串并返回。</li>
</ul>
<ol start="4">
<li>其他常用函数</li>
</ol>
<ul>
<li><code>setTimeout()</code>：延迟指定时间后执行函数。</li>
<li><code>setInterval()</code>：按照指定时间间隔重复执行函数。</li>
<li><code>clearTimeout()</code>：取消 <code>setTimeout()</code> 函数的执行。</li>
<li><code>clearInterval()</code>：取消 <code>setInterval()</code> 函数的执行。</li>
<li><code>encodeURI()</code>：将字符串编码为 URI 字符串。</li>
<li><code>decodeURI()</code>：将 URI 字符串解码为普通字符串。</li>
<li><code>encodeURIComponent()</code>：将字符串编码为 URI 组件字符串。</li>
<li><code>decodeURIComponent()</code>：将 URI 组件字符串解码为普通字符串。</li>
</ul>
<p>以上仅是一部分 JavaScript 内置常用函数，JavaScript 还有很多其他的内置函数，需要根据具体需求进行选择使用。</p>
<p><strong>自定义函数、递归调用</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">fibonacci</span>(<span class="params">n</span>) &#123;</span><br><span class="line">			  <span class="keyword">if</span> (n &lt;= <span class="number">2</span>) &#123;</span><br><span class="line">			    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">			  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			    <span class="keyword">return</span> <span class="title function_">fibonacci</span>(n - <span class="number">1</span>) + <span class="title function_">fibonacci</span>(n - <span class="number">2</span>);</span><br><span class="line">			  &#125;</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">			<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">fibonacci</span>(<span class="number">10</span>)); <span class="comment">// 输出第10项的值</span></span><br><span class="line">			<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;myspan&quot;</span>).<span class="property">innerHTML</span>=<span class="title function_">fibonacci</span>(<span class="number">10</span>);</span><br></pre></td></tr></table></figure>

<h3 id="4-循环语句，条件嵌套"><a href="#4-循环语句，条件嵌套" class="headerlink" title="4.循环语句，条件嵌套"></a>4.循环语句，条件嵌套</h3><p>JavaScript 中常用的循环语句有 <code>for</code> 循环和 <code>while</code> 循环。</p>
<ol>
<li><code>for</code> 循环</li>
</ol>
<p><code>for</code> 循环用于重复执行一段代码，通常使用在已知循环次数的情况下。</p>
<p>语法：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">for (初始化表达式; 条件表达式; 更新表达式) &#123;</span><br><span class="line">  // 循环体代码</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><code>初始化表达式</code>：定义循环变量并赋初值，只在循环开始时执行一次。</li>
<li><code>条件表达式</code>：定义循环条件，只要条件为真，循环就会继续执行。</li>
<li><code>更新表达式</code>：更新循环变量的值，通常是加 1，只在循环体执行完毕后执行一次。</li>
<li><code>循环体代码</code>：需要被重复执行的代码块。</li>
</ul>
<p>示例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">for (var i = 0; i &lt; 5; i++) &#123;</span><br><span class="line">  console.log(i);</span><br><span class="line">&#125;</span><br><span class="line">// 输出：0 1 2 3 4</span><br></pre></td></tr></table></figure>

<ol start="2">
<li><code>while</code> 循环</li>
</ol>
<p><code>while</code> 循环用于重复执行一段代码，通常使用在不知道循环次数的情况下，只要条件为真，循环就会一直执行下去。</p>
<p>语法：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">while (条件表达式) &#123;</span><br><span class="line">  // 循环体代码</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><code>条件表达式</code>：定义循环条件，只要条件为真，循环就会继续执行。</li>
<li><code>循环体代码</code>：需要被重复执行的代码块。</li>
</ul>
<p>示例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">var i = 0;</span><br><span class="line">while (i &lt; 5) &#123;</span><br><span class="line">  console.log(i);</span><br><span class="line">  i++;</span><br><span class="line">&#125;</span><br><span class="line">// 输出：0 1 2 3 4</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>条件嵌套</li>
</ol>
<p>在循环语句中可以嵌套条件语句，以根据不同的情况执行不同的代码块。</p>
<p>示例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">for (var i = 0; i &lt; 10; i++) &#123;</span><br><span class="line">  if (i % 2 === 0) &#123;</span><br><span class="line">    console.log(i + &quot; 是偶数&quot;);</span><br><span class="line">  &#125; else &#123;</span><br><span class="line">    console.log(i + &quot; 是奇数&quot;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>以上代码中，使用 <code>for</code> 循环遍历数字 0 到 9，通过 <code>if...else</code> 判断每个数字是偶数还是奇数，然后输出相应的提示信息。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://suyiharris.github.io/2023/10/24/2023-10-24-web%E7%AD%94%E7%96%91/" data-id="clo4h2l3w000pnso9cyhnb40x" data-title="web答疑" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-2023-10-24-LPC11C14刷卡门锁" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/10/24/2023-10-24-LPC11C14%E5%88%B7%E5%8D%A1%E9%97%A8%E9%94%81/" class="article-date">
  <time class="dt-published" datetime="2023-10-24T04:12:12.000Z" itemprop="datePublished">2023-10-24</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2023/10/24/2023-10-24-LPC11C14%E5%88%B7%E5%8D%A1%E9%97%A8%E9%94%81/">LPC11C14刷卡门锁</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>[TOC]</p>
<h2 id="产品开发平台"><a href="#产品开发平台" class="headerlink" title="产品开发平台"></a>产品开发平台</h2><p><img src="https://pic.imgdb.cn/item/6537cd30c458853aef624fbc.jpg"></p>
<h2 id="产品使用方法"><a href="#产品使用方法" class="headerlink" title="产品使用方法"></a>产品使用方法</h2><p>智能门锁支持RFID刷卡识别，但是卡片需要手动输入初始密码进行授权后才能使用(由于开发板集成高度并且没有多余按键可以使用，所以采用一个按键进行代替)。进行授权的卡片刷卡后会使得风扇开始转动，如果是非法卡，则就会使得引起蜂鸣器报警。进行授权时会在OLED屏幕上面出现相应提示，根据提示进行操作即可。应用界面可以显示当前环境的温度。湿度和光强。在测试时可以通过串口看到读取到的信息。</p>
<h2 id="结构框图"><a href="#结构框图" class="headerlink" title="结构框图"></a>结构框图</h2><p><img src="https://pic.imgdb.cn/item/6537cd3cc458853aef628310.jpg"></p>
<h2 id="产品运行流程"><a href="#产品运行流程" class="headerlink" title="产品运行流程"></a>产品运行流程</h2><p><img src="https://pic.imgdb.cn/item/6537cd4ec458853aef62ce04.jpg"></p>
<h2 id="产品运行界面"><a href="#产品运行界面" class="headerlink" title="产品运行界面"></a>产品运行界面</h2><p><img src="https://pic.imgdb.cn/item/6537cd5bc458853aef6303d1.jpg"></p>
<p><img src="https://pic.imgdb.cn/item/6537cd68c458853aef633ad3.jpg"></p>
<p><img src="https://pic.imgdb.cn/item/6537cd73c458853aef636d3b.jpg"></p>
<p><img src="https://pic.imgdb.cn/item/6537cd7ec458853aef639bec.jpg"></p>
<h2 id="程序源码"><a href="#程序源码" class="headerlink" title="程序源码"></a>程序源码</h2><p>主函数main.c</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;lpc11xx.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;oled.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;uart.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;rfid.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;stdio.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;dht11.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;light.h&quot;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> keybbuff[<span class="number">20</span>]=<span class="string">&quot;@haungqingyaunjain&quot;</span>;<span class="comment">//支持3个钥匙</span></span><br><span class="line"><span class="comment">//管脚默认输入</span></span><br><span class="line"><span class="comment">//GPIO时钟默认打开</span></span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">mydelay</span><span class="params">(<span class="type">int</span> x)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">int</span> i,j;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;x;i++)&#123;</span><br><span class="line">		<span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;<span class="number">20000</span>;j++)&#123;</span><br><span class="line">		</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">delay</span><span class="params">(<span class="type">int</span> time)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">while</span>(time--);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment">/************************					</span></span><br><span class="line"><span class="comment">							</span></span><br><span class="line"><span class="comment">风扇驱动函数</span></span><br><span class="line"><span class="comment">************************/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">faninit</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	LPC_GPIO0-&gt;DIR|=(<span class="number">0x01</span>&lt;&lt;<span class="number">2</span>);<span class="comment">//输出</span></span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">fanon</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	LPC_GPIO0-&gt;DATA&amp;=~(<span class="number">0x01</span>&lt;&lt;<span class="number">2</span>);<span class="comment">//低电平</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">fanoff</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	LPC_GPIO0-&gt;DATA|=(<span class="number">0x01</span>&lt;&lt;<span class="number">2</span>);<span class="comment">//高电平</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment">/***************************				</span></span><br><span class="line"><span class="comment">		LED灯驱动函数</span></span><br><span class="line"><span class="comment">****************************/</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">led_init</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">	LPC_GPIO3-&gt;DIR |= <span class="number">0x01</span>;     <span class="comment">//输出</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">led_on</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">	LPC_GPIO3-&gt;DATA  &amp;= ~<span class="number">0x01</span>;  <span class="comment">//低电平</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">led_off</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">	LPC_GPIO3-&gt;DATA  |= <span class="number">0x01</span>;   <span class="comment">//高电平</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="type">void</span>  <span class="title function_">led2init</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	LPC_GPIO3-&gt;DIR|=(<span class="number">1</span>&lt;&lt;<span class="number">1</span>);<span class="comment">//输出</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">led2on</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	LPC_GPIO3-&gt;DATA&amp;=~(<span class="number">0x01</span>&lt;&lt;<span class="number">1</span>);<span class="comment">//低电平</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">led2off</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	LPC_GPIO3-&gt;DATA|=(<span class="number">0x01</span>&lt;&lt;<span class="number">1</span>);<span class="comment">//高电平</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment">///*************************</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">//		蜂鸣器驱动</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">//*************************/</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">//void beepinit()</span></span><br><span class="line"><span class="comment">//&#123;</span></span><br><span class="line"><span class="comment">//	LPC_SYSCON-&gt;SYSAHBCLKCTRL|=(0x01&lt;&lt;16);		//GPIO时钟配置</span></span><br><span class="line"><span class="comment">//	LPC_IOCON-&gt;R_PIO1_1|=0x01;								//GPIO模式配置（针对复用端口）</span></span><br><span class="line"><span class="comment">//	LPC_GPIO1-&gt;DIR|=(1&lt;&lt;1);										//输出</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment">//void beepon()</span></span><br><span class="line"><span class="comment">//&#123;</span></span><br><span class="line"><span class="comment">//	int j=0;</span></span><br><span class="line"><span class="comment">//	for(j=0;j&lt;10;j++)</span></span><br><span class="line"><span class="comment">//	&#123;</span></span><br><span class="line"><span class="comment">//		LPC_GPIO1-&gt;DATA|=(1&lt;&lt;1);//置1</span></span><br><span class="line"><span class="comment">//		delay(5000);</span></span><br><span class="line"><span class="comment">//		LPC_GPIO1-&gt;DATA&amp;=~(1&lt;&lt;1);//置0</span></span><br><span class="line"><span class="comment">//		delay(1000);</span></span><br><span class="line"><span class="comment">//	&#125;</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">//void beepoff()</span></span><br><span class="line"><span class="comment">//&#123;</span></span><br><span class="line"><span class="comment">//	LPC_GPIO1-&gt;DATA|=(1&lt;&lt;1);//置1</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment">/*****************************</span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment">		按键驱动</span></span><br><span class="line"><span class="comment">******************************/</span></span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">keyinit</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	LPC_GPIO0-&gt;DIR&amp;=~(<span class="number">0x01</span>&lt;&lt;<span class="number">3</span>);		<span class="comment">//输入</span></span><br><span class="line">	LPC_GPIO0-&gt;IS&amp;=~(<span class="number">0x01</span>&lt;&lt;<span class="number">3</span>);		<span class="comment">//边沿触发</span></span><br><span class="line">	LPC_GPIO0-&gt;IBE&amp;=~(<span class="number">0x01</span>&lt;&lt;<span class="number">3</span>);		<span class="comment">//关闭双边沿触发</span></span><br><span class="line">	LPC_GPIO0-&gt;IEV&amp;=~(<span class="number">0x01</span>&lt;&lt;<span class="number">3</span>);		<span class="comment">//下降沿触发</span></span><br><span class="line">	LPC_GPIO0-&gt;IE|=(<span class="number">0x01</span>&lt;&lt;<span class="number">3</span>);			<span class="comment">//打开中断</span></span><br><span class="line">	NVIC_EnableIRQ(EINT0_IRQn);		<span class="comment">//中断使能外部中断0</span></span><br><span class="line">																<span class="comment">//参数在LPCXX.h;</span></span><br><span class="line">																<span class="comment">//core_cm0.h</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment">/**************************</span></span><br><span class="line"><span class="comment">		pwm驱动</span></span><br><span class="line"><span class="comment">***************************/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">PWMinit</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	LPC_SYSCON-&gt;SYSAHBCLKCTRL|=(<span class="number">0x01</span>&lt;&lt;<span class="number">16</span>);</span><br><span class="line">	LPC_SYSCON-&gt;SYSAHBCLKCTRL|=(<span class="number">0x01</span>&lt;&lt;<span class="number">10</span>);</span><br><span class="line">	LPC_IOCON-&gt;R_PIO1_1|=<span class="number">0x03</span>;</span><br><span class="line"> </span><br><span class="line">	LPC_TMR32B1-&gt;PR=<span class="number">4800</span>;</span><br><span class="line">	LPC_TMR32B1-&gt;MR1=<span class="number">10</span>;</span><br><span class="line">	LPC_TMR32B1-&gt;MR0=<span class="number">5</span>;</span><br><span class="line">	LPC_TMR32B1-&gt;MCR|=(<span class="number">0x01</span>&lt;&lt;<span class="number">4</span>);</span><br><span class="line">	LPC_TMR32B1-&gt;EMR|=(<span class="number">0x03</span>&lt;&lt;<span class="number">4</span>);</span><br><span class="line">	LPC_TMR32B1-&gt;PWMC|=<span class="number">0x01</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment">/*******************</span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment">	打开蜂鸣器</span></span><br><span class="line"><span class="comment">********************/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">beepstart</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	LPC_TMR32B1-&gt;TCR|=<span class="number">0x01</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment">/*************************</span></span><br><span class="line"><span class="comment">	关闭蜂鸣器</span></span><br><span class="line"><span class="comment">*************************/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">beepstop</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	LPC_TMR32B1-&gt;TCR&amp;=~<span class="number">0x01</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment">/***********************************</span></span><br><span class="line"><span class="comment">	密码验证函数</span></span><br><span class="line"><span class="comment">验证成功返回1，失败返回0</span></span><br><span class="line"><span class="comment">***********************************/</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="type">int</span> <span class="title function_">keycmp</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> *str)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">int</span> i=<span class="number">0</span>;</span><br><span class="line">	<span class="type">int</span> rnum=<span class="number">0</span>;</span><br><span class="line">	<span class="type">int</span> count=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">16</span>;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span>(keybbuff[i]==str[i+<span class="number">2</span>])</span><br><span class="line">		&#123;</span><br><span class="line">			count++;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(count==<span class="number">16</span>)</span><br><span class="line">	rnum=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">return</span> rnum;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/*****************************</span></span><br><span class="line"><span class="comment">开机界面显示函数</span></span><br><span class="line"><span class="comment">*****************************/</span></span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">display</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">char</span> str1[<span class="number">20</span>];</span><br><span class="line">	<span class="type">char</span> str2[<span class="number">20</span>];</span><br><span class="line">	<span class="type">int</span> wendu,shidu,lightval;</span><br><span class="line">	dht11_get(&amp;shidu,&amp;wendu);</span><br><span class="line">	<span class="built_in">snprintf</span>(str1,<span class="keyword">sizeof</span>(str1),<span class="string">&quot;shidu:%d   wendu:%d&quot;</span>,shidu,wendu);</span><br><span class="line">	lightval=light_get();</span><br><span class="line">	<span class="built_in">snprintf</span>(str2,<span class="keyword">sizeof</span>(str2),<span class="string">&quot;guangqiang:%d&quot;</span>,lightval);</span><br><span class="line">	oled_clear_screen();</span><br><span class="line">	oled_disp_string(<span class="number">0</span>,<span class="number">0</span>,<span class="string">&quot;   welcome to here&quot;</span>);</span><br><span class="line">	oled_disp_string(<span class="number">2</span>,<span class="number">0</span>,str1);</span><br><span class="line">	oled_disp_string(<span class="number">4</span>,<span class="number">0</span>,str2);</span><br><span class="line">	oled_disp_string(<span class="number">6</span>,<span class="number">0</span>,<span class="string">&quot; dream is possible&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">int</span> state;</span><br><span class="line">	led_init();				<span class="comment">//LED1初始化</span></span><br><span class="line">	oled_init();			<span class="comment">//OLED初始化</span></span><br><span class="line">	led2init();				<span class="comment">//LED2初始化</span></span><br><span class="line">	rfid_init();			<span class="comment">//rfid初始化</span></span><br><span class="line">	uart_init();			<span class="comment">//串口初始化</span></span><br><span class="line">	faninit();				<span class="comment">//风扇初始化</span></span><br><span class="line"> 	PWMinit();				<span class="comment">//蜂鸣器初始化</span></span><br><span class="line">	keyinit();				<span class="comment">//按键初始化</span></span><br><span class="line">	light_init();</span><br><span class="line">	dht11_init();</span><br><span class="line">	oled_disp_string(<span class="number">0</span>,<span class="number">0</span>,<span class="string">&quot;  welcome to use it&quot;</span>);			</span><br><span class="line">	oled_disp_string(<span class="number">1</span>,<span class="number">0</span>,<span class="string">&quot;     group nine&quot;</span>);</span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		state=rfid_state();</span><br><span class="line">		<span class="keyword">if</span>(state)							<span class="comment">//寻卡</span></span><br><span class="line">		&#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;找到卡片\r\n&quot;</span>);			<span class="comment">//串口打印</span></span><br><span class="line">			rfid_read();									<span class="comment">//ID号读取</span></span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;%s\r\n&quot;</span>,(buf+<span class="number">2</span>));			<span class="comment">//串口打印ID卡号</span></span><br><span class="line">			<span class="keyword">if</span>(keycmp(buf)==<span class="number">1</span>&amp;&amp;state==<span class="number">1</span>)						<span class="comment">//ID卡号比较</span></span><br><span class="line">			&#123;</span><br><span class="line">				led2off();</span><br><span class="line">				fanon();</span><br><span class="line">				mydelay(<span class="number">150</span>);</span><br><span class="line">				fanoff();</span><br><span class="line">				mydelay(<span class="number">10</span>);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> </span><br><span class="line">			&#123;</span><br><span class="line">				beepstart();</span><br><span class="line">				mydelay(<span class="number">50</span>);</span><br><span class="line">				beepstop();</span><br><span class="line">				led2on();</span><br><span class="line">			&#125;</span><br><span class="line">			display();</span><br><span class="line">		&#125;</span><br><span class="line">		led_on();</span><br><span class="line">	&#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment">/********************</span></span><br><span class="line"><span class="comment">按键中断处理函数</span></span><br><span class="line"><span class="comment">********************/</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">PIOINT0_IRQHandler</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">int</span> i=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">if</span>(LPC_GPIO0-&gt;RIS&amp;(<span class="number">0x01</span>&lt;&lt;<span class="number">3</span>))<span class="comment">//中断发生标志位判断</span></span><br><span class="line">	&#123;</span><br><span class="line">		oled_clear_screen();</span><br><span class="line">		oled_disp_string(<span class="number">0</span>,<span class="number">0</span>,<span class="string">&quot;    mode:add key   &quot;</span>);</span><br><span class="line">		oled_disp_string(<span class="number">2</span>,<span class="number">0</span>,<span class="string">&quot;  put card on rfid&quot;</span>);</span><br><span class="line">		<span class="keyword">while</span>(rfid_state()==<span class="number">0</span>);				<span class="comment">//等待卡片被放下</span></span><br><span class="line">		rfid_read();</span><br><span class="line">		<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">36</span>;i++)</span><br><span class="line">		&#123;</span><br><span class="line">			keybbuff[i]=buf[i+<span class="number">2</span>];				</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;addkeyID:%s\r\n&quot;</span>,keybbuff);</span><br><span class="line"><span class="comment">//		while(rfid_state()==1);				//等待卡片被拿起</span></span><br><span class="line"><span class="comment">///*****************************************************</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//此处代码存在bug，经检测与软件无关，卡片没有拿起，就直接进入</span></span><br><span class="line"><span class="comment">//下面的函数，直接跳过了while()循环，多次修改无效，为硬件问题</span></span><br><span class="line"><span class="comment">//有些东西用while(1)也留不住，就像中断一样，来得突然，离开莫</span></span><br><span class="line"><span class="comment">//名其妙。</span></span><br><span class="line"><span class="comment">//******************************************************/			</span></span><br><span class="line">		oled_clear_screen();</span><br><span class="line">		oled_disp_string(<span class="number">0</span>,<span class="number">0</span>,<span class="string">&quot;   add sucessfully&quot;</span>);</span><br><span class="line">		mydelay(<span class="number">500</span>);</span><br><span class="line">		LPC_GPIO0-&gt;IC|=(<span class="number">0x01</span>&lt;&lt;<span class="number">3</span>);<span class="comment">//清除中断标志位</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h2 id="温度传感器驱动"><a href="#温度传感器驱动" class="headerlink" title="温度传感器驱动"></a>温度传感器驱动</h2><p>dth11.h</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> __DHT_H__</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __DHT_H__</span></span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">dht11_init</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"><span class="type">int</span> <span class="title function_">dht11_get</span><span class="params">(<span class="type">int</span> *h, <span class="type">int</span> *t)</span>;</span><br><span class="line"> </span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure>

<p>dth11.c</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;LPC11xx.h&quot;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">Delay10uS</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">int</span> i = <span class="number">45</span>;</span><br><span class="line">	<span class="keyword">while</span> (i--);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">Delay10mS</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">int</span> i = <span class="number">1000</span>;</span><br><span class="line">	<span class="keyword">while</span> (i--)</span><br><span class="line">		Delay10uS();</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">dht11_init</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">int</span> i = <span class="number">100</span>;</span><br><span class="line">	</span><br><span class="line">	LPC_GPIO1-&gt;DIR |= <span class="number">1</span> &lt;&lt; <span class="number">5</span>;</span><br><span class="line">	LPC_GPIO1-&gt;DATA |= <span class="number">1</span> &lt;&lt; <span class="number">5</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">while</span> (i--)</span><br><span class="line">		Delay10mS();   </span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//严格根据 dht11时序读取</span></span><br><span class="line"> </span><br><span class="line"><span class="type">int</span> <span class="title function_">dht11_get</span><span class="params">(<span class="type">int</span>  *h, <span class="type">int</span> *t)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">int</span> i;</span><br><span class="line">	<span class="type">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> data[<span class="number">5</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">	</span><br><span class="line">	__disable_irq();</span><br><span class="line"> </span><br><span class="line">again:</span><br><span class="line">	LPC_GPIO1-&gt;DIR |= <span class="number">1</span> &lt;&lt; <span class="number">5</span>;</span><br><span class="line">	LPC_GPIO1-&gt;DATA |= <span class="number">1</span> &lt;&lt; <span class="number">5</span>;</span><br><span class="line">	Delay10mS();</span><br><span class="line">	<span class="comment">/* 低电平保持18mS */</span></span><br><span class="line">	LPC_GPIO1-&gt;DATA &amp;= ~(<span class="number">1</span> &lt;&lt; <span class="number">5</span>);</span><br><span class="line">	Delay10mS();</span><br><span class="line">	Delay10mS();</span><br><span class="line">	LPC_GPIO1-&gt;DATA |= <span class="number">1</span> &lt;&lt; <span class="number">5</span>;</span><br><span class="line">	</span><br><span class="line">	LPC_GPIO1-&gt;DIR &amp;= ~(<span class="number">1</span> &lt;&lt; <span class="number">5</span>);</span><br><span class="line">	Delay10uS();</span><br><span class="line">	Delay10uS();</span><br><span class="line">	Delay10uS();</span><br><span class="line">	<span class="comment">/* 等待DHT11输出低电平 */</span></span><br><span class="line">	<span class="keyword">if</span> (LPC_GPIO1-&gt;DATA &amp; (<span class="number">1</span> &lt;&lt; <span class="number">5</span>))</span><br><span class="line">		<span class="keyword">goto</span> again;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/* 等待低电平结束，80uS */</span></span><br><span class="line">	<span class="keyword">while</span> (!(LPC_GPIO1-&gt;DATA &amp; (<span class="number">1</span> &lt;&lt; <span class="number">5</span>))) &#123;</span><br><span class="line">		Delay10uS();</span><br><span class="line">		++cnt;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/* 开始输出高电平，80uS */</span></span><br><span class="line">	cnt = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span> (LPC_GPIO1-&gt;DATA &amp; (<span class="number">1</span> &lt;&lt; <span class="number">5</span>)) &#123;</span><br><span class="line">		Delay10uS();</span><br><span class="line">		++cnt;</span><br><span class="line">	&#125;</span><br><span class="line"> </span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">40</span>; i++) &#123;</span><br><span class="line">		<span class="comment">/* 等待低电平结束，50uS */</span></span><br><span class="line">		<span class="keyword">while</span> (!(LPC_GPIO1-&gt;DATA &amp; (<span class="number">1</span> &lt;&lt; <span class="number">5</span>)));</span><br><span class="line">		<span class="comment">/* 对高电平进行计时 */</span></span><br><span class="line">		cnt = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">while</span> (LPC_GPIO1-&gt;DATA &amp; (<span class="number">1</span> &lt;&lt; <span class="number">5</span>)) &#123;</span><br><span class="line">			Delay10uS();</span><br><span class="line">			++cnt;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (cnt &gt; <span class="number">5</span>)</span><br><span class="line">			data[i / <span class="number">8</span>] |= <span class="number">1</span> &lt;&lt; (<span class="number">7</span> - i % <span class="number">8</span>);</span><br><span class="line">		cnt = <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	__enable_irq();</span><br><span class="line">	</span><br><span class="line">	Delay10mS();</span><br><span class="line">	LPC_GPIO1-&gt;DIR |= <span class="number">1</span> &lt;&lt; <span class="number">5</span>;</span><br><span class="line">	LPC_GPIO1-&gt;DATA |= <span class="number">1</span> &lt;&lt; <span class="number">5</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> ((<span class="type">unsigned</span> <span class="type">char</span>)(data[<span class="number">0</span>] + data[<span class="number">1</span>] + data[<span class="number">2</span>] + data[<span class="number">3</span>]) != data[<span class="number">4</span>])</span><br><span class="line">		<span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">	<span class="keyword">else</span> &#123;</span><br><span class="line">		*h = data[<span class="number">0</span>];</span><br><span class="line">		*t = data[<span class="number">2</span>];</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h2 id="OLED显示屏驱动"><a href="#OLED显示屏驱动" class="headerlink" title="OLED显示屏驱动"></a>OLED显示屏驱动</h2><p>ascii.h</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> __ASCII_H__</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __ASCII_H__</span></span><br><span class="line"> </span><br><span class="line"><span class="type">const</span> <span class="type">unsigned</span> <span class="type">char</span> ASCII[<span class="number">241</span>][<span class="number">5</span>]=&#123;        <span class="comment">// Refer to &quot;Times New Roman&quot; Font Database...</span></span><br><span class="line">                                                                <span class="comment">//   Basic Characters</span></span><br><span class="line">    &#123;<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>&#125;,        <span class="comment">//   (  0)    - 0x0020 Space</span></span><br><span class="line">    &#123;<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x4F</span>,<span class="number">0x00</span>,<span class="number">0x00</span>&#125;,        <span class="comment">//   (  1)  ! - 0x0021 Exclamation Mark</span></span><br><span class="line">    &#123;<span class="number">0x00</span>,<span class="number">0x07</span>,<span class="number">0x00</span>,<span class="number">0x07</span>,<span class="number">0x00</span>&#125;,        <span class="comment">//   (  2)  &quot; - 0x0022 Quotation Mark</span></span><br><span class="line">    &#123;<span class="number">0x14</span>,<span class="number">0x7F</span>,<span class="number">0x14</span>,<span class="number">0x7F</span>,<span class="number">0x14</span>&#125;,        <span class="comment">//   (  3)  # - 0x0023 Number Sign</span></span><br><span class="line">    &#123;<span class="number">0x24</span>,<span class="number">0x2A</span>,<span class="number">0x7F</span>,<span class="number">0x2A</span>,<span class="number">0x12</span>&#125;,        <span class="comment">//   (  4)  $ - 0x0024 Dollar Sign</span></span><br><span class="line">    &#123;<span class="number">0x23</span>,<span class="number">0x13</span>,<span class="number">0x08</span>,<span class="number">0x64</span>,<span class="number">0x62</span>&#125;,        <span class="comment">//   (  5)  % - 0x0025 Percent Sign</span></span><br><span class="line">    &#123;<span class="number">0x36</span>,<span class="number">0x49</span>,<span class="number">0x55</span>,<span class="number">0x22</span>,<span class="number">0x50</span>&#125;,        <span class="comment">//   (  6)  &amp; - 0x0026 Ampersand</span></span><br><span class="line">    &#123;<span class="number">0x00</span>,<span class="number">0x05</span>,<span class="number">0x03</span>,<span class="number">0x00</span>,<span class="number">0x00</span>&#125;,        <span class="comment">//   (  7)  &#x27; - 0x0027 Apostrophe</span></span><br><span class="line">    &#123;<span class="number">0x00</span>,<span class="number">0x1C</span>,<span class="number">0x22</span>,<span class="number">0x41</span>,<span class="number">0x00</span>&#125;,        <span class="comment">//   (  8)  ( - 0x0028 Left Parenthesis</span></span><br><span class="line">    &#123;<span class="number">0x00</span>,<span class="number">0x41</span>,<span class="number">0x22</span>,<span class="number">0x1C</span>,<span class="number">0x00</span>&#125;,        <span class="comment">//   (  9)  ) - 0x0029 Right Parenthesis</span></span><br><span class="line">    &#123;<span class="number">0x14</span>,<span class="number">0x08</span>,<span class="number">0x3E</span>,<span class="number">0x08</span>,<span class="number">0x14</span>&#125;,        <span class="comment">//   ( 10)  * - 0x002A Asterisk</span></span><br><span class="line">    &#123;<span class="number">0x08</span>,<span class="number">0x08</span>,<span class="number">0x3E</span>,<span class="number">0x08</span>,<span class="number">0x08</span>&#125;,        <span class="comment">//   ( 11)  + - 0x002B Plus Sign</span></span><br><span class="line">    &#123;<span class="number">0x00</span>,<span class="number">0x50</span>,<span class="number">0x30</span>,<span class="number">0x00</span>,<span class="number">0x00</span>&#125;,        <span class="comment">//   ( 12)  , - 0x002C Comma</span></span><br><span class="line">    &#123;<span class="number">0x08</span>,<span class="number">0x08</span>,<span class="number">0x08</span>,<span class="number">0x08</span>,<span class="number">0x08</span>&#125;,        <span class="comment">//   ( 13)  - - 0x002D Hyphen-Minus</span></span><br><span class="line">    &#123;<span class="number">0x00</span>,<span class="number">0x60</span>,<span class="number">0x60</span>,<span class="number">0x00</span>,<span class="number">0x00</span>&#125;,        <span class="comment">//   ( 14)  . - 0x002E Full Stop</span></span><br><span class="line">    &#123;<span class="number">0x20</span>,<span class="number">0x10</span>,<span class="number">0x08</span>,<span class="number">0x04</span>,<span class="number">0x02</span>&#125;,        <span class="comment">//   ( 15)  / - 0x002F Solidus</span></span><br><span class="line">    &#123;<span class="number">0x3E</span>,<span class="number">0x51</span>,<span class="number">0x49</span>,<span class="number">0x45</span>,<span class="number">0x3E</span>&#125;,        <span class="comment">//   ( 16)  0 - 0x0030 Digit Zero</span></span><br><span class="line">    &#123;<span class="number">0x00</span>,<span class="number">0x42</span>,<span class="number">0x7F</span>,<span class="number">0x40</span>,<span class="number">0x00</span>&#125;,        <span class="comment">//   ( 17)  1 - 0x0031 Digit One</span></span><br><span class="line">    &#123;<span class="number">0x42</span>,<span class="number">0x61</span>,<span class="number">0x51</span>,<span class="number">0x49</span>,<span class="number">0x46</span>&#125;,        <span class="comment">//   ( 18)  2 - 0x0032 Digit Two</span></span><br><span class="line">    &#123;<span class="number">0x21</span>,<span class="number">0x41</span>,<span class="number">0x45</span>,<span class="number">0x4B</span>,<span class="number">0x31</span>&#125;,        <span class="comment">//   ( 19)  3 - 0x0033 Digit Three</span></span><br><span class="line">    &#123;<span class="number">0x18</span>,<span class="number">0x14</span>,<span class="number">0x12</span>,<span class="number">0x7F</span>,<span class="number">0x10</span>&#125;,        <span class="comment">//   ( 20)  4 - 0x0034 Digit Four</span></span><br><span class="line">    &#123;<span class="number">0x27</span>,<span class="number">0x45</span>,<span class="number">0x45</span>,<span class="number">0x45</span>,<span class="number">0x39</span>&#125;,        <span class="comment">//   ( 21)  5 - 0x0035 Digit Five</span></span><br><span class="line">    &#123;<span class="number">0x3C</span>,<span class="number">0x4A</span>,<span class="number">0x49</span>,<span class="number">0x49</span>,<span class="number">0x30</span>&#125;,        <span class="comment">//   ( 22)  6 - 0x0036 Digit Six</span></span><br><span class="line">    &#123;<span class="number">0x01</span>,<span class="number">0x71</span>,<span class="number">0x09</span>,<span class="number">0x05</span>,<span class="number">0x03</span>&#125;,        <span class="comment">//   ( 23)  7 - 0x0037 Digit Seven</span></span><br><span class="line">    &#123;<span class="number">0x36</span>,<span class="number">0x49</span>,<span class="number">0x49</span>,<span class="number">0x49</span>,<span class="number">0x36</span>&#125;,        <span class="comment">//   ( 24)  8 - 0x0038 Digit Eight</span></span><br><span class="line">    &#123;<span class="number">0x06</span>,<span class="number">0x49</span>,<span class="number">0x49</span>,<span class="number">0x29</span>,<span class="number">0x1E</span>&#125;,        <span class="comment">//   ( 25)  9 - 0x0039 Dight Nine</span></span><br><span class="line">    &#123;<span class="number">0x00</span>,<span class="number">0x36</span>,<span class="number">0x36</span>,<span class="number">0x00</span>,<span class="number">0x00</span>&#125;,        <span class="comment">//   ( 26)  : - 0x003A Colon</span></span><br><span class="line">    &#123;<span class="number">0x00</span>,<span class="number">0x56</span>,<span class="number">0x36</span>,<span class="number">0x00</span>,<span class="number">0x00</span>&#125;,        <span class="comment">//   ( 27)  ; - 0x003B Semicolon</span></span><br><span class="line">    &#123;<span class="number">0x08</span>,<span class="number">0x14</span>,<span class="number">0x22</span>,<span class="number">0x41</span>,<span class="number">0x00</span>&#125;,        <span class="comment">//   ( 28)  &lt; - 0x003C Less-Than Sign</span></span><br><span class="line">    &#123;<span class="number">0x14</span>,<span class="number">0x14</span>,<span class="number">0x14</span>,<span class="number">0x14</span>,<span class="number">0x14</span>&#125;,        <span class="comment">//   ( 29)  = - 0x003D Equals Sign</span></span><br><span class="line">    &#123;<span class="number">0x00</span>,<span class="number">0x41</span>,<span class="number">0x22</span>,<span class="number">0x14</span>,<span class="number">0x08</span>&#125;,        <span class="comment">//   ( 30)  &gt; - 0x003E Greater-Than Sign</span></span><br><span class="line">    &#123;<span class="number">0x02</span>,<span class="number">0x01</span>,<span class="number">0x51</span>,<span class="number">0x09</span>,<span class="number">0x06</span>&#125;,        <span class="comment">//   ( 31)  ? - 0x003F Question Mark</span></span><br><span class="line">    &#123;<span class="number">0x32</span>,<span class="number">0x49</span>,<span class="number">0x79</span>,<span class="number">0x41</span>,<span class="number">0x3E</span>&#125;,        <span class="comment">//   ( 32)  @ - 0x0040 Commercial At</span></span><br><span class="line">    &#123;<span class="number">0x7E</span>,<span class="number">0x11</span>,<span class="number">0x11</span>,<span class="number">0x11</span>,<span class="number">0x7E</span>&#125;,        <span class="comment">//   ( 33)  A - 0x0041 Latin Capital Letter A</span></span><br><span class="line">    &#123;<span class="number">0x7F</span>,<span class="number">0x49</span>,<span class="number">0x49</span>,<span class="number">0x49</span>,<span class="number">0x36</span>&#125;,        <span class="comment">//   ( 34)  B - 0x0042 Latin Capital Letter B</span></span><br><span class="line">    &#123;<span class="number">0x3E</span>,<span class="number">0x41</span>,<span class="number">0x41</span>,<span class="number">0x41</span>,<span class="number">0x22</span>&#125;,        <span class="comment">//   ( 35)  C - 0x0043 Latin Capital Letter C</span></span><br><span class="line">    &#123;<span class="number">0x7F</span>,<span class="number">0x41</span>,<span class="number">0x41</span>,<span class="number">0x22</span>,<span class="number">0x1C</span>&#125;,        <span class="comment">//   ( 36)  D - 0x0044 Latin Capital Letter D</span></span><br><span class="line">    &#123;<span class="number">0x7F</span>,<span class="number">0x49</span>,<span class="number">0x49</span>,<span class="number">0x49</span>,<span class="number">0x41</span>&#125;,        <span class="comment">//   ( 37)  E - 0x0045 Latin Capital Letter E</span></span><br><span class="line">    &#123;<span class="number">0x7F</span>,<span class="number">0x09</span>,<span class="number">0x09</span>,<span class="number">0x09</span>,<span class="number">0x01</span>&#125;,        <span class="comment">//   ( 38)  F - 0x0046 Latin Capital Letter F</span></span><br><span class="line">    &#123;<span class="number">0x3E</span>,<span class="number">0x41</span>,<span class="number">0x49</span>,<span class="number">0x49</span>,<span class="number">0x7A</span>&#125;,        <span class="comment">//   ( 39)  G - 0x0047 Latin Capital Letter G</span></span><br><span class="line">    &#123;<span class="number">0x7F</span>,<span class="number">0x08</span>,<span class="number">0x08</span>,<span class="number">0x08</span>,<span class="number">0x7F</span>&#125;,        <span class="comment">//   ( 40)  H - 0x0048 Latin Capital Letter H</span></span><br><span class="line">    &#123;<span class="number">0x00</span>,<span class="number">0x41</span>,<span class="number">0x7F</span>,<span class="number">0x41</span>,<span class="number">0x00</span>&#125;,        <span class="comment">//   ( 41)  I - 0x0049 Latin Capital Letter I</span></span><br><span class="line">    &#123;<span class="number">0x20</span>,<span class="number">0x40</span>,<span class="number">0x41</span>,<span class="number">0x3F</span>,<span class="number">0x01</span>&#125;,        <span class="comment">//   ( 42)  J - 0x004A Latin Capital Letter J</span></span><br><span class="line">    &#123;<span class="number">0x7F</span>,<span class="number">0x08</span>,<span class="number">0x14</span>,<span class="number">0x22</span>,<span class="number">0x41</span>&#125;,        <span class="comment">//   ( 43)  K - 0x004B Latin Capital Letter K</span></span><br><span class="line">    &#123;<span class="number">0x7F</span>,<span class="number">0x40</span>,<span class="number">0x40</span>,<span class="number">0x40</span>,<span class="number">0x40</span>&#125;,        <span class="comment">//   ( 44)  L - 0x004C Latin Capital Letter L</span></span><br><span class="line">    &#123;<span class="number">0x7F</span>,<span class="number">0x02</span>,<span class="number">0x0C</span>,<span class="number">0x02</span>,<span class="number">0x7F</span>&#125;,        <span class="comment">//   ( 45)  M - 0x004D Latin Capital Letter M</span></span><br><span class="line">    &#123;<span class="number">0x7F</span>,<span class="number">0x04</span>,<span class="number">0x08</span>,<span class="number">0x10</span>,<span class="number">0x7F</span>&#125;,        <span class="comment">//   ( 46)  N - 0x004E Latin Capital Letter N</span></span><br><span class="line">    &#123;<span class="number">0x3E</span>,<span class="number">0x41</span>,<span class="number">0x41</span>,<span class="number">0x41</span>,<span class="number">0x3E</span>&#125;,        <span class="comment">//   ( 47)  O - 0x004F Latin Capital Letter O</span></span><br><span class="line">    &#123;<span class="number">0x7F</span>,<span class="number">0x09</span>,<span class="number">0x09</span>,<span class="number">0x09</span>,<span class="number">0x06</span>&#125;,        <span class="comment">//   ( 48)  P - 0x0050 Latin Capital Letter P</span></span><br><span class="line">    &#123;<span class="number">0x3E</span>,<span class="number">0x41</span>,<span class="number">0x51</span>,<span class="number">0x21</span>,<span class="number">0x5E</span>&#125;,        <span class="comment">//   ( 49)  Q - 0x0051 Latin Capital Letter Q</span></span><br><span class="line">    &#123;<span class="number">0x7F</span>,<span class="number">0x09</span>,<span class="number">0x19</span>,<span class="number">0x29</span>,<span class="number">0x46</span>&#125;,        <span class="comment">//   ( 50)  R - 0x0052 Latin Capital Letter R</span></span><br><span class="line">    &#123;<span class="number">0x46</span>,<span class="number">0x49</span>,<span class="number">0x49</span>,<span class="number">0x49</span>,<span class="number">0x31</span>&#125;,        <span class="comment">//   ( 51)  S - 0x0053 Latin Capital Letter S</span></span><br><span class="line">    &#123;<span class="number">0x01</span>,<span class="number">0x01</span>,<span class="number">0x7F</span>,<span class="number">0x01</span>,<span class="number">0x01</span>&#125;,        <span class="comment">//   ( 52)  T - 0x0054 Latin Capital Letter T</span></span><br><span class="line">    &#123;<span class="number">0x3F</span>,<span class="number">0x40</span>,<span class="number">0x40</span>,<span class="number">0x40</span>,<span class="number">0x3F</span>&#125;,        <span class="comment">//   ( 53)  U - 0x0055 Latin Capital Letter U</span></span><br><span class="line">    &#123;<span class="number">0x1F</span>,<span class="number">0x20</span>,<span class="number">0x40</span>,<span class="number">0x20</span>,<span class="number">0x1F</span>&#125;,        <span class="comment">//   ( 54)  V - 0x0056 Latin Capital Letter V</span></span><br><span class="line">    &#123;<span class="number">0x3F</span>,<span class="number">0x40</span>,<span class="number">0x38</span>,<span class="number">0x40</span>,<span class="number">0x3F</span>&#125;,        <span class="comment">//   ( 55)  W - 0x0057 Latin Capital Letter W</span></span><br><span class="line">    &#123;<span class="number">0x63</span>,<span class="number">0x14</span>,<span class="number">0x08</span>,<span class="number">0x14</span>,<span class="number">0x63</span>&#125;,        <span class="comment">//   ( 56)  X - 0x0058 Latin Capital Letter X</span></span><br><span class="line">    &#123;<span class="number">0x07</span>,<span class="number">0x08</span>,<span class="number">0x70</span>,<span class="number">0x08</span>,<span class="number">0x07</span>&#125;,        <span class="comment">//   ( 57)  Y - 0x0059 Latin Capital Letter Y</span></span><br><span class="line">    &#123;<span class="number">0x61</span>,<span class="number">0x51</span>,<span class="number">0x49</span>,<span class="number">0x45</span>,<span class="number">0x43</span>&#125;,        <span class="comment">//   ( 58)  Z - 0x005A Latin Capital Letter Z</span></span><br><span class="line">    &#123;<span class="number">0x00</span>,<span class="number">0x7F</span>,<span class="number">0x41</span>,<span class="number">0x41</span>,<span class="number">0x00</span>&#125;,        <span class="comment">//   ( 59)  [ - 0x005B Left Square Bracket</span></span><br><span class="line">    &#123;<span class="number">0x02</span>,<span class="number">0x04</span>,<span class="number">0x08</span>,<span class="number">0x10</span>,<span class="number">0x20</span>&#125;,        <span class="comment">//   ( 60)  \ - 0x005C Reverse Solidus</span></span><br><span class="line">    &#123;<span class="number">0x00</span>,<span class="number">0x41</span>,<span class="number">0x41</span>,<span class="number">0x7F</span>,<span class="number">0x00</span>&#125;,        <span class="comment">//   ( 61)  ] - 0x005D Right Square Bracket</span></span><br><span class="line">    &#123;<span class="number">0x04</span>,<span class="number">0x02</span>,<span class="number">0x01</span>,<span class="number">0x02</span>,<span class="number">0x04</span>&#125;,        <span class="comment">//   ( 62)  ^ - 0x005E Circumflex Accent</span></span><br><span class="line">    &#123;<span class="number">0x40</span>,<span class="number">0x40</span>,<span class="number">0x40</span>,<span class="number">0x40</span>,<span class="number">0x40</span>&#125;,        <span class="comment">//   ( 63)  _ - 0x005F Low Line</span></span><br><span class="line">    &#123;<span class="number">0x01</span>,<span class="number">0x02</span>,<span class="number">0x04</span>,<span class="number">0x00</span>,<span class="number">0x00</span>&#125;,        <span class="comment">//   ( 64)  ` - 0x0060 Grave Accent</span></span><br><span class="line">    &#123;<span class="number">0x20</span>,<span class="number">0x54</span>,<span class="number">0x54</span>,<span class="number">0x54</span>,<span class="number">0x78</span>&#125;,        <span class="comment">//   ( 65)  a - 0x0061 Latin Small Letter A</span></span><br><span class="line">    &#123;<span class="number">0x7F</span>,<span class="number">0x48</span>,<span class="number">0x44</span>,<span class="number">0x44</span>,<span class="number">0x38</span>&#125;,        <span class="comment">//   ( 66)  b - 0x0062 Latin Small Letter B</span></span><br><span class="line">    &#123;<span class="number">0x38</span>,<span class="number">0x44</span>,<span class="number">0x44</span>,<span class="number">0x44</span>,<span class="number">0x20</span>&#125;,        <span class="comment">//   ( 67)  c - 0x0063 Latin Small Letter C</span></span><br><span class="line">    &#123;<span class="number">0x38</span>,<span class="number">0x44</span>,<span class="number">0x44</span>,<span class="number">0x48</span>,<span class="number">0x7F</span>&#125;,        <span class="comment">//   ( 68)  d - 0x0064 Latin Small Letter D</span></span><br><span class="line">    &#123;<span class="number">0x38</span>,<span class="number">0x54</span>,<span class="number">0x54</span>,<span class="number">0x54</span>,<span class="number">0x18</span>&#125;,        <span class="comment">//   ( 69)  e - 0x0065 Latin Small Letter E</span></span><br><span class="line">    &#123;<span class="number">0x08</span>,<span class="number">0x7E</span>,<span class="number">0x09</span>,<span class="number">0x01</span>,<span class="number">0x02</span>&#125;,        <span class="comment">//   ( 70)  f - 0x0066 Latin Small Letter F</span></span><br><span class="line">    &#123;<span class="number">0x06</span>,<span class="number">0x49</span>,<span class="number">0x49</span>,<span class="number">0x49</span>,<span class="number">0x3F</span>&#125;,        <span class="comment">//   ( 71)  g - 0x0067 Latin Small Letter G</span></span><br><span class="line">    &#123;<span class="number">0x7F</span>,<span class="number">0x08</span>,<span class="number">0x04</span>,<span class="number">0x04</span>,<span class="number">0x78</span>&#125;,        <span class="comment">//   ( 72)  h - 0x0068 Latin Small Letter H</span></span><br><span class="line">    &#123;<span class="number">0x00</span>,<span class="number">0x44</span>,<span class="number">0x7D</span>,<span class="number">0x40</span>,<span class="number">0x00</span>&#125;,        <span class="comment">//   ( 73)  i - 0x0069 Latin Small Letter I</span></span><br><span class="line">    &#123;<span class="number">0x20</span>,<span class="number">0x40</span>,<span class="number">0x44</span>,<span class="number">0x3D</span>,<span class="number">0x00</span>&#125;,        <span class="comment">//   ( 74)  j - 0x006A Latin Small Letter J</span></span><br><span class="line">    &#123;<span class="number">0x7F</span>,<span class="number">0x10</span>,<span class="number">0x28</span>,<span class="number">0x44</span>,<span class="number">0x00</span>&#125;,        <span class="comment">//   ( 75)  k - 0x006B Latin Small Letter K</span></span><br><span class="line">    &#123;<span class="number">0x00</span>,<span class="number">0x41</span>,<span class="number">0x7F</span>,<span class="number">0x40</span>,<span class="number">0x00</span>&#125;,        <span class="comment">//   ( 76)  l - 0x006C Latin Small Letter L</span></span><br><span class="line">    &#123;<span class="number">0x7C</span>,<span class="number">0x04</span>,<span class="number">0x18</span>,<span class="number">0x04</span>,<span class="number">0x7C</span>&#125;,        <span class="comment">//   ( 77)  m - 0x006D Latin Small Letter M</span></span><br><span class="line">    &#123;<span class="number">0x7C</span>,<span class="number">0x08</span>,<span class="number">0x04</span>,<span class="number">0x04</span>,<span class="number">0x78</span>&#125;,        <span class="comment">//   ( 78)  n - 0x006E Latin Small Letter N</span></span><br><span class="line">    &#123;<span class="number">0x38</span>,<span class="number">0x44</span>,<span class="number">0x44</span>,<span class="number">0x44</span>,<span class="number">0x38</span>&#125;,        <span class="comment">//   ( 79)  o - 0x006F Latin Small Letter O</span></span><br><span class="line">    &#123;<span class="number">0x7C</span>,<span class="number">0x14</span>,<span class="number">0x14</span>,<span class="number">0x14</span>,<span class="number">0x08</span>&#125;,        <span class="comment">//   ( 80)  p - 0x0070 Latin Small Letter P</span></span><br><span class="line">    &#123;<span class="number">0x08</span>,<span class="number">0x14</span>,<span class="number">0x14</span>,<span class="number">0x18</span>,<span class="number">0x7C</span>&#125;,        <span class="comment">//   ( 81)  q - 0x0071 Latin Small Letter Q</span></span><br><span class="line">    &#123;<span class="number">0x7C</span>,<span class="number">0x08</span>,<span class="number">0x04</span>,<span class="number">0x04</span>,<span class="number">0x08</span>&#125;,        <span class="comment">//   ( 82)  r - 0x0072 Latin Small Letter R</span></span><br><span class="line">    &#123;<span class="number">0x48</span>,<span class="number">0x54</span>,<span class="number">0x54</span>,<span class="number">0x54</span>,<span class="number">0x20</span>&#125;,        <span class="comment">//   ( 83)  s - 0x0073 Latin Small Letter S</span></span><br><span class="line">    &#123;<span class="number">0x04</span>,<span class="number">0x3F</span>,<span class="number">0x44</span>,<span class="number">0x40</span>,<span class="number">0x20</span>&#125;,        <span class="comment">//   ( 84)  t - 0x0074 Latin Small Letter T</span></span><br><span class="line">    &#123;<span class="number">0x3C</span>,<span class="number">0x40</span>,<span class="number">0x40</span>,<span class="number">0x20</span>,<span class="number">0x7C</span>&#125;,        <span class="comment">//   ( 85)  u - 0x0075 Latin Small Letter U</span></span><br><span class="line">    &#123;<span class="number">0x1C</span>,<span class="number">0x20</span>,<span class="number">0x40</span>,<span class="number">0x20</span>,<span class="number">0x1C</span>&#125;,        <span class="comment">//   ( 86)  v - 0x0076 Latin Small Letter V</span></span><br><span class="line">    &#123;<span class="number">0x3C</span>,<span class="number">0x40</span>,<span class="number">0x30</span>,<span class="number">0x40</span>,<span class="number">0x3C</span>&#125;,        <span class="comment">//   ( 87)  w - 0x0077 Latin Small Letter W</span></span><br><span class="line">    &#123;<span class="number">0x44</span>,<span class="number">0x28</span>,<span class="number">0x10</span>,<span class="number">0x28</span>,<span class="number">0x44</span>&#125;,        <span class="comment">//   ( 88)  x - 0x0078 Latin Small Letter X</span></span><br><span class="line">    &#123;<span class="number">0x0C</span>,<span class="number">0x50</span>,<span class="number">0x50</span>,<span class="number">0x50</span>,<span class="number">0x3C</span>&#125;,        <span class="comment">//   ( 89)  y - 0x0079 Latin Small Letter Y</span></span><br><span class="line">    &#123;<span class="number">0x44</span>,<span class="number">0x64</span>,<span class="number">0x54</span>,<span class="number">0x4C</span>,<span class="number">0x44</span>&#125;,        <span class="comment">//   ( 90)  z - 0x007A Latin Small Letter Z</span></span><br><span class="line">    &#123;<span class="number">0x00</span>,<span class="number">0x08</span>,<span class="number">0x36</span>,<span class="number">0x41</span>,<span class="number">0x00</span>&#125;,        <span class="comment">//   ( 91)  &#123; - 0x007B Left Curly Bracket</span></span><br><span class="line">    &#123;<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x7F</span>,<span class="number">0x00</span>,<span class="number">0x00</span>&#125;,        <span class="comment">//   ( 92)  | - 0x007C Vertical Line</span></span><br><span class="line">    &#123;<span class="number">0x00</span>,<span class="number">0x41</span>,<span class="number">0x36</span>,<span class="number">0x08</span>,<span class="number">0x00</span>&#125;,        <span class="comment">//   ( 93)  &#125; - 0x007D Right Curly Bracket</span></span><br><span class="line">    &#123;<span class="number">0x02</span>,<span class="number">0x01</span>,<span class="number">0x02</span>,<span class="number">0x04</span>,<span class="number">0x02</span>&#125;,        <span class="comment">//   ( 94)  ~ - 0x007E Tilde</span></span><br><span class="line">    &#123;<span class="number">0x3E</span>,<span class="number">0x55</span>,<span class="number">0x55</span>,<span class="number">0x41</span>,<span class="number">0x22</span>&#125;,        <span class="comment">//   ( 95)  C - 0x0080 &lt;Control&gt;</span></span><br><span class="line">    &#123;<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>&#125;,        <span class="comment">//   ( 96)    - 0x00A0 No-Break Space</span></span><br><span class="line">    &#123;<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x79</span>,<span class="number">0x00</span>,<span class="number">0x00</span>&#125;,        <span class="comment">//   ( 97)  ! - 0x00A1 Inverted Exclamation Mark</span></span><br><span class="line">    &#123;<span class="number">0x18</span>,<span class="number">0x24</span>,<span class="number">0x74</span>,<span class="number">0x2E</span>,<span class="number">0x24</span>&#125;,        <span class="comment">//   ( 98)  c - 0x00A2 Cent Sign</span></span><br><span class="line">    &#123;<span class="number">0x48</span>,<span class="number">0x7E</span>,<span class="number">0x49</span>,<span class="number">0x42</span>,<span class="number">0x40</span>&#125;,        <span class="comment">//   ( 99)  L - 0x00A3 Pound Sign</span></span><br><span class="line">    &#123;<span class="number">0x5D</span>,<span class="number">0x22</span>,<span class="number">0x22</span>,<span class="number">0x22</span>,<span class="number">0x5D</span>&#125;,        <span class="comment">//   (100)  o - 0x00A4 Currency Sign</span></span><br><span class="line">    &#123;<span class="number">0x15</span>,<span class="number">0x16</span>,<span class="number">0x7C</span>,<span class="number">0x16</span>,<span class="number">0x15</span>&#125;,        <span class="comment">//   (101)  Y - 0x00A5 Yen Sign</span></span><br><span class="line">    &#123;<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x77</span>,<span class="number">0x00</span>,<span class="number">0x00</span>&#125;,        <span class="comment">//   (102)  | - 0x00A6 Broken Bar</span></span><br><span class="line">    &#123;<span class="number">0x0A</span>,<span class="number">0x55</span>,<span class="number">0x55</span>,<span class="number">0x55</span>,<span class="number">0x28</span>&#125;,        <span class="comment">//   (103)    - 0x00A7 Section Sign</span></span><br><span class="line">    &#123;<span class="number">0x00</span>,<span class="number">0x01</span>,<span class="number">0x00</span>,<span class="number">0x01</span>,<span class="number">0x00</span>&#125;,        <span class="comment">//   (104)  &quot; - 0x00A8 Diaeresis</span></span><br><span class="line">    &#123;<span class="number">0x00</span>,<span class="number">0x0A</span>,<span class="number">0x0D</span>,<span class="number">0x0A</span>,<span class="number">0x04</span>&#125;,        <span class="comment">//   (105)    - 0x00AA Feminine Ordinal Indicator</span></span><br><span class="line">    &#123;<span class="number">0x08</span>,<span class="number">0x14</span>,<span class="number">0x2A</span>,<span class="number">0x14</span>,<span class="number">0x22</span>&#125;,        <span class="comment">//   (106) &lt;&lt; - 0x00AB Left-Pointing Double Angle Quotation Mark</span></span><br><span class="line">    &#123;<span class="number">0x04</span>,<span class="number">0x04</span>,<span class="number">0x04</span>,<span class="number">0x04</span>,<span class="number">0x1C</span>&#125;,        <span class="comment">//   (107)    - 0x00AC Not Sign</span></span><br><span class="line">    &#123;<span class="number">0x00</span>,<span class="number">0x08</span>,<span class="number">0x08</span>,<span class="number">0x08</span>,<span class="number">0x00</span>&#125;,        <span class="comment">//   (108)  - - 0x00AD Soft Hyphen</span></span><br><span class="line">    &#123;<span class="number">0x01</span>,<span class="number">0x01</span>,<span class="number">0x01</span>,<span class="number">0x01</span>,<span class="number">0x01</span>&#125;,        <span class="comment">//   (109)    - 0x00AF Macron</span></span><br><span class="line">    &#123;<span class="number">0x00</span>,<span class="number">0x02</span>,<span class="number">0x05</span>,<span class="number">0x02</span>,<span class="number">0x00</span>&#125;,        <span class="comment">//   (110)    - 0x00B0 Degree Sign</span></span><br><span class="line">    &#123;<span class="number">0x44</span>,<span class="number">0x44</span>,<span class="number">0x5F</span>,<span class="number">0x44</span>,<span class="number">0x44</span>&#125;,        <span class="comment">//   (111) +- - 0x00B1 Plus-Minus Sign</span></span><br><span class="line">    &#123;<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x04</span>,<span class="number">0x02</span>,<span class="number">0x01</span>&#125;,        <span class="comment">//   (112)  ` - 0x00B4 Acute Accent</span></span><br><span class="line">    &#123;<span class="number">0x7E</span>,<span class="number">0x20</span>,<span class="number">0x20</span>,<span class="number">0x10</span>,<span class="number">0x3E</span>&#125;,        <span class="comment">//   (113)  u - 0x00B5 Micro Sign</span></span><br><span class="line">    &#123;<span class="number">0x06</span>,<span class="number">0x0F</span>,<span class="number">0x7F</span>,<span class="number">0x00</span>,<span class="number">0x7F</span>&#125;,        <span class="comment">//   (114)    - 0x00B6 Pilcrow Sign</span></span><br><span class="line">    &#123;<span class="number">0x00</span>,<span class="number">0x18</span>,<span class="number">0x18</span>,<span class="number">0x00</span>,<span class="number">0x00</span>&#125;,        <span class="comment">//   (115)  . - 0x00B7 Middle Dot</span></span><br><span class="line">    &#123;<span class="number">0x00</span>,<span class="number">0x40</span>,<span class="number">0x50</span>,<span class="number">0x20</span>,<span class="number">0x00</span>&#125;,        <span class="comment">//   (116)    - 0x00B8 Cedilla</span></span><br><span class="line">    &#123;<span class="number">0x00</span>,<span class="number">0x0A</span>,<span class="number">0x0D</span>,<span class="number">0x0A</span>,<span class="number">0x00</span>&#125;,        <span class="comment">//   (117)    - 0x00BA Masculine Ordinal Indicator</span></span><br><span class="line">    &#123;<span class="number">0x22</span>,<span class="number">0x14</span>,<span class="number">0x2A</span>,<span class="number">0x14</span>,<span class="number">0x08</span>&#125;,        <span class="comment">//   (118) &gt;&gt; - 0x00BB Right-Pointing Double Angle Quotation Mark</span></span><br><span class="line">    &#123;<span class="number">0x17</span>,<span class="number">0x08</span>,<span class="number">0x34</span>,<span class="number">0x2A</span>,<span class="number">0x7D</span>&#125;,        <span class="comment">//   (119) /4 - 0x00BC Vulgar Fraction One Quarter</span></span><br><span class="line">    &#123;<span class="number">0x17</span>,<span class="number">0x08</span>,<span class="number">0x04</span>,<span class="number">0x6A</span>,<span class="number">0x59</span>&#125;,        <span class="comment">//   (120) /2 - 0x00BD Vulgar Fraction One Half</span></span><br><span class="line">    &#123;<span class="number">0x30</span>,<span class="number">0x48</span>,<span class="number">0x45</span>,<span class="number">0x40</span>,<span class="number">0x20</span>&#125;,        <span class="comment">//   (121)  ? - 0x00BF Inverted Question Mark</span></span><br><span class="line">    &#123;<span class="number">0x70</span>,<span class="number">0x29</span>,<span class="number">0x26</span>,<span class="number">0x28</span>,<span class="number">0x70</span>&#125;,        <span class="comment">//   (122) `A - 0x00C0 Latin Capital Letter A with Grave</span></span><br><span class="line">    &#123;<span class="number">0x70</span>,<span class="number">0x28</span>,<span class="number">0x26</span>,<span class="number">0x29</span>,<span class="number">0x70</span>&#125;,        <span class="comment">//   (123) &#x27;A - 0x00C1 Latin Capital Letter A with Acute</span></span><br><span class="line">    &#123;<span class="number">0x70</span>,<span class="number">0x2A</span>,<span class="number">0x25</span>,<span class="number">0x2A</span>,<span class="number">0x70</span>&#125;,        <span class="comment">//   (124) ^A - 0x00C2 Latin Capital Letter A with Circumflex</span></span><br><span class="line">    &#123;<span class="number">0x72</span>,<span class="number">0x29</span>,<span class="number">0x26</span>,<span class="number">0x29</span>,<span class="number">0x70</span>&#125;,        <span class="comment">//   (125) ~A - 0x00C3 Latin Capital Letter A with Tilde</span></span><br><span class="line">    &#123;<span class="number">0x70</span>,<span class="number">0x29</span>,<span class="number">0x24</span>,<span class="number">0x29</span>,<span class="number">0x70</span>&#125;,        <span class="comment">//   (126) &quot;A - 0x00C4 Latin Capital Letter A with Diaeresis</span></span><br><span class="line">    &#123;<span class="number">0x70</span>,<span class="number">0x2A</span>,<span class="number">0x2D</span>,<span class="number">0x2A</span>,<span class="number">0x70</span>&#125;,        <span class="comment">//   (127)  A - 0x00C5 Latin Capital Letter A with Ring Above</span></span><br><span class="line">    &#123;<span class="number">0x7E</span>,<span class="number">0x11</span>,<span class="number">0x7F</span>,<span class="number">0x49</span>,<span class="number">0x49</span>&#125;,        <span class="comment">//   (128) AE - 0x00C6 Latin Capital Letter Ae</span></span><br><span class="line">    &#123;<span class="number">0x0E</span>,<span class="number">0x51</span>,<span class="number">0x51</span>,<span class="number">0x71</span>,<span class="number">0x11</span>&#125;,        <span class="comment">//   (129)  C - 0x00C7 Latin Capital Letter C with Cedilla</span></span><br><span class="line">    &#123;<span class="number">0x7C</span>,<span class="number">0x55</span>,<span class="number">0x56</span>,<span class="number">0x54</span>,<span class="number">0x44</span>&#125;,        <span class="comment">//   (130) `E - 0x00C8 Latin Capital Letter E with Grave</span></span><br><span class="line">    &#123;<span class="number">0x7C</span>,<span class="number">0x55</span>,<span class="number">0x56</span>,<span class="number">0x54</span>,<span class="number">0x44</span>&#125;,        <span class="comment">//   (131) &#x27;E - 0x00C9 Latin Capital Letter E with Acute</span></span><br><span class="line">    &#123;<span class="number">0x7C</span>,<span class="number">0x56</span>,<span class="number">0x55</span>,<span class="number">0x56</span>,<span class="number">0x44</span>&#125;,        <span class="comment">//   (132) ^E - 0x00CA Latin Capital Letter E with Circumflex</span></span><br><span class="line">    &#123;<span class="number">0x7C</span>,<span class="number">0x55</span>,<span class="number">0x54</span>,<span class="number">0x55</span>,<span class="number">0x44</span>&#125;,        <span class="comment">//   (133) &quot;E - 0x00CB Latin Capital Letter E with Diaeresis</span></span><br><span class="line">    &#123;<span class="number">0x00</span>,<span class="number">0x45</span>,<span class="number">0x7E</span>,<span class="number">0x44</span>,<span class="number">0x00</span>&#125;,        <span class="comment">//   (134) `I - 0x00CC Latin Capital Letter I with Grave</span></span><br><span class="line">    &#123;<span class="number">0x00</span>,<span class="number">0x44</span>,<span class="number">0x7E</span>,<span class="number">0x45</span>,<span class="number">0x00</span>&#125;,        <span class="comment">//   (135) &#x27;I - 0x00CD Latin Capital Letter I with Acute</span></span><br><span class="line">    &#123;<span class="number">0x00</span>,<span class="number">0x46</span>,<span class="number">0x7D</span>,<span class="number">0x46</span>,<span class="number">0x00</span>&#125;,        <span class="comment">//   (136) ^I - 0x00CE Latin Capital Letter I with Circumflex</span></span><br><span class="line">    &#123;<span class="number">0x00</span>,<span class="number">0x45</span>,<span class="number">0x7C</span>,<span class="number">0x45</span>,<span class="number">0x00</span>&#125;,        <span class="comment">//   (137) &quot;I - 0x00CF Latin Capital Letter I with Diaeresis</span></span><br><span class="line">    &#123;<span class="number">0x7F</span>,<span class="number">0x49</span>,<span class="number">0x49</span>,<span class="number">0x41</span>,<span class="number">0x3E</span>&#125;,        <span class="comment">//   (138)  D - 0x00D0 Latin Capital Letter Eth</span></span><br><span class="line">    &#123;<span class="number">0x7C</span>,<span class="number">0x0A</span>,<span class="number">0x11</span>,<span class="number">0x22</span>,<span class="number">0x7D</span>&#125;,        <span class="comment">//   (139) ~N - 0x00D1 Latin Capital Letter N with Tilde</span></span><br><span class="line">    &#123;<span class="number">0x38</span>,<span class="number">0x45</span>,<span class="number">0x46</span>,<span class="number">0x44</span>,<span class="number">0x38</span>&#125;,        <span class="comment">//   (140) `O - 0x00D2 Latin Capital Letter O with Grave</span></span><br><span class="line">    &#123;<span class="number">0x38</span>,<span class="number">0x44</span>,<span class="number">0x46</span>,<span class="number">0x45</span>,<span class="number">0x38</span>&#125;,        <span class="comment">//   (141) &#x27;O - 0x00D3 Latin Capital Letter O with Acute</span></span><br><span class="line">    &#123;<span class="number">0x38</span>,<span class="number">0x46</span>,<span class="number">0x45</span>,<span class="number">0x46</span>,<span class="number">0x38</span>&#125;,        <span class="comment">//   (142) ^O - 0x00D4 Latin Capital Letter O with Circumflex</span></span><br><span class="line">    &#123;<span class="number">0x38</span>,<span class="number">0x46</span>,<span class="number">0x45</span>,<span class="number">0x46</span>,<span class="number">0x39</span>&#125;,        <span class="comment">//   (143) ~O - 0x00D5 Latin Capital Letter O with Tilde</span></span><br><span class="line">    &#123;<span class="number">0x38</span>,<span class="number">0x45</span>,<span class="number">0x44</span>,<span class="number">0x45</span>,<span class="number">0x38</span>&#125;,        <span class="comment">//   (144) &quot;O - 0x00D6 Latin Capital Letter O with Diaeresis</span></span><br><span class="line">    &#123;<span class="number">0x22</span>,<span class="number">0x14</span>,<span class="number">0x08</span>,<span class="number">0x14</span>,<span class="number">0x22</span>&#125;,        <span class="comment">//   (145)  x - 0x00D7 Multiplcation Sign</span></span><br><span class="line">    &#123;<span class="number">0x2E</span>,<span class="number">0x51</span>,<span class="number">0x49</span>,<span class="number">0x45</span>,<span class="number">0x3A</span>&#125;,        <span class="comment">//   (146)  O - 0x00D8 Latin Capital Letter O with Stroke</span></span><br><span class="line">    &#123;<span class="number">0x3C</span>,<span class="number">0x41</span>,<span class="number">0x42</span>,<span class="number">0x40</span>,<span class="number">0x3C</span>&#125;,        <span class="comment">//   (147) `U - 0x00D9 Latin Capital Letter U with Grave</span></span><br><span class="line">    &#123;<span class="number">0x3C</span>,<span class="number">0x40</span>,<span class="number">0x42</span>,<span class="number">0x41</span>,<span class="number">0x3C</span>&#125;,        <span class="comment">//   (148) &#x27;U - 0x00DA Latin Capital Letter U with Acute</span></span><br><span class="line">    &#123;<span class="number">0x3C</span>,<span class="number">0x42</span>,<span class="number">0x41</span>,<span class="number">0x42</span>,<span class="number">0x3C</span>&#125;,        <span class="comment">//   (149) ^U - 0x00DB Latin Capital Letter U with Circumflex</span></span><br><span class="line">    &#123;<span class="number">0x3C</span>,<span class="number">0x41</span>,<span class="number">0x40</span>,<span class="number">0x41</span>,<span class="number">0x3C</span>&#125;,        <span class="comment">//   (150) &quot;U - 0x00DC Latin Capital Letter U with Diaeresis</span></span><br><span class="line">    &#123;<span class="number">0x0C</span>,<span class="number">0x10</span>,<span class="number">0x62</span>,<span class="number">0x11</span>,<span class="number">0x0C</span>&#125;,        <span class="comment">//   (151) `Y - 0x00DD Latin Capital Letter Y with Acute</span></span><br><span class="line">    &#123;<span class="number">0x7F</span>,<span class="number">0x12</span>,<span class="number">0x12</span>,<span class="number">0x12</span>,<span class="number">0x0C</span>&#125;,        <span class="comment">//   (152)  P - 0x00DE Latin Capital Letter Thom</span></span><br><span class="line">    &#123;<span class="number">0x40</span>,<span class="number">0x3E</span>,<span class="number">0x01</span>,<span class="number">0x49</span>,<span class="number">0x36</span>&#125;,        <span class="comment">//   (153)  B - 0x00DF Latin Capital Letter Sharp S</span></span><br><span class="line">    &#123;<span class="number">0x20</span>,<span class="number">0x55</span>,<span class="number">0x56</span>,<span class="number">0x54</span>,<span class="number">0x78</span>&#125;,        <span class="comment">//   (154) `a - 0x00E0 Latin Small Letter A with Grave</span></span><br><span class="line">    &#123;<span class="number">0x20</span>,<span class="number">0x54</span>,<span class="number">0x56</span>,<span class="number">0x55</span>,<span class="number">0x78</span>&#125;,        <span class="comment">//   (155) &#x27;a - 0x00E1 Latin Small Letter A with Acute</span></span><br><span class="line">    &#123;<span class="number">0x20</span>,<span class="number">0x56</span>,<span class="number">0x55</span>,<span class="number">0x56</span>,<span class="number">0x78</span>&#125;,        <span class="comment">//   (156) ^a - 0x00E2 Latin Small Letter A with Circumflex</span></span><br><span class="line">    &#123;<span class="number">0x20</span>,<span class="number">0x55</span>,<span class="number">0x56</span>,<span class="number">0x55</span>,<span class="number">0x78</span>&#125;,        <span class="comment">//   (157) ~a - 0x00E3 Latin Small Letter A with Tilde</span></span><br><span class="line">    &#123;<span class="number">0x20</span>,<span class="number">0x55</span>,<span class="number">0x54</span>,<span class="number">0x55</span>,<span class="number">0x78</span>&#125;,        <span class="comment">//   (158) &quot;a - 0x00E4 Latin Small Letter A with Diaeresis</span></span><br><span class="line">    &#123;<span class="number">0x20</span>,<span class="number">0x56</span>,<span class="number">0x57</span>,<span class="number">0x56</span>,<span class="number">0x78</span>&#125;,        <span class="comment">//   (159)  a - 0x00E5 Latin Small Letter A with Ring Above</span></span><br><span class="line">    &#123;<span class="number">0x24</span>,<span class="number">0x54</span>,<span class="number">0x78</span>,<span class="number">0x54</span>,<span class="number">0x58</span>&#125;,        <span class="comment">//   (160) ae - 0x00E6 Latin Small Letter Ae</span></span><br><span class="line">    &#123;<span class="number">0x0C</span>,<span class="number">0x52</span>,<span class="number">0x52</span>,<span class="number">0x72</span>,<span class="number">0x13</span>&#125;,        <span class="comment">//   (161)  c - 0x00E7 Latin Small Letter c with Cedilla</span></span><br><span class="line">    &#123;<span class="number">0x38</span>,<span class="number">0x55</span>,<span class="number">0x56</span>,<span class="number">0x54</span>,<span class="number">0x18</span>&#125;,        <span class="comment">//   (162) `e - 0x00E8 Latin Small Letter E with Grave</span></span><br><span class="line">    &#123;<span class="number">0x38</span>,<span class="number">0x54</span>,<span class="number">0x56</span>,<span class="number">0x55</span>,<span class="number">0x18</span>&#125;,        <span class="comment">//   (163) &#x27;e - 0x00E9 Latin Small Letter E with Acute</span></span><br><span class="line">    &#123;<span class="number">0x38</span>,<span class="number">0x56</span>,<span class="number">0x55</span>,<span class="number">0x56</span>,<span class="number">0x18</span>&#125;,        <span class="comment">//   (164) ^e - 0x00EA Latin Small Letter E with Circumflex</span></span><br><span class="line">    &#123;<span class="number">0x38</span>,<span class="number">0x55</span>,<span class="number">0x54</span>,<span class="number">0x55</span>,<span class="number">0x18</span>&#125;,        <span class="comment">//   (165) &quot;e - 0x00EB Latin Small Letter E with Diaeresis</span></span><br><span class="line">    &#123;<span class="number">0x00</span>,<span class="number">0x49</span>,<span class="number">0x7A</span>,<span class="number">0x40</span>,<span class="number">0x00</span>&#125;,        <span class="comment">//   (166) `i - 0x00EC Latin Small Letter I with Grave</span></span><br><span class="line">    &#123;<span class="number">0x00</span>,<span class="number">0x48</span>,<span class="number">0x7A</span>,<span class="number">0x41</span>,<span class="number">0x00</span>&#125;,        <span class="comment">//   (167) &#x27;i - 0x00ED Latin Small Letter I with Acute</span></span><br><span class="line">    &#123;<span class="number">0x00</span>,<span class="number">0x4A</span>,<span class="number">0x79</span>,<span class="number">0x42</span>,<span class="number">0x00</span>&#125;,        <span class="comment">//   (168) ^i - 0x00EE Latin Small Letter I with Circumflex</span></span><br><span class="line">    &#123;<span class="number">0x00</span>,<span class="number">0x4A</span>,<span class="number">0x78</span>,<span class="number">0x42</span>,<span class="number">0x00</span>&#125;,        <span class="comment">//   (169) &quot;i - 0x00EF Latin Small Letter I with Diaeresis</span></span><br><span class="line">    &#123;<span class="number">0x31</span>,<span class="number">0x4A</span>,<span class="number">0x4E</span>,<span class="number">0x4A</span>,<span class="number">0x30</span>&#125;,        <span class="comment">//   (170)    - 0x00F0 Latin Small Letter Eth</span></span><br><span class="line">    &#123;<span class="number">0x7A</span>,<span class="number">0x11</span>,<span class="number">0x0A</span>,<span class="number">0x09</span>,<span class="number">0x70</span>&#125;,        <span class="comment">//   (171) ~n - 0x00F1 Latin Small Letter N with Tilde</span></span><br><span class="line">    &#123;<span class="number">0x30</span>,<span class="number">0x49</span>,<span class="number">0x4A</span>,<span class="number">0x48</span>,<span class="number">0x30</span>&#125;,        <span class="comment">//   (172) `o - 0x00F2 Latin Small Letter O with Grave</span></span><br><span class="line">    &#123;<span class="number">0x30</span>,<span class="number">0x48</span>,<span class="number">0x4A</span>,<span class="number">0x49</span>,<span class="number">0x30</span>&#125;,        <span class="comment">//   (173) &#x27;o - 0x00F3 Latin Small Letter O with Acute</span></span><br><span class="line">    &#123;<span class="number">0x30</span>,<span class="number">0x4A</span>,<span class="number">0x49</span>,<span class="number">0x4A</span>,<span class="number">0x30</span>&#125;,        <span class="comment">//   (174) ^o - 0x00F4 Latin Small Letter O with Circumflex</span></span><br><span class="line">    &#123;<span class="number">0x30</span>,<span class="number">0x4A</span>,<span class="number">0x49</span>,<span class="number">0x4A</span>,<span class="number">0x31</span>&#125;,        <span class="comment">//   (175) ~o - 0x00F5 Latin Small Letter O with Tilde</span></span><br><span class="line">    &#123;<span class="number">0x30</span>,<span class="number">0x4A</span>,<span class="number">0x48</span>,<span class="number">0x4A</span>,<span class="number">0x30</span>&#125;,        <span class="comment">//   (176) &quot;o - 0x00F6 Latin Small Letter O with Diaeresis</span></span><br><span class="line">    &#123;<span class="number">0x08</span>,<span class="number">0x08</span>,<span class="number">0x2A</span>,<span class="number">0x08</span>,<span class="number">0x08</span>&#125;,        <span class="comment">//   (177)  + - 0x00F7 Division Sign</span></span><br><span class="line">    &#123;<span class="number">0x38</span>,<span class="number">0x64</span>,<span class="number">0x54</span>,<span class="number">0x4C</span>,<span class="number">0x38</span>&#125;,        <span class="comment">//   (178)  o - 0x00F8 Latin Small Letter O with Stroke</span></span><br><span class="line">    &#123;<span class="number">0x38</span>,<span class="number">0x41</span>,<span class="number">0x42</span>,<span class="number">0x20</span>,<span class="number">0x78</span>&#125;,        <span class="comment">//   (179) `u - 0x00F9 Latin Small Letter U with Grave</span></span><br><span class="line">    &#123;<span class="number">0x38</span>,<span class="number">0x40</span>,<span class="number">0x42</span>,<span class="number">0x21</span>,<span class="number">0x78</span>&#125;,        <span class="comment">//   (180) &#x27;u - 0x00FA Latin Small Letter U with Acute</span></span><br><span class="line">    &#123;<span class="number">0x38</span>,<span class="number">0x42</span>,<span class="number">0x41</span>,<span class="number">0x22</span>,<span class="number">0x78</span>&#125;,        <span class="comment">//   (181) ^u - 0x00FB Latin Small Letter U with Circumflex</span></span><br><span class="line">    &#123;<span class="number">0x38</span>,<span class="number">0x42</span>,<span class="number">0x40</span>,<span class="number">0x22</span>,<span class="number">0x78</span>&#125;,        <span class="comment">//   (182) &quot;u - 0x00FC Latin Small Letter U with Diaeresis</span></span><br><span class="line">    &#123;<span class="number">0x0C</span>,<span class="number">0x50</span>,<span class="number">0x52</span>,<span class="number">0x51</span>,<span class="number">0x3C</span>&#125;,        <span class="comment">//   (183) &#x27;y - 0x00FD Latin Small Letter Y with Acute</span></span><br><span class="line">    &#123;<span class="number">0x7E</span>,<span class="number">0x14</span>,<span class="number">0x14</span>,<span class="number">0x14</span>,<span class="number">0x08</span>&#125;,        <span class="comment">//   (184)  p - 0x00FE Latin Small Letter Thom</span></span><br><span class="line">    &#123;<span class="number">0x0C</span>,<span class="number">0x51</span>,<span class="number">0x50</span>,<span class="number">0x51</span>,<span class="number">0x3C</span>&#125;,        <span class="comment">//   (185) &quot;y - 0x00FF Latin Small Letter Y with Diaeresis</span></span><br><span class="line">    &#123;<span class="number">0x1E</span>,<span class="number">0x09</span>,<span class="number">0x09</span>,<span class="number">0x29</span>,<span class="number">0x5E</span>&#125;,        <span class="comment">//   (186)  A - 0x0104 Latin Capital Letter A with Ogonek</span></span><br><span class="line">    &#123;<span class="number">0x08</span>,<span class="number">0x15</span>,<span class="number">0x15</span>,<span class="number">0x35</span>,<span class="number">0x4E</span>&#125;,        <span class="comment">//   (187)  a - 0x0105 Latin Small Letter A with Ogonek</span></span><br><span class="line">    &#123;<span class="number">0x38</span>,<span class="number">0x44</span>,<span class="number">0x46</span>,<span class="number">0x45</span>,<span class="number">0x20</span>&#125;,        <span class="comment">//   (188) &#x27;C - 0x0106 Latin Capital Letter C with Acute</span></span><br><span class="line">    &#123;<span class="number">0x30</span>,<span class="number">0x48</span>,<span class="number">0x4A</span>,<span class="number">0x49</span>,<span class="number">0x20</span>&#125;,        <span class="comment">//   (189) &#x27;c - 0x0107 Latin Small Letter C with Acute</span></span><br><span class="line">    &#123;<span class="number">0x38</span>,<span class="number">0x45</span>,<span class="number">0x46</span>,<span class="number">0x45</span>,<span class="number">0x20</span>&#125;,        <span class="comment">//   (190)  C - 0x010C Latin Capital Letter C with Caron</span></span><br><span class="line">    &#123;<span class="number">0x30</span>,<span class="number">0x49</span>,<span class="number">0x4A</span>,<span class="number">0x49</span>,<span class="number">0x20</span>&#125;,        <span class="comment">//   (191)  c - 0x010D Latin Small Letter C with Caron</span></span><br><span class="line">    &#123;<span class="number">0x7C</span>,<span class="number">0x45</span>,<span class="number">0x46</span>,<span class="number">0x45</span>,<span class="number">0x38</span>&#125;,        <span class="comment">//   (192)  D - 0x010E Latin Capital Letter D with Caron</span></span><br><span class="line">    &#123;<span class="number">0x20</span>,<span class="number">0x50</span>,<span class="number">0x50</span>,<span class="number">0x7C</span>,<span class="number">0x03</span>&#125;,        <span class="comment">//   (193) d&#x27; - 0x010F Latin Small Letter D with Caron</span></span><br><span class="line">    &#123;<span class="number">0x1F</span>,<span class="number">0x15</span>,<span class="number">0x15</span>,<span class="number">0x35</span>,<span class="number">0x51</span>&#125;,        <span class="comment">//   (194)  E - 0x0118 Latin Capital Letter E with Ogonek</span></span><br><span class="line">    &#123;<span class="number">0x0E</span>,<span class="number">0x15</span>,<span class="number">0x15</span>,<span class="number">0x35</span>,<span class="number">0x46</span>&#125;,        <span class="comment">//   (195)  e - 0x0119 Latin Small Letter E with Ogonek</span></span><br><span class="line">    &#123;<span class="number">0x7C</span>,<span class="number">0x55</span>,<span class="number">0x56</span>,<span class="number">0x55</span>,<span class="number">0x44</span>&#125;,        <span class="comment">//   (196)  E - 0x011A Latin Capital Letter E with Caron</span></span><br><span class="line">    &#123;<span class="number">0x38</span>,<span class="number">0x55</span>,<span class="number">0x56</span>,<span class="number">0x55</span>,<span class="number">0x18</span>&#125;,        <span class="comment">//   (197)  e - 0x011B Latin Small Letter E with Caron</span></span><br><span class="line">    &#123;<span class="number">0x00</span>,<span class="number">0x44</span>,<span class="number">0x7C</span>,<span class="number">0x40</span>,<span class="number">0x00</span>&#125;,        <span class="comment">//   (198)  i - 0x0131 Latin Small Letter Dotless I</span></span><br><span class="line">    &#123;<span class="number">0x7F</span>,<span class="number">0x48</span>,<span class="number">0x44</span>,<span class="number">0x40</span>,<span class="number">0x40</span>&#125;,        <span class="comment">//   (199)  L - 0x0141 Latin Capital Letter L with Stroke</span></span><br><span class="line">    &#123;<span class="number">0x00</span>,<span class="number">0x49</span>,<span class="number">0x7F</span>,<span class="number">0x44</span>,<span class="number">0x00</span>&#125;,        <span class="comment">//   (200)  l - 0x0142 Latin Small Letter L with Stroke</span></span><br><span class="line">    &#123;<span class="number">0x7C</span>,<span class="number">0x08</span>,<span class="number">0x12</span>,<span class="number">0x21</span>,<span class="number">0x7C</span>&#125;,        <span class="comment">//   (201) &#x27;N - 0x0143 Latin Capital Letter N with Acute</span></span><br><span class="line">    &#123;<span class="number">0x78</span>,<span class="number">0x10</span>,<span class="number">0x0A</span>,<span class="number">0x09</span>,<span class="number">0x70</span>&#125;,        <span class="comment">//   (202) &#x27;n - 0x0144 Latin Small Letter N with Acute</span></span><br><span class="line">    &#123;<span class="number">0x7C</span>,<span class="number">0x09</span>,<span class="number">0x12</span>,<span class="number">0x21</span>,<span class="number">0x7C</span>&#125;,        <span class="comment">//   (203)  N - 0x0147 Latin Capital Letter N with Caron</span></span><br><span class="line">    &#123;<span class="number">0x78</span>,<span class="number">0x11</span>,<span class="number">0x0A</span>,<span class="number">0x09</span>,<span class="number">0x70</span>&#125;,        <span class="comment">//   (204)  n - 0x0148 Latin Small Letter N with Caron</span></span><br><span class="line">    &#123;<span class="number">0x38</span>,<span class="number">0x47</span>,<span class="number">0x44</span>,<span class="number">0x47</span>,<span class="number">0x38</span>&#125;,        <span class="comment">//   (205) &quot;O - 0x0150 Latin Capital Letter O with Double Acute</span></span><br><span class="line">    &#123;<span class="number">0x30</span>,<span class="number">0x4B</span>,<span class="number">0x48</span>,<span class="number">0x4B</span>,<span class="number">0x30</span>&#125;,        <span class="comment">//   (206) &quot;o - 0x0151 Latin Small Letter O with Double Acute</span></span><br><span class="line">    &#123;<span class="number">0x3E</span>,<span class="number">0x41</span>,<span class="number">0x7F</span>,<span class="number">0x49</span>,<span class="number">0x49</span>&#125;,        <span class="comment">//   (207) OE - 0x0152 Latin Capital Ligature Oe</span></span><br><span class="line">    &#123;<span class="number">0x38</span>,<span class="number">0x44</span>,<span class="number">0x38</span>,<span class="number">0x54</span>,<span class="number">0x58</span>&#125;,        <span class="comment">//   (208) oe - 0x0153 Latin Small Ligature Oe</span></span><br><span class="line">    &#123;<span class="number">0x7C</span>,<span class="number">0x15</span>,<span class="number">0x16</span>,<span class="number">0x35</span>,<span class="number">0x48</span>&#125;,        <span class="comment">//   (209)  R - 0x0158 Latin Capital Letter R with Caron</span></span><br><span class="line">    &#123;<span class="number">0x78</span>,<span class="number">0x11</span>,<span class="number">0x0A</span>,<span class="number">0x09</span>,<span class="number">0x10</span>&#125;,        <span class="comment">//   (210)  r - 0x0159 Latin Small Letter R with Caron</span></span><br><span class="line">    &#123;<span class="number">0x48</span>,<span class="number">0x54</span>,<span class="number">0x56</span>,<span class="number">0x55</span>,<span class="number">0x20</span>&#125;,        <span class="comment">//   (211) &#x27;S - 0x015A Latin Capital Letter S with Acute</span></span><br><span class="line">    &#123;<span class="number">0x20</span>,<span class="number">0x48</span>,<span class="number">0x56</span>,<span class="number">0x55</span>,<span class="number">0x20</span>&#125;,        <span class="comment">//   (212) &#x27;s - 0x015B Latin Small Letter S with Acute</span></span><br><span class="line">    &#123;<span class="number">0x48</span>,<span class="number">0x55</span>,<span class="number">0x56</span>,<span class="number">0x55</span>,<span class="number">0x20</span>&#125;,        <span class="comment">//   (213)  S - 0x0160 Latin Capital Letter S with Caron</span></span><br><span class="line">    &#123;<span class="number">0x20</span>,<span class="number">0x49</span>,<span class="number">0x56</span>,<span class="number">0x55</span>,<span class="number">0x20</span>&#125;,        <span class="comment">//   (214)  s - 0x0161 Latin Small Letter S with Caron</span></span><br><span class="line">    &#123;<span class="number">0x04</span>,<span class="number">0x05</span>,<span class="number">0x7E</span>,<span class="number">0x05</span>,<span class="number">0x04</span>&#125;,        <span class="comment">//   (215)  T - 0x0164 Latin Capital Letter T with Caron</span></span><br><span class="line">    &#123;<span class="number">0x08</span>,<span class="number">0x3C</span>,<span class="number">0x48</span>,<span class="number">0x22</span>,<span class="number">0x01</span>&#125;,        <span class="comment">//   (216) t&#x27; - 0x0165 Latin Small Letter T with Caron</span></span><br><span class="line">    &#123;<span class="number">0x3C</span>,<span class="number">0x42</span>,<span class="number">0x45</span>,<span class="number">0x42</span>,<span class="number">0x3C</span>&#125;,        <span class="comment">//   (217)  U - 0x016E Latin Capital Letter U with Ring Above</span></span><br><span class="line">    &#123;<span class="number">0x38</span>,<span class="number">0x42</span>,<span class="number">0x45</span>,<span class="number">0x22</span>,<span class="number">0x78</span>&#125;,        <span class="comment">//   (218)  u - 0x016F Latin Small Letter U with Ring Above</span></span><br><span class="line">    &#123;<span class="number">0x3C</span>,<span class="number">0x43</span>,<span class="number">0x40</span>,<span class="number">0x43</span>,<span class="number">0x3C</span>&#125;,        <span class="comment">//   (219) &quot;U - 0x0170 Latin Capital Letter U with Double Acute</span></span><br><span class="line">    &#123;<span class="number">0x38</span>,<span class="number">0x43</span>,<span class="number">0x40</span>,<span class="number">0x23</span>,<span class="number">0x78</span>&#125;,        <span class="comment">//   (220) &quot;u - 0x0171 Latin Small Letter U with Double Acute</span></span><br><span class="line">    &#123;<span class="number">0x0C</span>,<span class="number">0x11</span>,<span class="number">0x60</span>,<span class="number">0x11</span>,<span class="number">0x0C</span>&#125;,        <span class="comment">//   (221) &quot;Y - 0x0178 Latin Capital Letter Y with Diaeresis</span></span><br><span class="line">    &#123;<span class="number">0x44</span>,<span class="number">0x66</span>,<span class="number">0x55</span>,<span class="number">0x4C</span>,<span class="number">0x44</span>&#125;,        <span class="comment">//   (222) &#x27;Z - 0x0179 Latin Capital Letter Z with Acute</span></span><br><span class="line">    &#123;<span class="number">0x48</span>,<span class="number">0x6A</span>,<span class="number">0x59</span>,<span class="number">0x48</span>,<span class="number">0x00</span>&#125;,        <span class="comment">//   (223) &#x27;z - 0x017A Latin Small Letter Z with Acute</span></span><br><span class="line">    &#123;<span class="number">0x44</span>,<span class="number">0x64</span>,<span class="number">0x55</span>,<span class="number">0x4C</span>,<span class="number">0x44</span>&#125;,        <span class="comment">//   (224)  Z - 0x017B Latin Capital Letter Z with Dot Above</span></span><br><span class="line">    &#123;<span class="number">0x48</span>,<span class="number">0x68</span>,<span class="number">0x5A</span>,<span class="number">0x48</span>,<span class="number">0x00</span>&#125;,        <span class="comment">//   (225)  z - 0x017C Latin Small Letter Z with Dot Above</span></span><br><span class="line">    &#123;<span class="number">0x44</span>,<span class="number">0x65</span>,<span class="number">0x56</span>,<span class="number">0x4D</span>,<span class="number">0x44</span>&#125;,        <span class="comment">//   (226)  Z - 0x017D Latin Capital Letter Z with Caron</span></span><br><span class="line">    &#123;<span class="number">0x48</span>,<span class="number">0x69</span>,<span class="number">0x5A</span>,<span class="number">0x49</span>,<span class="number">0x00</span>&#125;,        <span class="comment">//   (227)  z - 0x017E Latin Small Letter Z with Caron</span></span><br><span class="line">    &#123;<span class="number">0x00</span>,<span class="number">0x02</span>,<span class="number">0x01</span>,<span class="number">0x02</span>,<span class="number">0x00</span>&#125;,        <span class="comment">//   (228)  ^ - 0x02C6 Modifier Letter Circumflex Accent</span></span><br><span class="line">    &#123;<span class="number">0x00</span>,<span class="number">0x01</span>,<span class="number">0x02</span>,<span class="number">0x01</span>,<span class="number">0x00</span>&#125;,        <span class="comment">//   (229)    - 0x02C7 Caron</span></span><br><span class="line">    &#123;<span class="number">0x00</span>,<span class="number">0x01</span>,<span class="number">0x01</span>,<span class="number">0x01</span>,<span class="number">0x00</span>&#125;,        <span class="comment">//   (230)    - 0x02C9 Modifier Letter Macron</span></span><br><span class="line">    &#123;<span class="number">0x01</span>,<span class="number">0x02</span>,<span class="number">0x02</span>,<span class="number">0x01</span>,<span class="number">0x00</span>&#125;,        <span class="comment">//   (231)    - 0x02D8 Breve</span></span><br><span class="line">    &#123;<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x01</span>,<span class="number">0x00</span>,<span class="number">0x00</span>&#125;,        <span class="comment">//   (232)    - 0x02D9 Dot Above</span></span><br><span class="line">    &#123;<span class="number">0x00</span>,<span class="number">0x02</span>,<span class="number">0x05</span>,<span class="number">0x02</span>,<span class="number">0x00</span>&#125;,        <span class="comment">//   (233)    - 0x02DA Ring Above</span></span><br><span class="line">    &#123;<span class="number">0x02</span>,<span class="number">0x01</span>,<span class="number">0x02</span>,<span class="number">0x01</span>,<span class="number">0x00</span>&#125;,        <span class="comment">//   (234)  ~ - 0x02DC Small Tilde</span></span><br><span class="line">    &#123;<span class="number">0x7F</span>,<span class="number">0x05</span>,<span class="number">0x15</span>,<span class="number">0x3A</span>,<span class="number">0x50</span>&#125;,        <span class="comment">//   (235) Pt - 0x20A7 Peseta Sign</span></span><br><span class="line">    &#123;<span class="number">0x3E</span>,<span class="number">0x55</span>,<span class="number">0x55</span>,<span class="number">0x41</span>,<span class="number">0x22</span>&#125;,        <span class="comment">//   (236)  C - 0x20AC Euro Sign</span></span><br><span class="line">    &#123;<span class="number">0x18</span>,<span class="number">0x14</span>,<span class="number">0x08</span>,<span class="number">0x14</span>,<span class="number">0x0C</span>&#125;,        <span class="comment">//   (237)    - 0x221E Infinity</span></span><br><span class="line">    &#123;<span class="number">0x44</span>,<span class="number">0x4A</span>,<span class="number">0x4A</span>,<span class="number">0x51</span>,<span class="number">0x51</span>&#125;,        <span class="comment">//   (238)  &lt; - 0x2264 Less-Than or Equal to</span></span><br><span class="line">    &#123;<span class="number">0x51</span>,<span class="number">0x51</span>,<span class="number">0x4A</span>,<span class="number">0x4A</span>,<span class="number">0x44</span>&#125;,        <span class="comment">//   (239)  &gt; - 0x2265 Greater-Than or Equal to</span></span><br><span class="line">    &#123;<span class="number">0x74</span>,<span class="number">0x42</span>,<span class="number">0x41</span>,<span class="number">0x42</span>,<span class="number">0x74</span>&#125;,        <span class="comment">//   (240)    - 0x2302 House</span></span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure>

<p>spi.h</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> __SPI_H__</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __SPI_H__</span></span><br><span class="line"> </span><br><span class="line"><span class="meta">#<span class="keyword">define</span> OLED	0</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> FLASH	1</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> RFID	2</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> UART	3</span></span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">spi_init</span><span class="params">(<span class="type">int</span> ch, <span class="type">int</span> rate, <span class="type">int</span> mode)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">spi_write_read</span><span class="params">(<span class="type">int</span> ch, <span class="type">int</span> slave, <span class="type">unsigned</span> <span class="type">char</span> *wbuf, <span class="type">unsigned</span> <span class="type">char</span> *rbuf, <span class="type">unsigned</span> <span class="type">int</span> len)</span>;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> <span class="title function_">spi_send</span><span class="params">(<span class="type">int</span> ch, <span class="type">int</span> slave, <span class="type">unsigned</span> <span class="type">char</span> dat)</span>;</span><br><span class="line"> </span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure>

<p> spi.c</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;LPC11xx.h&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;spi.h&quot;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">spi_init</span><span class="params">(<span class="type">int</span> ch, <span class="type">int</span> rate, <span class="type">int</span> mode)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">if</span> (ch == <span class="number">0</span>) &#123;</span><br><span class="line">		</span><br><span class="line">		LPC_SYSCON-&gt;PRESETCTRL    |= (<span class="number">0x1</span>&lt;&lt;<span class="number">0</span>);</span><br><span class="line">		LPC_SYSCON-&gt;SYSAHBCLKCTRL |= (<span class="number">0x1</span>&lt;&lt;<span class="number">11</span>);</span><br><span class="line">		LPC_SYSCON-&gt;SSP0CLKDIV     = <span class="number">24</span>;				<span class="comment">/* Divided by 24 */</span></span><br><span class="line">		LPC_IOCON-&gt;PIO0_8         &amp;= ~<span class="number">0x07</span>;			<span class="comment">/* SSP I/O config */</span></span><br><span class="line">		LPC_IOCON-&gt;PIO0_8         |= <span class="number">0x01</span>;			<span class="comment">/* SSP MISO */</span></span><br><span class="line">		LPC_IOCON-&gt;PIO0_9         &amp;= ~<span class="number">0x07</span>;	</span><br><span class="line">		LPC_IOCON-&gt;PIO0_9         |= <span class="number">0x01</span>;			<span class="comment">/* SSP MOSI */</span></span><br><span class="line"> </span><br><span class="line">		LPC_IOCON-&gt;SCK_LOC = <span class="number">0x02</span>;</span><br><span class="line">		LPC_IOCON-&gt;PIO0_6 = <span class="number">0x02</span>;								<span class="comment">/* P0.6 function 2 is SSP clock, need to </span></span><br><span class="line"><span class="comment">																							combined with IOCONSCKLOC register setting */</span>  </span><br><span class="line"> </span><br><span class="line">		LPC_SYSCON-&gt;SYSAHBCLKCTRL |= (<span class="number">1</span>&lt;&lt;<span class="number">6</span>);</span><br><span class="line">		LPC_IOCON-&gt;PIO2_4 &amp;= ~<span class="number">0x07</span>;							<span class="comment">/* SSP SSEL0 is a GPIO pin, for OLED */</span></span><br><span class="line">		LPC_GPIO2-&gt;DIR |= <span class="number">1</span> &lt;&lt; <span class="number">4</span>;</span><br><span class="line">		LPC_GPIO2-&gt;DATA |= <span class="number">1</span> &lt;&lt; <span class="number">4</span>;</span><br><span class="line"> </span><br><span class="line">		LPC_IOCON-&gt;PIO2_6 &amp;= ~<span class="number">0x07</span>;							<span class="comment">/* SSP SSEL1 is a GPIO pin, for FLASH */</span></span><br><span class="line">		LPC_GPIO2-&gt;DIR |= <span class="number">1</span> &lt;&lt; <span class="number">6</span>;</span><br><span class="line">		LPC_GPIO2-&gt;DATA |= <span class="number">1</span> &lt;&lt; <span class="number">6</span>;</span><br><span class="line"> </span><br><span class="line">		LPC_IOCON-&gt;PIO2_7 &amp;= ~<span class="number">0x07</span>;							<span class="comment">/* SSP SSEL2 is a GPIO pin, for RFID */</span></span><br><span class="line">		LPC_GPIO2-&gt;DIR |= <span class="number">1</span> &lt;&lt; <span class="number">7</span>;</span><br><span class="line">		LPC_GPIO2-&gt;DATA |= <span class="number">1</span> &lt;&lt; <span class="number">7</span>;</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		LPC_SYSCON-&gt;PRESETCTRL    |= (<span class="number">0x1</span>&lt;&lt;<span class="number">2</span>);</span><br><span class="line">		LPC_SYSCON-&gt;SYSAHBCLKCTRL |= (<span class="number">1</span>&lt;&lt;<span class="number">18</span>);</span><br><span class="line">		LPC_SYSCON-&gt;SSP1CLKDIV     = <span class="number">24</span>;			<span class="comment">/* Divided by 24 */</span></span><br><span class="line">		LPC_IOCON-&gt;PIO2_2         &amp;= ~<span class="number">0x07</span>;		<span class="comment">/* SSP I/O config */</span></span><br><span class="line">		LPC_IOCON-&gt;PIO2_2         |= <span class="number">0x02</span>;		<span class="comment">/* SSP MISO */</span></span><br><span class="line">		LPC_IOCON-&gt;PIO2_3         &amp;= ~<span class="number">0x07</span>;	</span><br><span class="line">		LPC_IOCON-&gt;PIO2_3         |= <span class="number">0x02</span>;		<span class="comment">/* SSP MOSI */</span></span><br><span class="line">		LPC_IOCON-&gt;PIO2_1         &amp;= ~<span class="number">0x07</span>;</span><br><span class="line">		LPC_IOCON-&gt;PIO2_1         |= <span class="number">0x02</span>;		<span class="comment">/* SSP CLK */</span></span><br><span class="line">	 </span><br><span class="line">		LPC_IOCON-&gt;PIO2_0 &amp;= ~<span class="number">0x07</span>;						<span class="comment">/* SSP SSEL is a GPIO pin */</span></span><br><span class="line">		LPC_GPIO2-&gt;DIR |= <span class="number">1</span> &lt;&lt; <span class="number">0</span>;</span><br><span class="line">		LPC_GPIO2-&gt;DATA |= <span class="number">1</span> &lt;&lt; <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> (ch == <span class="number">0</span>) &#123;</span><br><span class="line">		LPC_SSP0-&gt;CPSR = <span class="number">2</span>;										<span class="comment">/* Divided by 2 */</span></span><br><span class="line">		LPC_SSP0-&gt;CR0 = ((<span class="number">1000000</span> / rate - <span class="number">1</span>) &lt;&lt; <span class="number">8</span>) | \</span><br><span class="line">										((mode &amp; <span class="number">1</span>) &lt;&lt; <span class="number">7</span>) | (((mode &amp; <span class="number">2</span>) &gt;&gt; <span class="number">1</span>) &lt;&lt; <span class="number">6</span>) | \</span><br><span class="line">										(<span class="number">7</span> &lt;&lt; <span class="number">0</span>);</span><br><span class="line">		LPC_SSP0-&gt;IMSC = <span class="number">0</span>;										<span class="comment">/* disable all interrupts */</span></span><br><span class="line">		LPC_SSP0-&gt;ICR = <span class="number">3</span>;										<span class="comment">/* clears interrupts */</span></span><br><span class="line">		LPC_SSP0-&gt;CR1 = <span class="number">1</span> &lt;&lt; <span class="number">1</span>;								<span class="comment">/* Master, SPI Enable */</span></span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		LPC_SSP1-&gt;CPSR = <span class="number">2</span>;										<span class="comment">/* Divided by 2 */</span></span><br><span class="line">		LPC_SSP1-&gt;CR0 = ((<span class="number">1000000</span> / rate - <span class="number">1</span>) &lt;&lt; <span class="number">8</span>) | \</span><br><span class="line">										((mode &amp; <span class="number">1</span>) &lt;&lt; <span class="number">7</span>) | (((mode &amp; <span class="number">2</span>) &gt;&gt; <span class="number">1</span>) &lt;&lt; <span class="number">6</span>) | \</span><br><span class="line">										(<span class="number">7</span> &lt;&lt; <span class="number">0</span>);</span><br><span class="line">		LPC_SSP1-&gt;IMSC = <span class="number">0</span>;										<span class="comment">/* disable all interrupts */</span></span><br><span class="line">		LPC_SSP1-&gt;ICR = <span class="number">3</span>;										<span class="comment">/* clears interrupts */</span></span><br><span class="line">		LPC_SSP1-&gt;CR1 = <span class="number">1</span> &lt;&lt; <span class="number">1</span>;								<span class="comment">/* Master, SPI Enable */</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">spi_set_cs</span><span class="params">(<span class="type">int</span> slave)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">switch</span> (slave) &#123;</span><br><span class="line">		<span class="keyword">case</span> OLED:</span><br><span class="line">			LPC_GPIO2-&gt;DATA |= <span class="number">1</span> &lt;&lt; <span class="number">4</span>;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> FLASH:</span><br><span class="line">			LPC_GPIO2-&gt;DATA |= <span class="number">1</span> &lt;&lt; <span class="number">6</span>;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> RFID:</span><br><span class="line">			LPC_GPIO2-&gt;DATA |= <span class="number">1</span> &lt;&lt; <span class="number">7</span>;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> UART:</span><br><span class="line">			LPC_GPIO2-&gt;DATA |= <span class="number">1</span> &lt;&lt; <span class="number">0</span>;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">spi_clr_cs</span><span class="params">(<span class="type">int</span> slave)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">switch</span> (slave) &#123;</span><br><span class="line">		<span class="keyword">case</span> OLED:</span><br><span class="line">			LPC_GPIO2-&gt;DATA &amp;= ~(<span class="number">1</span> &lt;&lt; <span class="number">4</span>);</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> FLASH:</span><br><span class="line">			LPC_GPIO2-&gt;DATA &amp;= ~(<span class="number">1</span> &lt;&lt; <span class="number">6</span>);</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> RFID:</span><br><span class="line">			LPC_GPIO2-&gt;DATA &amp;= ~(<span class="number">1</span> &lt;&lt; <span class="number">7</span>);</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> UART:</span><br><span class="line">			LPC_GPIO2-&gt;DATA &amp;= ~(<span class="number">1</span> &lt;&lt; <span class="number">0</span>);</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">spi_write_read</span><span class="params">(<span class="type">int</span> ch, <span class="type">int</span> slave, <span class="type">unsigned</span> <span class="type">char</span> *wbuf, <span class="type">unsigned</span> <span class="type">char</span> *rbuf, <span class="type">unsigned</span> <span class="type">int</span> len)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span>(ch == <span class="number">0</span>)</span><br><span class="line">  &#123;</span><br><span class="line">		<span class="keyword">while</span> (i &lt; len) &#123;</span><br><span class="line">			spi_clr_cs(slave);</span><br><span class="line">			<span class="keyword">while</span>((LPC_SSP0-&gt;SR &amp; ((<span class="number">1</span> &lt;&lt; <span class="number">1</span>) | (<span class="number">1</span> &lt;&lt; <span class="number">4</span>))) != (<span class="number">1</span> &lt;&lt; <span class="number">1</span>));</span><br><span class="line">			LPC_SSP0-&gt;DR = wbuf[i];</span><br><span class="line">			<span class="keyword">while</span>(LPC_SSP0-&gt;SR &amp; (<span class="number">1</span> &lt;&lt; <span class="number">4</span>));</span><br><span class="line"> </span><br><span class="line">			<span class="keyword">while</span>((LPC_SSP0-&gt;SR &amp; ((<span class="number">1</span> &lt;&lt; <span class="number">2</span>) | (<span class="number">1</span> &lt;&lt; <span class="number">4</span>))) != (<span class="number">1</span> &lt;&lt; <span class="number">2</span>));</span><br><span class="line">			rbuf[i] = LPC_SSP0-&gt;DR;</span><br><span class="line">			spi_set_cs(slave);</span><br><span class="line">			i++;</span><br><span class="line">		&#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="keyword">while</span> (i &lt; len) &#123;</span><br><span class="line">			spi_clr_cs(slave);</span><br><span class="line">			<span class="keyword">while</span>((LPC_SSP1-&gt;SR &amp; ((<span class="number">1</span> &lt;&lt; <span class="number">1</span>) | (<span class="number">1</span> &lt;&lt; <span class="number">4</span>))) != (<span class="number">1</span> &lt;&lt; <span class="number">1</span>));</span><br><span class="line">			LPC_SSP1-&gt;DR = wbuf[i];</span><br><span class="line">			<span class="keyword">while</span>(LPC_SSP1-&gt;SR &amp; (<span class="number">1</span> &lt;&lt; <span class="number">4</span>));</span><br><span class="line"> </span><br><span class="line">			<span class="keyword">while</span>((LPC_SSP1-&gt;SR &amp; ((<span class="number">1</span> &lt;&lt; <span class="number">2</span>) | (<span class="number">1</span> &lt;&lt; <span class="number">4</span>))) != (<span class="number">1</span> &lt;&lt; <span class="number">2</span>));</span><br><span class="line">			rbuf[i] = LPC_SSP1-&gt;DR;</span><br><span class="line">			spi_set_cs(slave);</span><br><span class="line">			i++;</span><br><span class="line">		&#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> <span class="title function_">spi_send</span><span class="params">(<span class="type">int</span> ch, <span class="type">int</span> slave, <span class="type">unsigned</span> <span class="type">char</span> dat)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> c;</span><br><span class="line">	</span><br><span class="line">	spi_write_read(ch, slave, &amp;dat, &amp;c, <span class="number">1</span>);</span><br><span class="line">	<span class="keyword">return</span> c;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>oled.h</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> __OLED_H__</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __OLED_H__</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">typedef</span> <span class="type">unsigned</span> <span class="type">char</span> <span class="type">uint8_t</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">unsigned</span> <span class="type">short</span> <span class="type">uint16_t</span>;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">oled_init</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">oled_clear_screen</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">oled_disp_char</span><span class="params">(<span class="type">uint8_t</span> Line, <span class="type">uint16_t</span> Column, <span class="type">uint8_t</span> Color, <span class="type">char</span> c)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">oled_disp_string</span><span class="params">(<span class="type">uint8_t</span> Line, <span class="type">uint8_t</span> Color, <span class="type">char</span> *ptr)</span>;</span><br><span class="line"> </span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure>

<p>oled.c</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;lpc11xx.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;spi.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;ascii.h&quot;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="comment">/******************************************************************************/</span></span><br><span class="line"><span class="comment">/*  Write command &amp; data                                                      */</span></span><br><span class="line"><span class="comment">/******************************************************************************/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">WriteCommand</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> cmd)</span></span><br><span class="line">&#123;</span><br><span class="line">	LPC_GPIO2-&gt;DATA &amp;= ~(<span class="number">1</span> &lt;&lt; <span class="number">5</span>);</span><br><span class="line">	spi_write_read(<span class="number">0</span>, OLED, &amp;cmd, &amp;cmd, <span class="number">1</span>);</span><br><span class="line">	LPC_GPIO2-&gt;DATA |= <span class="number">1</span> &lt;&lt; <span class="number">5</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">WriteData</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> dat)</span></span><br><span class="line">&#123;</span><br><span class="line">	LPC_GPIO2-&gt;DATA |= <span class="number">1</span> &lt;&lt; <span class="number">5</span>;</span><br><span class="line">	spi_write_read(<span class="number">0</span>, OLED, &amp;dat, &amp;dat, <span class="number">1</span>);</span><br><span class="line">	LPC_GPIO2-&gt;DATA |= <span class="number">1</span> &lt;&lt; <span class="number">5</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/******************************************************************************/</span></span><br><span class="line"><span class="comment">/*  Instruction Setting                                                       */</span></span><br><span class="line"><span class="comment">/******************************************************************************/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">SetStartColumn</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> d)</span></span><br><span class="line">&#123;</span><br><span class="line">	WriteCommand(<span class="number">0x00</span>+d%<span class="number">16</span>);		<span class="comment">// Set Lower Column Start Address for Page Addressing Mode</span></span><br><span class="line">															<span class="comment">//	Default =&gt; 0x00</span></span><br><span class="line">	WriteCommand(<span class="number">0x10</span>+d/<span class="number">16</span>);		<span class="comment">//	Set Higher Column Start Address for Page Addressing Mode</span></span><br><span class="line">															<span class="comment">//	Default =&gt; 0x10</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">SetAddressingMode</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> d)</span></span><br><span class="line">&#123;</span><br><span class="line">	WriteCommand(<span class="number">0x20</span>);					<span class="comment">// Set Memory Addressing Mode</span></span><br><span class="line">	WriteCommand(d);						<span class="comment">//	Default =&gt; 0x02</span></span><br><span class="line">															<span class="comment">//	0x00 =&gt; Horizontal Addressing Mode</span></span><br><span class="line">															<span class="comment">//	0x01 =&gt; Vertical Addressing Mode</span></span><br><span class="line">															<span class="comment">//	0x02 =&gt; Page Addressing Mode</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">SetColumnAddress</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> a, <span class="type">unsigned</span> <span class="type">char</span> b)</span></span><br><span class="line">&#123;</span><br><span class="line">	WriteCommand(<span class="number">0x21</span>);					<span class="comment">// Set Column Address</span></span><br><span class="line">	WriteCommand(a);						<span class="comment">//   Default =&gt; 0x00 (Column Start Address)</span></span><br><span class="line">	WriteCommand(b);						<span class="comment">//   Default =&gt; 0x7F (Column End Address)</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">SetPageAddress</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> a, <span class="type">unsigned</span> <span class="type">char</span> b)</span></span><br><span class="line">&#123;</span><br><span class="line">	WriteCommand(<span class="number">0x22</span>);					<span class="comment">// Set Page Address</span></span><br><span class="line">	WriteCommand(a);						<span class="comment">//   Default =&gt; 0x00 (Page Start Address)</span></span><br><span class="line">	WriteCommand(b);						<span class="comment">//   Default =&gt; 0x07 (Page End Address)</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">SetStartLine</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> d)</span></span><br><span class="line">&#123;</span><br><span class="line">	WriteCommand(<span class="number">0x40</span>|d);				<span class="comment">// Set Display Start Line</span></span><br><span class="line">															<span class="comment">//   Default =&gt; 0x40 (0x00)</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">SetContrastControl</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> d)</span></span><br><span class="line">&#123;</span><br><span class="line">	WriteCommand(<span class="number">0x81</span>);					<span class="comment">// Set Contrast Control</span></span><br><span class="line">	WriteCommand(d);						<span class="comment">//   Default =&gt; 0x7F</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">SetChargePump</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> d)</span></span><br><span class="line">&#123;</span><br><span class="line">	WriteCommand(<span class="number">0x8D</span>);					<span class="comment">// Set Charge Pump</span></span><br><span class="line">	WriteCommand(<span class="number">0x10</span>|d);				<span class="comment">//   Default =&gt; 0x10</span></span><br><span class="line">															<span class="comment">//     0x10 (0x00) =&gt; Disable Charge Pump</span></span><br><span class="line">															<span class="comment">//     0x14 (0x04) =&gt; Enable Charge Pump</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">SetSegmentRemap</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> d)</span></span><br><span class="line">&#123;</span><br><span class="line">	WriteCommand(<span class="number">0xA0</span>|d);				<span class="comment">// Set Segment Re-Map</span></span><br><span class="line">															<span class="comment">//	Default =&gt; 0xA0</span></span><br><span class="line">															<span class="comment">//	0xA0 (0x00) =&gt; Column Address 0 Mapped to SEG0</span></span><br><span class="line">															<span class="comment">//	0xA1 (0x01) =&gt; Column Address 0 Mapped to SEG127</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">SetEntireDisplay</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> d)</span></span><br><span class="line">&#123;</span><br><span class="line">	WriteCommand(<span class="number">0xA4</span>|d);				<span class="comment">// Set Entire Display On / Off</span></span><br><span class="line">															<span class="comment">//	Default =&gt; 0xA4</span></span><br><span class="line">															<span class="comment">//	0xA4 (0x00) =&gt; Normal Display</span></span><br><span class="line">															<span class="comment">//	0xA5 (0x01) =&gt; Entire Display On</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">SetInverseDisplay</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> d)</span></span><br><span class="line">&#123;</span><br><span class="line">	WriteCommand(<span class="number">0xA6</span>|d);				<span class="comment">// Set Inverse Display On/Off</span></span><br><span class="line">															<span class="comment">//	Default =&gt; 0xA6</span></span><br><span class="line">															<span class="comment">//	0xA6 (0x00) =&gt; Normal Display</span></span><br><span class="line">															<span class="comment">//	0xA7 (0x01) =&gt; Inverse Display On</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">SetMultiplexRatio</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> d)</span></span><br><span class="line">&#123;</span><br><span class="line">	WriteCommand(<span class="number">0xA8</span>);					<span class="comment">// Set Multiplex Ratio</span></span><br><span class="line">	WriteCommand(d);						<span class="comment">//	Default =&gt; 0x3F (1/64 Duty)</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">SetDisplayOnOff</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> d)</span>	</span><br><span class="line">&#123;</span><br><span class="line">	WriteCommand(<span class="number">0xAE</span>|d);				<span class="comment">// Set Display On/Off</span></span><br><span class="line">															<span class="comment">//	Default =&gt; 0xAE</span></span><br><span class="line">															<span class="comment">//	0xAE (0x00) =&gt; Display Off</span></span><br><span class="line">															<span class="comment">//	0xAF (0x01) =&gt; Display On</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">SetStartPage</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> d)</span></span><br><span class="line">&#123;</span><br><span class="line">	WriteCommand(<span class="number">0xB0</span>|d);				<span class="comment">// Set Page Start Address for Page Addressing Mode</span></span><br><span class="line">															<span class="comment">//	Default =&gt; 0xB0 (0x00)</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">SetCommonRemap</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> d)</span></span><br><span class="line">&#123;</span><br><span class="line">	WriteCommand(<span class="number">0xC0</span>|d);				<span class="comment">// Set COM Output Scan Direction</span></span><br><span class="line">															<span class="comment">//	Default =&gt; 0xC0</span></span><br><span class="line">															<span class="comment">//	0xC0 (0x00) =&gt; Scan from COM0 to 63</span></span><br><span class="line">															<span class="comment">//	0xC8 (0x08) =&gt; Scan from COM63 to 0</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">SetDisplayOffset</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> d)</span></span><br><span class="line">&#123;</span><br><span class="line">	WriteCommand(<span class="number">0xD3</span>);					<span class="comment">// Set Display Offset</span></span><br><span class="line">	WriteCommand(d);						<span class="comment">//   Default =&gt; 0x00</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">SetDisplayClock</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> d)</span></span><br><span class="line">&#123;</span><br><span class="line">	WriteCommand(<span class="number">0xD5</span>);					<span class="comment">// Set Display Clock Divide Ratio / Oscillator Frequency</span></span><br><span class="line">	WriteCommand(d);						<span class="comment">//	Default =&gt; 0x80</span></span><br><span class="line">															<span class="comment">//	D[3:0] =&gt; Display Clock Divider</span></span><br><span class="line">															<span class="comment">//	D[7:4] =&gt; Oscillator Frequency</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">SetPrechargePeriod</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> d)</span></span><br><span class="line">&#123;</span><br><span class="line">	WriteCommand(<span class="number">0xD9</span>);					<span class="comment">// Set Pre-Charge Period</span></span><br><span class="line">	WriteCommand(d);						<span class="comment">//	Default =&gt; 0x22 (2 Display Clocks [Phase 2] / 2 Display Clocks [Phase 1])</span></span><br><span class="line">															<span class="comment">//	D[3:0] =&gt; Phase 1 Period in 1~15 Display Clocks</span></span><br><span class="line">															<span class="comment">//	D[7:4] =&gt; Phase 2 Period in 1~15 Display Clocks</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">SetCommonConfig</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> d)</span></span><br><span class="line">&#123;</span><br><span class="line">	WriteCommand(<span class="number">0xDA</span>);					<span class="comment">// Set COM Pins Hardware Configuration</span></span><br><span class="line">	WriteCommand(<span class="number">0x02</span>|d);				<span class="comment">//	Default =&gt; 0x12 (0x10)</span></span><br><span class="line">															<span class="comment">//	Alternative COM Pin Configuration</span></span><br><span class="line">															<span class="comment">//	Disable COM Left/Right Re-Map</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">SetVCOMH</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> d)</span></span><br><span class="line">&#123;</span><br><span class="line">	WriteCommand(<span class="number">0xDB</span>);					<span class="comment">// Set VCOMH Deselect Level</span></span><br><span class="line">	WriteCommand(d);						<span class="comment">//   Default =&gt; 0x20 (0.77*VCC)</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">SetNOP</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">	WriteCommand(<span class="number">0xE3</span>);					<span class="comment">// Command for No Operation</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/******************************************************************************/</span></span><br><span class="line"><span class="comment">/*  Global Variables                                                          */</span></span><br><span class="line"><span class="comment">/******************************************************************************/</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> XLevelL		0x00</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> XLevelH		0x10</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> XLevel		((XLevelH&amp;0x0F)*16+XLevelL)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> Max_Column	128</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> Max_Row		64</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>	Brightness	0xCF</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">/******************************************************************************/</span></span><br><span class="line"><span class="comment">/*  Show Regular Pattern (Full Screen)                                        */</span></span><br><span class="line"><span class="comment">/******************************************************************************/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">FillRAM</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> Data)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> i,j;</span><br><span class="line"> </span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">8</span>;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		SetStartPage(i);</span><br><span class="line">		SetStartColumn(<span class="number">0x00</span>);</span><br><span class="line"> </span><br><span class="line">		<span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;<span class="number">128</span>;j++)</span><br><span class="line">		&#123;</span><br><span class="line">			WriteData(Data);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/******************************************************************************/</span></span><br><span class="line"><span class="comment">/*  OLED API                                                                  */</span></span><br><span class="line"><span class="comment">/******************************************************************************/</span></span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">oled_init</span><span class="params">(<span class="type">void</span>)</span>							<span class="comment">// VCC Generated by Internal DC/DC Circuit</span></span><br><span class="line">&#123;</span><br><span class="line">	LPC_SYSCON-&gt;SYSAHBCLKCTRL |= <span class="number">1</span>&lt;&lt;<span class="number">16</span>;<span class="comment">//只要是复用引脚就得打开IOCON时钟</span></span><br><span class="line">	</span><br><span class="line">	spi_init(<span class="number">0</span>, <span class="number">100000</span>, <span class="number">0</span>);</span><br><span class="line">	</span><br><span class="line">	LPC_GPIO2-&gt;DIR |= <span class="number">1</span> &lt;&lt; <span class="number">5</span>;</span><br><span class="line"> </span><br><span class="line">	SetDisplayOnOff(<span class="number">0x00</span>);					<span class="comment">// Display Off (0x00/0x01)</span></span><br><span class="line">	SetDisplayClock(<span class="number">0x80</span>);					<span class="comment">// Set Clock as 100 Frames/Sec</span></span><br><span class="line">	SetMultiplexRatio(<span class="number">0x3F</span>);				<span class="comment">// 1/64 Duty (0x0F~0x3F)</span></span><br><span class="line">	SetDisplayOffset(<span class="number">0x00</span>);					<span class="comment">// Shift Mapping RAM Counter (0x00~0x3F)</span></span><br><span class="line">	SetStartLine(<span class="number">0x00</span>);							<span class="comment">// Set Mapping RAM Display Start Line (0x00~0x3F)</span></span><br><span class="line">	SetChargePump(<span class="number">0x04</span>);						<span class="comment">// Enable Embedded DC/DC Converter (0x00/0x04)</span></span><br><span class="line">	SetAddressingMode(<span class="number">0x02</span>);				<span class="comment">// Set Page Addressing Mode (0x00/0x01/0x02)</span></span><br><span class="line">	SetSegmentRemap(<span class="number">0x01</span>);					<span class="comment">// Set SEG/Column Mapping (0x00/0x01)</span></span><br><span class="line">	SetCommonRemap(<span class="number">0x08</span>);						<span class="comment">// Set COM/Row Scan Direction (0x00/0x08)</span></span><br><span class="line">	SetCommonConfig(<span class="number">0x10</span>);					<span class="comment">// Set Sequential Configuration (0x00/0x10)</span></span><br><span class="line">	SetContrastControl(Brightness);	<span class="comment">// Set SEG Output Current</span></span><br><span class="line">	SetPrechargePeriod(<span class="number">0xF1</span>);				<span class="comment">// Set Pre-Charge as 15 Clocks &amp; Discharge as 1 Clock</span></span><br><span class="line">	SetVCOMH(<span class="number">0x40</span>);									<span class="comment">// Set VCOM Deselect Level</span></span><br><span class="line">	SetEntireDisplay(<span class="number">0x00</span>);					<span class="comment">// Disable Entire Display On (0x00/0x01)</span></span><br><span class="line">	SetInverseDisplay(<span class="number">0x00</span>);				<span class="comment">// Disable Inverse Display On (0x00/0x01)</span></span><br><span class="line"> </span><br><span class="line">	FillRAM(<span class="number">0x00</span>);									<span class="comment">// Clear Screen</span></span><br><span class="line"> </span><br><span class="line">	SetDisplayOnOff(<span class="number">0x01</span>);					<span class="comment">// Display On (0x00/0x01)</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">oled_clear_screen</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">  FillRAM(<span class="number">0x00</span>);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/*******************************************************************************</span></span><br><span class="line"><span class="comment">* Function Name  : oled_disp_char</span></span><br><span class="line"><span class="comment">* Description    : Displays a char on the OLED.</span></span><br><span class="line"><span class="comment">* Input          : - Line: the Line where to display the character shape .</span></span><br><span class="line"><span class="comment">*                    This parameter can be one of the following values:</span></span><br><span class="line"><span class="comment">*                       - Linex: where x can be 0..7</span></span><br><span class="line"><span class="comment">*                  - Column: start column address.</span></span><br><span class="line"><span class="comment">*                  - Color: display color</span></span><br><span class="line"><span class="comment">*                       - 0: dot is yellow or blue</span></span><br><span class="line"><span class="comment">*                       - 1: dot is black</span></span><br><span class="line"><span class="comment">*                  - c: character ascii code, must be between 0x20 and 0x7E.</span></span><br><span class="line"><span class="comment">* Output         : None</span></span><br><span class="line"><span class="comment">* Return         : None</span></span><br><span class="line"><span class="comment">*******************************************************************************/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">oled_disp_char</span><span class="params">(<span class="type">uint8_t</span> Line, <span class="type">uint16_t</span> Column, <span class="type">uint8_t</span> Color, <span class="type">char</span> c)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">uint8_t</span>	*Src_Pointer;</span><br><span class="line">	<span class="type">uint8_t</span>	i;</span><br><span class="line"> </span><br><span class="line">	Src_Pointer = (<span class="type">unsigned</span> <span class="type">char</span> *)&amp;ASCII[c - <span class="number">32</span>][<span class="number">0</span>];</span><br><span class="line"> </span><br><span class="line">	SetStartPage(Line);</span><br><span class="line">	<span class="keyword">if</span>(Column == <span class="number">0</span>) &#123;</span><br><span class="line">		SetStartColumn(<span class="number">0</span>);</span><br><span class="line">		<span class="keyword">if</span>(Color == <span class="number">0</span>)</span><br><span class="line">			WriteData(<span class="number">0x00</span>);</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">			WriteData(<span class="number">0xff</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	SetStartColumn(Column+<span class="number">1</span>);</span><br><span class="line"> </span><br><span class="line">  <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line">		<span class="keyword">if</span>(Color == <span class="number">0</span>)</span><br><span class="line">			WriteData(*Src_Pointer);</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">			WriteData(~(*Src_Pointer));</span><br><span class="line">		Src_Pointer ++;</span><br><span class="line">	&#125;</span><br><span class="line"> </span><br><span class="line">	<span class="keyword">if</span>(Color == <span class="number">0</span>)</span><br><span class="line">		WriteData(<span class="number">0x00</span>);</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		WriteData(<span class="number">0xff</span>);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/*******************************************************************************</span></span><br><span class="line"><span class="comment">* Function Name  : oled_disp_string</span></span><br><span class="line"><span class="comment">* Description    : Displays a maximum of 21 char on the OLED.</span></span><br><span class="line"><span class="comment">* Input          : - Line: the Line where to display the character shape .</span></span><br><span class="line"><span class="comment">*                    This parameter can be one of the following values:</span></span><br><span class="line"><span class="comment">*                       - Linex: where x can be 0..9</span></span><br><span class="line"><span class="comment">*                  - Color: display color</span></span><br><span class="line"><span class="comment">*                       - 0: dot is yellow or blue</span></span><br><span class="line"><span class="comment">*                       - 1: dot is black</span></span><br><span class="line"><span class="comment">*                  - *ptr: pointer to string to display on LCD.</span></span><br><span class="line"><span class="comment">* Output         : None</span></span><br><span class="line"><span class="comment">* Return         : None</span></span><br><span class="line"><span class="comment">*******************************************************************************/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">oled_disp_string</span><span class="params">(<span class="type">uint8_t</span> Line, <span class="type">uint8_t</span> Color, <span class="type">char</span> *ptr)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">uint16_t</span> refcolumn = <span class="number">0</span>;</span><br><span class="line"> </span><br><span class="line">  <span class="keyword">if</span>(Line &lt; <span class="number">8</span>) &#123;</span><br><span class="line">		<span class="keyword">while</span> ((*ptr != <span class="number">0</span>) &amp; (((refcolumn + <span class="number">1</span>) &amp; <span class="number">0xFFFF</span>) &lt; <span class="number">128</span>)) &#123;</span><br><span class="line">			oled_disp_char(Line, refcolumn, Color, *ptr);</span><br><span class="line">			refcolumn += <span class="number">6</span>;</span><br><span class="line">			ptr++;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br></pre></td></tr></table></figure>

<h2 id="串口驱动"><a href="#串口驱动" class="headerlink" title="串口驱动"></a>串口驱动</h2><p>uart.h</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> __UART__</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __UART__</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">uart_init</span><span class="params">(<span class="type">void</span>)</span>;  </span><br><span class="line"><span class="type">int</span> <span class="title function_">uart_send</span><span class="params">(<span class="type">char</span> c)</span>;</span><br><span class="line"><span class="type">char</span> <span class="title function_">uart_recv</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure>

<p>uart.c</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;LPC11xx.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;uart.h&quot;</span></span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">uart_init</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">	LPC_SYSCON-&gt;SYSAHBCLKCTRL |= <span class="number">1</span>&lt;&lt;<span class="number">16</span>;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">	LPC_IOCON-&gt;PIO1_6 &amp;= ~<span class="number">0x07</span>;    <span class="comment">/*  UART I/O config */</span></span><br><span class="line">	LPC_IOCON-&gt;PIO1_6 |= <span class="number">0x01</span>;     <span class="comment">/* UART RXD */</span></span><br><span class="line">	LPC_IOCON-&gt;PIO1_7 &amp;= ~<span class="number">0x07</span>;	</span><br><span class="line">	LPC_IOCON-&gt;PIO1_7 |= <span class="number">0x01</span>;     <span class="comment">/* UART TXD */</span></span><br><span class="line"> </span><br><span class="line">	<span class="comment">/* Enable UART clock */</span></span><br><span class="line">	LPC_SYSCON-&gt;SYSAHBCLKCTRL |= (<span class="number">1</span>&lt;&lt;<span class="number">12</span>);</span><br><span class="line">	LPC_SYSCON-&gt;UARTCLKDIV = <span class="number">0x1</span>;     </span><br><span class="line"> </span><br><span class="line">	LPC_UART-&gt;LCR = <span class="number">0x83</span>;             <span class="comment">/* 8 bits, no Parity, 1 Stop bit */</span></span><br><span class="line">	</span><br><span class="line">	LPC_UART-&gt;DLM = <span class="number">0</span>;</span><br><span class="line">	LPC_UART-&gt;DLL = <span class="number">16</span>;</span><br><span class="line">	LPC_UART-&gt;FDR = <span class="number">0x85</span>;</span><br><span class="line">	<span class="comment">//</span></span><br><span class="line">	LPC_UART-&gt;LCR = <span class="number">0x03</span>;		<span class="comment">/* DLAB = 0 */</span></span><br><span class="line">	LPC_UART-&gt;TER = <span class="number">1</span>&lt;&lt;<span class="number">7</span>;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">int</span> <span class="title function_">uart_send</span><span class="params">(<span class="type">char</span> c)</span></span><br><span class="line">&#123;</span><br><span class="line">	LPC_UART-&gt;THR = c;</span><br><span class="line">	<span class="keyword">while</span> (!(LPC_UART-&gt;LSR &amp; (<span class="number">1</span> &lt;&lt; <span class="number">5</span>)))&#123;</span><br><span class="line">		;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> c;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">char</span> <span class="title function_">uart_recv</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">while</span> (!(LPC_UART-&gt;LSR &amp; (<span class="number">1</span> &lt;&lt; <span class="number">0</span>)))&#123;</span><br><span class="line">		;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> LPC_UART-&gt;RBR;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">int</span> <span class="title function_">fputc</span><span class="params">(<span class="type">int</span> ch, FILE *f)</span> </span><br><span class="line">&#123;	</span><br><span class="line">	<span class="keyword">return</span> uart_send(ch);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">int</span> <span class="title function_">fgetc</span><span class="params">(FILE *f)</span> </span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">return</span> uart_recv();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="RFID模块驱动"><a href="#RFID模块驱动" class="headerlink" title="RFID模块驱动"></a>RFID模块驱动</h2><p>rfid.h</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> __RFID_H__</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __RFID_H__</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">extern</span> <span class="type">unsigned</span> <span class="type">char</span> buf[<span class="number">32</span>];</span><br><span class="line"><span class="type">void</span> <span class="title function_">rfid_init</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"><span class="type">int</span> <span class="title function_">rfid_state</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">rfid_read</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"><span class="type">int</span> <span class="title function_">rfid_write</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> *wbuf)</span>;</span><br><span class="line"> </span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br></pre></td></tr></table></figure>

<p>rfid.c</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;spi.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;LPC11xx.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;uart.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;stdio.h&quot;</span></span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> buf[<span class="number">32</span>];</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">delay</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> loop)</span>;</span><br><span class="line"> </span><br><span class="line"><span class="type">const</span> <span class="type">unsigned</span> <span class="type">char</span> RFID_READ_DATA_BLOCK_21[<span class="number">10</span>]  = &#123;<span class="number">0x0a</span>, <span class="number">0x21</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0xff</span>, <span class="number">0xff</span>, <span class="number">0xff</span>, <span class="number">0xff</span>, <span class="number">0xff</span>, <span class="number">0xff</span>&#125;;</span><br><span class="line"><span class="type">const</span> <span class="type">unsigned</span> <span class="type">char</span> RFID_WRITE_DATA_BLOCK_22[<span class="number">10</span>] = &#123;<span class="number">0x1a</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0xff</span>, <span class="number">0xff</span>, <span class="number">0xff</span>, <span class="number">0xff</span>, <span class="number">0xff</span>, <span class="number">0xff</span>&#125;; </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="type">static</span> <span class="type">void</span> <span class="title function_">delay</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> loop)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">int</span> i;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">while</span> (loop--) &#123;</span><br><span class="line">		<span class="keyword">for</span> (i = <span class="number">10000</span>; i &gt; <span class="number">0</span>; i--);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment">/**************************</span></span><br><span class="line"><span class="comment">	rfid初始化</span></span><br><span class="line"><span class="comment">**************************/</span></span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">rfid_init</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">	</span><br><span class="line">	LPC_SYSCON-&gt;SYSAHBCLKCTRL |= <span class="number">1</span> &lt;&lt; <span class="number">16</span>;</span><br><span class="line">	SystemCoreClockUpdate();</span><br><span class="line">	SysTick_Config(SystemCoreClock / <span class="number">500</span>);</span><br><span class="line">	</span><br><span class="line"> </span><br><span class="line">	spi_init(<span class="number">0</span>, <span class="number">100000</span>, <span class="number">0</span>);</span><br><span class="line">	</span><br><span class="line">	LPC_GPIO2-&gt;DIR &amp;= ~(<span class="number">1</span> &lt;&lt; <span class="number">8</span>);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment">/************************</span></span><br><span class="line"><span class="comment">	rfid检测卡片函数</span></span><br><span class="line"><span class="comment">************************/</span></span><br><span class="line"> </span><br><span class="line"><span class="type">int</span> <span class="title function_">rfid_state</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">static</span> <span class="type">unsigned</span> <span class="type">int</span> pre = <span class="number">1</span>, cur = <span class="number">1</span>;</span><br><span class="line">	</span><br><span class="line">	cur = (LPC_GPIO2-&gt;DATA &gt;&gt; <span class="number">8</span>) &amp; <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">if</span> (cur != pre &amp;&amp; pre == <span class="number">1</span>) &#123;</span><br><span class="line">		pre = cur;</span><br><span class="line">		<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		pre = cur;</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> <span class="title function_">rfid_checksum</span><span class="params">(<span class="type">const</span> <span class="type">unsigned</span> <span class="type">char</span> *buf)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">int</span> i;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> chksum = <span class="number">0</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; buf[<span class="number">0</span>]; i++)</span><br><span class="line">		chksum += buf[i];</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> chksum;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment">/**********************</span></span><br><span class="line"><span class="comment">	rfid读取函数（修改简易版）</span></span><br><span class="line"><span class="comment">	原来的函数用不了，就和</span></span><br><span class="line"><span class="comment">	STM32cubeIDE一个德行</span></span><br><span class="line"><span class="comment">**********************/</span></span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">rfid_read</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">int</span> i;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> chksum = rfid_checksum(RFID_READ_DATA_BLOCK_21);</span><br><span class="line"> </span><br><span class="line">	spi_send(<span class="number">0</span>, RFID, <span class="number">0xAA</span>);</span><br><span class="line">	delay(<span class="number">10</span>);</span><br><span class="line">	spi_send(<span class="number">0</span>, RFID, <span class="number">0xBB</span>);</span><br><span class="line">	delay(<span class="number">10</span>);</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; RFID_READ_DATA_BLOCK_21[<span class="number">0</span>]; i++) &#123;</span><br><span class="line">		spi_send(<span class="number">0</span>, RFID, RFID_READ_DATA_BLOCK_21[i]);</span><br><span class="line">		delay(<span class="number">10</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	spi_send(<span class="number">0</span>, RFID, chksum);</span><br><span class="line">	</span><br><span class="line">	delay(<span class="number">500</span>);</span><br><span class="line">	</span><br><span class="line">	spi_send(<span class="number">0</span>, RFID, <span class="number">0xAA</span>);</span><br><span class="line">	delay(<span class="number">10</span>);</span><br><span class="line">	spi_send(<span class="number">0</span>, RFID, <span class="number">0xBB</span>);</span><br><span class="line">	delay(<span class="number">10</span>);</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">19</span>; i++) &#123;</span><br><span class="line">		buf[i] = spi_send(<span class="number">0</span>, RFID, <span class="number">0</span>);</span><br><span class="line">		delay(<span class="number">10</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line"><span class="comment">//	chksum = rfid_checksum(buf);</span></span><br><span class="line"><span class="comment">//	if (chksum != buf[buf[0]])</span></span><br><span class="line"><span class="comment">//		return -1;</span></span><br><span class="line"><span class="comment">//	else &#123;</span></span><br><span class="line"><span class="comment">//		memcpy(rbuf, buf + 2, 16);</span></span><br><span class="line"><span class="comment">//		return 0;</span></span><br><span class="line"><span class="comment">//	&#125;</span></span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line"> </span><br><span class="line"><span class="comment">/****************************</span></span><br><span class="line"><span class="comment">	注释代码经过使用串口设置断点得知，会使得程序进入死循环，具体原因不明</span></span><br><span class="line"><span class="comment">	并且，全部代码在使用指针返回读取到的ID卡号时，串口没法打印，OLED没法显</span></span><br><span class="line"><span class="comment">	示，所以采用全局变量，并在头文件中用extern修饰。调用方式如下：</span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment">	int rfid_read(unsigned char *rbuf)</span></span><br><span class="line"><span class="comment">	&#123;</span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment">		.......................</span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment">	&#125;</span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment">	int main（）</span></span><br><span class="line"><span class="comment">	&#123;</span></span><br><span class="line"><span class="comment">		unsigned char *rbuf;</span></span><br><span class="line"><span class="comment">		int state；</span></span><br><span class="line"><span class="comment">		rfid_init();</span></span><br><span class="line"><span class="comment">		uartinit();</span></span><br><span class="line"><span class="comment">		while(1)</span></span><br><span class="line"><span class="comment">		&#123;</span></span><br><span class="line"><span class="comment">			if(rfid_state())</span></span><br><span class="line"><span class="comment">			&#123;</span></span><br><span class="line"><span class="comment">				printf(&quot;找到卡片&quot;)；</span></span><br><span class="line"><span class="comment">				state=rfid_read(buf);</span></span><br><span class="line"><span class="comment">				if(staate==0)</span></span><br><span class="line"><span class="comment">				printf(&quot;%s&quot;,buf);</span></span><br><span class="line"><span class="comment">				else if(state===-1)</span></span><br><span class="line"><span class="comment">				printf(&quot;读取失败&quot;)；</span></span><br><span class="line"><span class="comment">			&#125;</span></span><br><span class="line"><span class="comment">		&#125;</span></span><br><span class="line"><span class="comment">	&#125;</span></span><br><span class="line"><span class="comment">在显示找到卡片后，代码就处于一个停止状态。</span></span><br><span class="line"><span class="comment">上述代码的正常运行情况应该是，在显示找到卡片之后</span></span><br><span class="line"><span class="comment">如果读取成功就通过串口打印ID，失败就打印，读取失败</span></span><br><span class="line"><span class="comment">，并且是循环打印，但是，这东西是直接死机了。硬件问题</span></span><br><span class="line"><span class="comment">硬件问题</span></span><br><span class="line"><span class="comment">****************************/</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment">/********************************</span></span><br><span class="line"><span class="comment">	写函数</span></span><br><span class="line"><span class="comment">（</span></span><br><span class="line"><span class="comment">	向ID卡写入数据，通过这个函数；</span></span><br><span class="line"><span class="comment">	可以将ID卡读取的信息进行改变;</span></span><br><span class="line"><span class="comment">	比如，我们可以将我们所使用的;</span></span><br><span class="line"><span class="comment">	money：100修改为，I am cool man;</span></span><br><span class="line"><span class="comment">	unsigned char *str=&quot;I am cool man&quot;</span></span><br><span class="line"><span class="comment">	rfid_write(str);</span></span><br><span class="line"><span class="comment">）</span></span><br><span class="line"><span class="comment">********************************/</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">rfid_write</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> *wbuf)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">int</span> i;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> chksum;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> buf[<span class="number">32</span>];</span><br><span class="line"> </span><br><span class="line">	<span class="built_in">memcpy</span>(buf, RFID_WRITE_DATA_BLOCK_22, <span class="number">10</span>);</span><br><span class="line">	<span class="built_in">memcpy</span>(buf + <span class="number">10</span>, wbuf, <span class="number">16</span>);</span><br><span class="line">	chksum = rfid_checksum(buf);</span><br><span class="line"> </span><br><span class="line">	spi_send(<span class="number">0</span>, RFID, <span class="number">0xAA</span>);</span><br><span class="line">	delay(<span class="number">10</span>);</span><br><span class="line">	spi_send(<span class="number">0</span>, RFID, <span class="number">0xBB</span>);</span><br><span class="line">	delay(<span class="number">10</span>);</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; buf[<span class="number">0</span>]; i++) &#123;</span><br><span class="line">		spi_send(<span class="number">0</span>, RFID, buf[i]);</span><br><span class="line">		delay(<span class="number">10</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	spi_send(<span class="number">0</span>, RFID, chksum);</span><br><span class="line">	</span><br><span class="line">	delay(<span class="number">500</span>);</span><br><span class="line">	</span><br><span class="line">	spi_send(<span class="number">0</span>, RFID, <span class="number">0xAA</span>);</span><br><span class="line">	delay(<span class="number">10</span>);</span><br><span class="line">	spi_send(<span class="number">0</span>, RFID, <span class="number">0xBB</span>);</span><br><span class="line">	delay(<span class="number">10</span>);</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++) &#123;</span><br><span class="line">		buf[i] = spi_send(<span class="number">0</span>, RFID, <span class="number">0</span>);</span><br><span class="line">		delay(<span class="number">10</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> (buf[<span class="number">0</span>] != <span class="number">3</span> || buf[<span class="number">1</span>] != <span class="number">0x22</span>)</span><br><span class="line">		<span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">SysTick_Handler</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br></pre></td></tr></table></figure>

<h2 id="光强传感器驱动"><a href="#光强传感器驱动" class="headerlink" title="光强传感器驱动"></a>光强传感器驱动</h2><p>i2c.h</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> __I2C_H__</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __I2C_H__</span></span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">i2c_init</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"><span class="type">int</span> <span class="title function_">i2c_write</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> addr, <span class="type">unsigned</span> <span class="type">char</span> reg, <span class="type">unsigned</span> <span class="type">char</span> *buf, <span class="type">int</span> len)</span>;</span><br><span class="line"><span class="type">int</span> <span class="title function_">i2c_read</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> addr, <span class="type">unsigned</span> <span class="type">char</span> reg, <span class="type">unsigned</span> <span class="type">char</span> *buf, <span class="type">int</span> len)</span>;</span><br><span class="line"> </span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure>

<p>i2c.c</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdbool.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;LPC11xx.h&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="type">bool</span> <span class="title function_">i2c_start</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"><span class="type">bool</span> <span class="title function_">i2c_stop</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">i2c_init</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">	LPC_SYSCON-&gt;PRESETCTRL |= <span class="number">1</span> &lt;&lt; <span class="number">1</span>;</span><br><span class="line">	LPC_SYSCON-&gt;SYSAHBCLKCTRL |= <span class="number">1</span> &lt;&lt; <span class="number">5</span>;</span><br><span class="line">	</span><br><span class="line">	LPC_IOCON-&gt;PIO0_4 = <span class="number">0x01</span>;</span><br><span class="line">	LPC_IOCON-&gt;PIO0_5 = <span class="number">0x01</span>;</span><br><span class="line">	LPC_I2C-&gt;SCLH = <span class="number">480</span>;</span><br><span class="line">	LPC_I2C-&gt;SCLL = <span class="number">480</span>;</span><br><span class="line">	LPC_I2C-&gt;CONCLR |= (<span class="number">1</span> &lt;&lt; <span class="number">2</span>) | (<span class="number">1</span> &lt;&lt; <span class="number">3</span>) | (<span class="number">1</span> &lt;&lt; <span class="number">5</span>) | (<span class="number">1</span> &lt;&lt; <span class="number">6</span>);</span><br><span class="line">	LPC_I2C-&gt;CONSET |= (<span class="number">1</span> &lt;&lt; <span class="number">6</span>);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">bool</span> <span class="title function_">i2c_start</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">	LPC_I2C-&gt;CONSET = (<span class="number">1</span> &lt;&lt; <span class="number">5</span>);							<span class="comment">/* START */</span></span><br><span class="line">	<span class="keyword">while</span> (!(LPC_I2C-&gt;CONSET &amp; (<span class="number">1</span> &lt;&lt; <span class="number">3</span>)));	<span class="comment">/* wait interrupt */</span></span><br><span class="line">	<span class="keyword">if</span> (LPC_I2C-&gt;STAT != <span class="number">0x08</span> &amp;&amp; LPC_I2C-&gt;STAT != <span class="number">0x10</span>) &#123;</span><br><span class="line">		i2c_stop();</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">bool</span> <span class="title function_">i2c_stop</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">	LPC_I2C-&gt;CONSET = (<span class="number">1</span> &lt;&lt; <span class="number">4</span>);							<span class="comment">/* Set Stop flag */</span> </span><br><span class="line">  LPC_I2C-&gt;CONCLR = (<span class="number">1</span> &lt;&lt; <span class="number">3</span>);							<span class="comment">/* Clear SI flag */</span> </span><br><span class="line">  <span class="keyword">while</span>(LPC_I2C-&gt;CONSET &amp; (<span class="number">1</span> &lt;&lt; <span class="number">4</span>));			<span class="comment">/* Wait for STOP detected */</span></span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">bool</span> <span class="title function_">i2c_send_sla</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> addr)</span></span><br><span class="line">&#123;</span><br><span class="line">	LPC_I2C-&gt;DAT = addr;</span><br><span class="line">	LPC_I2C-&gt;CONCLR = (<span class="number">1</span> &lt;&lt; <span class="number">5</span>) | (<span class="number">1</span> &lt;&lt; <span class="number">3</span>);	<span class="comment">/* clear interrupt and sta */</span></span><br><span class="line">	<span class="keyword">while</span> (!(LPC_I2C-&gt;CONSET &amp; (<span class="number">1</span> &lt;&lt; <span class="number">3</span>)));	<span class="comment">/* wait interrupt */</span></span><br><span class="line">	<span class="keyword">if</span> (LPC_I2C-&gt;STAT != <span class="number">0x18</span> &amp;&amp; LPC_I2C-&gt;STAT != <span class="number">0x40</span>) &#123;</span><br><span class="line">		i2c_stop();</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	&#125; <span class="keyword">else</span></span><br><span class="line">		<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">bool</span> <span class="title function_">i2c_send_dat</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> dat)</span></span><br><span class="line">&#123;</span><br><span class="line">	LPC_I2C-&gt;DAT = dat;</span><br><span class="line">	LPC_I2C-&gt;CONCLR = (<span class="number">1</span> &lt;&lt; <span class="number">5</span>) | (<span class="number">1</span> &lt;&lt; <span class="number">3</span>);	<span class="comment">/* clear interrupt and sta */</span></span><br><span class="line">	<span class="keyword">while</span> (!(LPC_I2C-&gt;CONSET &amp; (<span class="number">1</span> &lt;&lt; <span class="number">3</span>)));	<span class="comment">/* wait interrupt */</span></span><br><span class="line">	<span class="keyword">if</span> (LPC_I2C-&gt;STAT != <span class="number">0x28</span>) &#123;</span><br><span class="line">		i2c_stop();</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	&#125; <span class="keyword">else</span></span><br><span class="line">		<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">bool</span> <span class="title function_">i2c_recv_dat</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> *dat, <span class="type">bool</span> ack)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">if</span> (!ack)</span><br><span class="line">		LPC_I2C-&gt;CONCLR = <span class="number">1</span> &lt;&lt; <span class="number">2</span>;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		LPC_I2C-&gt;CONSET = <span class="number">1</span> &lt;&lt; <span class="number">2</span>;</span><br><span class="line">	LPC_I2C-&gt;CONCLR = <span class="number">1</span> &lt;&lt; <span class="number">3</span>;</span><br><span class="line">	<span class="keyword">while</span> (!(LPC_I2C-&gt;CONSET &amp; (<span class="number">1</span> &lt;&lt; <span class="number">3</span>)));	<span class="comment">/* wait interrupt */</span></span><br><span class="line">	<span class="keyword">if</span> (LPC_I2C-&gt;STAT != <span class="number">0x50</span> &amp;&amp; LPC_I2C-&gt;STAT != <span class="number">0x58</span>) &#123;</span><br><span class="line">		i2c_stop();</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	*dat = LPC_I2C-&gt;DAT;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">int</span> <span class="title function_">i2c_write</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> addr, <span class="type">unsigned</span> <span class="type">char</span> reg, <span class="type">unsigned</span> <span class="type">char</span> *buf, <span class="type">int</span> len)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">int</span> i;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/* 1. transmit a START condition */</span></span><br><span class="line">	<span class="keyword">if</span> (!i2c_start())</span><br><span class="line">		<span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line"> </span><br><span class="line">	<span class="comment">/* 2. send slave address */</span></span><br><span class="line">	<span class="keyword">if</span> (!i2c_send_sla(addr &lt;&lt; <span class="number">1</span>))</span><br><span class="line">		<span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line"> </span><br><span class="line">	<span class="comment">/* 3. send register address */</span></span><br><span class="line">	<span class="keyword">if</span> (!i2c_send_dat(reg))</span><br><span class="line">		<span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/* 4. send data */</span></span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">		<span class="keyword">if</span> (!i2c_send_dat(buf[i]))</span><br><span class="line">			<span class="keyword">return</span> i;</span><br><span class="line">	&#125;</span><br><span class="line"> </span><br><span class="line">	<span class="comment">/* 5. generate stop */</span></span><br><span class="line">	i2c_stop();</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> len;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">int</span> <span class="title function_">i2c_read</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> addr, <span class="type">unsigned</span> <span class="type">char</span> reg, <span class="type">unsigned</span> <span class="type">char</span> *buf, <span class="type">int</span> len)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">int</span> i = len;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/* 1. transmit a START condition */</span></span><br><span class="line">	<span class="keyword">if</span> (!i2c_start())</span><br><span class="line">		<span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line"> </span><br><span class="line">	<span class="comment">/* 2. send slave address */</span></span><br><span class="line">	<span class="keyword">if</span> (!i2c_send_sla(addr &lt;&lt; <span class="number">1</span>))</span><br><span class="line">		<span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line"> </span><br><span class="line">	<span class="comment">/* 3. send register address */</span></span><br><span class="line">	<span class="keyword">if</span> (!i2c_send_dat(reg))</span><br><span class="line">		<span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/* 4. nonstandard */</span></span><br><span class="line">	i2c_stop();</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/* 5. transmit a START condition */</span></span><br><span class="line">	<span class="keyword">if</span> (!i2c_start())</span><br><span class="line">		<span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line"> </span><br><span class="line">	<span class="comment">/* 5. send slave address */</span></span><br><span class="line">	<span class="keyword">if</span> (!i2c_send_sla((addr &lt;&lt; <span class="number">1</span>) | <span class="number">1</span>))</span><br><span class="line">		<span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/* 6. receive data */</span></span><br><span class="line">	<span class="keyword">while</span> (i) &#123;</span><br><span class="line">		<span class="keyword">if</span> (i == <span class="number">1</span>) &#123;</span><br><span class="line">			<span class="keyword">if</span> (!i2c_recv_dat(buf + len - i, <span class="literal">false</span>))</span><br><span class="line">				<span class="keyword">return</span> len - i;</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="keyword">if</span> (!i2c_recv_dat(buf + len - i, <span class="literal">true</span>))</span><br><span class="line">				<span class="keyword">return</span> len - i;</span><br><span class="line">		&#125;</span><br><span class="line">		i--;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/* 7. transmit a STOP condition */</span></span><br><span class="line">	i2c_stop();</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> len;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>light.h</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> __LIGHT_H__</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __LIGHT_H__</span></span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">light_init</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">short</span> <span class="title function_">light_get</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">light_set_thr</span><span class="params">(<span class="type">unsigned</span> <span class="type">short</span> thrhi, <span class="type">unsigned</span> <span class="type">short</span> thrlo)</span>;</span><br><span class="line"> </span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure>

<p>light.c</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;i2c.h&quot;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ISL29003_ADDR	0x44</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> COMMAND				0</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> CONTROL				1</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> THRHI					2</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> THRLO					3</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> LUXLSB				4</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> LUXMSB				5</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> TMRLSB				6</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> TMRMSB				7</span></span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">light_init</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	 * 2^16 cycles, Diode1&#x27;s current to unsigned 16-bit data, </span></span><br><span class="line"><span class="comment">	 * Integration is internally timed, Normal operation, enable ADC-core</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> cmd = (<span class="number">1</span> &lt;&lt; <span class="number">7</span>);</span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	 * 0 to 64000 lux, </span></span><br><span class="line"><span class="comment">	 * Interrupt is triggered after 8 integration cycles</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> ctl = (<span class="number">3</span> &lt;&lt; <span class="number">2</span>) | (<span class="number">2</span> &lt;&lt; <span class="number">0</span>);</span><br><span class="line">	</span><br><span class="line">	i2c_init();</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	i2c_write(ISL29003_ADDR, COMMAND, &amp;cmd, <span class="number">1</span>);</span><br><span class="line">	i2c_write(ISL29003_ADDR, CONTROL, &amp;ctl, <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">unsigned</span> <span class="type">short</span> <span class="title function_">light_get</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">short</span> lux;</span><br><span class="line">	</span><br><span class="line">	i2c_read(ISL29003_ADDR, LUXLSB, (<span class="type">unsigned</span> <span class="type">char</span> *)&amp;lux, <span class="number">2</span>);</span><br><span class="line"> </span><br><span class="line">	<span class="keyword">return</span> lux;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">light_set_thr</span><span class="params">(<span class="type">unsigned</span> <span class="type">short</span> thrhi, <span class="type">unsigned</span> <span class="type">short</span> thrlo)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> buf[<span class="number">2</span>];</span><br><span class="line"> </span><br><span class="line">	buf[<span class="number">0</span>] = thrhi &gt;&gt; <span class="number">8</span>;</span><br><span class="line">	buf[<span class="number">1</span>] = thrlo &gt;&gt; <span class="number">8</span>;</span><br><span class="line">	i2c_write(ISL29003_ADDR, COMMAND, buf, <span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>用这个开发板的应该是在参加华清远见的实训或者学校采购了华清远见的开发板。各位好运。</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_54052950/article/details/130534961">原文链接</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://suyiharris.github.io/2023/10/24/2023-10-24-LPC11C14%E5%88%B7%E5%8D%A1%E9%97%A8%E9%94%81/" data-id="clo4h2l3x000qnso90fw82m3a" data-title="LPC11C14刷卡门锁" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-2023-10-24-SpringCloud-Netflix" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/10/24/2023-10-24-SpringCloud-Netflix/" class="article-date">
  <time class="dt-published" datetime="2023-10-24T04:12:12.000Z" itemprop="datePublished">2023-10-24</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2023/10/24/2023-10-24-SpringCloud-Netflix/">SpringCloud-Netflix</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="SpringCloud-Netflix"><a href="#SpringCloud-Netflix" class="headerlink" title="SpringCloud-Netflix"></a>SpringCloud-Netflix</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">1.spring cloud Netflix 一站式解决方案！</span><br><span class="line">	api网关，zuul组件</span><br><span class="line">	Feign --- HttpClinet --- Http 通信方式，同步，阻塞</span><br><span class="line">	服务注册发现： Eureka</span><br><span class="line">	熔断机制： Hystrix</span><br><span class="line">	。。。</span><br><span class="line">2.Apache Dubbo Zookeeper  半自动，需要整合别人的</span><br><span class="line">	API：没有，找第三方组件，或自己实现</span><br><span class="line">	Dubbo</span><br><span class="line">	Zookeeper</span><br><span class="line">	没有：借助 Hystrix</span><br><span class="line">	Dubbo这个方案并不完善</span><br><span class="line">3.Spring Cloud Alibaba 一站式解决方案！ 更简单</span><br><span class="line">新概念：服务网格~ Server Mesh</span><br><span class="line">	istio</span><br><span class="line">	</span><br><span class="line">万变不离其宗</span><br><span class="line">	1.API</span><br><span class="line">	2.HTTP，RPC</span><br><span class="line">	3.注册和发现</span><br><span class="line">	4.熔断机制</span><br></pre></td></tr></table></figure>



<h1 id="常见面试题"><a href="#常见面试题" class="headerlink" title="常见面试题"></a>常见面试题</h1><p>1.1、什么是微服务？</p>
<p>1.2、 微服务之间是如何独立通讯的？</p>
<p>1.3、 SpringCloud和Dubbo有哪些区别？</p>
<p>1.4、 SpringBoot和SpringCloud，请你谈谈对他们的理解</p>
<p>1.5、 什么是服务熔断？什么是服务降级？</p>
<p>1.6、 微服务的优缺点分别是什么？说一下你在项目开发中遇到的坑</p>
<p>1.7、 你所知道的微服务服务技术栈有哪些？列举一二</p>
<p>1.8、 eureka和zookeeper都可以提供服务注册与发现的功能，请说说两个的区别？</p>
<p>……</p>
<h2 id="什么是微服务？"><a href="#什么是微服务？" class="headerlink" title="什么是微服务？"></a>什么是微服务？</h2><p>微服务（Microservice Architecture）是近几年流行的一种架构思想，关于它的概念很难一言以蔽之。</p>
<p>究竟什么是微服务呢？我们再次引用ThoughtWorks公司的首席科学家Martin Fowler于2014年提出的一段话：<br>原文：<a target="_blank" rel="noopener" href="https://martinfowler.com/articles/microservices.html">https://martinfowler.com/articles/microservices.html</a></p>
<p>汉化：<a target="_blank" rel="noopener" href="http://www.bdata-cap.com/newsinfo/1713874.html">http://www.bdata-cap.com/newsinfo/1713874.html</a></p>
<h2 id="微服务与微服务架构"><a href="#微服务与微服务架构" class="headerlink" title="微服务与微服务架构"></a>微服务与微服务架构</h2><h3 id="微服务"><a href="#微服务" class="headerlink" title="微服务"></a>微服务</h3><p>强调的是服务的大小，他关注的是某一个点，是具体解决某一问题&#x2F;提供落地对应服务的一个服务应用，下一的看，可以看做是IDEA中的一个个微服务工程，或者Moudle</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">IDEA 工具里面使用Maven开发的一个独立的小Moudle，它具体是使用springboot开发的一个小模块，专业的事情交给专业的模块来做，一个模块就做着一件事</span><br><span class="line">强调的是一个个的个体，每个个体完成一个具体的任务或者功能！</span><br></pre></td></tr></table></figure>

<h3 id="微服务架构"><a href="#微服务架构" class="headerlink" title="微服务架构"></a>微服务架构</h3><p>一种新的结构形式，Martin Fowler，2014提出</p>
<p>微服务架构是一种架构模式，它提倡将单应用程序划分成一组小的服务，服务之间互相协调，互相配合，为用户提供最终价值。每个服务运行在其独立的进程中，服务于服务间采用轻量级的通信机制互相协作，每个服务都围绕着具体的业务构建，并且能够被独立的部署到生产环境中，另外，应尽量避免统一的，集中式的服务管理机制，对具体的一个服务而言，应根据业务上下文，选择合适的语言，工具对其进行构建。</p>
<h3 id="微服务优缺点"><a href="#微服务优缺点" class="headerlink" title="微服务优缺点"></a>微服务优缺点</h3><h4 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h4><ul>
<li>单一职责原则</li>
<li>每个服务足够内聚，足够小，代码容易理解，这样能聚焦一个指定的业务功能或业务需求；</li>
<li>开发简单，开发效率提高，一个服务可能就是转移的只干一件事</li>
<li>微服务能够被小团队单独开发，这个小团队是2–5人的开发人员组成</li>
<li>微服务是松耦合的，是有功能意义的服务，无论是在开发阶段或部署阶段都是独立的。</li>
<li>微服务能使用不同的语言开发</li>
<li>易于和第三方集成，微服务允许容易且灵活的方式集成自动部署，通过持续集成工具，如jenkins，Hudson，bamboo</li>
<li>微服务易于被一个开发人员理解，修改和维护，这样小团队能够更关注自己的工作成果。无需通过合作才能体现价值</li>
<li>微服务允许你利用融合最新技术</li>
<li>微服务只是业务逻辑的代码，不会和HTML，CSS或其他界面混合</li>
<li>每个微服务都有自己的存储能力，可以有自己的数据库，也可以有统一数据库</li>
</ul>
<h4 id="缺点"><a href="#缺点" class="headerlink" title="缺点"></a>缺点</h4><ul>
<li>开发人员要处理分布式系统的复杂性</li>
<li>多服务运维难度，随着服务的增加，运维的压力也在增大</li>
<li>系统部署依赖</li>
<li>服务间通信成本</li>
<li>数据统一性</li>
<li>系统集成测试</li>
<li>性能监控……</li>
</ul>
<h2 id="微服务技术栈有哪些？"><a href="#微服务技术栈有哪些？" class="headerlink" title="微服务技术栈有哪些？"></a>微服务技术栈有哪些？</h2><table>
<thead>
<tr>
<th>服务条条目</th>
<th>落地技术</th>
</tr>
</thead>
<tbody><tr>
<td>服务开发</td>
<td>SpringBoot,Spring,SpringMVC</td>
</tr>
<tr>
<td>服务配置与管理</td>
<td>Netflix公司的Archaius、阿里的Diamond等</td>
</tr>
<tr>
<td>服务注册与发现</td>
<td>Eureka、Consul、Zookeeper等</td>
</tr>
<tr>
<td>服务调用</td>
<td>Rest、RPC、gRPC</td>
</tr>
<tr>
<td>服务熔断器</td>
<td>Hystrix、Envoy等</td>
</tr>
<tr>
<td>负载均衡</td>
<td>Ribbon、Nginx等</td>
</tr>
<tr>
<td>服务接口调用（客户端调用服务的简化工具）</td>
<td>Feign等</td>
</tr>
<tr>
<td>消息队列</td>
<td>Kafka、RabbitMQ、ActiveMQ等</td>
</tr>
<tr>
<td>服务配置中心管理</td>
<td>SpringCloudConfig、Chef等</td>
</tr>
<tr>
<td>服务路由（API网关）</td>
<td>Zuul等</td>
</tr>
<tr>
<td>服务监控</td>
<td>Zabbix、Nagios、Metrics、Specatator等</td>
</tr>
<tr>
<td>全链路追踪</td>
<td>Zipkin、Brave、Dapper等</td>
</tr>
<tr>
<td>服务部署</td>
<td>Docker、OpenStack、Kubernetes等</td>
</tr>
<tr>
<td>数据流操作开发包</td>
<td>SpringCloud Stream（封装与Redis、Rabbit、Kafka等发送接收消息）</td>
</tr>
<tr>
<td>时间消息总线</td>
<td>SpringCloud Bus</td>
</tr>
</tbody></table>
<h2 id="为什么选择SpringCloud作为微服务架构"><a href="#为什么选择SpringCloud作为微服务架构" class="headerlink" title="为什么选择SpringCloud作为微服务架构"></a>为什么选择SpringCloud作为微服务架构</h2><h3 id="1-选型依据"><a href="#1-选型依据" class="headerlink" title="1.选型依据"></a>1.选型依据</h3><ul>
<li>整体解决方案和框架成熟</li>
<li>社区热度</li>
<li>可维护性</li>
<li>学习曲线</li>
</ul>
<h3 id="2-当前各大IT公司用的微服务架构有哪些？"><a href="#2-当前各大IT公司用的微服务架构有哪些？" class="headerlink" title="2.当前各大IT公司用的微服务架构有哪些？"></a>2.当前各大IT公司用的微服务架构有哪些？</h3><ul>
<li>阿里：dubbo+HFS</li>
<li>京东：JSF</li>
<li>新浪：Motan</li>
<li>当当网：DubboX</li>
<li>………</li>
</ul>
<h3 id="3-各微服务框架对比"><a href="#3-各微服务框架对比" class="headerlink" title="3.各微服务框架对比"></a>3.各微服务框架对比</h3><table>
<thead>
<tr>
<th>功能点&#x2F;服务框架</th>
<th>Netflix&#x2F;SpringCloud</th>
<th>Motan</th>
<th>gRPC</th>
<th>Thrift</th>
<th>Dubbo&#x2F;DubboX</th>
</tr>
</thead>
<tbody><tr>
<td>功能定位</td>
<td>完整的微服务框架</td>
<td>RPC框架，但整合了ZK或Consul，实现集群环境的基本服务注册&#x2F;发现</td>
<td>RPC框架</td>
<td>RPC框架</td>
<td>服务框架</td>
</tr>
<tr>
<td>支持Rest</td>
<td>是，Ribbon支持多种可插拔的序列化选择</td>
<td>否</td>
<td>否</td>
<td>否</td>
<td>否</td>
</tr>
<tr>
<td>支持RPC</td>
<td>否</td>
<td>是（Hession2）</td>
<td>是</td>
<td>是</td>
<td>是</td>
</tr>
<tr>
<td>支持多语言</td>
<td>是（Rest形式）？</td>
<td>否</td>
<td>是</td>
<td>是</td>
<td>否</td>
</tr>
<tr>
<td>负载均衡</td>
<td>是（服务端zuul+客户端Ribbon），zuul-服务，动态路由，云端负载均衡Eureka（针对中间层服务器）</td>
<td>是（客户端）</td>
<td>否</td>
<td>否</td>
<td>是（客户端）</td>
</tr>
<tr>
<td>配置服务</td>
<td>Netflix Archaius，SpringCloud Config Server集中配置</td>
<td>是（zookeeper提供）</td>
<td>否</td>
<td>否</td>
<td>否</td>
</tr>
<tr>
<td>服务调用链监</td>
<td>是（zuul），zuul提供边缘服务，API网关</td>
<td>否</td>
<td>否</td>
<td>否</td>
<td>否</td>
</tr>
<tr>
<td>高可用&#x2F;容错</td>
<td>是（服务端Hystrix+客户端Ribbon）</td>
<td>是（客户端）</td>
<td>否</td>
<td>否</td>
<td>是（客户端）</td>
</tr>
<tr>
<td>典型应用案例</td>
<td>Netflix</td>
<td>Sina</td>
<td>Google</td>
<td>Faceboot</td>
<td></td>
</tr>
<tr>
<td>社区活跃程度</td>
<td>高</td>
<td>一般</td>
<td>高</td>
<td>一般</td>
<td>2017年后重新开始维护，之前终端了5年</td>
</tr>
<tr>
<td>学习难度</td>
<td>中断</td>
<td>低</td>
<td>高</td>
<td>高</td>
<td>低</td>
</tr>
<tr>
<td>文档丰富成都</td>
<td>高</td>
<td>一般</td>
<td>一般</td>
<td>一般</td>
<td>高</td>
</tr>
<tr>
<td>其他</td>
<td>SpringCloudBus为我们的应用程序带来了更多管理端点</td>
<td>支持降级</td>
<td>Netflix内部在开发集成gRPC</td>
<td>IDL定义</td>
<td>实践的公司比较多</td>
</tr>
</tbody></table>
<h1 id="什么是SpringCloud？"><a href="#什么是SpringCloud？" class="headerlink" title="什么是SpringCloud？"></a>什么是SpringCloud？</h1><h2 id="SpringCloud和SpringBoot关系"><a href="#SpringCloud和SpringBoot关系" class="headerlink" title="SpringCloud和SpringBoot关系"></a>SpringCloud和SpringBoot关系</h2><ul>
<li>SpringBoot专注于快速方便的开发单个个体微服务。 -Jar</li>
<li>SpringCloud是关注全局的服务服务协调整理治理框架，它将SpringBoot开发的一个个单体微服务整合并管理起来，为各个微服务之间提供：配置管理，服务发现，断路器，路由，微代理，事件总线，全局锁，决策竞选，分布式会话等等集成服务。</li>
<li>SpringBoot可以离开SpringCloud独立使用，开发项目，但是SpringCloud离不开SpringBoot，属于依赖关系</li>
<li><strong>SpringBoot专注于快速、方便的开发单个个体微服务，SpringCloud关注全局的服务治理框架</strong></li>
</ul>
<h1 id="Dubbo和SpringCloud技术选型"><a href="#Dubbo和SpringCloud技术选型" class="headerlink" title="Dubbo和SpringCloud技术选型"></a>Dubbo和SpringCloud技术选型</h1><h2 id="1-分布式-服务治理Dubbo"><a href="#1-分布式-服务治理Dubbo" class="headerlink" title="1.分布式+服务治理Dubbo"></a>1.分布式+服务治理Dubbo</h2><p>目前成熟的互联网架构：应用服务化拆分+消息中间件</p>
<p><img src="/../assets/1621239485812.png" alt="1621239485812"></p>
<h2 id="2-Dubbo和SpringCloud对比"><a href="#2-Dubbo和SpringCloud对比" class="headerlink" title="2.Dubbo和SpringCloud对比"></a>2.Dubbo和SpringCloud对比</h2><p>可以看一下社区活跃度</p>
<p><a target="_blank" rel="noopener" href="https://github.com/dubbo">https://github.com/dubbo</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/spring-cloud">https://github.com/spring-cloud</a></p>
<p>结果：</p>
<table>
<thead>
<tr>
<th></th>
<th>Dubbo</th>
<th>Spring</th>
</tr>
</thead>
<tbody><tr>
<td>服务注册中心</td>
<td>Zookeeper</td>
<td>SpringCloud Netflix Eureka</td>
</tr>
<tr>
<td>服务调用方式</td>
<td>RPC</td>
<td>Rest API</td>
</tr>
<tr>
<td>服务监控</td>
<td>Dubbo-monitor</td>
<td>SpringBoot Admin</td>
</tr>
<tr>
<td>断路器</td>
<td>不完善</td>
<td>SpringCloud Netflix Hystrix</td>
</tr>
<tr>
<td>服务网关</td>
<td>无</td>
<td>SpringCloud Netflix Zuul</td>
</tr>
<tr>
<td>分布式配置</td>
<td>无</td>
<td>SpringCloud Config</td>
</tr>
<tr>
<td>服务跟踪</td>
<td>无</td>
<td>SpringCloud Sleuth</td>
</tr>
<tr>
<td>消息总线</td>
<td>无</td>
<td>SpringCloud Bus</td>
</tr>
<tr>
<td>数据流</td>
<td>无</td>
<td>SpringCloud Stream</td>
</tr>
<tr>
<td>批量任务</td>
<td>无</td>
<td>SpringCloud Task</td>
</tr>
</tbody></table>
<p><strong>最大区别</strong>：SpringCloud抛弃了Dubbo的RPC通信，采用的是基于HTTP的Resst方式。</p>
<p><strong>解决的问题与不一样：Dubbo的定位是一款RPC框架，SpringCloud的目标是微服务架构下的一站式解决方案</strong></p>
<h2 id="SpringCloud能干什么？"><a href="#SpringCloud能干什么？" class="headerlink" title="SpringCloud能干什么？"></a>SpringCloud能干什么？</h2><ul>
<li>Distributed&#x2F;versioned configuration（分布式&#x2F;版本控制配置）</li>
<li>Service registration and discovery（服务注册与发现）</li>
<li>Routing（路由）</li>
<li>Service-to-service calls（服务到服务的调用）</li>
<li>Load balancing（负载均衡配置）</li>
<li>Circuit Breakers（段容器）</li>
<li>Distributed messaging（分布式消息管理）</li>
<li>……</li>
</ul>
<h2 id="SpringCloud在哪里下？"><a href="#SpringCloud在哪里下？" class="headerlink" title="SpringCloud在哪里下？"></a>SpringCloud在哪里下？</h2><p>官网：<a target="_blank" rel="noopener" href="https://projects.spring.io/spring-cloud/">https://projects.spring.io/spring-cloud/</a></p>
<p><img src="/../assets/1621240904492.png" alt="1621240904492"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">这些版本名称的命名方式采用了伦敦地铁站的名称，同时根据字母表的顺序来对应版本时间顺序，比如最早的Release版本：Angel，第二个Release版本：Brixton，然后是Camden、Dalston、Edgware，目前最新的是Finchley版本。</span><br></pre></td></tr></table></figure>

<p>参考书：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://springcloud.cc/spring-cloud-netflix.html">https://springcloud.cc/spring-cloud-netflix.html</a></li>
<li>中文API文档：<a target="_blank" rel="noopener" href="https://springcloud.cc/spring-cloud-dalston.html">https://springcloud.cc/spring-cloud-dalston.html</a></li>
<li>SpringCloud中国社区 <a target="_blank" rel="noopener" href="https://springcloud.cn/">https://springcloud.cn/</a></li>
<li>SpringCloud中文网 <a target="_blank" rel="noopener" href="https://springcloud.cc/">https://springcloud.cc</a></li>
</ul>
<h1 id="SpringCloud"><a href="#SpringCloud" class="headerlink" title="SpringCloud"></a>SpringCloud</h1><h2 id="依赖"><a href="#依赖" class="headerlink" title="依赖"></a>依赖</h2><p>父级依赖pom.xml : maven依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.sec<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>SpringCloud<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">packaging</span>&gt;</span>pom<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.build.sourceEncoding</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.source</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">maven.compiler.source</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.target</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">maven.compiler.target</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">junit.version</span>&gt;</span>4.12<span class="tag">&lt;/<span class="name">junit.version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">lombok.version</span>&gt;</span>1.16.18<span class="tag">&lt;/<span class="name">lombok.version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">log4j.version</span>&gt;</span>1.2.17<span class="tag">&lt;/<span class="name">log4j.version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencyManagement</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--springCloud的依赖--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-dependencies<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>Greenwich.SR1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">type</span>&gt;</span>pom<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">scope</span>&gt;</span>import<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--springboot依赖--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-dependencies<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.1.4.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">type</span>&gt;</span>pom<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">scope</span>&gt;</span>import<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--数据库--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.47<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--德鲁伊--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1.10<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--springboot 启动器--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.spring.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--日志测试--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>ch.qos.logback<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>logback-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--单元测试--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;junit.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--lombok--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;lombok.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--log4j--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;log4j.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencyManagement</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">resources</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">resource</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">directory</span>&gt;</span>src/main/java<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">includes</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.properties<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.xml<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">includes</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">filtering</span>&gt;</span>false<span class="tag">&lt;/<span class="name">filtering</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">resource</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">resource</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">directory</span>&gt;</span>src/main/resources<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">includes</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.properties<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.xml<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">includes</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">filtering</span>&gt;</span>false<span class="tag">&lt;/<span class="name">filtering</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">resource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">resources</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>注册中心依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--eureka服务--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-eureka-server<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.4.6.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--热部署--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-devtools<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>服务提供者依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--actuator 完善监控信息--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--eureka--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-eureka<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.4.6.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--我们需要拿到实体类，所以要配置api module--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.sec<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springcloud-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>ch.qos.logback<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>logback-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.spring.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--test--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--jetty--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.springframework.boot/spring-boot-starter-jetty --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-jetty<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--热部署--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-devtools<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>消费者依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-eureka<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.4.6.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.sec<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springcloud-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-devtools<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h2><p>注册中心application配置文件</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">7001</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#Eureka配置</span></span><br><span class="line"><span class="attr">eureka:</span></span><br><span class="line">  <span class="attr">instance:</span></span><br><span class="line">    <span class="attr">hostname:</span> <span class="string">eureka7001.com</span></span><br><span class="line">  <span class="attr">client:</span></span><br><span class="line">    <span class="attr">register-with-eureka:</span> <span class="literal">false</span>  <span class="comment">#是否向eureka注册中心注册自己</span></span><br><span class="line">    <span class="attr">fetch-registry:</span> <span class="literal">false</span>  <span class="comment">#如果为false，则表示自己为注册中心</span></span><br><span class="line">    <span class="attr">service-url:</span></span><br><span class="line">      <span class="attr">defaultZone:</span> <span class="string">http://eureka7002.com:7002/eureka/,http://eureka7003.com:7003/eureka/</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>服务提供者application配置文件</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">8001</span></span><br><span class="line"><span class="comment">#mybatis的配置</span></span><br><span class="line"><span class="attr">mybatis:</span></span><br><span class="line">  <span class="attr">type-aliases-package:</span> <span class="string">com.suyi.springcloud.pojo</span></span><br><span class="line">  <span class="attr">config-location:</span> <span class="string">classpath:mybatis/mybatis-config.xml</span></span><br><span class="line">  <span class="attr">mapper-locations:</span> <span class="string">classpath:mybatis/mapper/*.xml</span></span><br><span class="line"><span class="comment">#spring的配置</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">springcloud-provider-dept</span></span><br><span class="line">  <span class="attr">datasource:</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">com.alibaba.druid.pool.DruidDataSource</span></span><br><span class="line">    <span class="attr">driver-class-name:</span> <span class="string">com.mysql.jdbc.Driver</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">jdbc:mysql://localhost:3306/db01?useUnicode=true&amp;characterEncoding=utf8&amp;setTimezone=UTC</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">root</span></span><br><span class="line">    <span class="attr">password:</span> <span class="number">123456</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#eureka的配置</span></span><br><span class="line"><span class="attr">eureka:</span></span><br><span class="line">  <span class="attr">client:</span></span><br><span class="line">    <span class="attr">service-url:</span></span><br><span class="line">      <span class="attr">defaultZone:</span> <span class="string">http://eureka7001.com:7001/eureka/,http://eureka7002.com:7002/eureka/,http://eureka7003.com:7003/eureka/</span></span><br><span class="line">  <span class="attr">instance:</span></span><br><span class="line">    <span class="attr">instance-id:</span> <span class="string">springcloud-provider-dept8001</span></span><br><span class="line"><span class="attr">info:</span></span><br><span class="line">  <span class="attr">app.name:</span> <span class="string">suyi</span></span><br><span class="line">  <span class="attr">company:</span> <span class="string">haojiacheng.cn</span></span><br></pre></td></tr></table></figure>

<p>消费者application配置文件</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">80</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#Eureka配置</span></span><br><span class="line"><span class="attr">eureka:</span></span><br><span class="line">  <span class="attr">client:</span></span><br><span class="line">    <span class="attr">register-with-eureka:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">service-url:</span></span><br><span class="line">      <span class="attr">defaultZone:</span> <span class="string">http://eureka7001.com:7001/eureka/,http://eureka7002.com:7002/eureka/,http://eureka7003.com:7003/eureka/</span></span><br></pre></td></tr></table></figure>

<h2 id="数据库文件，三个数据库"><a href="#数据库文件，三个数据库" class="headerlink" title="数据库文件，三个数据库"></a>数据库文件，三个数据库</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> database if <span class="keyword">exists</span> db01; <span class="comment">-- db02/db03</span></span><br><span class="line"><span class="keyword">create</span> database db03 <span class="keyword">default</span> <span class="type">character</span> <span class="keyword">set</span> utf8;</span><br><span class="line"></span><br><span class="line">use db01;<span class="comment">-- db02/db03</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> dept(</span><br><span class="line">	deptno <span class="type">BIGINT</span> <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">PRIMARY</span> KEY auto_increment,</span><br><span class="line">	dname <span class="type">varchar</span>(<span class="number">60</span>) <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">	db_source <span class="type">varchar</span>(<span class="number">60</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `dept`(dname,db_source) <span class="keyword">VALUES</span> (<span class="string">&#x27;开发部&#x27;</span>,<span class="string">&#x27;DATABASE()&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `dept`(dname,db_source) <span class="keyword">VALUES</span> (<span class="string">&#x27;人事部&#x27;</span>,<span class="string">&#x27;DATABASE()&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `dept`(dname,db_source) <span class="keyword">VALUES</span> (<span class="string">&#x27;财务部&#x27;</span>,<span class="string">&#x27;DATABASE()&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `dept`(dname,db_source) <span class="keyword">VALUES</span> (<span class="string">&#x27;市场部&#x27;</span>,<span class="string">&#x27;DATABASE()&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `dept`(dname,db_source) <span class="keyword">VALUES</span> (<span class="string">&#x27;运维部&#x27;</span>,<span class="string">&#x27;DATABASE()&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> dept;</span><br></pre></td></tr></table></figure>



<h1 id="Eureka服务注册与与发现"><a href="#Eureka服务注册与与发现" class="headerlink" title="Eureka服务注册与与发现"></a>Eureka服务注册与与发现</h1><h2 id="什么是Eureka？"><a href="#什么是Eureka？" class="headerlink" title="什么是Eureka？"></a>什么是Eureka？</h2><ul>
<li>Netflix在设计Eureka时，遵循的就是AP原则</li>
<li>Eureka时Netflix的一个子模块，也是核心模块之一，Eureka是一个基于REST的服务，用于定位服务，以实现云端中间层服务发现和故障转移，服务注册与发现对于微服务来说是非常重要的，有了服务发现与注册，只需要使用服务的标识，就可以访问到服务，而不需要修改服务调用的配置文件了，功能类似于Dubbo的注册中心，比如Zookeeper；</li>
</ul>
<h2 id="原理讲解"><a href="#原理讲解" class="headerlink" title="原理讲解"></a>原理讲解</h2><ul>
<li>Eureka的基本架构<ul>
<li>SpringCloud封装了Netflix公司开发的Eureka模块来实现服务注册和发现（对比Zookeeper）</li>
<li>Eureka采用了C-S的架构设计，EurekaServer作为服务服务注册功能的服务器，他是服务注册中心</li>
<li>而系统中的其他微服务。使用Eureka的客户端连接到EurekaServer并维持心跳连接。这样系统的维护人员就可以通过EurekaServer来监控系统中各个微服务是否正常运行，SpringCloud的一些其他模块（比如Zuul）就可以通过EurekaServer来发现系统中的其他微服务，并执行相关的逻辑；</li>
<li>和Dubbo架构对比<br><img src="/../assets/1621317410254.png" alt="1621317410254"><br><img src="/../assets/1621317432029.png" alt="1621317432029"></li>
<li>Eureka包含两个组件：Eureka Server和Eureka Client。</li>
<li>Eureka Server提供服务注册服务，各个节点启动后，会在EurekaServer中进行注册，这样Eureka Server中的服务注册表中将会存储所有可用服务节点的信息，服务节点的信息可以在界面中直观的看到。</li>
</ul>
</li>
<li>三大角色<ul>
<li>Eureka Server：提供服务的注册与发现</li>
<li>Service Provider：将自身服务注册到Eureka中，从而使消费方能够找到</li>
<li>Service Consumer：服务消费方从Eureka中获取注册服务列表，从而找到消费服务。</li>
</ul>
</li>
<li>盘点目前工程状况<ul>
<li><img src="/../assets/1621317650022.png" alt="1621317650022"></li>
</ul>
</li>
</ul>
<h2 id="构建步骤"><a href="#构建步骤" class="headerlink" title="构建步骤"></a>构建步骤</h2><h3 id="eureka-server"><a href="#eureka-server" class="headerlink" title="eureka-server"></a>eureka-server</h3><ol>
<li><p>springcloud-eureka-7001模块建立</p>
</li>
<li><p>pom.xml配置</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--eureka服务--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-eureka-server<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.4.6.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--热部署--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-devtools<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>配置application.yml</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line"><span class="attr">port:</span> <span class="number">7001</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#Eureka配置</span></span><br><span class="line"><span class="attr">eureka:</span></span><br><span class="line"><span class="attr">instance:</span></span><br><span class="line"><span class="attr">hostname:</span> <span class="string">localhost</span></span><br><span class="line"><span class="attr">client:</span></span><br><span class="line"><span class="attr">register-with-eureka:</span> <span class="literal">false</span>  <span class="comment">#是否向eureka注册中心注册自己</span></span><br><span class="line"><span class="attr">fetch-registry:</span> <span class="literal">false</span>  <span class="comment">#如果为false，则表示自己为注册中心</span></span><br><span class="line"><span class="attr">service-url:</span></span><br><span class="line">  <span class="attr">defaultZone:</span> <span class="string">http://$&#123;eureka.instance.hostname&#125;:$&#123;server.port&#125;/eureka/</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>服务提供者导入依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--actuator  完善监控信息--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--eureka--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-eureka-server<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.4.6.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>开启服务</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@EnableEurekaClient</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DeptProvider_8001</span> &#123;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">    SpringApplication.run(DeptProvider_8001.class,args);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>首先启动服务注册中心，再启动服务提供者，先7001，后8001，然后访问：<a target="_blank" rel="noopener" href="http://localhost:7001/">http://localhost:7001/</a></p>
<p><img src="/../assets/1621322118617.png" alt="1621322118617"></p>
</li>
<li><p>配置服务提供者名称<br><img src="/../assets/1621322200573.png" alt="1621322200573"></p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">info:</span></span><br><span class="line">  <span class="attr">app.name:</span> <span class="string">suyi</span></span><br><span class="line">  <span class="attr">company:</span> <span class="string">haojiacheng.cn</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>访问<img src="/../assets/1621322286696.png" alt="1621322286696"></p>
</li>
<li><p><img src="/../assets/1621322298265.png" alt="1621322298265"></p>
</li>
</ol>
<h3 id="eureka自我保护机制：好死不如赖活着"><a href="#eureka自我保护机制：好死不如赖活着" class="headerlink" title="eureka自我保护机制：好死不如赖活着"></a>eureka自我保护机制：好死不如赖活着</h3><p>一句话总结：某时某刻某一个微服务不可用了，eureka不会立刻清理，依旧会对该微服务的信息进行保存！</p>
<ul>
<li>默认情况下，如果EurekaServer在一定时间内没有接收到某个微服务实例的心跳，EurekaServer将会注销该实例（默认90）秒，但是当网络分区故障发生时，微服务与Eureka之间无法正常同行，以上行为可能变得非常危险了–因为微服务本身其实是健康的，此时本不应该注销这个服务，Eureka通过自我保护机制来解决这个问题–当EurekaServer节点在短时间内丢失过多客户端时（可能发生了网络分区故障），那么这个节点就会进行自我保护模式，一旦进入该模式，EurekaServer就会保护服务注册表中的信息，不再删除服务注册表中的数据（也就是不会注销任何微服务）。当网络故障恢复后，该EurekaServer节点会自动退出自我保护模式。</li>
<li>在自我保护模式中，EurekaServer会保护服务注册表中的信息，不再注销任何服务实例。当它收到的心跳数重新恢复到阈值以上时，该EurekaServer节点就会自动推出自我保护模式，它的设计哲学就是宁可保留错误的服务注册信息，也不盲目注销任何可能健康的服务实例，一句话：好死不如赖活着</li>
<li>综上，自我保护模式是一种应对网络异常的安全保护措施，它的架构哲学是宁可同时保留所有微服务（健康的微服务和不健康的微服务都会保留），也不盲目注销任何健康的微服务。使用自我保护模式，可以让Eureka集群更加的健壮和稳定</li>
<li>在SpringCloud中，可以使用eureka.server.enable-self-preservation &#x3D; false 禁用自我保护模式【不推荐关闭自我保护机制】</li>
</ul>
<h1 id="eureka集群"><a href="#eureka集群" class="headerlink" title="eureka集群"></a>eureka集群</h1><p>为了能区分开，首先改了本地的 &#x3D;&#x3D;域名映射&#x3D;&#x3D;</p>
<p><code>C:\Windows\System32\drivers\etc\hosts</code> </p>
<p>添加三个域名映射</p>
<figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">127.0</span>.<span class="number">0.1</span>       eureka7001.<span class="keyword">com</span></span><br><span class="line"><span class="number">127.0</span>.<span class="number">0.1</span>       eureka7002.<span class="keyword">com</span></span><br><span class="line"><span class="number">127.0</span>.<span class="number">0.1</span>       eureka7003.<span class="keyword">com</span></span><br></pre></td></tr></table></figure>

<p>1.创建三个注册中心</p>
<ul>
<li>springcloud-eureka-7001</li>
<li>springcloud-eureka-7002</li>
<li>springcloud-eureka-7003</li>
</ul>
<p>2.导入依赖    三个注册中心的依赖是一样的</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--eureka服务--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-eureka-server<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.4.6.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--热部署--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-devtools<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>3.创建启动项   三个都是一样的   记得开启&#x3D;&#x3D;eureka服务&#x3D;&#x3D;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sec.springcloud;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cloud.netflix.eureka.server.EnableEurekaServer;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@EnableEurekaServer</span> <span class="comment">//开启eureka服务</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">eurekaServer_7001</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        SpringApplication.run(eurekaServer_7001.class,args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>4.配置application.yml</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">7001</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#Eureka配置</span></span><br><span class="line"><span class="attr">eureka:</span></span><br><span class="line">  <span class="attr">instance:</span></span><br><span class="line">    <span class="attr">hostname:</span> <span class="string">eureka7001.com</span></span><br><span class="line">  <span class="attr">client:</span></span><br><span class="line">    <span class="attr">register-with-eureka:</span> <span class="literal">false</span>  <span class="comment">#是否向eureka注册中心注册自己</span></span><br><span class="line">    <span class="attr">fetch-registry:</span> <span class="literal">false</span>  <span class="comment">#如果为false，则表示自己为注册中心</span></span><br><span class="line">    <span class="attr">service-url:</span></span><br><span class="line">      <span class="attr">defaultZone:</span> <span class="string">http://eureka7002.com:7002/eureka/,http://eureka7003.com:7003/eureka/</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">7002</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#Eureka配置</span></span><br><span class="line"><span class="attr">eureka:</span></span><br><span class="line">  <span class="attr">instance:</span></span><br><span class="line">    <span class="attr">hostname:</span> <span class="string">eureka7002.com</span></span><br><span class="line">  <span class="attr">client:</span></span><br><span class="line">    <span class="attr">register-with-eureka:</span> <span class="literal">false</span>  <span class="comment">#是否向eureka注册中心注册自己</span></span><br><span class="line">    <span class="attr">fetch-registry:</span> <span class="literal">false</span>  <span class="comment">#如果为false，则表示自己为注册中心</span></span><br><span class="line">    <span class="attr">service-url:</span></span><br><span class="line">      <span class="attr">defaultZone:</span> <span class="string">http://eureka7001.com:7001/eureka/,http://eureka7003.com:7003/eureka/</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">7003</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#Eureka配置</span></span><br><span class="line"><span class="attr">eureka:</span></span><br><span class="line">  <span class="attr">instance:</span></span><br><span class="line">    <span class="attr">hostname:</span> <span class="string">eureka7003.com</span></span><br><span class="line">  <span class="attr">client:</span></span><br><span class="line">    <span class="attr">register-with-eureka:</span> <span class="literal">false</span>  <span class="comment">#是否向eureka注册中心注册自己</span></span><br><span class="line">    <span class="attr">fetch-registry:</span> <span class="literal">false</span>  <span class="comment">#如果为false，则表示自己为注册中心</span></span><br><span class="line">    <span class="attr">service-url:</span></span><br><span class="line">      <span class="attr">defaultZone:</span> <span class="string">http://eureka7001.com:7001/eureka/,http://eureka7002.com:7002/eureka/</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="ACID是什么？"><a href="#ACID是什么？" class="headerlink" title="ACID是什么？"></a>ACID是什么？</h1><ul>
<li>A（Atomicity）原子性</li>
<li>C（Consistency）一致性</li>
<li>I（Isolation）隔离性</li>
<li>D（Durability）持久性</li>
</ul>
<h1 id="CAP是什么？"><a href="#CAP是什么？" class="headerlink" title="CAP是什么？"></a>CAP是什么？</h1><ul>
<li>C（Consistency）强一致性</li>
<li>A（Availability）可用性</li>
<li>P（Partition tolerance）分区容错性</li>
</ul>
<p>CAP的三进二：CA、AP、CP</p>
<p>CAP理论的核心</p>
<ul>
<li>一个分布式系统不可能同时很好的满足一致性，可用性和分区容错性这三个需求</li>
<li>根据CAP原理，将NoSQL数据库分成了满足CA原则，满足CP原则和满足AP原则三大类：<ul>
<li>CA：单点集群，满足一致性，可用性的系统，通常可扩展性较差</li>
<li>CP：满足一致性，分区容错性的系统，通常性能不是特别高</li>
<li>AP：满足可用性，分区容错性的系统，通常可能对一致性要求低一些</li>
</ul>
</li>
</ul>
<h1 id="作为服务注册中心，Eureka比Zookeeper好在哪里？"><a href="#作为服务注册中心，Eureka比Zookeeper好在哪里？" class="headerlink" title="作为服务注册中心，Eureka比Zookeeper好在哪里？"></a>作为服务注册中心，Eureka比Zookeeper好在哪里？</h1><p>著名的CAP理论指出，一个分布式系统不可能同时满足C（一致性）、A（可用性）、P（容错性）。</p>
<p>由于分区容错性P在分布式系统中是必须要保证的，因此我们只能在A和C之间进行权衡。</p>
<ul>
<li>Zookeeper保证的是CP</li>
<li>Eureka保证的是AP</li>
</ul>
<h2 id="Zookeeper保证的是CP"><a href="#Zookeeper保证的是CP" class="headerlink" title="Zookeeper保证的是CP"></a>Zookeeper保证的是CP</h2><p>​	当向注册中心查询服务列表时，我们可以容忍注册中心返回的是几分钟以前的注册信息，但不能接收服务直接down掉不可用，也就是说，服务注册功能对可用性的要求高于一致性，但是Zookeeper会出现这样一种情况，当master节点因为网络故障与其他节点失去联系时，剩余节点会重新进行leader选举。问题在于，选举leader的时间太长，30~120s，且选举期间整个zk集群都是不可用的，这就导致在选举期间注册服务瘫痪。在云部署的环境下，因为网络问题使得zk集群失去master节点是较大概率会发生的事件，虽然服务最终能够恢复，但是漫长的选举时间导致的注册长期不可用是不能容忍的。</p>
<h2 id="Eureka保证的是AP"><a href="#Eureka保证的是AP" class="headerlink" title="Eureka保证的是AP"></a>Eureka保证的是AP</h2><p>​	Eureka看明白了这一点，因此在设计时就优先保证可用性。<strong>Eureka各个节点都是平等的</strong>，几个节点挂掉不会影响正常节点的工作，剩余的节点依然可以提供注册和查询服务。而Eureka的客户端在向某个Eureka注册时，如果发现连接失败，则会自动切换至其他节点，只要有一台Eureka还在，就能保住注册服务的可用性，只不过查到的信息可能不是最新的，除此之外，Eureka还有一种自我保护机制，如果在15分钟内超过85%的节点都没有正常的心跳，那么Eureka就认为客户端与注册中心出现了网络故障，此时会出现以下几种情况：</p>
<ol>
<li>Eureka不再从注册列表中移除因为长时间没收到心跳而应该过期的服务</li>
<li>Eureka仍然能够接收新服务的注册和查询请求，但是不会被同步到其他节点上（即保证当前节点依然可用）</li>
<li>当网络稳定时，当前实例新的注册信息就会被同步到其他节点中</li>
</ol>
<p>&#x3D;&#x3D;因此，Eureka可以很好的应对因网络故障导致部分节点失去联系的情况，而不会像zookeeper那样使整个服务瘫痪&#x3D;&#x3D;</p>
<h1 id="Ribbon是什么？"><a href="#Ribbon是什么？" class="headerlink" title="Ribbon是什么？"></a>Ribbon是什么？</h1><ul>
<li>Spring Cloud Ribbon是基于Netflix Ribbon实现的一套&#x3D;&#x3D;客户端负载均衡的工具&#x3D;&#x3D;。</li>
<li>简单地说，Ribbon是Netflix发布的开源项目，主要功能是提供客户端的软件负载均衡算法，将Netflix的中间层服务连接在一起。Ribbon的客户端组件提供一系列完整的配置如：连接超时、重试等等。简单地说，就是在配置文件中列出Load Balancer（简称LB，负载均衡）后面所有的机器，Ribbon会自动的帮你基于某种规则（如简单轮询，随机连接等等）去连接这些机器。我们也很容易使用Ribbon实现自定义的负载均衡算法！</li>
<li>面试造飞机，工作拧螺丝</li>
</ul>
<p>LVS是什么？</p>
<p>​	LVS<strong>是</strong>Linux Virtual Server<strong>的简写，意即</strong>Linux虚拟服务器**，是一个虚拟的服务器集群系统。本项目在1998年5月由<code>章文嵩</code>博士成立，是中国国内最早出现的自由软件项目之一。 </p>
<h2 id="Ribbon能干嘛？"><a href="#Ribbon能干嘛？" class="headerlink" title="Ribbon能干嘛？"></a>Ribbon能干嘛？</h2><ul>
<li>LB，即负载均衡（Load Balance），在微服务或分布式集群中经常用的一种应用。</li>
<li>负载均衡简单的说就是将用户的请求平摊的分配到多个服务上，从而达到系统的HA（高可用）。</li>
<li>常见的负载均衡软件有Nginx，LVS等等  Apache+Tomcat</li>
<li>dubbo、SpringCloud中均给我们提供了负载均衡，SpringCloud的负载均衡算法可以自定义</li>
<li>负载均衡简单分类：<ul>
<li>集中式LB<ul>
<li>即在服务的消费方和提供方之间是同独立的LB设施，如Nginx，由该设施负责把访问请求通过某种策略转发至服务的提供方！</li>
</ul>
</li>
<li>进程式LB<ul>
<li>将LB逻辑集成到消费方，消费方从注册中心获知有哪些地址可用，然后自己再从这些地址中选出一个合适的服务器。</li>
<li>&#x3D;&#x3D;Ribbon就属于进程内LB&#x3D;&#x3D;，它只是一个类库，集成于消费方进程，消费方通过它来获取到服务提供方的地址！</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>测试目录：</p>
<p><img src="/../assets/1621657587120.png" alt="1621657587120"></p>
<p>MyRuleConfig.java:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sec.MyRule;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyRuleConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> SuRandomRule <span class="title function_">getSuRandomRule</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">SuRandomRule</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>SuRandomRule.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sec.MyRule;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.netflix.client.config.IClientConfig;</span><br><span class="line"><span class="keyword">import</span> com.netflix.loadbalancer.AbstractLoadBalancerRule;</span><br><span class="line"><span class="keyword">import</span> com.netflix.loadbalancer.ILoadBalancer;</span><br><span class="line"><span class="keyword">import</span> com.netflix.loadbalancer.Server;</span><br><span class="line"><span class="comment">//import edu.umd.cs.findbugs.annotations.SuppressWarnings;</span></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.ThreadLocalRandom;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SuRandomRule</span> <span class="keyword">extends</span> <span class="title class_">AbstractLoadBalancerRule</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     每个服务用5次？</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> total=<span class="number">0</span>;<span class="comment">//每个服务调用的次数，当它==5的时候，调用下一个服务</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> currentIndex=<span class="number">0</span>;<span class="comment">//当前的服务索引，当total==5的时候，currentIndex+1；</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">SuRandomRule</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//@SuppressWarnings(&#123;&quot;RCN_REDUNDANT_NULLCHECK_OF_NULL_VALUE&quot;&#125;)</span></span><br><span class="line">    <span class="keyword">public</span> Server <span class="title function_">choose</span><span class="params">(ILoadBalancer lb, Object key)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (lb == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="type">Server</span> <span class="variable">server</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">while</span>(server == <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (Thread.interrupted()) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                List&lt;Server&gt; upList = lb.getReachableServers();<span class="comment">//获取活着的服务</span></span><br><span class="line">                List&lt;Server&gt; allList = lb.getAllServers();<span class="comment">//获取全部服务</span></span><br><span class="line">                <span class="type">int</span> <span class="variable">serverCount</span> <span class="operator">=</span> allList.size();</span><br><span class="line">                <span class="keyword">if</span> (serverCount == <span class="number">0</span>) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="comment">/*int index = this.chooseRandomInt(serverCount);//获取随机数</span></span><br><span class="line"><span class="comment">                server = (Server)upList.get(index);//根据随机数来拿到服务列表中的一个服务*/</span></span><br><span class="line"></span><br><span class="line">                <span class="comment">//-============================================================</span></span><br><span class="line">                <span class="keyword">if</span>(total&lt;<span class="number">5</span>)&#123;</span><br><span class="line">                    server=upList.get(currentIndex);</span><br><span class="line">                    total++;</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    total=<span class="number">0</span>;</span><br><span class="line">                    currentIndex++;</span><br><span class="line">                    <span class="keyword">if</span>(currentIndex&gt;upList.size()-<span class="number">1</span>)&#123;</span><br><span class="line">                        currentIndex=<span class="number">0</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    server=upList.get(currentIndex);</span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="comment">//-============================================================</span></span><br><span class="line">                <span class="keyword">if</span> (server == <span class="literal">null</span>) &#123;</span><br><span class="line">                    Thread.<span class="keyword">yield</span>();</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">if</span> (server.isAlive()) &#123;</span><br><span class="line">                        <span class="keyword">return</span> server;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    server = <span class="literal">null</span>;</span><br><span class="line">                    Thread.<span class="keyword">yield</span>();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> server;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="type">int</span> <span class="title function_">chooseRandomInt</span><span class="params">(<span class="type">int</span> serverCount)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> ThreadLocalRandom.current().nextInt(serverCount);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Server <span class="title function_">choose</span><span class="params">(Object key)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.choose(<span class="built_in">this</span>.getLoadBalancer(), key);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">initWithNiwsConfig</span><span class="params">(IClientConfig clientConfig)</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ConfigBean.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sec.springcloud.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.cloud.client.loadbalancer.LoadBalanced;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.client.RestTemplate;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ConfigBean</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//配置负载均衡实现RestTemplate</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="meta">@LoadBalanced</span> <span class="comment">//Ribbon</span></span><br><span class="line">    <span class="comment">//IRule接口下的↓↓↓↓↓↓↓↓↓↓↓</span></span><br><span class="line">    <span class="comment">//AvailabilityFilteringRule：会先过滤掉，跳闸，访问故障的服务，对剩下的服务进行轮询~</span></span><br><span class="line">    <span class="comment">//RoundRobinRule：轮询</span></span><br><span class="line">    <span class="comment">//RandomRule：随机</span></span><br><span class="line">    <span class="comment">//WeightedResponseTimeRule：权重</span></span><br><span class="line">    <span class="comment">//RetryRule：会先按照轮询的方式获取服务，如果服务失败，则会在指定的时间内进行，重试</span></span><br><span class="line">    <span class="keyword">public</span> RestTemplate <span class="title function_">getRestTemplate</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">RestTemplate</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>启动类：consumer_80.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sec.springcloud;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sec.MyRule.MyRuleConfig;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cloud.netflix.eureka.EnableEurekaClient;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cloud.netflix.ribbon.RibbonClient;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@EnableEurekaClient</span></span><br><span class="line"><span class="comment">//在微服务启动的时候就可以去加载我们自定义的Ribbon类</span></span><br><span class="line"><span class="meta">@RibbonClient(name = &quot;springcloud-provider-dept&quot;,configuration = MyRuleConfig.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">consumer_80</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        SpringApplication.run(consumer_80.class);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h1 id="Feign负载均衡"><a href="#Feign负载均衡" class="headerlink" title="Feign负载均衡"></a>Feign负载均衡</h1><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>​	feign是声明式的web Service客户端，它让微服务之间的调用变得更简单了，类似controller调用service。SpringCloud集成了Ribbon和Eureka，可在使用Feign时提供负载均衡的http客户端。</p>
<p>只需要创建一个接口，然后添加注解即可！</p>
<p>feign，主要是社区，大家都习惯面向接口编程。这个是很多开发人员的规范。调用微服务访问两种方法</p>
<ol>
<li>微服务名字【Ribbon】</li>
<li>接口和注解【Feign】</li>
</ol>
<p>Feign能干什么？</p>
<ul>
<li>Feign旨在使编写java Http客户端变得更容易</li>
<li>前面再使用Ribbon+RestTemplate时，利用RestTemplate对Http请求的封装处理，形成了一套模板化的调用方法。但是在实际开发中，由于对服务依赖的调用可能不止一处，往往一个接口会被多处调用，所以通常都会针对每个微服务自行封装一些客户端类来包装这些依赖服务的调用。所以，Feign在此基础上作了进一步封装，由他来帮助我们定义和实现依赖服务接口的定义，&#x3D;&#x3D;在Feign的实现下，我们只需要创建一个接口并使用注解的方式来配置它（类似于以前Dao接口上标注Mapper注解，现在是一个微服务接口上面标注一个Feign注解即可。）&#x3D;&#x3D;即可完成对服务提供方的接口绑定，简化了使用Spring Cloud Ribbon时，自动封装服务调用客户端的开发量。</li>
</ul>
<p>Feign集成了Ribbon</p>
<ul>
<li>利用Ribbon维护了MicroServiceCloud-Dept的服务列表信息，并且通过轮询实现了客户端的负载均衡，而与Ribbon不同的是，通过Feign只需要定义服务绑定接口且以声明式的方法，优雅而且简单的实现了服务调用。</li>
</ul>
<h2 id="使用接口方式调用服务"><a href="#使用接口方式调用服务" class="headerlink" title="使用接口方式调用服务"></a>使用接口方式调用服务</h2><ol>
<li><p>导入依赖   springcloud-api</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--feign--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-openfeign<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.4.6.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-openfeign-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>再编写service层</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.suyi.springcloud.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.suyi.springcloud.pojo.Dept;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cloud.openfeign.FeignClient;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.PathVariable;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.PostMapping;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@FeignClient(value = &quot;SPRINGCLOUD-PROVIDER-DEPT&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">DeptClientService</span> &#123;</span><br><span class="line">    <span class="meta">@GetMapping(&quot;/dept/queryAll&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;Dept&gt; <span class="title function_">queryAll</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/dept/queryById/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Dept <span class="title function_">queryById</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Long id)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/dept/addDept/&#123;dept&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">add</span><span class="params">(<span class="meta">@PathVariable(&quot;dept&quot;)</span> Dept dept)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
<li><p>创建一个Module <code>springcloud-consumer-dept-feign</code>   导入pom依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-openfeign<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.4.6.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-eureka<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.4.6.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.sec<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springcloud-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-devtools<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>application.yml:</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">80</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#Eureka配置</span></span><br><span class="line"><span class="attr">eureka:</span></span><br><span class="line">  <span class="attr">client:</span></span><br><span class="line">    <span class="attr">register-with-eureka:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">service-url:</span></span><br><span class="line">      <span class="attr">defaultZone:</span> <span class="string">http://eureka7001.com:7001/eureka/,http://eureka7002.com:7002/eureka/,http://eureka7003.com:7003/eureka/</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>config-&gt;ConfigBean</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sec.springcloud.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.cloud.client.loadbalancer.LoadBalanced;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.client.RestTemplate;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ConfigBean</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//配置负载均衡实现RestTemplate</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="meta">@LoadBalanced</span> <span class="comment">//Ribbon</span></span><br><span class="line">    <span class="comment">//IRule接口下的↓↓↓↓↓↓↓↓↓↓↓</span></span><br><span class="line">    <span class="comment">//AvailabilityFilteringRule：会先过滤掉，跳闸，访问故障的服务，对剩下的服务进行轮询~</span></span><br><span class="line">    <span class="comment">//RoundRobinRule：轮询</span></span><br><span class="line">    <span class="comment">//RandomRule：随机</span></span><br><span class="line">    <span class="comment">//WeightedResponseTimeRule：权重</span></span><br><span class="line">    <span class="comment">//RetryRule：会先按照轮询的方式获取服务，如果服务失败，则会在指定的时间内进行，重试</span></span><br><span class="line">    <span class="keyword">public</span> RestTemplate <span class="title function_">getRestTemplate</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">RestTemplate</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
<li><p>controller-&gt;DeptConsumerController</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sec.springcloud.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.suyi.springcloud.pojo.Dept;</span><br><span class="line"><span class="keyword">import</span> com.suyi.springcloud.service.DeptClientService;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.PathVariable;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DeptConsumerController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> DeptClientService deptClientService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/consumer/dept/add/&#123;dept&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">add</span><span class="params">(<span class="meta">@PathVariable(&quot;dept&quot;)</span> Dept dept)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> deptClientService.add(dept);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/consumer/dept/queryById/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Dept <span class="title function_">queryById</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Long id)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> deptClientService.queryById(id);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/consumer/dept/queryAll&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;Dept&gt; <span class="title function_">queryAll</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> deptClientService.queryAll();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
<li><p>启动项</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sec.springcloud;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cloud.netflix.eureka.EnableEurekaClient;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cloud.openfeign.EnableFeignClients;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@EnableEurekaClient</span></span><br><span class="line"><span class="meta">@EnableFeignClients(basePackages = &#123;&quot;com.suyi.springcloud&quot;&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Feign_consumer_80</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        SpringApplication.run(Feign_consumer_80.class);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ol>
<h1 id="分布式系统面临的问题"><a href="#分布式系统面临的问题" class="headerlink" title="分布式系统面临的问题"></a>分布式系统面临的问题</h1><p>复杂分布式体系结构中的应用程序有数十个依赖关系，每个依赖关系在某些时候将不可避免的失败！</p>
<h2 id="服务雪崩"><a href="#服务雪崩" class="headerlink" title="服务雪崩"></a>服务雪崩</h2><p>​	多个服务之间调用的时候，假设微服务A调用微服务B和微服务C，微服务B和微服务C又调用其他的微服务，这就是所谓的“扇出”、如果扇出的链路上某个微服务的调用响应时间过长或者不可用，对微服务A的调用就会占用越来越多的系统资源，进而引起系统崩溃，所谓的“雪崩效应”。</p>
<p>​	对于高流量的应用来说，单一的后端依赖可能会导致所有服务器上的所有资源都在几秒钟内饱和。比失败更糟糕的是，这些应用程序还可能导致服务之间的延迟增加，备份队列，线程和其他系统资源紧张，导致整个系统发生更多的级联故障，这些都表示需要对故障和延迟进行隔离和管理，以便单个依赖关系的失败，不能取消整个应用程序或系统。</p>
<p>​	我们需要   <code>弃车保帅</code></p>
<h2 id="什么是Hystrix"><a href="#什么是Hystrix" class="headerlink" title="什么是Hystrix"></a>什么是Hystrix</h2><p>​	Hystrix是一个用于处理分布式系统的延迟和容错的开源库，在分布式系统里，许多依赖不可避免的会调用失败，比如超时，异常等，Hystrix能够保证在一个依赖出问题的情况下，不会导致整体服务失败，避免级联故障，以提高分布式系统的弹性。</p>
<p>​	“断路器”本身是一种开关装置，当某个服务单元发生故障之后，通过断路器的故障监控（类似熔断保险丝），<strong>向调用方返回一个服务预期的，可处理的备选响应（FallBack），而不是长时间的等待或者抛出调用方法无法处理的异常，这样就可以保证了服务调用方的线程不会被长时间</strong>，不必要的占用，从而避免了故障在分布式系统中的蔓延，乃至雪崩</p>
<h2 id="Hystrix能干嘛"><a href="#Hystrix能干嘛" class="headerlink" title="Hystrix能干嘛"></a>Hystrix能干嘛</h2><ul>
<li>服务降级</li>
<li>服务熔断</li>
<li>服务限流</li>
<li>接近实时的监控</li>
<li>…………</li>
</ul>
<p>官网资料</p>
<p><a target="_blank" rel="noopener" href="https://github.com/Netflix/Hystrix/wiki">https://github.com/Netflix/Hystrix/wiki</a></p>
<h2 id="服务熔断"><a href="#服务熔断" class="headerlink" title="服务熔断"></a>服务熔断</h2><p><strong>是什么</strong></p>
<p>​    熔断机制是对应雪崩效应的一种微服务链路保护机制</p>
<p>​    当扇出链路的某个微服务不可用或者响应时间太长时，会进行服务的降级，&#x3D;&#x3D;进而熔断该节点微服务的调用，快速返回错误的响应信息&#x3D;&#x3D;。当检测到该节点微服务调用响应正常后恢复调用链路。在SpringCloud框架里熔断机制通过Hystrix实现。Hystrix会监控微服务间调用的状况，当失败的调用到一定阈值，缺省是5秒内20次调用失败就会启动熔断机制。熔断机制的注解是@HystrixCommand。</p>
<p><strong>实现步骤</strong></p>
<ol>
<li><p>创建<code>springcloud-provider-dept-hystrix-8001</code></p>
<p><img src="/../assets/1621947999245.png" alt="1621947999245"></p>
</li>
<li><p>导入依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--hystrix--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-hystrix<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.4.6.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--actuator 完善监控信息--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--eureka--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-eureka<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.4.6.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--我们需要拿到实体类，所以要配置api module--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.sec<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springcloud-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>ch.qos.logback<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>logback-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.spring.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--test--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--jetty--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.springframework.boot/spring-boot-starter-jetty --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-jetty<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--热部署--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-devtools<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>controller层写一个方法的备选方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sec.springcloud.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.netflix.hystrix.contrib.javanica.annotation.HystrixCommand;</span><br><span class="line"><span class="keyword">import</span> com.sec.springcloud.service.deptService;</span><br><span class="line"><span class="keyword">import</span> com.suyi.springcloud.pojo.Dept;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cloud.client.ServiceInstance;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cloud.client.discovery.DiscoveryClient;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">//提供Restful服务</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">deptController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    deptService ds;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/dept/queryById/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="meta">@HystrixCommand(fallbackMethod = &quot;queryByIdHystrix&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Dept <span class="title function_">queryById</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Long id)</span>&#123;</span><br><span class="line">        <span class="type">Dept</span> <span class="variable">dept</span> <span class="operator">=</span> ds.queryById(id);</span><br><span class="line">        <span class="keyword">if</span>(dept==<span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;id异常&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dept;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//备选方法</span></span><br><span class="line">    <span class="keyword">public</span> Dept <span class="title function_">queryByIdHystrix</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Long id)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Dept</span>().setDeptno(id).setDname(<span class="string">&quot;没有该&quot;</span>+id+<span class="string">&quot;的相关信心&quot;</span>).setDb_source(<span class="string">&quot;未找到该&quot;</span>+id+<span class="string">&quot;的database&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
<li><p>主启动类上开启断路器</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sec.springcloud;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cloud.client.circuitbreaker.EnableCircuitBreaker;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cloud.client.discovery.EnableDiscoveryClient;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cloud.netflix.eureka.EnableEurekaClient;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@EnableEurekaClient</span> <span class="comment">//在服务启动后自动注册到eureka中</span></span><br><span class="line"><span class="meta">@EnableDiscoveryClient</span> <span class="comment">//服务发现</span></span><br><span class="line"><span class="meta">@EnableCircuitBreaker</span>  <span class="comment">//启用断路器</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DeptProviderHystrix_8001</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        SpringApplication.run(DeptProviderHystrix_8001.class,args);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
<li><p>测试</p>
</li>
</ol>
<p>服务正常被注册到注册中心里来</p>
<p><img src="/../assets/1621948161573.png" alt="1621948161573"></p>
<p>访问id为1的</p>
<p><img src="/../assets/1621948201460.png" alt="1621948201460"></p>
<p>访问id不存在的</p>
<p><img src="/../assets/1621948221526.png" alt="1621948221526"></p>
<p>显示服务IP地址</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">eureka:</span></span><br><span class="line">  <span class="attr">client:</span></span><br><span class="line">    <span class="attr">service-url:</span></span><br><span class="line">      <span class="attr">defaultZone:</span> <span class="string">http://eureka7001.com:7001/eureka/,http://eureka7002.com:7002/eureka/,http://eureka7003.com:7003/eureka/</span></span><br><span class="line">  <span class="attr">instance:</span></span><br><span class="line">    <span class="attr">instance-id:</span> <span class="string">springcloud-provider-dept-hystrix-8001</span></span><br><span class="line">    <span class="attr">prefer-ip-address:</span> <span class="literal">true</span> <span class="comment">#true标识显示该服务的ip地址</span></span><br></pre></td></tr></table></figure>



<p><img src="/../assets/1621948263976.png" alt="1621948263976"></p>
<h2 id="服务降级"><a href="#服务降级" class="headerlink" title="服务降级"></a>服务降级</h2><p>springcloud-api的service下实现DeptClientService接口的实现类</p>
<p>接口：</p>
<ul>
<li><p>注意加上&#x3D;&#x3D;@Component&#x3D;&#x3D;注解，和</p>
</li>
<li><p><code>fallbackFactory = DeptClientServiceFallbackFactory.class</code></p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.suyi.springcloud.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.suyi.springcloud.pojo.Dept;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cloud.openfeign.FeignClient;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.PathVariable;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.PostMapping;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@FeignClient(value = &quot;SPRINGCLOUD-PROVIDER-DEPT&quot;,fallbackFactory = DeptClientServiceFallbackFactory.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">DeptClientService</span> &#123;</span><br><span class="line">    <span class="meta">@GetMapping(&quot;/dept/queryAll&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;Dept&gt; <span class="title function_">queryAll</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/dept/queryById/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Dept <span class="title function_">queryById</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Long id)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/dept/addDept/&#123;dept&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">add</span><span class="params">(<span class="meta">@PathVariable(&quot;dept&quot;)</span> Dept dept)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>实现类： <code>FallbackFactory&lt;DeptClientService&gt;</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.suyi.springcloud.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.suyi.springcloud.pojo.Dept;</span><br><span class="line"><span class="keyword">import</span> feign.hystrix.FallbackFactory;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DeptClientServiceFallbackFactory</span> <span class="keyword">implements</span> <span class="title class_">FallbackFactory</span>&lt;DeptClientService&gt; &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> DeptClientService <span class="title function_">create</span><span class="params">(Throwable throwable)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">DeptClientService</span>() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> List&lt;Dept&gt; <span class="title function_">queryAll</span><span class="params">()</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> Dept <span class="title function_">queryById</span><span class="params">(Long id)</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Dept</span>()</span><br><span class="line">                        .setDeptno(id)</span><br><span class="line">                        .setDname(<span class="string">&quot;没有对应的信息，客户端提供了降级的信息，这个服务已经被关闭&quot;</span>)</span><br><span class="line">                        .setDb_source(<span class="string">&quot;没有数据&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">add</span><span class="params">(Dept dept)</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><code>springcloud-consumer-dept-feign</code>的启动类上添加注解</p>
<p><strong>注意：</strong></p>
<ul>
<li>@ComponentScans({@ComponentScan(“com.suyi.springcloud”)}) </li>
<li>~ <code>com.suyi.springcloud</code>就是<code>springcloud-api</code>的接口的包</li>
</ul>
<p>开启服务降级    <code>application.yaml</code></p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#开启服务降级</span></span><br><span class="line"><span class="attr">feign:</span></span><br><span class="line">  <span class="attr">hystrix:</span></span><br><span class="line">    <span class="attr">enabled:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<p><strong>启动</strong><code>springcloud-eureka-7001</code>，<code>springcloud-provider-dept-8001</code>，<code>springcloud-consumer-dept-feign</code></p>
<p><strong>访问</strong><a target="_blank" rel="noopener" href="http://localhost/consumer/dept/queryById/1">http://localhost/consumer/dept/queryById/1</a></p>
<p><img src="/../assets/1622032910108.png" alt="1622032910108"></p>
<p><strong>关掉</strong><code>springcloud-provider-dept-8001</code>    </p>
<p> <strong>再次访问</strong></p>
<p><img src="/../assets/1622032967774.png" alt="1622032967774"></p>
<h3 id="总结："><a href="#总结：" class="headerlink" title="总结："></a>总结：</h3><ul>
<li>服务熔断：服务端<del>，某个服务超时或异常，引起熔断</del>   类似于保险丝</li>
<li>服务降级：客户端~，从整个网站请求负载考虑，当某个服务熔断或者关闭后，服务将不再被调用<br>              此时在客户端，我们可以准备一个FallbackFactory，返回一个默认的值（缺省值），整体的服务水平下降了</li>
</ul>
<h2 id="Hystrix：Dashboard监控流"><a href="#Hystrix：Dashboard监控流" class="headerlink" title="Hystrix：Dashboard监控流"></a>Hystrix：Dashboard监控流</h2><p>创建<code>springcloud-consumer-hystrix-dashboard</code></p>
<p>写启动类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sec.springcloud;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cloud.netflix.hystrix.dashboard.EnableHystrixDashboard;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@EnableHystrixDashboard</span> <span class="comment">//开启监控页面</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DeptConsumerDashboard_9001</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        SpringApplication.run(DeptConsumerDashboard_9001.class,args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>测试访问<a target="_blank" rel="noopener" href="http://localhost:9081/hystrix">http://localhost:9081/hystrix</a></p>
<p><img src="/../assets/1622036341259.png" alt="1622036341259"></p>
<ol>
<li><p>导入依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-hystrix-dashboard<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.4.6.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-hystrix<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.4.6.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-eureka<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.4.6.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.sec<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springcloud-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-devtools<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>


</li>
<li><p>编写application.yaml</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">9081</span></span><br><span class="line"><span class="attr">eureka:</span></span><br><span class="line">  <span class="attr">client:</span></span><br><span class="line">    <span class="attr">register-with-eureka:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><code>springcloud-provider-dept-hystrix-8001</code>的启动类中编写</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//增加一个  Servlet</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> ServletRegistrationBean <span class="title function_">HystrixMetricsStreamServlet</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">ServletRegistrationBean</span> <span class="variable">registrationBean</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ServletRegistrationBean</span>(<span class="keyword">new</span> <span class="title class_">HystrixMetricsStreamServlet</span>());</span><br><span class="line">        registrationBean.addUrlMappings(<span class="string">&quot;/actuator/hystrix.stream&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span>  registrationBean;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>访问<a target="_blank" rel="noopener" href="http://localhost:9081/hystrix.stream">http://localhost:9081/hystrix.stream</a></p>
</li>
</ol>
<p><img src="/../assets/1622036017022.png" alt="1622036017022"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://suyiharris.github.io/2023/10/24/2023-10-24-SpringCloud-Netflix/" data-id="clo4h2l3x000rnso9cm4o9kc8" data-title="SpringCloud-Netflix" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-2023-10-24-SpringBoot快速入门" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/10/24/2023-10-24-SpringBoot%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/" class="article-date">
  <time class="dt-published" datetime="2023-10-24T04:12:12.000Z" itemprop="datePublished">2023-10-24</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2023/10/24/2023-10-24-SpringBoot%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/">SpringBoot快速入门</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="SpringBoot：快速入门"><a href="#SpringBoot：快速入门" class="headerlink" title="SpringBoot：快速入门"></a>SpringBoot：快速入门</h1><h3 id="什么是Spring"><a href="#什么是Spring" class="headerlink" title="什么是Spring"></a>什么是Spring</h3><p>​	spring是一个开源框架，2003年兴起的一个轻量级的Java开发框架，作者：Rod Johnson。</p>
<p>​	<strong>Spring是为了解决企业级应用开发的复杂性而创建的，简化开发</strong></p>
<h3 id="Spring是如何简化java开发的"><a href="#Spring是如何简化java开发的" class="headerlink" title="Spring是如何简化java开发的"></a>Spring是如何简化java开发的</h3><p>​	为了降低Java开发的复杂性,Spring采用了以下四种关键策略:</p>
<ol>
<li>基于pojo的轻量级和最小侵入性编程;</li>
<li>通过IOC(控制反转),依赖注入(DI)和面向接口实现松耦合;</li>
<li>基于切面(AOP)和惯例进行声明式编程;</li>
<li>通过切面和模板减少样式代码;</li>
</ol>
<h3 id="什么是SpringBoot"><a href="#什么是SpringBoot" class="headerlink" title="什么是SpringBoot"></a>什么是SpringBoot</h3><p>​	SpringBoot就是一个javaweb的开发框架,和springmvc类似,对比其他javaweb框架的好处,官方说是简化开发,约定大于配置,”you can *just run”,能迅速的开发web应用,几行代码开发一个http接口.</p>
<h3 id="SpringBoot主要优点"><a href="#SpringBoot主要优点" class="headerlink" title="SpringBoot主要优点"></a>SpringBoot主要优点</h3><ul>
<li>为所有spring开发者更快的入门</li>
<li>开箱即用,提供各种默认配置来简化项目配置</li>
<li>内嵌式容器简化web项目</li>
<li>没有冗余代码生成和xml配置的要求</li>
</ul>
<h3 id="Hello-World"><a href="#Hello-World" class="headerlink" title="Hello World"></a>Hello World</h3><p>创建springboot项目   next</p>
<p><img src="/../assets/1620206756685.png" alt="1620206756685"></p>
<p>搜索web   勾选springweb  这将在pom.xml自动导入web环境的依赖</p>
<p><img src="/../assets/1620206784997.png" alt="1619397305635"></p>
<p>创建好之后在SpringbootApplication同级目录下创建controller包，如果不在此创建，则扫描不到包，虽然运行正常，但是显示不出来。</p>
<p><img src="/../assets/1620206846932.png" alt="1619397376738"></p>
<p>在controller包下写一个简单的方法进行测试</p>
<p><img src="/../assets/1620206866527.png" alt="1619397487204"></p>
<p>最后在SpringbootApplication中启动</p>
<p><img src="/../assets/1620206884909.png" alt="1619397523877"></p>
<h3 id="pom-xml"><a href="#pom-xml" class="headerlink" title="pom.xml"></a>pom.xml</h3><ul>
<li>spring-boot-dependencies：核心依赖在父工程中！</li>
<li>我们在写或者引入一些springboot依赖的时候，不需要指定版本</li>
</ul>
<h3 id="启动器"><a href="#启动器" class="headerlink" title="启动器"></a>启动器</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>springboot的启动场景</li>
<li>自动导入web环境所有的依赖</li>
<li>springboot会将所有的功能场景，变成一个个的启动器</li>
</ul>
<h3 id="原理初探"><a href="#原理初探" class="headerlink" title="原理初探"></a>原理初探</h3><p>主程序：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.suyi;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"></span><br><span class="line"><span class="comment">//标注这个类是一个springboot的应用</span></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Springboot01Application</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">//将springboot应用启动</span></span><br><span class="line">        SpringApplication.run(Springboot01Application.class, args);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>注解</p>
<ul>
<li><pre><code class="java">@SpringBootConfiguration:  springboot的配置
    @Configuration：  spring配置类
    @Component：  spring的组件
@EnableAutoConfiguration：  自动配置
    @AutoConfigurationPackage：  自动配置包
    @Import(AutoConfigurationPackages.Registrar.class)：  自动配置‘包注册’
    @Import(AutoConfigurationImportSelector.class)：  自动配置导入选择
//获取所有的配置
List&lt;String&gt; configurations = getCandidateConfigurations(annotationMetadata, attributes);

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">    获取候选的配置</span><br><span class="line"></span><br><span class="line">    ```java</span><br><span class="line">    protected List&lt;String&gt; getCandidateConfigurations(AnnotationMetadata metadata, AnnotationAttributes attributes) &#123;</span><br><span class="line">       List&lt;String&gt; configurations = SpringFactoriesLoader.loadFactoryNames(getSpringFactoriesLoaderFactoryClass(),</span><br><span class="line">             getBeanClassLoader());</span><br><span class="line">       Assert.notEmpty(configurations, &quot;No auto configuration classes found in META-INF/spring.factories. If you &quot;</span><br><span class="line">             + &quot;are using a custom packaging, make sure that file is correct.&quot;);</span><br><span class="line">       return configurations;</span><br><span class="line">    &#125;</span><br><span class="line">    ```</span><br><span class="line"></span><br><span class="line">    META-INF/spring.factories ： 自动配置的核心文件![1620206978295](../assets/1620206978295.png)</span><br><span class="line"></span><br><span class="line">结论：springboot所有自动装配都是在启动的时候扫描并加载：`‘spring.factories’`，所有自动配置类都在这里面，但是不一定都生效，因为要导入对应的start，导入start后就有启动器了，然后自动装配才会生效，最后配置成功！</span><br><span class="line"></span><br><span class="line">1. springboot在启动的时候，从类路径下`META-INF/spring.factories`获取指定的值</span><br><span class="line">2. 将这些自动配置的类导入容器，自动配置就会生效，进行自动配置</span><br><span class="line">3. 以前需要我们手动配置的东西，现在springboot帮我们自动配置好了</span><br><span class="line">4. 整合javaEE ，解决方案和自动配置的东西都在spring-boot-autoconfigure-2.2.0.RELEASE.jar 这个包下</span><br><span class="line">5. 他会把所有需要导入的组件，以类名的方式返回，这些组件就会被添加到容器</span><br><span class="line">6. 容器中也会存在非常多的xxxxAutoConfigurration的文件，就是这些类给容器中导入了这个场景需要的所有组件，并自动配置，@Configuration，JavaConfig！</span><br><span class="line">7. 有了自动配置的类，免去了我们手动编写配置文件的工作！</span><br><span class="line"></span><br><span class="line">JavaConfig  @Configuration   @Bean</span><br><span class="line"></span><br><span class="line">Docker:进程</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">关于springboot，谈谈你的理解：</span><br><span class="line"></span><br><span class="line">- 自动配置</span><br><span class="line">- run()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">全面接管SpringMVC的配置！</span><br><span class="line"></span><br><span class="line">### SpringBoot 配置</span><br><span class="line"></span><br><span class="line">配置文件：Springboot使用一个全局的配置文件，配置文件名称是固定的</span><br><span class="line"></span><br><span class="line">- application.properties</span><br><span class="line">  - 语法结构：key=value</span><br><span class="line">- application.yaml</span><br><span class="line">  - 语法结构：key：空格 value</span><br><span class="line"></span><br><span class="line">配置文件的作用：修改SpringBoot自动配置的默认值，因为SpringBoot在底层给我们都已经配置好了。</span><br><span class="line"></span><br><span class="line">#### yaml</span><br><span class="line"></span><br><span class="line">YAML 是 &quot;YAML Ain&#x27;t a Markup Language&quot;（YAML 不是一种标记语言）的递归缩写。在开发的这种语言时，YAML 的意思其实是：&quot;Yet Another Markup Language&quot;（仍是一种标记语言）。</span><br><span class="line"></span><br><span class="line">YAML 的语法和其他高级语言类似，并且可以简单表达清单、散列表，标量等数据形态。它使用空白符号缩进和大量依赖外观的特色，特别适合用来表达或编辑数据结构、各种配置文件、倾印调试内容、文件大纲（例如：许多电子邮件标题格式和YAML非常接近）。</span><br><span class="line"></span><br><span class="line">YAML 的配置文件后缀为 .yml，如：**runoob.yml** 。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">springboot推荐使用yaml，如果不使用yaml，也可以使用properties配置文件。但是需要设置文件的编码格式</span><br><span class="line"></span><br><span class="line">如：![1619409764613](../assets/1620207084686.png)</span><br><span class="line"></span><br><span class="line">注解解释：</span><br><span class="line"></span><br><span class="line">```java</span><br><span class="line">/*</span><br><span class="line">* @ConfigurationProperties的作用：</span><br><span class="line">* 将配置文件中配置的每一个属性的值，映射到这个组件中；</span><br><span class="line">* 告诉SpringBoot将本类中的所有属性和配置文件中相关的配置进行绑定</span><br><span class="line">* 参数 prefix = &quot;person&quot; : 将配置文件中的person下面的所有属性一一对应</span><br><span class="line">*</span><br><span class="line">* 只有这个组件时容器中的组件，才能使用容器提供的@ConfigurationProperties功能</span><br><span class="line">*</span><br><span class="line">* */</span><br><span class="line">@ConfigurationProperties(prefix = &quot;person&quot;)</span><br><span class="line"></span><br><span class="line">@PropertySource(value = &quot;classpath:suyi.properties&quot;)// 加载指定的配置文件  与@Value搭配使用</span><br><span class="line"></span><br><span class="line">```</span><br><span class="line"></span><br><span class="line">|                      | @ConfigurationProperties |   @Value   |</span><br><span class="line">| :------------------: | :----------------------: | :--------: |</span><br><span class="line">|         功能         | 批量注入配置文件中的属性 | 一个个指定 |</span><br><span class="line">| 松散绑定（松散语法） |           支持           |   不支持   |</span><br><span class="line">|         SpEL         |          不支持          |    支持    |</span><br><span class="line">|    JSR303数据校验    |           支持           |   不支持   |</span><br><span class="line">|     复杂类型封装     |           支持           |   不支持   |</span><br><span class="line"></span><br><span class="line">yaml给实体类赋值</span><br><span class="line"></span><br><span class="line">~~~java</span><br><span class="line">package com.suyi.pojo;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">import org.springframework.beans.factory.annotation.Value;</span><br><span class="line">import org.springframework.boot.context.properties.ConfigurationProperties;</span><br><span class="line">import org.springframework.context.annotation.PropertySource;</span><br><span class="line">import org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line">import java.util.Date;</span><br><span class="line">import java.util.List;</span><br><span class="line">import java.util.Map;</span><br><span class="line">/*</span><br><span class="line">* @ConfigurationProperties的作用：</span><br><span class="line">* 将配置文件中配置的每一个属性的值，映射到这个组件中；</span><br><span class="line">* 告诉SpringBoot将本类中的所有属性和配置文件中相关的配置进行绑定</span><br><span class="line">* 参数 prefix = &quot;person&quot; : 将配置文件中的person下面的所有属性一一对应</span><br><span class="line">*</span><br><span class="line">* 只有这个组件时容器中的组件，才能使用容器提供的@ConfigurationProperties功能</span><br><span class="line">*</span><br><span class="line">* */</span><br><span class="line">@Component //注册bean</span><br><span class="line">//@PropertySource(value = &quot;classpath:suyi.properties&quot;)// 加载指定的配置文件</span><br><span class="line">@ConfigurationProperties(prefix = &quot;person&quot;)</span><br><span class="line">public class Person &#123;</span><br><span class="line">    //@Value(&quot;$&#123;name&#125;&quot;)</span><br><span class="line">    private String name;</span><br><span class="line">    //@Value(&quot;$&#123;age&#125;&quot;)</span><br><span class="line">    private Integer age;</span><br><span class="line">    private Boolean happy;</span><br><span class="line">    private Date birth;</span><br><span class="line">    private Map&lt;String,Object&gt; maps;</span><br><span class="line">    private List&lt;Object&gt; lists;</span><br><span class="line">    private Dog dog;</span><br><span class="line">    ………………</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</code></pre>
</li>
</ul>
</li>
</ul>
<p>yaml：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">person:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">hjc$&#123;random.uuid&#125;</span></span><br><span class="line">  <span class="attr">age:</span> <span class="string">$&#123;random.int&#125;</span></span><br><span class="line">  <span class="attr">happy:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">birth:</span> <span class="number">2000</span><span class="string">/11/19</span></span><br><span class="line">  <span class="attr">maps:</span> &#123;<span class="attr">k1:</span> <span class="string">v1</span>,<span class="attr">k2:</span> <span class="string">v2</span>&#125;</span><br><span class="line">  <span class="attr">lists:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">code</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">music</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">girl</span></span><br><span class="line">  <span class="attr">hello:</span> <span class="string">&#x27;person的&#x27;</span></span><br><span class="line">  <span class="attr">dog:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">$&#123;person.hello&#125;旺财</span></span><br><span class="line">    <span class="attr">age:</span> <span class="number">3</span></span><br></pre></td></tr></table></figure>



<h4 id="松散绑定"><a href="#松散绑定" class="headerlink" title="松散绑定"></a>松散绑定</h4><p>属性松散绑定<br>表示驼峰式、下划线(_)、短横线(-)</p>
<h5 id="标准方式"><a href="#标准方式" class="headerlink" title="标准方式"></a><strong>标准方式</strong></h5><p>person.firstName</p>
<h5 id="方式一"><a href="#方式一" class="headerlink" title="方式一"></a><strong>方式一</strong></h5><p>大写用-<br>person.first-name</p>
<h5 id="方式二"><a href="#方式二" class="headerlink" title="方式二"></a><strong>方式二</strong></h5><p>大写用_<br>person.first_name</p>
<p>三种方式，都可以使用<br>推荐，属性书写方式<br>PERSON_FIRST_NAME</p>
<h4 id="JSR303数据校验"><a href="#JSR303数据校验" class="headerlink" title="JSR303数据校验"></a>JSR303数据校验</h4><p>springboot中可以用@Validated来校验数据，如果数据异常则会统一抛出异常，方便异常中心统一处理。我们这里来写个注解让我们的email只能支持Email格式。</p>
<p>Student.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.suyi.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.*;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.context.properties.ConfigurationProperties;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"><span class="keyword">import</span> org.springframework.validation.annotation.Validated;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.validation.constraints.Email;</span><br><span class="line"></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@ToString</span></span><br><span class="line"><span class="meta">@Getter</span></span><br><span class="line"><span class="meta">@Setter</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@ConfigurationProperties(prefix = &quot;student&quot;)</span></span><br><span class="line"><span class="meta">@Validated</span>   <span class="comment">//数据校验</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Student</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String firstName;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">	<span class="comment">//可以自定义提示信息</span></span><br><span class="line">    <span class="meta">@Email(message = &quot;邮箱格式错误&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String email;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>自定义设置提示错误信息</p>
<p><img src="/../assets/1620208158386.png" alt="1619422943844"></p>
<p>application.yaml</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">student:</span></span><br><span class="line">  <span class="attr">first-name:</span> <span class="string">郝嘉诚</span></span><br><span class="line">  <span class="attr">age:</span> <span class="number">21</span></span><br><span class="line">  <span class="attr">email:</span> <span class="number">990784805</span><span class="string">@qq.com</span> <span class="comment">#使用正确格式测试一次和使用错误格式测试一次</span></span><br></pre></td></tr></table></figure>

<p>email错误格式运行结果：</p>
<p><img src="/../assets/1620208200175.png" alt="1619422681231"></p>
<p><strong>JSR303常用注解</strong></p>
<table>
<thead>
<tr>
<th align="left">注解</th>
<th align="left">功能</th>
</tr>
</thead>
<tbody><tr>
<td align="left">@Null</td>
<td align="left">对象必须为null</td>
</tr>
<tr>
<td align="left">@NotNull</td>
<td align="left">对象必须不为null，无法检查长度为0的字符串</td>
</tr>
<tr>
<td align="left">@NotBlank</td>
<td align="left">字符串必须不为Null，且去掉前后空格长度必须大于0</td>
</tr>
<tr>
<td align="left">@AssertTrue</td>
<td align="left">对象必须为true</td>
</tr>
<tr>
<td align="left">@AssertFalse</td>
<td align="left">对象必须为false</td>
</tr>
<tr>
<td align="left">@Max(Value)</td>
<td align="left">必须为数字，且小于或等于Value</td>
</tr>
<tr>
<td align="left">@Min(Value)</td>
<td align="left">必须为数字，且大于或等于Value</td>
</tr>
<tr>
<td align="left">@DecimalMax(Value)</td>
<td align="left">必须为数字( BigDecimal )，且小于或等于Value。小数存在精度</td>
</tr>
<tr>
<td align="left">@DecimalMin(Value)</td>
<td align="left">必须为数字( BigDecimal )，且大于或等于Value。小数存在精度</td>
</tr>
<tr>
<td align="left">@Digits(integer,fraction)</td>
<td align="left">必须为数字( BigDecimal )，integer整数精度，fraction小数精度</td>
</tr>
<tr>
<td align="left">@Size(min,max)</td>
<td align="left">对象(Array、Collection、Map、String)长度必须在给定范围</td>
</tr>
<tr>
<td align="left">@Email</td>
<td align="left">字符串必须是合法邮件地址</td>
</tr>
<tr>
<td align="left">@Past</td>
<td align="left">Date和Calendar对象必须在当前时间之前</td>
</tr>
<tr>
<td align="left">@Future</td>
<td align="left">Date和Calendar对象必须在当前时间之后</td>
</tr>
<tr>
<td align="left">@Pattern(regexp&#x3D;“正则”)</td>
<td align="left">String对象必须符合正则表达式</td>
</tr>
</tbody></table>
<h4 id="多环境配置及配置文件位置"><a href="#多环境配置及配置文件位置" class="headerlink" title="多环境配置及配置文件位置"></a>多环境配置及配置文件位置</h4><p>配置文件位置的优先级：</p>
<p><img src="/../assets/1620207822634.png" alt="1620207822634"></p>
<p>多环境配置：（dev，test，默认）</p>
<p><strong>方法一</strong>：多配置文件</p>
<ul>
<li>默认  application.properties：</li>
</ul>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#spring的多环境配置，可以选择激活哪一个配置！</span></span><br><span class="line"><span class="attr">spring.profiles.active</span>=<span class="string">test</span></span><br></pre></td></tr></table></figure>

<ul>
<li>dev application-dev.properties:</li>
</ul>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server.port</span>=<span class="string">8081</span></span><br></pre></td></tr></table></figure>

<ul>
<li>test application-test.properties:</li>
</ul>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server.port</span>=<span class="string">8082</span></span><br></pre></td></tr></table></figure>



<p><strong>方法二</strong>：yml的多文档块</p>
<p>和properties配置文件中一样，但是使用yml去实现不需要创建多个配置文件了。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">8081</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">profiles:</span></span><br><span class="line">    <span class="attr">active:</span> <span class="string">test</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">8082</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">profiles:</span> <span class="string">dev</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">8083</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">profiles:</span> <span class="string">test</span></span><br></pre></td></tr></table></figure>



<h1 id="SpringBoot-Web开发"><a href="#SpringBoot-Web开发" class="headerlink" title="SpringBoot Web开发"></a>SpringBoot Web开发</h1><p>jar：webapp！</p>
<p>自动装配</p>
<p>springboot到底帮我们配置了什么？我们能不能进行修改？能修改哪些东西？能不能扩展？</p>
<ul>
<li>xxxAutoConfiguration..向容器中自动配置组件</li>
<li>xxxProperties：自动配置类，装配配置文件中自定义的一些内容！</li>
</ul>
<p>要解决的问题：</p>
<ul>
<li>导入静态资源……</li>
<li>首页</li>
<li>jsp，模板引擎Thymeleaf</li>
<li>装配扩展SpringMVC</li>
<li>增删改查</li>
<li>拦截器</li>
<li>国际化！</li>
</ul>
<h2 id="静态资源"><a href="#静态资源" class="headerlink" title="静态资源"></a>静态资源</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">addResourceHandlers</span><span class="params">(ResourceHandlerRegistry registry)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.addResourceHandlers(registry);</span><br><span class="line">        <span class="keyword">if</span> (!<span class="built_in">this</span>.resourceProperties.isAddMappings()) &#123;</span><br><span class="line">            logger.debug(<span class="string">&quot;Default resource handling disabled&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">ServletContext</span> <span class="variable">servletContext</span> <span class="operator">=</span> getServletContext();</span><br><span class="line">        addResourceHandler(registry, <span class="string">&quot;/webjars/**&quot;</span>, <span class="string">&quot;classpath:/META-INF/resources/webjars/&quot;</span>);</span><br><span class="line">        addResourceHandler(registry, <span class="built_in">this</span>.mvcProperties.getStaticPathPattern(), (registration) -&gt; &#123;</span><br><span class="line">            registration.addResourceLocations(<span class="built_in">this</span>.resourceProperties.getStaticLocations());</span><br><span class="line">            <span class="keyword">if</span> (servletContext != <span class="literal">null</span>) &#123;</span><br><span class="line">                registration.addResourceLocations(<span class="keyword">new</span> <span class="title class_">ServletContextResource</span>(servletContext, SERVLET_LOCATION));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="什么是webjars？"><a href="#什么是webjars？" class="headerlink" title="什么是webjars？"></a>什么是webjars？</h3><p>​	WebJars是将客户端（浏览器）资源（JavaScript，Css等）打成jar包文件，以对资源进行统一依赖管理。<strong>WebJars的jar包部署在Maven中央仓库上。</strong> </p>
<h3 id="为什么使用"><a href="#为什么使用" class="headerlink" title="为什么使用"></a>为什么使用</h3><p>​	我们在开发Java web项目的时候会使用像Maven，Gradle等构建工具以实现对jar包版本依赖管理，以及项目的自动化管理，但是对于JavaScript，Css等前端资源包，我们只能采用拷贝到webapp目录下的手工方式，这样做就无法对这些资源进行依赖管理。而且容易导致文件混乱、版本不一致等问题。那么<strong>WebJars就提供给我们这些前端资源的jar包形式</strong>，我们就可以进行<strong>依赖管理</strong>。</p>
<p>​	WebJars是将这些<strong>通用的Web前端资源打包成Java的Jar包</strong>，然后<strong>借助Maven工具对其管理</strong>，保证这些Web资源版本唯一性，升级也比较容易。关于webjars资源，有一个专门的网站<a target="_blank" rel="noopener" href="http://www.webjars.org/%EF%BC%8C%E6%88%91%E4%BB%AC%E5%8F%AF%E4%BB%A5%E5%88%B0%E8%BF%99%E4%B8%AA**%E7%BD%91%E7%AB%99%E4%B8%8A%E6%89%BE%E5%88%B0%E8%87%AA%E5%B7%B1%E9%9C%80%E8%A6%81%E7%9A%84%E8%B5%84%E6%BA%90%EF%BC%8C%E5%9C%A8%E8%87%AA%E5%B7%B1%E7%9A%84%E5%B7%A5%E7%A8%8B%E4%B8%AD%E6%B7%BB%E5%8A%A0%E5%85%A5maven%E4%BE%9D%E8%B5%96%EF%BC%8C%E5%8D%B3%E5%8F%AF%E7%9B%B4%E6%8E%A5%E4%BD%BF%E7%94%A8%E8%BF%99%E4%BA%9B%E8%B5%84%E6%BA%90%E4%BA%86**%E3%80%82">http://www.webjars.org/，我们可以到这个**网站上找到自己需要的资源，在自己的工程中添加入maven依赖，即可直接使用这些资源了**。</a></p>
<h3 id="总结："><a href="#总结：" class="headerlink" title="总结："></a>总结：</h3><ol>
<li>在springboot，我们可以使用以下方式处理静态资源<ul>
<li>webjars      <code>http://localhost:8080/webjars/jquery/3.5.1/jquery.js</code></li>
<li>public ,statis,&#x2F;**,resources   <code>localhost:8080/1.js</code></li>
</ul>
</li>
<li>优先级：resource&gt;static(默认)&gt;public</li>
</ol>
<h3 id="首页："><a href="#首页：" class="headerlink" title="首页："></a>首页：</h3><p>​	直接在public或resource或static文件夹下编写html，推荐在public中</p>
<p><img src="/../assets/1620207470957.png" alt="1619489820346"></p>
<h3 id="页面图标制定："><a href="#页面图标制定：" class="headerlink" title="页面图标制定："></a>页面图标制定：</h3><p>​	在public或static下创建favicon.ico的图片</p>
<p><img src="/../assets/1620207374045.png" alt="1619491964832"></p>
<p>然后在application.properties中写入</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring.mvc.favicon.enabled</span>=<span class="string">false</span></span><br></pre></td></tr></table></figure>



<h3 id="模板引擎："><a href="#模板引擎：" class="headerlink" title="模板引擎："></a>模板引擎：</h3><p>导入包</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-thymeleaf<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.thymeleaf<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>thymeleaf-spring5<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.thymeleaf.extras<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>thymeleaf-extras-java8time<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>要在templates文件夹中创建html页面，否则识别不到</p>
<p>这里要注意的是在页面头部一定要引入  <code>xmlns:th=&quot;http://www.thymeleaf.org&quot;</code> </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;msg&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sec.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.ui.Model;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloController</span> &#123;</span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/test&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">test</span><span class="params">(Model model)</span>&#123;</span><br><span class="line">        model.addAttribute(<span class="string">&quot;msg&quot;</span>,<span class="string">&quot;hello,springboot!!!&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;test&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>访问：localhost:8080&#x2F;test</p>
<h3 id="Thymeleaf语法："><a href="#Thymeleaf语法：" class="headerlink" title="Thymeleaf语法："></a>Thymeleaf语法：</h3><p><strong>· 简单表达式 （simple expressions）</strong></p>
<ul>
<li>　　${…}  变量表达式</li>
<li>　　*{…}  选择变量表达式</li>
<li>　　#{…}  消息表达式</li>
<li>　　@{…}  链接url表达式</li>
</ul>
<p><strong>· 字面量</strong></p>
<ul>
<li>　	‘one text’,’another one!’,…   文本</li>
<li>　　0,34,3.0,12.3,… 数值</li>
<li>　　true false 布尔类型</li>
<li>　　null 空</li>
<li>​       one,sometext,main 文本字符</li>
</ul>
<p><strong>· 文本操作</strong></p>
<ul>
<li>　　+  字符串连接</li>
<li>　　|The name is ${name}|  字符串连接</li>
</ul>
<p><strong>· 算术运算</strong></p>
<ul>
<li>　　+ , - , * , &#x2F; , %  二元运算符</li>
<li>　　-  负号（一元运算符）</li>
</ul>
<p><strong>· 布尔操作</strong></p>
<ul>
<li>　　and,or  二元操作符</li>
<li>　　!,not 非（一元操作符）</li>
</ul>
<p><strong>· 关系操作符</strong></p>
<ul>
<li>　　&gt; , &lt; , &gt;&#x3D; , &lt;&#x3D; (gt , lt , ge , le)</li>
<li>　　&#x3D;&#x3D; , !&#x3D; (eq, ne)</li>
</ul>
<p><strong>· 条件判断</strong></p>
<ul>
<li>(if) ? (then)      if-then</li>
<li>(if) ? (then) : (else)   if-then-else</li>
</ul>
<p>详细语法：<a target="_blank" rel="noopener" href="https://www.codercto.com/a/50477.html">https://www.codercto.com/a/50477.html</a></p>
<h3 id="MVC配置原理："><a href="#MVC配置原理：" class="headerlink" title="MVC配置原理："></a>MVC配置原理：</h3><h4 id="视图解析器："><a href="#视图解析器：" class="headerlink" title="视图解析器："></a>视图解析器：</h4><p>ContentNegotiatingViewResolver.java——ViewResolver(接口)</p>
<p> ViewResolver 实现了视图解析器接口的类，我们就可以把它看做视图解析器</p>
<p>MyMvcConfig.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sec.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.View;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.ViewResolver;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.config.annotation.InterceptorRegistry;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.config.annotation.WebMvcConfigurer;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Locale;</span><br><span class="line"></span><br><span class="line"><span class="comment">//扩展springmvc</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyMvcConfig</span> <span class="keyword">implements</span> <span class="title class_">WebMvcConfigurer</span> &#123;</span><br><span class="line">    <span class="comment">//public interface ViewResolver 实现了视图解析器接口的类，我们就可以把它看做试图解析器</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> ViewResolver <span class="title function_">MyViewResolver</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">MyViewResolver</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//自定义了一个自己的视图解析器MyViewResolver</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">MyViewResolver</span> <span class="keyword">implements</span> <span class="title class_">ViewResolver</span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> View <span class="title function_">resolveViewName</span><span class="params">(String viewName, Locale locale)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="视图跳转："><a href="#视图跳转：" class="headerlink" title="视图跳转："></a>视图跳转：</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sec.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.config.annotation.ViewControllerRegistry;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.config.annotation.WebMvcConfigurer;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Locale;</span><br><span class="line"></span><br><span class="line"><span class="comment">//扩展springmvc   官方建议这样做</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyMvcConfig</span> <span class="keyword">implements</span> <span class="title class_">WebMvcConfigurer</span> &#123;</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    <span class="comment">//视图跳转</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addViewControllers</span><span class="params">(ViewControllerRegistry registry)</span> &#123;</span><br><span class="line">        registry.addViewController(<span class="string">&quot;/qwe&quot;</span>).setViewName(<span class="string">&quot;test&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>在springboot中，有非常多的xxxxConfiguration，帮助我们进行扩展配置，只要看到了这个东西，我们就要注意了</p>
<h3 id="国际化："><a href="#国际化：" class="headerlink" title="国际化："></a>国际化：</h3><ol>
<li>首页配置：<ol>
<li>注意点，所有页面的静态资源都需要使用thymeleaf接管；@{}</li>
<li>url:   @{}</li>
</ol>
</li>
<li>页面国际化：<ol>
<li>我们需要配置i18n文件</li>
<li>我们如果需要在项目中进行按钮自动切换，我们需要自定义一个组件<code>LocaleResolver</code></li>
<li>记得将自己写的组件配置到spring容器  <code>@Bean</code></li>
<li>#{}</li>
</ol>
</li>
</ol>
<p><strong>实现步骤：</strong>①</p>
<p><img src="/../assets/1619516834028.png" alt="1619516834028"></p>
<p>②  MyLocaleResolver.java:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sec.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.LocaleResolver;</span><br><span class="line"><span class="keyword">import</span> org.thymeleaf.util.StringUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> java.util.Locale;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyLocaleResolver</span> <span class="keyword">implements</span> <span class="title class_">LocaleResolver</span> &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> Locale <span class="title function_">resolveLocale</span><span class="params">(HttpServletRequest request)</span> &#123;</span><br><span class="line">    <span class="comment">//获取请求中的参数</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">l</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;l&quot;</span>);</span><br><span class="line">    <span class="comment">//如果没有就使用默认的</span></span><br><span class="line">    <span class="type">Locale</span> <span class="variable">locale</span> <span class="operator">=</span> Locale.getDefault();</span><br><span class="line">    <span class="comment">//如果请求的链接携带了国际化的参数</span></span><br><span class="line">    <span class="keyword">if</span>(!StringUtils.isEmpty(l))&#123;</span><br><span class="line">        <span class="comment">//zh_CN</span></span><br><span class="line">        String[] split = l.split(<span class="string">&quot;_&quot;</span>);</span><br><span class="line">        <span class="comment">//国家，地区</span></span><br><span class="line">         locale = <span class="keyword">new</span> <span class="title class_">Locale</span>(split[<span class="number">0</span>], split[<span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> locale;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setLocale</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Locale locale)</span> &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>③</p>
<p><img src="/../assets/1619516629377.png" alt="1619516629377"></p>
<h3 id="拦截器："><a href="#拦截器：" class="headerlink" title="拦截器："></a>拦截器：</h3><p>①登录跳转时设置session</p>
<p><img src="/../assets/1619527437852.png" alt="1619527437852"></p>
<p>②在config文件下创建————–LoginHandlerInterceptor.java</p>
<p><img src="/../assets/1619527505539.png" alt="1619527505539"></p>
<p>代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sec.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.HandlerInterceptor;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LoginHandlerInterceptor</span> <span class="keyword">implements</span> <span class="title class_">HandlerInterceptor</span> &#123;</span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">preHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    <span class="type">Object</span> <span class="variable">user</span> <span class="operator">=</span> request.getSession().getAttribute(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>(user==<span class="literal">null</span>)&#123;</span><br><span class="line">        request.setAttribute(<span class="string">&quot;msg&quot;</span>,<span class="string">&quot;没有权限，请先登录&quot;</span>);</span><br><span class="line">        request.getRequestDispatcher(<span class="string">&quot;/index.html&quot;</span>).forward(request,response);</span><br><span class="line">        <span class="keyword">return</span>  <span class="literal">false</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span>  <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>③在自定义的配置文件中写以下内容：</p>
<p><img src="/../assets/1619527614742.png" alt="1619527614742"></p>
<p>代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//拦截器</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addInterceptors</span><span class="params">(InterceptorRegistry registry)</span> &#123;</span><br><span class="line">    registry.addInterceptor(<span class="keyword">new</span> <span class="title class_">LoginHandlerInterceptor</span>()).addPathPatterns(<span class="string">&quot;/**&quot;</span>).excludePathPatterns(<span class="string">&quot;/index.html&quot;</span>,<span class="string">&quot;/&quot;</span>,<span class="string">&quot;/css/**&quot;</span>,<span class="string">&quot;/js/**&quot;</span>,<span class="string">&quot;/img/**&quot;</span>,<span class="string">&quot;/user/login&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="自定义错误页面："><a href="#自定义错误页面：" class="headerlink" title="自定义错误页面："></a>自定义错误页面：</h3><p><img src="/../assets/1619527729539.png" alt="1619527729539"></p>
<h3 id="员工列表展示："><a href="#员工列表展示：" class="headerlink" title="员工列表展示："></a>员工列表展示：</h3><ol>
<li>提取公共页面<ol>
<li>把公共部分写到commons文件夹下  命名为commons.html<img src="/../assets/1619573100721.png" alt="1619573100721"></li>
<li>使用th:replace&#x3D;”~{}”<img src="/../assets/1619573150004.png" alt="1619573150004"></li>
</ol>
</li>
<li>列表循环展示</li>
</ol>
<h4 id="添加员工："><a href="#添加员工：" class="headerlink" title="添加员工："></a>添加员工：</h4><ol>
<li><pre><code class="html">&lt;!--按钮跳转--&gt;
&lt;h2&gt;&lt;a href=&quot;&quot; class=&quot;btn btn-sm btn-success&quot; th:href=&quot;@&#123;/emp&#125;&quot;&gt;添加员工&lt;/a&gt;&lt;/h2&gt;
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">2. 跳转至添加员工的页面</span><br><span class="line"></span><br><span class="line">   ~~~java</span><br><span class="line">   @GetMapping(&quot;/emp&quot;)</span><br><span class="line">   public String toAddPage(Model model)&#123;</span><br><span class="line">       //获取部门</span><br><span class="line">       Collection&lt;Department&gt; departments = departmentDao.getDepartments();</span><br><span class="line">       model.addAttribute(&quot;departments&quot;,departments);</span><br><span class="line">       return &quot;emp/add&quot;;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
</code></pre>
</li>
<li><p>添加员工的页面<img src="/../assets/1619596902531.png" alt="1619596902531"></p>
</li>
<li><p>controller执行添加</p>
</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PostMapping(&quot;/emp&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">addEmp</span><span class="params">(Employee employee)</span>&#123;</span><br><span class="line">    <span class="comment">//添加的操作</span></span><br><span class="line">    employeeDao.save(employee);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;redirect:emps&quot;</span>;<span class="comment">//返回首页</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="查询："><a href="#查询：" class="headerlink" title="查询："></a>查询：</h4><ol>
<li><p>使用thymeleaf语法跳转controller，利用controller实现查询方法<img src="/../assets/1619597353071.png" alt="1619597353071"></p>
</li>
<li><pre><code class="java">@RequestMapping(&quot;/emps&quot;)
public String list(Model model)&#123;
    Collection&lt;Employee&gt; employees = employeeDao.getAll();
    model.addAttribute(&quot;emps&quot;,employees);
    return &quot;emp/list&quot;;
&#125;
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">3. ![1619597410911](../assets/1619597410911.png)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#### 修改：</span><br><span class="line"></span><br><span class="line">1. ![1619597453919](../assets/1619597453919.png)</span><br><span class="line"></span><br><span class="line">2. 跳转修改页面</span><br><span class="line"></span><br><span class="line">   ~~~java</span><br><span class="line">   @GetMapping(&quot;/emp/&#123;id&#125;&quot;)</span><br><span class="line">   public String updEmp(@PathVariable(&quot;id&quot;)Integer id,Model model)&#123;</span><br><span class="line">       //查出原来的数据</span><br><span class="line">       Employee emlpoyee = employeeDao.getEmlpoyeeById(id);</span><br><span class="line">       model.addAttribute(&quot;emp&quot;,emlpoyee);</span><br><span class="line">       //查询部门信息</span><br><span class="line">       Collection&lt;Department&gt; departments = departmentDao.getDepartments();</span><br><span class="line">       model.addAttribute(&quot;departments&quot;,departments);</span><br><span class="line">       return &quot;emp/update&quot;;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
</code></pre>
</li>
<li><p>修改页面</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">th:replace</span>=<span class="string">&quot;~&#123;commons/commons::topbar&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;container-fluid&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;row&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">th:replace</span>=<span class="string">&quot;~&#123;commons/commons::sidebar&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">main</span> <span class="attr">role</span>=<span class="string">&quot;main&quot;</span> <span class="attr">class</span>=<span class="string">&quot;col-md-9 ml-sm-auto col-lg-10 pt-3 px-4&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">form</span> <span class="attr">th:action</span>=<span class="string">&quot;@&#123;/updateEmp&#125;&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-group&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">lable</span>&gt;</span>姓名<span class="tag">&lt;/<span class="name">lable</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span> <span class="attr">name</span>=<span class="string">&quot;id&quot;</span> <span class="attr">th:value</span>=<span class="string">&quot;$&#123;emp.getId()&#125;&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span> <span class="attr">name</span>=<span class="string">&quot;lastName&quot;</span> <span class="attr">th:value</span>=<span class="string">&quot;$&#123;emp.getLastName()&#125;&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-group&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">lable</span>&gt;</span>邮箱<span class="tag">&lt;/<span class="name">lable</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;email&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span> <span class="attr">name</span>=<span class="string">&quot;email&quot;</span> <span class="attr">th:value</span>=<span class="string">&quot;$&#123;emp.getEmail()&#125;&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-group&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">lable</span>&gt;</span>性别<span class="tag">&lt;/<span class="name">lable</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-check form-check-inline&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">form-check-input</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;gender&quot;</span> <span class="attr">value</span>=<span class="string">&quot;0&quot;</span> <span class="attr">th:checked</span>=<span class="string">&quot;$&#123;emp.getGender()==0&#125;&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">lable</span> <span class="attr">class</span>=<span class="string">form-check-label</span>&gt;</span>男<span class="tag">&lt;/<span class="name">lable</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-check form-check-inline&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">&quot;form-check-input&quot;</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;gender&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1&quot;</span> <span class="attr">th:checked</span>=<span class="string">&quot;$&#123;emp.getGender()==1&#125;&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">lable</span> <span class="attr">class</span>=<span class="string">&quot;form-check-label&quot;</span>&gt;</span>女<span class="tag">&lt;/<span class="name">lable</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-group&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">label</span>&gt;</span>部门<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">select</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span> <span class="attr">name</span>=<span class="string">&quot;department.id&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">option</span> <span class="attr">th:selected</span>=<span class="string">&quot;$&#123;dep.getDepartmentName()==emp.getDepartment()&#125;&quot;</span> <span class="attr">th:each</span>=<span class="string">&quot;dep:$&#123;departments&#125;&quot;</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;dep.getDepartmentName()&#125;&quot;</span> <span class="attr">th:value</span>=<span class="string">&quot;$&#123;dep.getId()&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-group&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">label</span>&gt;</span>生日<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span> <span class="attr">name</span>=<span class="string">&quot;birth&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;2020-5-22&quot;</span> <span class="attr">th:value</span>=<span class="string">&quot;$&#123;#dates.format(emp.getBirth(),&#x27;yyyy-MM-dd HH:mm:ss&#x27;)&#125;&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-primary&quot;</span>&gt;</span>修改<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">main</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>执行修改</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PostMapping(&quot;/updateEmp&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">doUpdEmp</span><span class="params">(Employee employee)</span>&#123;</span><br><span class="line">        employeeDao.save(employee);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;redirect:/emps&quot;</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>



<h4 id="删除："><a href="#删除：" class="headerlink" title="删除："></a>删除：</h4><ol>
<li><p>按钮<img src="/../assets/1619597763795.png" alt="1619597763795"></p>
</li>
<li><p>执行删除</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/delEmp/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">delEmp</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span>Integer id)</span>&#123;</span><br><span class="line">        employeeDao.delete(id);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;redirect:/emps&quot;</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h4 id="404页面："><a href="#404页面：" class="headerlink" title="404页面："></a>404页面：</h4><p>在templates文件下创建error文件夹，存放404页面，springboot自定识别</p>
<p><img src="/../assets/1619597883852.png" alt="1619597883852"></p>
<p>访问一个错误的页面时，会跳转至404页面；</p>
<p>500，400页面都是如此！</p>
</li>
</ol>
</li>
</ol>
<h1 id="前端："><a href="#前端：" class="headerlink" title="前端："></a>前端：</h1><ul>
<li><p>模板：别人写好的，我们拿来改就行了</p>
</li>
<li><p>框架：组件：自己手动组合拼接！Bootstrap，Layui，semantic-ui</p>
<ul>
<li>栅格系统</li>
<li>导航栏</li>
<li>侧边栏</li>
<li>表单</li>
</ul>
</li>
<li><p><strong>前端搞定后，知道页面长什么样子，数据怎么传</strong></p>
</li>
<li><p><strong>设计数据库（难点！）</strong></p>
</li>
<li><p><strong>前端可以独立运行，独立化工程</strong></p>
</li>
<li><p><strong>数据接口如何对接：json，对象all in one！</strong></p>
</li>
<li><p><strong>前后端联调测试！</strong></p>
</li>
</ul>
<ol>
<li><p>有一套自己熟悉的后台模板：工作必要！，———-xadmin</p>
</li>
<li><p>前端界面：至少自己能够通过前端框架，组合出来一个网站页面</p>
<ol>
<li>index</li>
<li>about</li>
<li>blog</li>
<li>post</li>
<li>user</li>
</ol>
</li>
<li><p>让这个网站可以独立运行！</p>
</li>
</ol>
<ul>
<li>JDBC</li>
<li><strong>mybatis：重点</strong></li>
<li><strong>Druid：重点</strong></li>
<li><strong>Shiro：重点  （安全）</strong></li>
<li><strong>Spring Security：重点 （安全）</strong></li>
<li>异步任务，邮件发送，定时任务</li>
<li>Swagger</li>
<li>Dubbo+Zookeeper</li>
</ul>
<h1 id="整合druid数据源"><a href="#整合druid数据源" class="headerlink" title="整合druid数据源"></a>整合druid数据源</h1><ol>
<li><p>application.yml</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#spring:</span></span><br><span class="line"><span class="comment">#  datasource:</span></span><br><span class="line"><span class="comment">#    username: root</span></span><br><span class="line"><span class="comment">#    password: 123456</span></span><br><span class="line"><span class="comment">#    rul: jdbc:mysql://localhost:3306/mybatis?serverTimezone=UTC&amp;useUnicode=true&amp;characterEncoding=utf-8</span></span><br><span class="line"><span class="comment">#    driver: com.mysql.jdbc.Driver</span></span><br><span class="line"></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line"><span class="attr">datasource:</span></span><br><span class="line"><span class="attr">data:</span></span><br><span class="line"><span class="attr">username:</span> <span class="string">root</span></span><br><span class="line"><span class="attr">password:</span> <span class="number">123456</span></span><br><span class="line"><span class="attr">url:</span> <span class="string">jdbc:mysql://localhost:3306/mybatis?serverTimezone=UTC&amp;useUnicode=true&amp;characterEncoding=utf-8</span></span><br><span class="line"><span class="attr">driver-class-name:</span> <span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line"><span class="attr">type:</span> <span class="string">com.alibaba.druid.pool.DruidDataSource</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#springboot默认是不注入这些属性值的，需要自己绑定</span></span><br><span class="line"><span class="comment">#druid 数据源专有配置</span></span><br><span class="line"><span class="attr">initialSize:</span> <span class="number">5</span></span><br><span class="line"><span class="attr">minIdle:</span> <span class="number">5</span></span><br><span class="line"><span class="attr">maxActive:</span> <span class="number">20</span></span><br><span class="line"><span class="attr">maxWait:</span> <span class="number">60000</span></span><br><span class="line"><span class="attr">timeBetweenEvictionRunsMillis:</span> <span class="number">60000</span></span><br><span class="line"><span class="attr">minEvictableIdleTimeMillis:</span> <span class="number">300000</span></span><br><span class="line"><span class="attr">validationQuery:</span> <span class="string">SELECT</span> <span class="number">1</span> <span class="string">FROM</span> <span class="string">DUAL</span></span><br><span class="line"><span class="attr">testWhileIdle:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">testOnBorrow:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">testOnReturn:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">poolPreparedStatements:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#配置监控统计拦截的filters,stat:监控统计,log4j:日志记录、wall:防御sql注入</span></span><br><span class="line"><span class="comment">#如果允许时报错  java.lang.ClassNotFoundException：org.apache.log4j.Priority</span></span><br><span class="line"><span class="comment">#则导入 log4j 依赖即可，maven 地址：https://mvnrepository.com/artifact/log4j/log4j</span></span><br><span class="line"><span class="attr">filters:</span> <span class="string">stat,wall,log4j</span></span><br><span class="line"><span class="attr">maxPoolPreparedStatementPerConnectionSize:</span> <span class="number">20</span></span><br><span class="line"><span class="attr">useGlobalDataSourceStat:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">connectionProperties:</span> <span class="string">druid.stat.mergeSql=true;druid.stat.slowSqlMills=500</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>config&#x3D;&#x3D;&#x3D;&gt;DruidConfig.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sec.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.druid.pool.DruidDataSource;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.druid.support.http.StatViewServlet;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.druid.support.http.WebStatFilter;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.context.properties.ConfigurationProperties;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.web.servlet.FilterRegistrationBean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.web.servlet.ServletRegistrationBean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.Filter;</span><br><span class="line"><span class="keyword">import</span> javax.sql.DataSource;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DruidConfig</span> &#123;</span><br><span class="line"><span class="comment">//与application.yml绑定</span></span><br><span class="line"><span class="meta">@ConfigurationProperties(&quot;spring.datasource&quot;)</span></span><br><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="keyword">public</span> DataSource <span class="title function_">druidDataSource</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">DruidDataSource</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//后台监控    ：web.xml   ,   ServletRegistrationBean</span></span><br><span class="line"><span class="comment">//因为springboot内置了servlet容器，所以没有web.xml， 替方法：ServletRegistrationBean</span></span><br><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="keyword">public</span> ServletRegistrationBean <span class="title function_">statViewServlet</span><span class="params">()</span>&#123;</span><br><span class="line">    ServletRegistrationBean&lt;StatViewServlet&gt; bean = <span class="keyword">new</span> <span class="title class_">ServletRegistrationBean</span>&lt;&gt;(<span class="keyword">new</span> <span class="title class_">StatViewServlet</span>(), <span class="string">&quot;/druid/*&quot;</span>);</span><br><span class="line">    HashMap&lt;String, String&gt; initParameters = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    initParameters.put(<span class="string">&quot;loginUsername&quot;</span>,<span class="string">&quot;admin&quot;</span>);</span><br><span class="line">    initParameters.put(<span class="string">&quot;loginPassword&quot;</span>,<span class="string">&quot;123456&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//谁可以访问</span></span><br><span class="line">    initParameters.put(<span class="string">&quot;allow&quot;</span>,<span class="string">&quot;&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//谁不能访问   initParameters.put(&quot;haojiacheng&quot;,&quot;192.168.11.123&quot;);</span></span><br><span class="line"></span><br><span class="line">    bean.setInitParameters(initParameters);<span class="comment">//设置初始化参数</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> bean;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//filter过滤器</span></span><br><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="keyword">public</span> FilterRegistrationBean <span class="title function_">webStatFilter</span><span class="params">()</span>&#123;</span><br><span class="line">    FilterRegistrationBean&lt;Filter&gt; bean = <span class="keyword">new</span> <span class="title class_">FilterRegistrationBean</span>&lt;&gt;();</span><br><span class="line">    bean.setFilter(<span class="keyword">new</span> <span class="title class_">WebStatFilter</span>());</span><br><span class="line">    <span class="comment">//可以过滤哪些请求呢？</span></span><br><span class="line">    HashMap&lt;String, String&gt; initParameters = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    <span class="comment">//这些东西不进行统计</span></span><br><span class="line">    initParameters.put(<span class="string">&quot;exclusions&quot;</span>,<span class="string">&quot;*.js,*.css,/druid/*&quot;</span>);</span><br><span class="line">    bean.setInitParameters(initParameters);</span><br><span class="line">    <span class="keyword">return</span>  bean;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ol>
<h1 id="整合mybatis数据源"><a href="#整合mybatis数据源" class="headerlink" title="整合mybatis数据源"></a>整合mybatis数据源</h1><ol>
<li><p>导入包</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.spring.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.1.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>配置文件<br>application.properties</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring.datasource.driver-class-name</span>=<span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line"><span class="attr">spring.datasource.username</span>=<span class="string">root</span></span><br><span class="line"><span class="attr">spring.datasource.password</span>=<span class="string">123456</span></span><br><span class="line"><span class="attr">spring.datasource.url</span>=<span class="string">jdbc:mysql://localhost:3306/mybatis?serverTimezone=UTC&amp;useUnicode=true&amp;characterEncoding=utf-8</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">#整合mybatis</span></span><br><span class="line"><span class="attr">mybatis.type-aliases-package</span>=<span class="string">com.sec.pojo</span></span><br><span class="line"><span class="attr">mybatis.mapper-locations</span>=<span class="string">classpath:mybatis/mapper/*.xml</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>编写sql</p>
</li>
<li><p>业务层调用dao层</p>
</li>
</ol>
<h1 id="springSecurity-安全"><a href="#springSecurity-安全" class="headerlink" title="springSecurity(安全)"></a>springSecurity(安全)</h1><p>在web开发中，安全第一位！过滤器，拦截器</p>
<p>功能性需求：否</p>
<p>做网站：安全应该在设计之初的时候考虑</p>
<ul>
<li>漏洞，隐私泄露</li>
<li>架构一旦确定，更改成本很高</li>
</ul>
<p>shiro、springSecurity:很像、除了类不一样，名字不一样；</p>
<p>认证，授权（vip1，vip2，vip3）</p>
<ul>
<li>功能权限</li>
<li>访问权限</li>
<li>菜单权限</li>
<li>……拦截器，过滤器：大量的原生代码   冗余</li>
</ul>
<p>MVC—spring—springboot—架构思想</p>
<p>AOP：横切—配置类</p>
<p><strong>简介</strong></p>
<p>Spring Security是针对spring项目的安全框架，也是springboot底层安全模块默认的技术选型，他可以实现强大的web安全控制，对于安全控制，我们仅需要引入spring-boot-starter-security模块，进行少量的配置，即可实现强大的安全管理！</p>
<p>记住几个类：</p>
<ul>
<li>WebSecurityConfigurerAdapter：自定义security策略</li>
<li>AuthenticationManagerBuilder：自定义认证策略</li>
<li>@EnableWebSecurity：开启WebSecurity模式   @Enablexxxx开启某个功能</li>
</ul>
<p>spring security的两个主要目标是“认证”和“授权”（访问控制）。</p>
<p>“认证”（Authentication）</p>
<p>“授权”（Authorization）</p>
<p>这个概念是通用的，而不是只在springsecurity中存在。</p>
<p>参考官网：<a target="_blank" rel="noopener" href="https://spring.io/projects/spring-security">https://spring.io/projects/spring-security</a> ,查看我们自己项目中的版本，找到对应的帮助文档：</p>
<p><a target="_blank" rel="noopener" href="https://docs.spring.io/spring-security/site/docs/5.2.0.RELEASE/reference/htmlsingle">https://docs.spring.io/spring-security/site/docs/5.2.0.RELEASE/reference/htmlsingle</a></p>
<h2 id="环境搭建："><a href="#环境搭建：" class="headerlink" title="环境搭建："></a>环境搭建：</h2><p>在com.sec下创建config，在config下创建SecurityConfig</p>
<p>导入依赖：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--security-thymeleaf整合包 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.thymeleaf.extras<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>thymeleaf-extras-springsecurity5<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.0.4.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--security--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-security<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--thymeleaf--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-thymeleaf<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--web--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="授权"><a href="#授权" class="headerlink" title="授权"></a>授权</h2><ul>
<li>权限访问问题</li>
<li>防止网站攻击，也是注销失败可能出现的原因</li>
</ul>
<h2 id="认证"><a href="#认证" class="headerlink" title="认证"></a>认证</h2><ul>
<li>通过设置用户登录名和密码以及权限来相对于的显示页面当前权限该显示的模块</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sec.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.security.config.annotation.authentication.builders.AuthenticationManagerBuilder;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.config.annotation.web.builders.HttpSecurity;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder;</span><br><span class="line"></span><br><span class="line"><span class="comment">//AOP思想</span></span><br><span class="line"><span class="meta">@EnableWebSecurity</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SecurityConfig</span> <span class="keyword">extends</span> <span class="title class_">WebSecurityConfigurerAdapter</span> &#123;</span><br><span class="line"><span class="comment">//授权</span></span><br><span class="line"><span class="comment">//链式编程</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">configure</span><span class="params">(HttpSecurity http)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    <span class="comment">//首页所有人可以访问，功能页只有有权限的人才可以访问</span></span><br><span class="line">    <span class="comment">//请求权限的规则</span></span><br><span class="line">    http.authorizeRequests()</span><br><span class="line">            .antMatchers(<span class="string">&quot;/&quot;</span>).permitAll()</span><br><span class="line">            .antMatchers(<span class="string">&quot;/level1/**&quot;</span>).hasRole(<span class="string">&quot;vip1&quot;</span>)</span><br><span class="line">            .antMatchers(<span class="string">&quot;/level2/**&quot;</span>).hasRole(<span class="string">&quot;vip2&quot;</span>)</span><br><span class="line">            .antMatchers(<span class="string">&quot;/level3/**&quot;</span>).hasRole(<span class="string">&quot;vip3&quot;</span>);</span><br><span class="line">    <span class="comment">//没有权限默认跳转到登录界面    /login</span></span><br><span class="line">    http.formLogin();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//防止网站攻击</span></span><br><span class="line">    http.csrf().disable();<span class="comment">//注销失败可能出现的原因</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//注销    清楚cookie和session：   logout().deleteCookies(&quot;remove&quot;).invalidateHttpSession(true)</span></span><br><span class="line">    <span class="comment">//    .logoutUrl()  ：注销的页面     logoutSuccessUrl(&quot;/&quot;)  ： 注销成功的页面</span></span><br><span class="line">    http.logout().logoutSuccessUrl(<span class="string">&quot;/&quot;</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//认证</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">configure</span><span class="params">(AuthenticationManagerBuilder auth)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    auth.inMemoryAuthentication().passwordEncoder(<span class="keyword">new</span> <span class="title class_">BCryptPasswordEncoder</span>())</span><br><span class="line">            .withUser(<span class="string">&quot;haojiacheng&quot;</span>).password(<span class="keyword">new</span> <span class="title class_">BCryptPasswordEncoder</span>().encode(<span class="string">&quot;123456&quot;</span>)).roles(<span class="string">&quot;vip2&quot;</span>,<span class="string">&quot;vip3&quot;</span>)</span><br><span class="line">            .and().withUser(<span class="string">&quot;mihua&quot;</span>).password(<span class="keyword">new</span> <span class="title class_">BCryptPasswordEncoder</span>().encode(<span class="string">&quot;654321&quot;</span>)).roles(<span class="string">&quot;vip1&quot;</span>,<span class="string">&quot;vip2&quot;</span>,<span class="string">&quot;vip3&quot;</span>)</span><br><span class="line">            .and().withUser(<span class="string">&quot;user&quot;</span>).password(<span class="keyword">new</span> <span class="title class_">BCryptPasswordEncoder</span>().encode(<span class="string">&quot;111111&quot;</span>)).roles(<span class="string">&quot;vip1&quot;</span>)</span><br><span class="line">            .and().withUser(<span class="string">&quot;zhangsan&quot;</span>).password(<span class="keyword">new</span> <span class="title class_">BCryptPasswordEncoder</span>().encode(<span class="string">&quot;123456&quot;</span>)).roles(<span class="string">&quot;vip1&quot;</span>)</span><br><span class="line">            .and().withUser(<span class="string">&quot;lisi&quot;</span>).password(<span class="keyword">new</span> <span class="title class_">BCryptPasswordEncoder</span>().encode(<span class="string">&quot;123456&quot;</span>)).roles(<span class="string">&quot;vip2&quot;</span>)</span><br><span class="line">            .and().withUser(<span class="string">&quot;wangwu&quot;</span>).password(<span class="keyword">new</span> <span class="title class_">BCryptPasswordEncoder</span>().encode(<span class="string">&quot;123456&quot;</span>)).roles(<span class="string">&quot;vip3&quot;</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="用户名与角色权限显示"><a href="#用户名与角色权限显示" class="headerlink" title="用户名与角色权限显示"></a>用户名与角色权限显示</h2><p><img src="/../assets/1619700092953.png" alt="1619700092953"></p>
<h2 id="不同的权限显示不同的模块："><a href="#不同的权限显示不同的模块：" class="headerlink" title="不同的权限显示不同的模块："></a>不同的权限显示不同的模块：</h2><p><img src="/../assets/1619699458129.png" alt="1619699458129"></p>
<h2 id="记住我："><a href="#记住我：" class="headerlink" title="记住我："></a>记住我：</h2><p><img src="/../assets/1619700528150.png" alt="1619700528150"></p>
<ul>
<li>用户勾选后，网页存入cookie，cookie存在时长14天</li>
<li>但是用户手动删除cookie或者注销，则<code>记住我</code>失效</li>
</ul>
<h2 id="首页定制："><a href="#首页定制：" class="headerlink" title="首页定制："></a>首页定制：</h2><ul>
<li><p>loginPage(“&#x2F;toLogin”)：设置自定义登录页面</p>
</li>
<li><p>usernameParameter(“user”)：设置自定义登录页面的用户输入的用户名的name</p>
</li>
<li><p>passwordParameter(“pwd”)：设置自定义登录页面的用户输入的密码的name</p>
<ul>
<li><pre><code class="html">&lt;form th:action=&quot;@&#123;/login&#125;&quot; method=&quot;post&quot;&gt;
    &lt;div class=&quot;field&quot;&gt;
        &lt;label&gt;Username&lt;/label&gt;
        &lt;div class=&quot;ui left icon input&quot;&gt;
            &lt;input type=&quot;text&quot; placeholder=&quot;Username&quot; name=&quot;user&quot;&gt;
            &lt;i class=&quot;user icon&quot;&gt;&lt;/i&gt;
        &lt;/div&gt;
    &lt;/div&gt;
    &lt;div class=&quot;field&quot;&gt;
        &lt;label&gt;Password&lt;/label&gt;
        &lt;div class=&quot;ui left icon input&quot;&gt;
            &lt;input type=&quot;password&quot; name=&quot;pwd&quot;&gt;
            &lt;i class=&quot;lock icon&quot;&gt;&lt;/i&gt;
        &lt;/div&gt;
    &lt;/div&gt;
    &lt;div class=&quot;field&quot;&gt;
        &lt;input type=&quot;checkbox&quot; name=&quot;remember&quot;&gt;记住我
    &lt;/div&gt;
    &lt;input type=&quot;submit&quot; class=&quot;ui blue submit button&quot;/&gt;
&lt;/form&gt;
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- loginProcessingUrl(&quot;/login&quot;)：设置登录提交信息的页面，也就是自己跳转自己，springboot判断正确则跳至主页面</span><br><span class="line"></span><br><span class="line">~~~java</span><br><span class="line">http.formLogin().loginPage(&quot;/toLogin&quot;).usernameParameter(&quot;user&quot;).passwordParameter(&quot;pwd&quot;).loginProcessingUrl(&quot;/login&quot;);</span><br></pre></td></tr></table></figure>
</code></pre>
</li>
</ul>
</li>
</ul>
<h2 id="Shiro"><a href="#Shiro" class="headerlink" title="Shiro"></a>Shiro</h2><h3 id="maven项目："><a href="#maven项目：" class="headerlink" title="maven项目："></a><strong>maven项目：</strong></h3><ol>
<li><p>导入依赖  pom.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.shiro<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>shiro-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.4.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- configure logging --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.slf4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jcl-over-slf4j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.7.21<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.slf4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>slf4j-log4j12<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.7.21<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.17<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>配置文件</p>
<ol>
<li><p>log4j.properties:</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">log4j.rootLogger</span>=<span class="string">INFO, stdout</span></span><br><span class="line"></span><br><span class="line"><span class="attr">log4j.appender.stdout</span>=<span class="string">org.apache.log4j.ConsoleAppender</span></span><br><span class="line"><span class="attr">log4j.appender.stdout.layout</span>=<span class="string">org.apache.log4j.PatternLayout</span></span><br><span class="line"><span class="attr">log4j.appender.stdout.layout.ConversionPattern</span>=<span class="string">%d %p [%c] - %m %n</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># General Apache libraries</span></span><br><span class="line"><span class="attr">log4j.logger.org.apache</span>=<span class="string">WARN</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># Spring</span></span><br><span class="line"><span class="attr">log4j.logger.org.springframework</span>=<span class="string">WARN</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># Default Shiro logging</span></span><br><span class="line"><span class="attr">log4j.logger.org.apache.shiro</span>=<span class="string">INFO</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># Disable verbose logging</span></span><br><span class="line"><span class="attr">log4j.logger.org.apache.shiro.util.ThreadContext</span>=<span class="string">WARN</span></span><br><span class="line"><span class="attr">log4j.logger.org.apache.shiro.cache.ehcache.EhCache</span>=<span class="string">WARN</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>shiro.ini:    如果没有代码没有高亮 去下载idea的插件：ini </p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[users]</span></span><br><span class="line"><span class="comment"># user &#x27;root&#x27; with password &#x27;secret&#x27; and the &#x27;admin&#x27; role</span></span><br><span class="line"><span class="attr">root</span> = secret, admin</span><br><span class="line"><span class="comment"># user &#x27;guest&#x27; with the password &#x27;guest&#x27; and the &#x27;guest&#x27; role</span></span><br><span class="line"><span class="attr">guest</span> = guest, guest</span><br><span class="line"><span class="comment"># user &#x27;presidentskroob&#x27; with password &#x27;12345&#x27; (&quot;That&#x27;s the same combination on</span></span><br><span class="line"><span class="comment"># my luggage!!!&quot; ;)), and role &#x27;president&#x27;</span></span><br><span class="line"><span class="attr">presidentskroob</span> = <span class="number">12345</span>, president</span><br><span class="line"><span class="comment"># user &#x27;darkhelmet&#x27; with password &#x27;ludicrousspeed&#x27; and roles &#x27;darklord&#x27; and &#x27;schwartz&#x27;</span></span><br><span class="line"><span class="attr">darkhelmet</span> = ludicrousspeed, darklord, schwartz</span><br><span class="line"><span class="comment"># user &#x27;lonestarr&#x27; with password &#x27;vespa&#x27; and roles &#x27;goodguy&#x27; and &#x27;schwartz&#x27;</span></span><br><span class="line"><span class="attr">lonestarr</span> = vespa, goodguy, schwartz</span><br><span class="line"></span><br><span class="line"><span class="comment"># -----------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment"># Roles with assigned permissions</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Each line conforms to the format defined in the</span></span><br><span class="line"><span class="comment"># org.apache.shiro.realm.text.TextConfigurationRealm#setRoleDefinitions JavaDoc</span></span><br><span class="line"><span class="comment"># -----------------------------------------------------------------------------</span></span><br><span class="line"><span class="section">[roles]</span></span><br><span class="line"><span class="comment"># &#x27;admin&#x27; role has all permissions, indicated by the wildcard &#x27;*&#x27;</span></span><br><span class="line"><span class="attr">admin</span> = *</span><br><span class="line"><span class="comment"># The &#x27;schwartz&#x27; role can do anything (*) with any lightsaber:</span></span><br><span class="line"><span class="attr">schwartz</span> = lightsaber:*</span><br><span class="line"><span class="comment"># The &#x27;goodguy&#x27; role is allowed to &#x27;drive&#x27; (action) the winnebago (type) with</span></span><br><span class="line"><span class="comment"># license plate &#x27;eagle5&#x27; (instance specific id)</span></span><br><span class="line"><span class="attr">goodguy</span> = winnebago:drive:eagle5</span><br></pre></td></tr></table></figure>
</li>
<li><p>QuickStart.java:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.shiro.SecurityUtils;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.authc.*;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.config.IniSecurityManagerFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.mgt.SecurityManager;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.session.Session;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.subject.Subject;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.util.Factory;</span><br><span class="line"><span class="keyword">import</span> org.slf4j.Logger;</span><br><span class="line"><span class="keyword">import</span> org.slf4j.LoggerFactory;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Quickstart</span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">transient</span> <span class="type">Logger</span> <span class="variable">log</span> <span class="operator">=</span> LoggerFactory.getLogger(Quickstart.class);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 创建具有已配置领域，用户，角色和权限的Shiro SecurityManager的最简单方法是使用简单的INI配置。</span></span><br><span class="line">    <span class="comment">// 我们将通过使用可以提取.ini文件并返回SecurityManager实例的工厂来做到这一点：</span></span><br><span class="line">    <span class="comment">// 在类路径的根目录下使用shiro.ini文件（分别从文件和url加载前缀：file：和url：）：</span></span><br><span class="line">    Factory&lt;SecurityManager&gt; factory = <span class="keyword">new</span> <span class="title class_">IniSecurityManagerFactory</span>(<span class="string">&quot;classpath:shiro.ini&quot;</span>);</span><br><span class="line">    <span class="type">SecurityManager</span> <span class="variable">securityManager</span> <span class="operator">=</span> factory.getInstance();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 对于这个简单的示例快速入门，使SecurityManager可以作为JVM单例进行访问。大多数应用程序不会这样做，</span></span><br><span class="line">    <span class="comment">// 而是依赖于其容器配置或webapps的web.xml。这超出了此简单快速入门的范围，因此我们将只做最少的工作，</span></span><br><span class="line">    <span class="comment">// 以便您可以继续感受一下。</span></span><br><span class="line">    SecurityUtils.setSecurityManager(securityManager);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获取当前执行的用户：Subject</span></span><br><span class="line">    <span class="type">Subject</span> <span class="variable">currentUser</span> <span class="operator">=</span> SecurityUtils.getSubject();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 通过当前用户拿到session</span></span><br><span class="line">    <span class="type">Session</span> <span class="variable">session</span> <span class="operator">=</span> currentUser.getSession();</span><br><span class="line">    session.setAttribute(<span class="string">&quot;someKey&quot;</span>, <span class="string">&quot;aValue&quot;</span>);</span><br><span class="line">    <span class="type">String</span> <span class="variable">value</span> <span class="operator">=</span> (String) session.getAttribute(<span class="string">&quot;someKey&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (value.equals(<span class="string">&quot;aValue&quot;</span>)) &#123;</span><br><span class="line">        log.info(<span class="string">&quot;Subject==&gt;Session [&quot;</span> + value + <span class="string">&quot;]&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 判断当前的用户是否被认证   isAuthenticated=&gt;已认证</span></span><br><span class="line">    <span class="keyword">if</span> (!currentUser.isAuthenticated()) &#123;</span><br><span class="line">        <span class="type">UsernamePasswordToken</span> <span class="variable">token</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UsernamePasswordToken</span>(<span class="string">&quot;lonestarr&quot;</span>, <span class="string">&quot;vespa&quot;</span>);</span><br><span class="line">        token.setRememberMe(<span class="literal">true</span>);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//登录</span></span><br><span class="line">            currentUser.login(token);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (UnknownAccountException uae) &#123;<span class="comment">//未知帐户异常</span></span><br><span class="line">            log.info(<span class="string">&quot;There is no user with username of &quot;</span> + token.getPrincipal());</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IncorrectCredentialsException ice) &#123;<span class="comment">//账号密码不正确</span></span><br><span class="line">            log.info(<span class="string">&quot;Password for account &quot;</span> + token.getPrincipal() + <span class="string">&quot; was incorrect!&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (LockedAccountException lae) &#123;<span class="comment">//锁定帐户异常</span></span><br><span class="line">            log.info(<span class="string">&quot;The account for username &quot;</span> + token.getPrincipal() + <span class="string">&quot; is locked.  &quot;</span> +</span><br><span class="line">                    <span class="string">&quot;Please contact your administrator to unlock it.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 在这里捕获更多异常（也许是针对您的应用程序的自定义异常？</span></span><br><span class="line">        <span class="keyword">catch</span> (AuthenticationException ae) &#123;</span><br><span class="line">            <span class="comment">//意外情况？错误？</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//说出他们是谁：打印其身份验证主体（在这种情况下，为用户名）：</span></span><br><span class="line">    log.info(<span class="string">&quot;User [&quot;</span> + currentUser.getPrincipal() + <span class="string">&quot;] logged in successfully.&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//测试角色：</span></span><br><span class="line">    <span class="keyword">if</span> (currentUser.hasRole(<span class="string">&quot;schwartz&quot;</span>)) &#123;</span><br><span class="line">        log.info(<span class="string">&quot;May the Schwartz be with you!&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        log.info(<span class="string">&quot;Hello, mere mortal.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//测试类型化的权限（不是实例级别）  isPermitted: 被允许</span></span><br><span class="line">    <span class="keyword">if</span> (currentUser.isPermitted(<span class="string">&quot;lightsaber:wield&quot;</span>)) &#123;</span><br><span class="line">        log.info(<span class="string">&quot;You may use a lightsaber ring.  Use it wisely.&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        log.info(<span class="string">&quot;Sorry, lightsaber rings are for schwartz masters only.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//（非常强大的）实例级别权限：</span></span><br><span class="line">    <span class="keyword">if</span> (currentUser.isPermitted(<span class="string">&quot;winnebago:drive:eagle5&quot;</span>)) &#123;</span><br><span class="line">        log.info(<span class="string">&quot;You are permitted to &#x27;drive&#x27; the winnebago with license plate (id) &#x27;eagle5&#x27;.  &quot;</span> +</span><br><span class="line">                <span class="string">&quot;Here are the keys - have fun!&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        log.info(<span class="string">&quot;Sorry, you aren&#x27;t allowed to drive the &#x27;eagle5&#x27; winnebago!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//注销！</span></span><br><span class="line">    currentUser.logout();</span><br><span class="line"></span><br><span class="line">    System.exit(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ol>
</li>
<li><p>Hello World!<br><img src="/../assets/1619745491515.png" alt="1619745491515"></p>
</li>
</ol>
<p>Spring Security都有</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Subject</span> <span class="variable">currentUser</span> <span class="operator">=</span> SecurityUtils.getSubject();<span class="comment">//获取当前用户</span></span><br><span class="line"><span class="type">Session</span> <span class="variable">session</span> <span class="operator">=</span> currentUser.getSession();<span class="comment">//通过当前用户获取session</span></span><br><span class="line">!currentUser.isAuthenticated()；<span class="comment">//当前用户未认证</span></span><br><span class="line">currentUser.login(token);<span class="comment">//登录</span></span><br><span class="line">currentUser.hasRole(<span class="string">&quot;schwartz&quot;</span>)；<span class="comment">//当前用户的角色</span></span><br><span class="line">currentUser.isPermitted(<span class="string">&quot;lightsaber:wield&quot;</span>)；<span class="comment">//当前用户有什么权限</span></span><br><span class="line">currentUser.isPermitted(<span class="string">&quot;winnebago:drive:eagle5&quot;</span>)；<span class="comment">//权限</span></span><br><span class="line">currentUser.logout();<span class="comment">//注销</span></span><br><span class="line">System.exit(<span class="number">0</span>);<span class="comment">//系统结束</span></span><br></pre></td></tr></table></figure>

<h3 id="springboot集成shiro"><a href="#springboot集成shiro" class="headerlink" title="springboot集成shiro"></a>springboot集成shiro</h3><h4 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h4><ul>
<li>pom.xml:       spring-boot-starter-parent&#x3D;&#x3D;&#x3D;&gt;2.4.5</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.shiro<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>shiro-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.shiro<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>shiro-spring<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.4.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.shiro<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>shiro-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.4.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.thymeleaf<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>thymeleaf-spring5<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.thymeleaf.extras<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>thymeleaf-extras-java8time<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-thymeleaf<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>配置文件和controller<br><img src="/../assets/1619750994887.png" alt="1619750994887"></p>
<ul>
<li><p>ShiroConfig:java:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sec.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.spring.web.ShiroFilterFactoryBean;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.web.mgt.DefaultWebSecurityManager;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Qualifier;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ShiroConfig</span> &#123;</span><br><span class="line">    <span class="comment">//ShiroFilterFactoryBean:3</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> ShiroFilterFactoryBean <span class="title function_">getShiroFilterFactoryBean</span><span class="params">(<span class="meta">@Qualifier(&quot;getDefaultWebSecurityManager&quot;)</span> DefaultWebSecurityManager defaultWebSecurityManager)</span>&#123;</span><br><span class="line">        ShiroFilterFactoryBean bean=<span class="keyword">new</span> <span class="title class_">ShiroFilterFactoryBean</span>();</span><br><span class="line">        <span class="comment">//设置安全管理器</span></span><br><span class="line">        bean.setSecurityManager(defaultWebSecurityManager);</span><br><span class="line">        <span class="keyword">return</span> bean;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//DefaultWebSecurityManager:2</span></span><br><span class="line">    <span class="comment">//如果我们在某个注入点需要另一个 bean，我们需要专门指出它。我们可以通过 @Qualifier 注解来做到这一点。</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> DefaultWebSecurityManager <span class="title function_">getDefaultWebSecurityManager</span><span class="params">(<span class="meta">@Qualifier(&quot;userRealm&quot;)</span> UserRealm userRealm)</span>&#123;</span><br><span class="line">        <span class="type">DefaultWebSecurityManager</span> <span class="variable">securityManager</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DefaultWebSecurityManager</span>();</span><br><span class="line">        <span class="comment">//关联UserRealm</span></span><br><span class="line">        securityManager.setRealm(userRealm);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> securityManager;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//创建 realm 对象 ， 需要自定义:1</span></span><br><span class="line">    <span class="meta">@Bean(name = &quot;userRealm&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> UserRealm <span class="title function_">userRealm</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">UserRealm</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
<li><p>UserRealm.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sec.config;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.authc.AuthenticationException;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.authc.AuthenticationInfo;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.authc.AuthenticationToken;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.authz.AuthorizationInfo;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.realm.AuthorizingRealm;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.subject.PrincipalCollection;</span><br><span class="line"></span><br><span class="line"><span class="comment">//自定义的 UserRealm</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserRealm</span> <span class="keyword">extends</span> <span class="title class_">AuthorizingRealm</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="comment">//doGetAuthenticationInfo：获取身份验证信息</span></span><br><span class="line">    <span class="keyword">protected</span> AuthenticationInfo <span class="title function_">doGetAuthenticationInfo</span><span class="params">(AuthenticationToken authenticationToken)</span> <span class="keyword">throws</span> AuthenticationException &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;执行了=&gt;授权doGetAuthenticationInfo:获取身份验证信息&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="comment">//doGetAuthorizationInfo：获取授权信息</span></span><br><span class="line">    <span class="keyword">protected</span> AuthorizationInfo <span class="title function_">doGetAuthorizationInfo</span><span class="params">(PrincipalCollection principalCollection)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;执行了=&gt;doGetAuthorizationInfo:获取授权信息&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
<li><p>MyController.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sec.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.ui.Model;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyController</span> &#123;</span><br><span class="line">    <span class="meta">@RequestMapping(&#123;&quot;/&quot;,&quot;/index&quot;,&quot;/index.html&quot;&#125;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toIndex</span><span class="params">(Model model)</span>&#123;</span><br><span class="line">        model.addAttribute(<span class="string">&quot;msg&quot;</span>,<span class="string">&quot;hello shiro&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;index&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/user/add&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">add</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;user/add&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/user/upd&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">upd</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;/user/upd&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>页面：<br><img src="/../assets/1619751125107.png" alt="1619751125107"></p>
<ul>
<li><p>add.html：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>add<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>upd.html：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>upd<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>index.html：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>我是index<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;msg&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/user/add&#125;&quot;</span>&gt;</span>add<span class="tag">&lt;/<span class="name">a</span>&gt;</span> ||  <span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/user/upd&#125;&quot;</span>&gt;</span>upd<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>application.properties：</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring.thymeleaf.cache</span>=<span class="string">false</span></span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<h4 id="Shiro实现登录拦截"><a href="#Shiro实现登录拦截" class="headerlink" title="Shiro实现登录拦截"></a>Shiro实现登录拦截</h4><ul>
<li><p>Shiro的内置过滤器</p>
<ul>
<li>anon：无需认证就可以访问</li>
<li>authc：必须认证了才能访问</li>
<li>user：必须拥有  记住我  功能才能用</li>
<li>perms：拥有对某个资源的权限才能访问</li>
</ul>
</li>
<li><pre><code class="java">LinkedHashMap&lt;String, String&gt; filterMap = new LinkedHashMap&lt;&gt;();
filterMap.put(&quot;/user/*&quot;,&quot;authc&quot;);
bean.setFilterChainDefinitionMap(filterMap);
//设置登录的请求
bean.setLoginUrl(&quot;/toLogin&quot;);
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">1. UserRealm：</span><br><span class="line"></span><br><span class="line">   ~~~java</span><br><span class="line">   @Override</span><br><span class="line">   //doGetAuthenticationInfo：获取身份验证信息</span><br><span class="line">   protected AuthenticationInfo doGetAuthenticationInfo(AuthenticationToken authenticationToken) throws AuthenticationException &#123;</span><br><span class="line">       System.out.println(&quot;执行了=&gt;认证doGetAuthenticationInfo:获取身份验证信息&quot;);</span><br><span class="line">   </span><br><span class="line">       //用户名和密码  原本来数据库中取</span><br><span class="line">       String name=&quot;admin&quot;;</span><br><span class="line">       String pwd=&quot;123123&quot;;</span><br><span class="line">   </span><br><span class="line">       //加密令牌</span><br><span class="line">       UsernamePasswordToken uToken= (UsernamePasswordToken) authenticationToken;</span><br><span class="line">       //判断用户名</span><br><span class="line">       if(!uToken.getUsername().equals(name))&#123;</span><br><span class="line">           return null;//这里返回null  也就是抛出异常 UnknownAccountException</span><br><span class="line">       &#125;</span><br><span class="line">       //密码认证：shiro做</span><br><span class="line">       return new SimpleAuthenticationInfo(&quot;&quot;,pwd,&quot;&quot;);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
</code></pre>
</li>
</ul>
<ol start="2">
<li><p>login.html：  登录界面</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>登录<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>登录<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;msg&#125;&quot;</span> <span class="attr">style</span>=<span class="string">&quot;color: red&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">th:action</span>=<span class="string">&quot;@&#123;/login&#125;&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>用户名：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>密码：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> &gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>跳转登录  and    登录执行</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/toLogin&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toLogin</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;login&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/login&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">login</span><span class="params">(String username,String password,Model model)</span>&#123;</span><br><span class="line">    <span class="comment">//获取当前用户</span></span><br><span class="line">    <span class="type">Subject</span> <span class="variable">subject</span> <span class="operator">=</span> SecurityUtils.getSubject();</span><br><span class="line">    <span class="comment">//封装用户的登录数据</span></span><br><span class="line">    <span class="type">UsernamePasswordToken</span> <span class="variable">token</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UsernamePasswordToken</span>(username, password);</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        subject.login(token);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;index&quot;</span>;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (UnknownAccountException e) &#123;</span><br><span class="line">        model.addAttribute(<span class="string">&quot;msg&quot;</span>,<span class="string">&quot;用户名错误&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;login&quot;</span>;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IncorrectCredentialsException e)&#123;</span><br><span class="line">        model.addAttribute(<span class="string">&quot;msg&quot;</span>,<span class="string">&quot;密码错误&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;login&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h4 id="Shiro整合mybatis"><a href="#Shiro整合mybatis" class="headerlink" title="Shiro整合mybatis"></a>Shiro整合mybatis</h4><ol>
<li><p>pom.xml:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.shiro<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>shiro-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.18.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.17<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1.21<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.spring.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.1.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.shiro<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>shiro-spring<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.4.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.shiro<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>shiro-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.4.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.thymeleaf<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>thymeleaf-spring5<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.thymeleaf.extras<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>thymeleaf-extras-java8time<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-thymeleaf<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>application.properties:</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring.datasource.driver-class-name</span>=<span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line"><span class="attr">spring.datasource.username</span>=<span class="string">root</span></span><br><span class="line"><span class="attr">spring.datasource.password</span>=<span class="string">123456</span></span><br><span class="line"><span class="attr">spring.datasource.url</span>=<span class="string">jdbc:mysql://localhost:3306/mybatis?serverTimezone=UTC&amp;useUnicode=true&amp;characterEncoding=utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="attr">mybatis.type-aliases-package</span>=<span class="string">com.sec.pojo</span></span><br><span class="line"><span class="attr">mybatis.mapper-locations</span>=<span class="string">classpath:mapper/*.xml</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>UserRealm.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sec.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sec.pojo.User;</span><br><span class="line"><span class="keyword">import</span> com.sec.service.userService;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.authc.*;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.authz.AuthorizationInfo;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.realm.AuthorizingRealm;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.subject.PrincipalCollection;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"></span><br><span class="line"><span class="comment">//自定义的 UserRealm</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserRealm</span> <span class="keyword">extends</span> <span class="title class_">AuthorizingRealm</span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> userService uS;</span><br><span class="line"></span><br><span class="line"><span class="comment">//授权</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="comment">//doGetAuthorizationInfo：获取授权信息</span></span><br><span class="line"><span class="keyword">protected</span> AuthorizationInfo <span class="title function_">doGetAuthorizationInfo</span><span class="params">(PrincipalCollection principalCollection)</span> &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;执行了=&gt;授权doGetAuthorizationInfo:获取授权信息&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//认证</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="comment">//doGetAuthenticationInfo：获取身份验证信息</span></span><br><span class="line"><span class="keyword">protected</span> AuthenticationInfo <span class="title function_">doGetAuthenticationInfo</span><span class="params">(AuthenticationToken authenticationToken)</span> <span class="keyword">throws</span> AuthenticationException &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;执行了=&gt;认证doGetAuthenticationInfo:获取身份验证信息&quot;</span>);</span><br><span class="line">    <span class="comment">//加密令牌</span></span><br><span class="line">    UsernamePasswordToken uToken= (UsernamePasswordToken) authenticationToken;</span><br><span class="line">    <span class="type">User</span> <span class="variable">u</span> <span class="operator">=</span> uS.selectUserByName(uToken.getUsername());</span><br><span class="line">    <span class="keyword">if</span>(u==<span class="literal">null</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span>  <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//密码可以加密：MD5  MD5盐值加密</span></span><br><span class="line">    <span class="comment">//密码认证：shiro做</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">SimpleAuthenticationInfo</span>(<span class="string">&quot;&quot;</span>,u.getPwd(),<span class="string">&quot;&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
<li><p>mapper&#x3D;&gt;userMapper.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sec.mapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sec.pojo.User;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Mapper;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Repository;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Repository</span></span><br><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">userMapper</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> User <span class="title function_">selectUserByName</span><span class="params">(String name)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
<li><p>service&#x3D;&gt;userService.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sec.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sec.pojo.User;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">userService</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> User <span class="title function_">selectUserByName</span><span class="params">(String name)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
<li><p>service&#x3D;&gt;userServiceImpl.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sec.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sec.mapper.userMapper;</span><br><span class="line"><span class="keyword">import</span> com.sec.pojo.User;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">userServiceImpl</span>  <span class="keyword">implements</span> <span class="title class_">userService</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> userMapper uM;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> User <span class="title function_">selectUserByName</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> uM.selectUserByName(name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
<li><p>resource&#x3D;&gt;mapper&#x3D;&gt;userMapper.xml:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">mapper</span></span></span><br><span class="line"><span class="meta">        <span class="keyword">PUBLIC</span> <span class="string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.sec.mapper.userMapper&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;selectUserByName&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;User&quot;</span>&gt;</span></span><br><span class="line">        select * from user where name = #&#123;name&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>pojo&#x3D;&gt;User.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sec.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.AllArgsConstructor;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> lombok.NoArgsConstructor;</span><br><span class="line"><span class="keyword">import</span> lombok.ToString;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@ToString</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String pwd;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ol>
<h4 id="请求授权实现"><a href="#请求授权实现" class="headerlink" title="请求授权实现"></a>请求授权实现</h4><ol>
<li><pre><code class="java">//授权，正常的情况下，没有授权会跳转到未授权页面
filterMap.put(&quot;/user/add&quot;,&quot;perms[user:add]&quot;);//用户user需要拥有对add资源的权限
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">2. ~~~java</span><br><span class="line">   //设置未授权页面</span><br><span class="line">   bean.setUnauthorizedUrl(&quot;/noauth&quot;);</span><br></pre></td></tr></table></figure>
</code></pre>
</li>
<li><pre><code class="java">@RequestMapping(&quot;/noauth&quot;)
@ResponseBody
public String unauthorized()&#123;
    return &quot;未经授权不得进入&quot;;
&#125;
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">![1620224715645](../assets/1620224715645.png)</span><br><span class="line"></span><br><span class="line">#### 用户登录访问授权</span><br><span class="line"></span><br><span class="line">- 从数据库拿用户的权限：</span><br><span class="line"></span><br><span class="line">  ~~~java</span><br><span class="line">  //授权</span><br><span class="line">  @Override</span><br><span class="line">  //doGetAuthorizationInfo：获取授权信息</span><br><span class="line">  protected AuthorizationInfo doGetAuthorizationInfo(PrincipalCollection principalCollection) &#123;</span><br><span class="line">      System.out.println(&quot;执行了=&gt;授权doGetAuthorizationInfo:获取授权信息&quot;);</span><br><span class="line">      //SimpleAuthorizationInfo</span><br><span class="line">      SimpleAuthorizationInfo info = new SimpleAuthorizationInfo();</span><br><span class="line">      //拿到当前登录的这个对象</span><br><span class="line">      Subject subject = SecurityUtils.getSubject();</span><br><span class="line">      //拿到user对象</span><br><span class="line">      User currentUser = (User) subject.getPrincipal();</span><br><span class="line">      //设置当前用户权限</span><br><span class="line">      info.addStringPermission(currentUser.getPerms());</span><br><span class="line">      return info;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
</code></pre>
</li>
</ol>
<ul>
<li><p>设置用户对某资源的权限</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//授权，正常的情况下，没有授权会跳转到未授权页面</span></span><br><span class="line">filterMap.put(<span class="string">&quot;/user/add&quot;</span>,<span class="string">&quot;perms[user:add]&quot;</span>);</span><br><span class="line">filterMap.put(<span class="string">&quot;/user/upd&quot;</span>,<span class="string">&quot;perms[user:update]&quot;</span>);</span><br></pre></td></tr></table></figure></li>
</ul>
<p>数据库表：<img src="/../assets/1620225869814.png" alt="1620225869814"></p>
<p>测试结果：root用户没有进入add的权限，user用户没有进入upd的权限</p>
<h4 id="Shiro整合Thymeleaf"><a href="#Shiro整合Thymeleaf" class="headerlink" title="Shiro整合Thymeleaf"></a>Shiro整合Thymeleaf</h4><p>导入依赖：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.github.theborakompanioni<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>thymeleaf-extras-shiro<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>写Bean</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="keyword">public</span> ShiroDialect <span class="title function_">getShiroDialect</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ShiroDialect</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<ul>
<li><p>方法一：在认证时存入当前用户到session中</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Subject</span> <span class="variable">subject</span> <span class="operator">=</span> SecurityUtils.getSubject();</span><br><span class="line"><span class="type">Session</span> <span class="variable">session</span> <span class="operator">=</span> subject.getSession();</span><br><span class="line">session.setAttribute(<span class="string">&quot;loginUser&quot;</span>,u);</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">th:if</span>=<span class="string">&quot;$&#123;session.get(&#x27;loginUser&#x27;)==null&#125;&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/toLogin&#125;&quot;</span>&gt;</span>登录<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>方法二：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">shiro:guest</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/toLogin&#125;&quot;</span>&gt;</span>登录<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>方法三：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">shiro:notAuthenticated</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/toLogin&#125;&quot;</span>&gt;</span>登录<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">shiro:hasPermission</span>=<span class="string">&quot;user:add&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/user/add&#125;&quot;</span>&gt;</span>add<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">shiro:hasPermission</span>=<span class="string">&quot;user:update&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/user/upd&#125;&quot;</span>&gt;</span>upd<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="Swagger"><a href="#Swagger" class="headerlink" title="Swagger"></a>Swagger</h4><p>学习目标：</p>
<ul>
<li>了解Swagger的作用和概念</li>
<li>了解前后端分离</li>
<li>在SpringBoot中集成Swagger</li>
</ul>
<h2 id="Swagger简介"><a href="#Swagger简介" class="headerlink" title="Swagger简介"></a>Swagger简介</h2><p><strong>前后端分离</strong></p>
<p>Vue + SpringBoot</p>
<p>后端时代：前端只用管理静态页面； html&#x3D;&#x3D;》后端。模板引擎 JSP &#x3D;》 后端是主力</p>
<p>前后端分离时代：</p>
<ul>
<li>后端：后端控制层、服务层、数据访问层【后端团队】</li>
<li>前端：前端控制层、视图层【前端团队】<ul>
<li>伪造后端数据，json。已经存在了，不需要后端，前端工程依旧可以跑起来</li>
</ul>
</li>
<li>前后端如何交互？&#x3D;&#x3D;》API</li>
<li>前后端相对独立，松耦合；</li>
<li>前后端甚至可以部署在不同的服务器上；</li>
</ul>
<p>产生一个问题：</p>
<ul>
<li>前后端集成联调，前端人员和后端人员无法做到“及时协商，尽早解决”，最终导致问题集中爆发；</li>
</ul>
<p>解决方案：</p>
<ul>
<li>首先指定schema[计划的提纲]，实时更新最新API，降低了集成的风险；</li>
<li>早些年：制定word计划文档；</li>
<li>前后端分离：<ul>
<li>前端测试后端接口：postman</li>
<li>后端提供接口，需要实时更新最新的消息及改动！</li>
</ul>
</li>
</ul>
<h2 id="Swagger-1"><a href="#Swagger-1" class="headerlink" title="Swagger"></a>Swagger</h2><ul>
<li>号称世界上最流行的API框架</li>
<li>RestFul API 文档在线自动生成工具&#x3D;》&#x3D;&#x3D;API文档与API定义同步更新&#x3D;&#x3D;</li>
<li>直接运行，可以在线测试API接口；</li>
<li>支持多种语言：（java，PHP）；</li>
</ul>
<p>官网：<a target="_blank" rel="noopener" href="https://swagger.io/">https://swagger.io</a></p>
<p>在项目使用Swagger需要springbox；</p>
<ul>
<li>swagger2</li>
<li>ui</li>
</ul>
<h1 id="SpringBoot-集成Swagger"><a href="#SpringBoot-集成Swagger" class="headerlink" title="SpringBoot 集成Swagger"></a>SpringBoot 集成Swagger</h1><ol>
<li><p>新建一个springboot-web项目</p>
</li>
<li><p>导入相关依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/io.springfox/springfox-swagger2 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.springfox<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springfox-swagger2<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.9.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/io.springfox/springfox-swagger-ui --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.springfox<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springfox-swagger-ui<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.9.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
<li><p>编写一个Hello工程</p>
</li>
<li><p>配置swagger&#x3D;&#x3D;》Config</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sec.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.swagger2.annotations.EnableSwagger2;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@EnableSwagger2</span>     <span class="comment">//开启Swagger2</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SwaggerConfig</span> &#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>测试运行<br><a target="_blank" rel="noopener" href="http://localhost:8080/swagger-ui.html">http://localhost:8080/swagger-ui.html</a></p>
</li>
</ol>
<p><img src="/../assets/1620292186287.png" alt="1620292186287"></p>
<h3 id="配置Swagger"><a href="#配置Swagger" class="headerlink" title="配置Swagger"></a>配置Swagger</h3><p>Swagger的bean实例Docket；</p>
<p>com.sec.config&#x3D;&gt;SwaggerConfig.java</p>
<ul>
<li><pre><code class="java">package com.sec.config;

import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import springfox.documentation.service.ApiInfo;
import springfox.documentation.service.Contact;
import springfox.documentation.spi.DocumentationType;
import springfox.documentation.spring.web.plugins.Docket;
import springfox.documentation.swagger2.annotations.EnableSwagger2;

import java.util.ArrayList;

@Configuration
@EnableSwagger2     //开启Swagger2
public class SwaggerConfig &#123;

    //配置swagger的Docket的bean实例
    @Bean
    public Docket docket()&#123;
        return new Docket(DocumentationType.SWAGGER_2).apiInfo(apiInfo());
    &#125;

    //配置swagger信息=apiInfo
    private ApiInfo apiInfo()&#123;
        //作者信息
        Contact contact = new Contact(&quot;郝嘉诚&quot;, &quot;http://haojiacheng.cn&quot;, &quot;990784805@qq.com&quot;);

        return new ApiInfo(&quot;苏弋的swaggerAPI文档&quot;,
                &quot;不积硅步无以至千里&quot;,
                &quot;v1.0&quot;,
                &quot;http://haojiacheng.cn&quot;,
                contact,
                &quot;Apache 2.0&quot;,
                &quot;http://www.apache.org/licenses/LICENSE-2.0&quot;,
                new ArrayList()
        );
    &#125;
&#125;

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">### Swagger配置扫描接口</span><br><span class="line"></span><br><span class="line">Docket.select()</span><br><span class="line"></span><br><span class="line">~~~java</span><br><span class="line">//配置swagger的Docket的bean实例</span><br><span class="line">    @Bean</span><br><span class="line">    public Docket docket()&#123;</span><br><span class="line">        return new Docket(DocumentationType.SWAGGER_2)</span><br><span class="line">                .apiInfo(apiInfo())</span><br><span class="line">                .select()</span><br><span class="line">                //RequestHandlerSelectors：配置要扫描接口的方式</span><br><span class="line">                //basePackage：指定要扫描的包</span><br><span class="line">                //any():扫描全部</span><br><span class="line">                //none()：不扫描</span><br><span class="line">                //withMethodAnnotation:扫描方法上的注解，参数是注解的反射对象</span><br><span class="line">                //withClassAnnotation:扫描类上的注解</span><br><span class="line">                .apis(RequestHandlerSelectors.basePackage(&quot;com.sec.controller&quot;))</span><br><span class="line">                //paths:过滤什么路径</span><br><span class="line">                .paths(PathSelectors.ant(&quot;/sec/**&quot;))</span><br><span class="line">                .build();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
</code></pre>
</li>
</ul>
<p><strong>配置是否启动swagger</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.enable(<span class="literal">false</span>)<span class="comment">//为false时则swagger不能在浏览器中访问</span></span><br></pre></td></tr></table></figure>

<p>我只希望我的swagger在生产环境中使用，在发布的时候不用？</p>
<ul>
<li>判断是不是生产环境    flag&#x3D;false</li>
<li>注入enable(flag)</li>
</ul>
<p>&#x3D;&#x3D;步骤&#x3D;&#x3D;：</p>
<ol>
<li><p>application.properties:   执行dev</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring.profiles.active</span>=<span class="string">dev</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>application-dev.properties:   </p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server.port</span>=<span class="string">8081</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>application-prod.properties: </p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server.port</span>=<span class="string">8082</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>SwaggerConfig.java:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sec.config;</span><br><span class="line"></span><br><span class="line">....</span><br><span class="line">    </span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@EnableSwagger2</span>     <span class="comment">//开启Swagger2</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SwaggerConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//配置swagger的Docket的bean实例</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Docket <span class="title function_">docket</span><span class="params">(Environment environment)</span>&#123;</span><br><span class="line">        <span class="comment">//设置要显示的Swagger环境</span></span><br><span class="line">        <span class="type">Profiles</span> <span class="variable">profiles</span> <span class="operator">=</span> Profiles.of(<span class="string">&quot;dev&quot;</span>,<span class="string">&quot;test&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//获取项目的环境：</span></span><br><span class="line">        <span class="comment">//通过environment.acceptsProfiles判断此时是否处于自己设定的环境</span></span><br><span class="line">        <span class="type">boolean</span> <span class="variable">flag</span> <span class="operator">=</span> environment.acceptsProfiles(profiles);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Docket</span>(DocumentationType.SWAGGER_2)</span><br><span class="line">                .apiInfo(apiInfo())</span><br><span class="line">                <span class="comment">//enable：是否启动swagger</span></span><br><span class="line">                .enable(flag)<span class="comment">//若为false，则在浏览器中不能访问swagger-ui.html</span></span><br><span class="line">                .select()</span><br><span class="line">                .apis(RequestHandlerSelectors.basePackage(<span class="string">&quot;com.sec.controller&quot;</span>))</span><br><span class="line">                .build();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//配置swagger信息=apiInfo</span></span><br><span class="line">    <span class="keyword">private</span> ApiInfo <span class="title function_">apiInfo</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="comment">//作者信息</span></span><br><span class="line">        <span class="type">Contact</span> <span class="variable">contact</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Contact</span>(<span class="string">&quot;郝嘉诚&quot;</span>, <span class="string">&quot;http://haojiacheng.cn&quot;</span>, <span class="string">&quot;990784805@qq.com&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ApiInfo</span>(<span class="string">&quot;苏弋的swaggerAPI文档&quot;</span>,</span><br><span class="line">                <span class="string">&quot;不积硅步无以至千里&quot;</span>,</span><br><span class="line">                <span class="string">&quot;v1.0&quot;</span>,</span><br><span class="line">                <span class="string">&quot;http://haojiacheng.cn&quot;</span>,</span><br><span class="line">                contact,</span><br><span class="line">                <span class="string">&quot;Apache 2.0&quot;</span>,</span><br><span class="line">                <span class="string">&quot;http://www.apache.org/licenses/LICENSE-2.0&quot;</span>,</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">ArrayList</span>()</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ol>
<p>配置API文档的分组</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.groupName(<span class="string">&quot;郝嘉诚&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>如何配置多个分组；多个Docket即可</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="keyword">public</span> Docket <span class="title function_">docket1</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Docket</span>(DocumentationType.SWAGGER_2).groupName(<span class="string">&quot;张三&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="keyword">public</span> Docket <span class="title function_">docket2</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Docket</span>(DocumentationType.SWAGGER_2).groupName(<span class="string">&quot;李四&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="keyword">public</span> Docket <span class="title function_">docket3</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Docket</span>(DocumentationType.SWAGGER_2).groupName(<span class="string">&quot;王五&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="Swagger常用注解使用详解"><a href="#Swagger常用注解使用详解" class="headerlink" title="Swagger常用注解使用详解"></a>Swagger常用注解使用详解</h3><h4 id="1-Api"><a href="#1-Api" class="headerlink" title="1. Api"></a>1. Api</h4><p>@Api 用在类上，说明该类的作用。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Api(value = &quot;hello控制类&quot;,tags = &quot;苏弋&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloController</span> &#123;</span><br><span class="line">    <span class="meta">@ApiOperation(value = &quot;hello方法&quot;,notes = &quot;hello方法的notes&quot;)</span></span><br><span class="line">    <span class="meta">@GetMapping</span> (value = <span class="string">&quot;/hello&quot;</span>)</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">hello</span><span class="params">(<span class="meta">@ApiParam(&quot;名字&quot;)</span> String name)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;hello&quot;</span>+name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiOperation(value = &quot;user方法&quot;,notes = &quot;user方法的notes&quot;)</span></span><br><span class="line">    <span class="comment">//只要接口中，返回值有实体类，它就会被扫描到swagger中</span></span><br><span class="line">    <span class="meta">@PostMapping(value = &quot;/user&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> User <span class="title function_">user</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/../assets/1620348961215.png" alt="1620348961215"></p>
<h4 id="2-ApiModel"><a href="#2-ApiModel" class="headerlink" title="2. ApiModel"></a>2. ApiModel</h4><p>@ApiModel 常用在实体类上</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ApiModel(&quot;用户实体类&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> String username;</span><br><span class="line">    <span class="keyword">public</span> String password;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/../assets/1620349115367.png" alt="1620349115367"></p>
<h4 id="3-ApiModelProperty"><a href="#3-ApiModelProperty" class="headerlink" title="3. ApiModelProperty"></a>3. ApiModelProperty</h4><p>@ApiModelProperty() 用于字段，表示对 model 属性的说明。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ApiModel(&quot;用户实体类&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="meta">@ApiModelProperty(&quot;用户名&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String username;</span><br><span class="line">    <span class="meta">@ApiModelProperty(&quot;密码&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String password;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/../assets/1620349122428.png" alt="1620349122428"></p>
<h4 id="4-ApiParam"><a href="#4-ApiParam" class="headerlink" title="4. ApiParam"></a>4. ApiParam</h4><p>@ApiParam 用于 Controller 中方法的参数说明。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ApiOperation(value = &quot;hello方法&quot;,notes = &quot;hello方法的notes&quot;)</span></span><br><span class="line"><span class="meta">@GetMapping</span> (value = <span class="string">&quot;/hello&quot;</span>)</span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">hello</span><span class="params">(<span class="meta">@ApiParam(&quot;名字&quot;)</span> String name)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;hello&quot;</span>+name;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/../assets/1620349197404.png" alt="1620349197404"></p>
<h4 id="5-ApiOperation"><a href="#5-ApiOperation" class="headerlink" title="5. ApiOperation"></a>5. ApiOperation</h4><p>@ApiOperation 用在 Controller 里的方法上，说明方法的作用</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ApiOperation(value = &quot;user方法&quot;,notes = &quot;user方法的notes&quot;)</span></span><br><span class="line"><span class="comment">//只要接口中，返回值有实体类，它就会被扫描到swagger中</span></span><br><span class="line"><span class="meta">@PostMapping(value = &quot;/user&quot;)</span></span><br><span class="line"><span class="keyword">public</span> User <span class="title function_">user</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/../assets/1620349267574.png" alt="1620349267574"></p>
<h4 id="6-ApiResponse-和-ApiResponses"><a href="#6-ApiResponse-和-ApiResponses" class="headerlink" title="6. ApiResponse 和 ApiResponses"></a>6. ApiResponse 和 ApiResponses</h4><p>@ApiResponse 用于方法上，说明接口响应的一些信息；@ApiResponses 组装了多个 @ApiResponse。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ApiResponses(&#123; @ApiResponse(code = 200, message = &quot;OK&quot;, response = UserDto.class) &#125;)</span></span><br><span class="line"><span class="meta">@PostMapping(&quot;/user&quot;)</span></span><br><span class="line"><span class="keyword">public</span> UserDto <span class="title function_">addUser</span><span class="params">(<span class="meta">@ApiParam(value = &quot;新增用户参数&quot;, required = true)</span> <span class="meta">@RequestBody</span> AddUserParam param)</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="7-ApiImplicitParam-和-ApiImplicitParams"><a href="#7-ApiImplicitParam-和-ApiImplicitParams" class="headerlink" title="7. ApiImplicitParam 和 ApiImplicitParams"></a>7. ApiImplicitParam 和 ApiImplicitParams</h4><p>用于方法上，为单独的请求参数进行说明。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ApiImplicitParams(&#123;</span></span><br><span class="line"><span class="meta">        @ApiImplicitParam(name = &quot;id&quot;, value = &quot;用户ID&quot;, dataType = &quot;string&quot;, paramType = &quot;query&quot;, required = true, defaultValue = &quot;1&quot;) &#125;)</span></span><br><span class="line"><span class="meta">@ApiResponses(&#123; @ApiResponse(code = 200, message = &quot;OK&quot;, response = UserDto.class) &#125;)</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;/user&quot;)</span></span><br><span class="line"><span class="keyword">public</span> UserDto <span class="title function_">getUser</span><span class="params">(<span class="meta">@RequestParam(&quot;id&quot;)</span> String id)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">UserDto</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>name：参数名，对应方法中单独的参数名称。</li>
<li>value：参数中文说明。</li>
<li>required：是否必填。</li>
<li>paramType：参数类型，取值为 path、query、body、header、form。</li>
<li>dataType：参数数据类型。</li>
<li>defaultValue：默认值。</li>
</ul>
<h3 id="Swagger中的Try-it-out"><a href="#Swagger中的Try-it-out" class="headerlink" title="Swagger中的Try it out"></a>Swagger中的Try it out</h3><p>实体类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sec.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiModel;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiModelProperty;</span><br><span class="line"></span><br><span class="line"><span class="meta">@ApiModel(&quot;用户实体类&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="meta">@ApiModelProperty(&quot;用户名&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String username;</span><br><span class="line">    <span class="meta">@ApiModelProperty(&quot;密码&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String password;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">User</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">User</span><span class="params">(String username, String password)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.username = username;</span><br><span class="line">        <span class="built_in">this</span>.password = password;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getUsername</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> username;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setUsername</span><span class="params">(String username)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.username = username;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getPassword</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> password;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setPassword</span><span class="params">(String password)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.password = password;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>controller：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ApiOperation(value = &quot;测试方法&quot;,notes = &quot;这是一个测试方法&quot;)</span></span><br><span class="line"><span class="meta">@PostMapping(&quot;/ceshi&quot;)</span></span><br><span class="line"><span class="keyword">public</span> User <span class="title function_">ceshi</span><span class="params">(User user)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> user;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>点击 Try it out，输入用户名和密码</p>
<p><img src="/../assets/1620349920120.png" alt="1620349920120"></p>
<p>点击 execute<img src="/../assets/1620350051071.png" alt="1620350051071"></p>
<p>可以看到方法执行的结果<img src="/../assets/1620350094357.png" alt="1620350094357"></p>
<h3 id="总结：-1"><a href="#总结：-1" class="headerlink" title="总结："></a>总结：</h3><ul>
<li>我们可以通过swagger给一些难理解的属性或接口，添加注释</li>
<li>接口文档实时更新</li>
<li>可以在线测试controller中的方法</li>
</ul>
<p>&#x3D;&#x3D;注意&#x3D;&#x3D;：在正式发布的时候，要关闭swagger，不能被用户所看到。出于安全考虑，节省运行内存；</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://suyiharris.github.io/2023/10/24/2023-10-24-SpringBoot%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/" data-id="clo4h2l3z000snso90fd431qc" data-title="SpringBoot快速入门" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-2023-10-24-Redis" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/10/24/2023-10-24-Redis/" class="article-date">
  <time class="dt-published" datetime="2023-10-24T04:12:12.000Z" itemprop="datePublished">2023-10-24</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2023/10/24/2023-10-24-Redis/">Redis</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="NoSQL的四大分类"><a href="#NoSQL的四大分类" class="headerlink" title="NoSQL的四大分类"></a>NoSQL的四大分类</h1><h2 id="KV键值对："><a href="#KV键值对：" class="headerlink" title="KV键值对："></a>KV键值对：</h2><ul>
<li>新浪：Redis</li>
<li>美团：Redis + Tair（是由淘宝网自主开发的KV结构数据存储系统，在淘宝网有着大规模的应用）</li>
<li>阿里、百度：Redis + memecache（高速缓存系统，与redis相似 ）</li>
</ul>
<h2 id="文档型数据库（bson-和json一样）："><a href="#文档型数据库（bson-和json一样）：" class="headerlink" title="文档型数据库（bson  和json一样）："></a>文档型数据库（bson  和json一样）：</h2><ul>
<li>MongoDB（一般必须要掌握）<ul>
<li>MongoDB是一个基于分布式文件存储的数据库，C++编写的，只要用来处理大量的文档！</li>
<li>MongoDB是一个介于关系型数据库和非关系型数据库中中间的产品！MongoDB是非关系型数据库中功能最丰富，最像关系型数据库的！</li>
</ul>
</li>
<li>ConchDB</li>
</ul>
<h2 id="列存储数据库（分布式的文件系统）"><a href="#列存储数据库（分布式的文件系统）" class="headerlink" title="列存储数据库（分布式的文件系统）"></a><strong>列存储数据库</strong>（分布式的文件系统）</h2><ul>
<li>HBase</li>
<li>分布式文件系统</li>
</ul>
<h2 id="图关系数据库-社交网络，推荐系统等。专注于构建关系图谱"><a href="#图关系数据库-社交网络，推荐系统等。专注于构建关系图谱" class="headerlink" title="图关系数据库    (社交网络，推荐系统等。专注于构建关系图谱)"></a><strong>图关系数据库</strong>    (社交网络，推荐系统等。专注于构建关系图谱)</h2><ul>
<li>Neo4J</li>
<li>InfoGrid</li>
<li>infinite Graph</li>
</ul>
<h1 id="Redis入门"><a href="#Redis入门" class="headerlink" title="Redis入门"></a>Redis入门</h1><h3 id="概述："><a href="#概述：" class="headerlink" title="概述："></a>概述：</h3><blockquote>
<p>Redis是什么？</p>
</blockquote>
<p>​	Redis（&#x3D;&#x3D;Re&#x3D;&#x3D;mote &#x3D;&#x3D;d&#x3D;&#x3D;ictionary &#x3D;&#x3D;S&#x3D;&#x3D;erver），即远程字典服务！</p>
<p>是一个开源的使用ANSI C语言编写、支持网络、可基于内存亦可持久化的日志型、Key-Value数据库，并提供多种语言的API。</p>
<p>免费和开源！是当下最热门的NoSQL技术之一！也被人们称之为结构化数据库！</p>
<blockquote>
<p>Redis能干什么？</p>
</blockquote>
<ol>
<li>内存存储、持久化，内存中是断电即失、所以说持久化很重要（edb、aof）</li>
<li>效率高，可以用于高速缓存</li>
<li>发布订阅系统</li>
<li>地图信息分析</li>
<li>计时器、计数器（浏览量！）</li>
<li>……</li>
</ol>
<blockquote>
<p>特性</p>
</blockquote>
<ol>
<li>多样的数据类型</li>
<li>持久化</li>
<li>集群</li>
<li>事务</li>
</ol>
<h3 id="安装Redis"><a href="#安装Redis" class="headerlink" title="安装Redis"></a>安装Redis</h3><h4 id="Windows安装"><a href="#Windows安装" class="headerlink" title="Windows安装"></a>Windows安装</h4><p>直接下载Redis64位的解压在自己电脑的环境目录下就OK了</p>
<blockquote>
<p>启动服务端，然后使用客户端连接Redis</p>
</blockquote>
<p><img src="/../assets/1637216387583.png" alt="1637216387583"></p>
<h4 id="Linux安装（推荐使用）"><a href="#Linux安装（推荐使用）" class="headerlink" title="Linux安装（推荐使用）"></a>Linux安装（推荐使用）</h4><p><img src="/../assets/1637216699146.png" alt="1637216699146"></p>
<p>1、将redis的Linux版解压安装到Linux服务器上</p>
<p>解压命令：&#x3D;&#x3D;tar -zxvf redis.tar.gz&#x3D;&#x3D;</p>
<p>2、redis默认不是后端启动的，修改配置文件</p>
<p><img src="/../assets/1637218892305.png" alt="1637218892305"></p>
<p>3、启动redis服务</p>
<p><img src="/../assets/1637219141193.png" alt="1637219141193"></p>
<p>4、使用redis-cli连接测试</p>
<p><img src="/../assets/1637219189443.png" alt="1637219189443"></p>
<p>5、查看redis的进程是否开启！</p>
<p><img src="/../assets/1637219245806.png" alt="1637219245806"></p>
<p>6、关闭redis服务 &#x3D;&#x3D;shutdown&#x3D;&#x3D;</p>
<h3 id="性能测试"><a href="#性能测试" class="headerlink" title="性能测试"></a>性能测试</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 测试： 100个并发连接   100000请求</span></span><br><span class="line">redis-benchmark -h localhost -p 6379 -c100 -n 100000</span><br></pre></td></tr></table></figure>

<p><img src="/../assets/1637221977033.png" alt="1637221977033"></p>
<p><strong>参数</strong></p>
<p><img src="/../assets/1637222653050.png" alt="1637222653050"></p>
<h3 id="基础的知识"><a href="#基础的知识" class="headerlink" title="基础的知识"></a>基础的知识</h3><p>redis默认有16个数据库</p>
<p><img src="/../assets/1637222911124.png" alt="1637222911124"></p>
<p>默认使用的是第0个</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; <span class="keyword">select</span> 3 <span class="comment">#切换数据库</span></span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379[3]&gt;DBSIZE <span class="comment">#查看DB大小</span></span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br><span class="line">127.0.0.1:6379[3]&gt;keys * <span class="comment">#查看数据库所有的key</span></span><br><span class="line">1) <span class="string">&quot;name&quot;</span></span><br><span class="line">127.0.0.1:6379[3]&gt;flushdb <span class="comment">#清除当前数据库</span></span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379[3]&gt;keys *</span><br><span class="line">(empty list or <span class="built_in">set</span>)</span><br><span class="line">127.0.0.1:6379[3]&gt;flushall <span class="comment">#清除全部数据库的内容</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>Redis 是单线程的！</strong></p>
</blockquote>
<blockquote>
<p>明白Redis是很快的，官方表示，Reis是基于内存操作，CPU不是Redis性能瓶颈，Redis的瓶颈是根据机器的内存和网络带宽，既然可以使用单线程来实现，就使用单线程了！</p>
</blockquote>
<blockquote>
<p>Redis是C语言写的，官方提供的数据为 100000+的QPS，完全不比同样是使用Key-Value的Memecache差！</p>
</blockquote>
<blockquote>
<p><strong>Redis 为什么单线程还这么快？</strong></p>
<p>1、误区1：高性能的服务器一定是多线程的？</p>
<p>2、误区2：多线程（CPU上下文会切换！）一定比单线程效率高！</p>
</blockquote>
<p><strong>核心</strong>：redis是将所有的数据全部放在内存中的，所以使用单线程去操作效率就是最高的多线程（CPU上下文会切换！：耗时的操作！！！），对于内存系统来说，如果没有上下文切换效率就是最高的！多次读写都在一个CPU上，在内存情况下，这个就是最佳的方案！</p>
<h1 id="五大数据类型"><a href="#五大数据类型" class="headerlink" title="五大数据类型"></a>五大数据类型</h1><p>Redis 是一个开源（BSD许可）的，内存中的数据结构存储系统，它可以用作&#x3D;&#x3D;数据库&#x3D;&#x3D;、&#x3D;&#x3D;缓存&#x3D;&#x3D;和&#x3D;&#x3D;消息中间件&#x3D;&#x3D;。 它支持多种类型的数据结构，如 <a target="_blank" rel="noopener" href="http://redis.cn/topics/data-types-intro.html#strings">字符串（strings）</a>， <a target="_blank" rel="noopener" href="http://redis.cn/topics/data-types-intro.html#hashes">散列（hashes）</a>， <a target="_blank" rel="noopener" href="http://redis.cn/topics/data-types-intro.html#lists">列表（lists）</a>， <a target="_blank" rel="noopener" href="http://redis.cn/topics/data-types-intro.html#sets">集合（sets）</a>， <a target="_blank" rel="noopener" href="http://redis.cn/topics/data-types-intro.html#sorted-sets">有序集合（sorted sets）</a> 与范围查询， <a target="_blank" rel="noopener" href="http://redis.cn/topics/data-types-intro.html#bitmaps">bitmaps</a>， <a target="_blank" rel="noopener" href="http://redis.cn/topics/data-types-intro.html#hyperloglogs">hyperloglogs</a> 和 <a target="_blank" rel="noopener" href="http://redis.cn/commands/geoadd.html">地理空间（geospatial）</a> 索引半径查询。 Redis 内置了 <a target="_blank" rel="noopener" href="http://redis.cn/topics/replication.html">复制（replication）</a>，<a target="_blank" rel="noopener" href="http://redis.cn/commands/eval.html">LUA脚本（Lua scripting）</a>， <a target="_blank" rel="noopener" href="http://redis.cn/topics/lru-cache.html">LRU驱动事件（LRU eviction）</a>，<a target="_blank" rel="noopener" href="http://redis.cn/topics/transactions.html">事务（transactions）</a> 和不同级别的 <a target="_blank" rel="noopener" href="http://redis.cn/topics/persistence.html">磁盘持久化（persistence）</a>， 并通过 <a target="_blank" rel="noopener" href="http://redis.cn/topics/sentinel.html">Redis哨兵（Sentinel）</a>和自动 <a target="_blank" rel="noopener" href="http://redis.cn/topics/cluster-tutorial.html">分区（Cluster）</a>提供高可用性（high availability）。 </p>
<p>Redis-Key</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">exists [key] 		<span class="comment">#判断当前的key是否存在</span></span><br><span class="line">move [key] 1   		<span class="comment">#移动key到1号数据库</span></span><br><span class="line">expire [key] 10 		<span class="comment">#设置key的过期时间（单位是秒）</span></span><br><span class="line">ttl [key] 			<span class="comment">#查看key的剩余时间</span></span><br><span class="line"><span class="built_in">type</span> [key]		 	<span class="comment">#查看key的类型</span></span><br></pre></td></tr></table></figure>



<h3 id="String（字符串）"><a href="#String（字符串）" class="headerlink" title="String（字符串）"></a>String（字符串）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">append [key] <span class="string">&quot;hello&quot;</span> 		<span class="comment">#追加字符串，如果key不存在就相当于set key &quot;hello&quot;</span></span><br><span class="line">strlen [key]				<span class="comment">#获取key值的长度</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#############################################################################</span></span><br><span class="line"><span class="built_in">set</span> [key] 0 			<span class="comment">#设置key的value为0</span></span><br><span class="line">incr [key] 				<span class="comment">#增长1</span></span><br><span class="line">decr [key] 				<span class="comment">#减少1</span></span><br><span class="line">INCRBY [key] 5 			<span class="comment">#增加5</span></span><br><span class="line">DECRBY [key] 4 			<span class="comment">#减少4</span></span><br><span class="line">GETRANGE [key] 0 3 		<span class="comment">#截取字符串[0,3]</span></span><br><span class="line">GETRANGE [key] 0 -1 	<span class="comment">#截取全部的字符串  相当于get key</span></span><br><span class="line">SETRANGE [key] 2		<span class="comment">#假设key的value为hello  则结果为 </span></span><br><span class="line"><span class="comment">#############################################################################</span></span><br><span class="line"></span><br><span class="line">setex [key] [value] 30		<span class="comment">#设置key的值并设置有效期为30秒</span></span><br><span class="line">setnx [key] [value] 		<span class="comment">#设置key的值，如果key存在，则set失败，反之set成功（常用于分布式锁）</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#设置/获取多个值</span></span><br><span class="line">mset k1 v1 k2 v2 k3 v3		<span class="comment">#同时设置多个值</span></span><br><span class="line">mget k1 k2 k3				<span class="comment">#同时获取多个值</span></span><br><span class="line">msetnx k1 k4    <span class="comment">#(k1存在，k4不存在)， msetnx是个原子性的操作，要么全成功，要么全失败</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#对象</span></span><br><span class="line">mset user:1:name zhangsan user:1:age 2	<span class="comment">#设置一个对象name值为zhangsan，age值为2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#getset 先get后set</span></span><br><span class="line">getset db redis		<span class="comment">#如果值不存在则返回nil（此处的set是成功的）</span></span><br><span class="line">getset db mongodb 	<span class="comment">#如果db值存在则先获取db的值，然后更新db的值为mongodb</span></span><br></pre></td></tr></table></figure>



<h3 id="List（列表）"><a href="#List（列表）" class="headerlink" title="List（列表）"></a>List（列表）</h3><p>基本的数据类型，列表</p>
<p><img src="/../assets/1637229101337.png" alt="1637229101337"></p>
<p>在redis里面，我们可以把list玩成，栈、队列、阻塞队列!</p>
<p>所有的list命令都是用l开头的，Redis不区分大小写命令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">########################################################################</span></span><br><span class="line">Lpush</span><br><span class="line"></span><br><span class="line">Lrange</span><br><span class="line">127.0.0.1:6379&gt; LPUSH list one	<span class="comment">#将一个值或者多个值，插入到列表头部(左)</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; LPUSH list two</span><br><span class="line">(<span class="built_in">integer</span>) 2</span><br><span class="line">127.0.0.1:6379&gt; LPUSH list three</span><br><span class="line">(<span class="built_in">integer</span>) 3</span><br><span class="line">127.0.0.1:6379&gt; LRANGE 1ist 0 -1		<span class="comment">#获取1ist中值!</span></span><br><span class="line">1) <span class="string">&quot;three&quot;</span></span><br><span class="line">2) <span class="string">&quot;two&quot;</span></span><br><span class="line">3) <span class="string">&quot;one&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; LRANGE list 0 1			<span class="comment">#通过区间获取具体的值!</span></span><br><span class="line">1) <span class="string">&quot;three&quot;</span></span><br><span class="line">2) <span class="string">&quot;two&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; Rpush list right 		<span class="comment">#将一个值或者多个值，插入到列表位部（右)(integer)4</span></span><br><span class="line">127.0.0.1:6379&gt; LRANGE list 0 -1</span><br><span class="line">1) <span class="string">&quot;three&quot;</span></span><br><span class="line">2) <span class="string">&quot;two&quot;</span></span><br><span class="line">3) <span class="string">&quot;one&quot;</span></span><br><span class="line">4)<span class="string">&quot;right&quot;</span></span><br><span class="line"><span class="comment">########################################################################</span></span><br><span class="line">LPOP</span><br><span class="line">RPOP</span><br><span class="line"></span><br><span class="line">127.0.0.1:6379&gt; LRANGE 1ist 0 -1</span><br><span class="line">1) <span class="string">&quot;three&quot;</span></span><br><span class="line">2) <span class="string">&quot;two&quot;</span></span><br><span class="line">3) <span class="string">&quot;one &quot;</span></span><br><span class="line">4)<span class="string">&quot;right&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; Lpop list 	<span class="comment">#移除1ist的第一个元素</span></span><br><span class="line"><span class="string">&quot;three&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; Rpop list	<span class="comment">#移除1ist的最后一个元素</span></span><br><span class="line"><span class="string">&quot;right&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; LRANGE list 0 -1</span><br><span class="line">1) <span class="string">&quot;two&quot;</span></span><br><span class="line">2) <span class="string">&quot;one&quot;</span></span><br><span class="line"><span class="comment">########################################################################</span></span><br><span class="line">Lindex</span><br><span class="line"></span><br><span class="line">127.0.0.1:6379&gt; LRANGE list 0 -1</span><br><span class="line">1) <span class="string">&quot;two&quot;</span></span><br><span class="line">2) <span class="string">&quot;one&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; Lindex list 1		<span class="comment">#通过下标获得list中的某一个值!</span></span><br><span class="line"><span class="string">&quot;one&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; Lindex list 0</span><br><span class="line"><span class="string">&quot;two&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">########################################################################</span></span><br><span class="line">Llen</span><br><span class="line"></span><br><span class="line">127.0.0.1:6379&gt; Lpush list one</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; Lpush list two</span><br><span class="line">(<span class="built_in">integer</span>) 2</span><br><span class="line">127.0.0.1:6379&gt; Lpush list three</span><br><span class="line">(<span class="built_in">integer</span>) 3</span><br><span class="line">127.0.0.1:6379&gt; Llen list	<span class="comment"># 返回列表的长度</span></span><br><span class="line">(<span class="built_in">integer</span>) 3</span><br><span class="line"></span><br><span class="line"><span class="comment">########################################################################</span></span><br><span class="line">移除指定的值！</span><br><span class="line">取关  uid</span><br><span class="line"></span><br><span class="line">Lrem</span><br><span class="line"></span><br><span class="line">127.0.0.1:6379&gt; LRANGE 1ist 0 -1</span><br><span class="line">1) <span class="string">&quot;three&quot;</span></span><br><span class="line">2) <span class="string">&quot;three&quot;</span></span><br><span class="line">3) <span class="string">&quot;two&quot;</span></span><br><span class="line">4) <span class="string">&quot;one&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; Lrem list 1 one  <span class="comment">#移除list集合中指定个数的value，精确匹配</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; LRANGE list 0 -1</span><br><span class="line">1) <span class="string">&quot;three&quot;</span></span><br><span class="line">2) <span class="string">&quot;three&quot;</span></span><br><span class="line">3) <span class="string">&quot;two&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; Lrem list 1 three</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; LRANGE 1ist 0 -1</span><br><span class="line">1) <span class="string">&quot;three&quot;</span></span><br><span class="line">2) <span class="string">&quot;two&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; Lpush list three</span><br><span class="line">(<span class="built_in">integer</span>) 3</span><br><span class="line">127.0.0.1:6379&gt; Lrem list 2 three</span><br><span class="line">(<span class="built_in">integer</span>) 2</span><br><span class="line">127.0.0.1:6379&gt; LRANGE 1ist 0 -1</span><br><span class="line">1) <span class="string">&quot;two&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">########################################################################</span></span><br><span class="line">trim 修剪。 让列表只保留指定区间内的元素</span><br><span class="line"></span><br><span class="line">127.0.0.1:6379&gt;Rpush mylist <span class="string">&quot;he11o&quot;</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; Rpush mylist <span class="string">&quot;he11o1&quot;</span></span><br><span class="line">(<span class="built_in">integer</span>) 2</span><br><span class="line">127.0.0.1:6379&gt; Rpush mylist <span class="string">&quot;he17o2&quot;</span></span><br><span class="line">(<span class="built_in">integer</span>) 3</span><br><span class="line">127.0.0.1:6379&gt; Rpush mylist <span class="string">&quot;he11o3&quot;</span></span><br><span class="line">(<span class="built_in">integer</span>) 4</span><br><span class="line">127.0.0.1:6379&gt;Ltrim mylist 1 2        <span class="comment">#通过下标截取指定的长度，这个1ist已经被改变了，截断了只剩下截取的元素!oK</span></span><br><span class="line">127.0.0.1:6379&gt; LRANGE mylist 0 -1</span><br><span class="line">1) <span class="string">&quot;he11o1&quot;</span></span><br><span class="line">2) <span class="string">&quot;he11o2&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">########################################################################</span></span><br><span class="line">rpoplpush  <span class="comment">#移除列表最右边的元素并添加到另一个list（从左边往进添加）</span></span><br><span class="line"></span><br><span class="line">127.0.0.1:6379&gt; Lpush list one two three four five</span><br><span class="line">(<span class="built_in">integer</span>) 5</span><br><span class="line">127.0.0.1:6379&gt; Lrange list 0 -1</span><br><span class="line">1) <span class="string">&quot;five&quot;</span></span><br><span class="line">2) <span class="string">&quot;four&quot;</span></span><br><span class="line">3) <span class="string">&quot;three&quot;</span></span><br><span class="line">4) <span class="string">&quot;two&quot;</span></span><br><span class="line">5) <span class="string">&quot;one&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; RpopLpush list mylist</span><br><span class="line"><span class="string">&quot;one&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; Lrange list 0 -1</span><br><span class="line">1) <span class="string">&quot;five&quot;</span></span><br><span class="line">2) <span class="string">&quot;four&quot;</span></span><br><span class="line">3) <span class="string">&quot;three&quot;</span></span><br><span class="line">4) <span class="string">&quot;two&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; Lrange mylist 0 -1</span><br><span class="line">1) <span class="string">&quot;one&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">########################################################################</span></span><br><span class="line">lset 将列表中指定下标的值替换为另外一个值，更新操作</span><br><span class="line"></span><br><span class="line">127.0.0.1:6379&gt; EXISTS list		<span class="comment">#判断这个列表是否存在</span></span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br><span class="line">127.0.0.1:6379&gt; lset list 0 item	<span class="comment">#如果不存在列表我们去更新就会报错</span></span><br><span class="line">(error) ERR no such key</span><br><span class="line">127.0.0.1:6379&gt; lpush list value1</span><br><span class="line">(<span class="built_in">integer</span>） 1</span><br><span class="line">127.0.0.1:6379&gt;LRANGE list 0 0</span><br><span class="line">1) <span class="string">&quot;value1&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; lset list 0 item	<span class="comment">#如果存在，更新当前下标的值</span></span><br><span class="line">oK</span><br><span class="line">127.0.0.1:6379&gt;LRANGE list 0 0</span><br><span class="line">1) <span class="string">&quot;item&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; lset list 1 other	<span class="comment">#如果不存在，则会报错</span></span><br><span class="line">(error) ERR index out of range</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">########################################################################</span></span><br><span class="line">Linsert 把值插入到指定值的之前（左）或之后（右）</span><br><span class="line"></span><br><span class="line">127.0.0.1:6379&gt;Rpush mylist <span class="string">&quot;hello&quot;</span></span><br><span class="line">( <span class="built_in">integer</span>)1</span><br><span class="line">127.0.0.1:6379&gt; Rpush mylist <span class="string">&quot;world&quot;</span></span><br><span class="line">(<span class="built_in">integer</span>)2</span><br><span class="line">127.0.0.1:6379&gt;LINSERT mylist before <span class="string">&quot;world&quot;</span> <span class="string">&quot;other&quot;</span></span><br><span class="line">( <span class="built_in">integer</span>)3</span><br><span class="line">127.0.0.1:6379&gt;LRANGE mylist 0 -1</span><br><span class="line">1) <span class="string">&quot;hello&quot;</span></span><br><span class="line">2)<span class="string">&quot;other&quot;</span></span><br><span class="line">3)<span class="string">&quot;world&quot;</span></span><br><span class="line">127.0.0.1:6379&gt;LINSERT mylist after world new</span><br><span class="line">(<span class="built_in">integer</span>)4</span><br><span class="line">127.0.0.1:6379&gt; LRANGE mylist 0 -1</span><br><span class="line">1)<span class="string">&quot;hello&quot;</span></span><br><span class="line">2)<span class="string">&quot;other&quot;</span></span><br><span class="line">3)<span class="string">&quot;world&quot;</span></span><br><span class="line">4)<span class="string">&quot;new&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>小结</p>
<ul>
<li>它实际上是一个链表，before Node after ， left ， right 都可以插入值</li>
<li>如果key不存在，创建新的链表</li>
<li>如果key存在，新增内容</li>
<li>如果移除了所有值，空链表，也代表不存在！</li>
<li>在两边插入或者改动值，效率最高！中间元素，相对来说效率会低一点。</li>
</ul>
</blockquote>
<p>消息排队！消息队列（Lpush Rpop），栈（Lpush Lpop）</p>
<h3 id="Set（集合）"><a href="#Set（集合）" class="headerlink" title="Set（集合）"></a>Set（集合）</h3><p>set中的值是不能重复的！</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">########################################################################</span></span><br><span class="line">127.0.0.1:6379&gt; sadd myset <span class="string">&quot;hel1o&quot;</span>		<span class="comment">#set集合中添加元素</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; sadd myset <span class="string">&quot;kuangshen&quot;</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; sadd myset <span class="string">&quot;lovekuangshen&quot;</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; SMEMBERS myset			<span class="comment">#查看指定set的所有值</span></span><br><span class="line">1) <span class="string">&quot;hello&quot;</span></span><br><span class="line">2) <span class="string">&quot;lovekuangshen&quot;</span></span><br><span class="line">3) <span class="string">&quot;kuangshen&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; SISMEMBER myset hello		<span class="comment">#判断某个值是否存在与set集合中</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt;SISMEMBER myset wor1d	</span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br><span class="line"></span><br><span class="line"><span class="comment">########################################################################</span></span><br><span class="line">scard</span><br><span class="line"></span><br><span class="line">127.0.0.1:6379&gt; scard myset  	<span class="comment">#获取set集合中的内容元素个数！</span></span><br><span class="line">(<span class="built_in">integer</span>) 4</span><br><span class="line"><span class="comment">########################################################################</span></span><br><span class="line">srem</span><br><span class="line"></span><br><span class="line">127.0.0.1:6379&gt; srem myset hello	<span class="comment">#移除set集合中的指定元素</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; scard myset</span><br><span class="line">(<span class="built_in">integer</span>) 2</span><br><span class="line">127.0.0.1:6379&gt; smembers myset</span><br><span class="line">1) <span class="string">&quot;hello world haojiacheng&quot;</span></span><br><span class="line">2) <span class="string">&quot;hello world&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">########################################################################</span></span><br><span class="line"><span class="built_in">set</span> 无序不重复集合。抽随机！</span><br><span class="line">srandmember <span class="comment">#随机抽一个元素</span></span><br><span class="line"></span><br><span class="line">127.0.0.1:6379&gt; srandmember myset</span><br><span class="line"><span class="string">&quot;k&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; srandmember myset</span><br><span class="line"><span class="string">&quot;h&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; srandmember myset</span><br><span class="line"><span class="string">&quot;hello world haojiacheng&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; srandmember myset</span><br><span class="line"><span class="string">&quot;a&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; srandmember myset</span><br><span class="line"><span class="string">&quot;f&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; srandmember myset</span><br><span class="line"><span class="string">&quot;hello world&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; srandmember myset 2		<span class="comment">#随机抽选出指定个数的元素</span></span><br><span class="line">1) <span class="string">&quot;j&quot;</span></span><br><span class="line">2) <span class="string">&quot;n&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; srandmember myset 2</span><br><span class="line">1) <span class="string">&quot;m&quot;</span></span><br><span class="line">2) <span class="string">&quot;i&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">########################################################################</span></span><br><span class="line">spop  		<span class="comment">#随即删除一个元素，也可以指定随机删除个数</span></span><br><span class="line"></span><br><span class="line">127.0.0.1:6379&gt; SMEMBERS myset</span><br><span class="line"> 1) <span class="string">&quot;c&quot;</span></span><br><span class="line"> 2) <span class="string">&quot;hello world&quot;</span></span><br><span class="line"> 3) <span class="string">&quot;hello world haojiacheng&quot;</span></span><br><span class="line"> 4) <span class="string">&quot;o&quot;</span></span><br><span class="line"> 5) <span class="string">&quot;e&quot;</span></span><br><span class="line"> 6) <span class="string">&quot;l&quot;</span></span><br><span class="line"> 7) <span class="string">&quot;i&quot;</span></span><br><span class="line"> 8) <span class="string">&quot;b&quot;</span></span><br><span class="line"> 9) <span class="string">&quot;h&quot;</span></span><br><span class="line">10) <span class="string">&quot;n&quot;</span></span><br><span class="line">11) <span class="string">&quot;g&quot;</span></span><br><span class="line">12) <span class="string">&quot;d&quot;</span></span><br><span class="line">13) <span class="string">&quot;j&quot;</span></span><br><span class="line">14) <span class="string">&quot;p&quot;</span></span><br><span class="line">15) <span class="string">&quot;k&quot;</span></span><br><span class="line">16) <span class="string">&quot;m&quot;</span></span><br><span class="line">17) <span class="string">&quot;q&quot;</span></span><br><span class="line">18) <span class="string">&quot;a&quot;</span></span><br><span class="line">19) <span class="string">&quot;f&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; SPOP myset</span><br><span class="line"><span class="string">&quot;a&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; SPOP myset</span><br><span class="line"><span class="string">&quot;hello world&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; SPOP myset</span><br><span class="line"><span class="string">&quot;j&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; SPOP myset 2</span><br><span class="line">1) <span class="string">&quot;f&quot;</span></span><br><span class="line">2) <span class="string">&quot;i&quot;</span></span><br><span class="line"><span class="comment">########################################################################</span></span><br><span class="line">smove		<span class="comment">#将一个指定的值，移动到另外一个set集合中</span></span><br><span class="line"></span><br><span class="line">127.0.0.1:6379&gt; sadd myset one two three hello haojiacheng</span><br><span class="line">(<span class="built_in">integer</span>) 5</span><br><span class="line">127.0.0.1:6379&gt; SMEMBERS myset</span><br><span class="line">1) <span class="string">&quot;one&quot;</span></span><br><span class="line">2) <span class="string">&quot;hello&quot;</span></span><br><span class="line">3) <span class="string">&quot;three&quot;</span></span><br><span class="line">4) <span class="string">&quot;two&quot;</span></span><br><span class="line">5) <span class="string">&quot;haojiacheng&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; smove myset newmyset haojiacheng</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; scard myset</span><br><span class="line">(<span class="built_in">integer</span>) 4</span><br><span class="line">127.0.0.1:6379&gt; SMEMBERS newmyset</span><br><span class="line">1) <span class="string">&quot;haojiacheng&quot;</span></span><br><span class="line"><span class="comment">########################################################################</span></span><br><span class="line">数字集合类</span><br><span class="line"> - 差集	sdiff</span><br><span class="line"> - 交集	sinter</span><br><span class="line"> - 并集	sunion</span><br><span class="line"> </span><br><span class="line"> 127.0.0.1:6379&gt; sadd key1 a b c</span><br><span class="line">(<span class="built_in">integer</span>) 3</span><br><span class="line">127.0.0.1:6379&gt; sadd key2 c d e</span><br><span class="line">(<span class="built_in">integer</span>) 3</span><br><span class="line">127.0.0.1:6379&gt; sdiff key1 key2		<span class="comment">#key1中key2没有的元素</span></span><br><span class="line">1) <span class="string">&quot;a&quot;</span></span><br><span class="line">2) <span class="string">&quot;b&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; sdiff key2 key1		<span class="comment">#key2中key1没有的元素</span></span><br><span class="line">1) <span class="string">&quot;d&quot;</span></span><br><span class="line">2) <span class="string">&quot;e&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; sinter key1 key2	<span class="comment">#key1和key2共同的元素</span></span><br><span class="line">1) <span class="string">&quot;c&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; sunion key1 key2	<span class="comment">#key1和key2全部元素</span></span><br><span class="line">1) <span class="string">&quot;e&quot;</span></span><br><span class="line">2) <span class="string">&quot;b&quot;</span></span><br><span class="line">3) <span class="string">&quot;c&quot;</span></span><br><span class="line">4) <span class="string">&quot;a&quot;</span></span><br><span class="line">5) <span class="string">&quot;d&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>微博，A用户将所有关注的人放在一个set集合中，将它的粉丝也放在一个set集合中；这时可以做一些功能：</p>
<p>共同关注，共同爱好，二度好友，推荐好友！（六度分割理论）</p>
<h3 id="Hash（哈希）"><a href="#Hash（哈希）" class="headerlink" title="Hash（哈希）"></a>Hash（哈希）</h3><p>Map集合，key-value（map）！这里的value是一个map集合！</p>
<p>set myhash field kuangshen</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">########################################################################</span></span><br><span class="line">hset hmset hmget hgetall hdel </span><br><span class="line"></span><br><span class="line">127.0.0.1:6379&gt; hset myhash field1 haojiacheng		<span class="comment">#set一个具体 key-value</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; hget myhash field1</span><br><span class="line"><span class="string">&quot;haojiacheng&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; hmset myhash field1 hello field2 world		<span class="comment">#set多个 key-value</span></span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; hmget myhash field1 field2		<span class="comment">#获取多个字段值</span></span><br><span class="line">1) <span class="string">&quot;hello&quot;</span></span><br><span class="line">2) <span class="string">&quot;world&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; Hgetall myhash		<span class="comment">#获取全部的数据（包含value中的key）</span></span><br><span class="line">1) <span class="string">&quot;field1&quot;</span></span><br><span class="line">2) <span class="string">&quot;hello&quot;</span></span><br><span class="line">3) <span class="string">&quot;field2&quot;</span></span><br><span class="line">4) <span class="string">&quot;world&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; HDEL myhash field1		<span class="comment">#删除hash指定key字段！对应的value值也就消失了</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; hgetall myhash</span><br><span class="line">1) <span class="string">&quot;field2&quot;</span></span><br><span class="line">2) <span class="string">&quot;world&quot;</span></span><br><span class="line"><span class="comment">########################################################################</span></span><br><span class="line">hlen</span><br><span class="line"></span><br><span class="line">127.0.0.1:6379&gt; hlen myhash		<span class="comment">#获取hash表的字段数量</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line"><span class="comment">########################################################################</span></span><br><span class="line">hexists</span><br><span class="line"></span><br><span class="line">127.0.0.1:6379&gt; HEXISTS myhash field1	<span class="comment">#判断hash中指定字段是否存在</span></span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br><span class="line">127.0.0.1:6379&gt; HEXISTS myhash field2</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line"><span class="comment">########################################################################</span></span><br><span class="line">hkeys 	<span class="comment">#只获得所有field</span></span><br><span class="line">hvals	<span class="comment">#只获得所有value</span></span><br><span class="line"></span><br><span class="line">127.0.0.1:6379&gt; hmset myhash one 1 two 2 three 3 four 4</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; HGETALL myhash</span><br><span class="line">1) <span class="string">&quot;one&quot;</span></span><br><span class="line">2) <span class="string">&quot;1&quot;</span></span><br><span class="line">3) <span class="string">&quot;two&quot;</span></span><br><span class="line">4) <span class="string">&quot;2&quot;</span></span><br><span class="line">5) <span class="string">&quot;three&quot;</span></span><br><span class="line">6) <span class="string">&quot;3&quot;</span></span><br><span class="line">7) <span class="string">&quot;four&quot;</span></span><br><span class="line">8) <span class="string">&quot;4&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; hkeys myhash</span><br><span class="line">1) <span class="string">&quot;one&quot;</span></span><br><span class="line">2) <span class="string">&quot;two&quot;</span></span><br><span class="line">3) <span class="string">&quot;three&quot;</span></span><br><span class="line">4) <span class="string">&quot;four&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; hvals myhash</span><br><span class="line">1) <span class="string">&quot;1&quot;</span></span><br><span class="line">2) <span class="string">&quot;2&quot;</span></span><br><span class="line">3) <span class="string">&quot;3&quot;</span></span><br><span class="line">4) <span class="string">&quot;4&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">########################################################################</span></span><br><span class="line">HINCRBY  hsetnx		</span><br><span class="line"></span><br><span class="line">127.0.0.1:6379&gt; HGETALL myhash</span><br><span class="line">1) <span class="string">&quot;one&quot;</span></span><br><span class="line">2) <span class="string">&quot;1&quot;</span></span><br><span class="line">3) <span class="string">&quot;two&quot;</span></span><br><span class="line">4) <span class="string">&quot;2&quot;</span></span><br><span class="line">5) <span class="string">&quot;three&quot;</span></span><br><span class="line">6) <span class="string">&quot;3&quot;</span></span><br><span class="line">7) <span class="string">&quot;four&quot;</span></span><br><span class="line">8) <span class="string">&quot;4&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; hset myhash five 5</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; HGETALL myhash</span><br><span class="line"> 1) <span class="string">&quot;one&quot;</span></span><br><span class="line"> 2) <span class="string">&quot;1&quot;</span></span><br><span class="line"> 3) <span class="string">&quot;two&quot;</span></span><br><span class="line"> 4) <span class="string">&quot;2&quot;</span></span><br><span class="line"> 5) <span class="string">&quot;three&quot;</span></span><br><span class="line"> 6) <span class="string">&quot;3&quot;</span></span><br><span class="line"> 7) <span class="string">&quot;four&quot;</span></span><br><span class="line"> 8) <span class="string">&quot;4&quot;</span></span><br><span class="line"> 9) <span class="string">&quot;five&quot;</span></span><br><span class="line">10) <span class="string">&quot;5&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; HINCRBY myhash five 1	<span class="comment">#增长1</span></span><br><span class="line">(<span class="built_in">integer</span>) 6</span><br><span class="line">127.0.0.1:6379&gt; HINCRBY myhash five -1	<span class="comment">#减少1</span></span><br><span class="line">(<span class="built_in">integer</span>) 5</span><br><span class="line">127.0.0.1:6379&gt; hsetnx myhash sex 6		<span class="comment">#存在则创建失败，不存在则创建</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; hsetnx myhash sex nihao</span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br></pre></td></tr></table></figure>

<p>hash变更的数据user name age，尤其是用户信息之类的，经常变动的信息！</p>
<p>hash更适合存储对象，String更适合存储字符串</p>
<h3 id="Zset（有序集合）"><a href="#Zset（有序集合）" class="headerlink" title="Zset（有序集合）"></a>Zset（有序集合）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">########################################################################</span></span><br><span class="line">zadd 	zrangebyscore（排序--小到大）  ZREVRANGE（排序--大到小）</span><br><span class="line">127.0.0.1:6379&gt; clear</span><br><span class="line">127.0.0.1:6379&gt; zadd salary 2500 xiaohong	<span class="comment">#添加三个用户</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; zadd salary 5000 zhangsan</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; zadd salary 200 suyi</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; zrangebyscore salary -inf +inf	<span class="comment">#显示全部的用户  从小到大</span></span><br><span class="line">1) <span class="string">&quot;suyi&quot;</span></span><br><span class="line">2) <span class="string">&quot;xiaohong&quot;</span></span><br><span class="line">3) <span class="string">&quot;zhangsan&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; ZREVRANGE salary 0 -1		<span class="comment">#显示全部的用户  从大到小</span></span><br><span class="line">1) <span class="string">&quot;zhangsan&quot;</span></span><br><span class="line">2) <span class="string">&quot;libai&quot;</span></span><br><span class="line">3) <span class="string">&quot;suyi&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; ZREVRANGE salary 0 -1 withscores		<span class="comment">#从大到小排序全部的用户附带薪水</span></span><br><span class="line">1) <span class="string">&quot;zhangsan&quot;</span></span><br><span class="line">2) <span class="string">&quot;5000&quot;</span></span><br><span class="line">3) <span class="string">&quot;libai&quot;</span></span><br><span class="line">4) <span class="string">&quot;3000&quot;</span></span><br><span class="line">5) <span class="string">&quot;suyi&quot;</span></span><br><span class="line">6) <span class="string">&quot;200&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; zrangebyscore salary -inf +inf withscores	<span class="comment">#显示全部的用户并附带薪水</span></span><br><span class="line">1) <span class="string">&quot;suyi&quot;</span></span><br><span class="line">2) <span class="string">&quot;200&quot;</span></span><br><span class="line">3) <span class="string">&quot;xiaohong&quot;</span></span><br><span class="line">4) <span class="string">&quot;2500&quot;</span></span><br><span class="line">5) <span class="string">&quot;zhangsan&quot;</span></span><br><span class="line">6) <span class="string">&quot;5000&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; zrangebyscore salary -inf +inf withscores	<span class="comment">#显示工资小于等于2500的用户即薪水</span></span><br><span class="line">1) <span class="string">&quot;suyi&quot;</span></span><br><span class="line">2) <span class="string">&quot;200&quot;</span></span><br><span class="line">3) <span class="string">&quot;xiaohong&quot;</span></span><br><span class="line">4) <span class="string">&quot;2500&quot;</span></span><br><span class="line"><span class="comment">########################################################################</span></span><br><span class="line">zrem	<span class="comment">#移除</span></span><br><span class="line">zcard	<span class="comment">#获取有序集合中的个数</span></span><br><span class="line"></span><br><span class="line">127.0.0.1:6379&gt; zrange salary 0 -1</span><br><span class="line">1) <span class="string">&quot;suyi&quot;</span></span><br><span class="line">2) <span class="string">&quot;xiaohong&quot;</span></span><br><span class="line">3) <span class="string">&quot;zhangsan&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; zrem salary xiaohong	<span class="comment">#移除小红</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; zrange salary 0 -1</span><br><span class="line">1) <span class="string">&quot;suyi&quot;</span></span><br><span class="line">2) <span class="string">&quot;zhangsan&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; zcard salary <span class="comment">#获取有序集合中的个数</span></span><br><span class="line">(<span class="built_in">integer</span>) 2</span><br><span class="line"><span class="comment">########################################################################</span></span><br><span class="line">zount 	<span class="comment">#获取指定区间的成员数量！</span></span><br><span class="line">127.0.0.1:6379&gt; zadd myzset 1 hello 2 world 3 !</span><br><span class="line">(<span class="built_in">integer</span>) 3</span><br><span class="line">127.0.0.1:6379&gt; zcount myzset 0 -1</span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br><span class="line">127.0.0.1:6379&gt; zcount myzset 0  4</span><br><span class="line">(<span class="built_in">integer</span>) 3</span><br><span class="line">127.0.0.1:6379&gt; zcount myzset 0  6</span><br><span class="line">(<span class="built_in">integer</span>) 3</span><br><span class="line">127.0.0.1:6379&gt; zcount myzset 0  2</span><br><span class="line">(<span class="built_in">integer</span>) 2</span><br><span class="line">127.0.0.1:6379&gt; zcount myzset -inf +inf</span><br><span class="line">(<span class="built_in">integer</span>) 3</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>案例思路：</p>
<p>存储班级成绩表，工资表</p>
<p>带权重的消息：普通消息：1；重要消息：2</p>
<p>排行榜  取top N</p>
<h1 id="三种特殊数据类型"><a href="#三种特殊数据类型" class="headerlink" title="三种特殊数据类型"></a>三种特殊数据类型</h1><h4 id="geospatial"><a href="#geospatial" class="headerlink" title="geospatial"></a>geospatial</h4><p>  <a target="_blank" rel="noopener" href="https://jingweidu.bmcx.com/">经纬度在线查询</a></p>
<blockquote>
<p><a target="_blank" rel="noopener" href="http://redis.cn/commands/geoadd.html">geoadd</a></p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#geoadd		添加地理位置</span></span><br><span class="line">127.0.0.1:6379&gt; geoadd china:city 121.48941 31.40527 shanghai</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; geoadd china:city 116.23128 40.22077 beijing</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; geoadd china:city 113.88308 22.55329 shenzhen</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; geoadd china:city 108.93425 34.23053 xian</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; geoadd china:city 109.26291 35.57937 huangling</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p><a target="_blank" rel="noopener" href="http://redis.cn/commands/geopos.html">geopos</a></p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#geopos		获取城市经纬度  可获取多个</span></span><br><span class="line">127.0.0.1:6379&gt; geopos china:city huangling</span><br><span class="line">1) 1) <span class="string">&quot;109.26290899515151978&quot;</span></span><br><span class="line">   2) <span class="string">&quot;35.579370167327248&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; geopos china:city huangling xian</span><br><span class="line">1) 1) <span class="string">&quot;109.26290899515151978&quot;</span></span><br><span class="line">   2) <span class="string">&quot;35.579370167327248&quot;</span></span><br><span class="line">2) 1) <span class="string">&quot;108.93425256013870239&quot;</span></span><br><span class="line">   2) <span class="string">&quot;34.23053097599082406&quot;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p><a target="_blank" rel="noopener" href="http://redis.cn/commands/geodist.html">geodist</a></p>
</blockquote>
<ul>
<li>m表示为米</li>
<li>km表示为千米</li>
<li>mi表示为英里</li>
<li>ft表示为英尺</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#geodist 	返回两个地理空间之间的距离</span></span><br><span class="line">127.0.0.1:6379&gt; GEODIST china:city beijing shanghai</span><br><span class="line"><span class="string">&quot;1088644.3544&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; GEODIST china:city beijing shanghai km	<span class="comment">#以千米形式返回</span></span><br><span class="line"><span class="string">&quot;1088.6444&quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p><a target="_blank" rel="noopener" href="http://redis.cn/commands/georadius.html">georadius</a>  以给定的经纬度为中心，找出某一半径被的元素</p>
</blockquote>
<p>我附近的人？（获得所有附近的人的地址，定位）通过半径来查询</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#返回110经度 30纬度为中心的1000km距离的数据</span></span><br><span class="line">127.0.0.1:6379&gt; georadius china:city 110 30 1000 km		</span><br><span class="line">1) <span class="string">&quot;xian&quot;</span></span><br><span class="line">2) <span class="string">&quot;huangling&quot;</span></span><br><span class="line">3) <span class="string">&quot;shenzhen&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; georadius china:city 110 30 500 km		</span><br><span class="line">1) <span class="string">&quot;xian&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#返回以经纬度110，30为中心500km的数据并附带距离</span></span><br><span class="line">127.0.0.1:6379&gt; georadius china:city 110 30 500 km withdist</span><br><span class="line">1) 1) <span class="string">&quot;xian&quot;</span></span><br><span class="line">   2) <span class="string">&quot;481.1278&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#返回以经纬度110，30为中心1000km的数据并附带经纬度</span></span><br><span class="line">127.0.0.1:6379&gt; georadius china:city 110 30 1000 km withcoord</span><br><span class="line">1) 1) <span class="string">&quot;xian&quot;</span></span><br><span class="line">   2) 1) <span class="string">&quot;108.93425256013870239&quot;</span></span><br><span class="line">      2) <span class="string">&quot;34.23053097599082406&quot;</span></span><br><span class="line">2) 1) <span class="string">&quot;huangling&quot;</span></span><br><span class="line">   2) 1) <span class="string">&quot;109.26290899515151978&quot;</span></span><br><span class="line">      2) <span class="string">&quot;35.579370167327248&quot;</span></span><br><span class="line">3) 1) <span class="string">&quot;shenzhen&quot;</span></span><br><span class="line">   2) 1) <span class="string">&quot;113.88307839632034302&quot;</span></span><br><span class="line">      2) <span class="string">&quot;22.55329111565713873&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#返回以经纬度110，30为中心1000km的数据并附带经纬度和距离且限制返回数据的个数</span></span><br><span class="line">127.0.0.1:6379&gt; georadius china:city 110 30 1000 km withcoord withdist count 2	</span><br><span class="line">1) 1) <span class="string">&quot;xian&quot;</span></span><br><span class="line">   2) <span class="string">&quot;481.1278&quot;</span></span><br><span class="line">   3) 1) <span class="string">&quot;108.93425256013870239&quot;</span></span><br><span class="line">      2) <span class="string">&quot;34.23053097599082406&quot;</span></span><br><span class="line">2) 1) <span class="string">&quot;huangling&quot;</span></span><br><span class="line">   2) <span class="string">&quot;624.3814&quot;</span></span><br><span class="line">   3) 1) <span class="string">&quot;109.26290899515151978&quot;</span></span><br><span class="line">      2) <span class="string">&quot;35.579370167327248&quot;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p><a target="_blank" rel="noopener" href="http://redis.cn/commands/georadiusbymember.html">georadiusbymember</a>    相比于<a target="_blank" rel="noopener" href="http://redis.cn/commands/georadius.html">georedius</a> 的区别是   中心元素变成了城市</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; GEORADIUSBYMEMBER china:city beijing 1000 km </span><br><span class="line">1) <span class="string">&quot;beijing&quot;</span></span><br><span class="line">2) <span class="string">&quot;xian&quot;</span></span><br><span class="line">3) <span class="string">&quot;huangling&quot;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p><a target="_blank" rel="noopener" href="http://redis.cn/commands/geohash.html">geohash</a>  	返回一个或多个位置元素的 <a target="_blank" rel="noopener" href="http://redis.cn/commands/geohash.html">Geohash</a> 表示。</p>
</blockquote>
<p>该命令返回11个字符的geohash字符串</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#将二维的经纬度转换为一维的字符串</span></span><br><span class="line"><span class="comment">#如果两个字符串越接近，则距离越近</span></span><br><span class="line">127.0.0.1:6379&gt; geohash china:city beijing shanghai</span><br><span class="line">1) <span class="string">&quot;wx4sucvncn0&quot;</span></span><br><span class="line">2) <span class="string">&quot;wtw6st1uuq0&quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>GEO底层的实现原理</p>
<p>Zset！</p>
<p>可以使用Zset命令操作geo！</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; zrange china:city 0 -1		<span class="comment">#查看地图中全部元素</span></span><br><span class="line">1) <span class="string">&quot;xian&quot;</span></span><br><span class="line">2) <span class="string">&quot;huangling&quot;</span></span><br><span class="line">3) <span class="string">&quot;shenzhen&quot;</span></span><br><span class="line">4) <span class="string">&quot;shanghai&quot;</span></span><br><span class="line">5) <span class="string">&quot;beijing&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; zrem china:city shenzhen		<span class="comment">#移除指定元素</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h4 id="hyperloglog"><a href="#hyperloglog" class="headerlink" title="hyperloglog"></a>hyperloglog</h4><p>Redis 2.8.9版本就更新了Hyperloglog 数据结构!<br>Redis Hyperloglog基数统计的算法!<br>优点:占用的内存是固定, 2^64不同的元素的技术,只需要废12KB内存! 如果要从内存角度来比较的话Hyperloglog首选!<br><strong>网页的UV (一个人访问一个网站多次,但是还是算作一个人! )</strong><br>传统的方式，set保存用户的id ,然后就可以统计set中的元素数量作为标准判断!<br>这个方式如果保存大量的用户id ,就会比较麻烦!我们的目的是为了计数,而不是保存用户id ;<br>0.81%错误率!统计UV任务,可以忽略不计的!</p>
<blockquote>
<p>测试使用</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; PFadd mykey a b c d e f g h i j		<span class="comment">#创建第一组元素 mykey</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; PFCOUNT mykey						<span class="comment">#统计 mykey 元素的基数数量</span></span><br><span class="line">(<span class="built_in">integer</span>) 10</span><br><span class="line">127.0.0.1:6379&gt; PFadd mykey2 i j z x c v b n m		<span class="comment">#创建第二组元素 mykey</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; PFCOUNT mykey2</span><br><span class="line">(<span class="built_in">integer</span>) 9</span><br><span class="line">127.0.0.1:6379&gt; PFMERGE mykey3 mykey mykey2			<span class="comment">#合并两组 mykey mykey2=》 mykey3 并集</span></span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; PFCOUNT mykey3						<span class="comment">#查看并集的数量</span></span><br><span class="line">(<span class="built_in">integer</span>) 15</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>如果允许容错，那么一定可以使用Hyperloglog</p>
<p>如果不允许容错，就使用set或者自己的数据类型即可！</p>
<h4 id="bitmap"><a href="#bitmap" class="headerlink" title="bitmap"></a>bitmap</h4><blockquote>
<p>位存储</p>
</blockquote>
<p>统计用户信息，活跃，不活跃！登录、未登录！打卡，365打卡！两个状态的，都可以使用Bitmaps！</p>
<p>Bitmaps 位图，数据结构！ 都是操作二进制位来进行记录，就只有0和1两个状态！</p>
<p>365天&#x3D;365 bit 1字节&#x3D;8 bit 46个字节左右！</p>
<blockquote>
<p>测试</p>
</blockquote>
<p>使用Bitmaps 来记录 周一到周日的打卡！</p>
<p>周一：1 周二：0 周三：0 周四：1……</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; setbit sign 0 1</span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br><span class="line">127.0.0.1:6379&gt; setbit sign 1 0</span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br><span class="line">127.0.0.1:6379&gt; setbit sign 2 0</span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br><span class="line">127.0.0.1:6379&gt; setbit sign 3 1</span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br><span class="line">127.0.0.1:6379&gt; setbit sign 4 1</span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br><span class="line">127.0.0.1:6379&gt; setbit sign 5 0</span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br><span class="line">127.0.0.1:6379&gt; setbit sign 6 0</span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br></pre></td></tr></table></figure>

<p>查看某一天是否有打卡！</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; getbit sign 3</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; getbit sign 6</span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br></pre></td></tr></table></figure>

<p>统计操作，统计打卡的天数！</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; bitcount sign  <span class="comment">#统计这周的打卡记录，就可以看到是否有全勤</span></span><br><span class="line">(<span class="built_in">integer</span>) 3</span><br></pre></td></tr></table></figure>



<h1 id="事务"><a href="#事务" class="headerlink" title="事务"></a>事务</h1><p>要么都成功，要么都失败，原子性！</p>
<p>Redis事务本质：一组命令的集合！一个事务中的所有命令都会被序列化，在事务执行过程的中，会按照顺序执行!</p>
<p>一次性、顺序性、排他性！执行一系列的命令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">---------- 队列 <span class="built_in">set</span>  <span class="built_in">set</span>  <span class="built_in">set</span>  执行----------</span><br></pre></td></tr></table></figure>



<p>&#x3D;&#x3D;Redis事务没有隔离级别的概念&#x3D;&#x3D;</p>
<p>所有的命令在事务中，并没有直接被执行，只有发起执行命令的时候才会执行！Exec</p>
<p>&#x3D;&#x3D;Redis单条命令是保存原子性的，但是Redis的事务是不保证原子性的！&#x3D;&#x3D;</p>
<p>redis事务</p>
<ul>
<li>开启事务（multi）</li>
<li>命令入队（…）</li>
<li>执行事务（exec）</li>
</ul>
<blockquote>
<p>正常执行事务！</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; multi</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379(TX)&gt; <span class="built_in">set</span> name zhangsan</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379(TX)&gt; <span class="built_in">set</span> age 20</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379(TX)&gt; get name</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379(TX)&gt; <span class="built_in">set</span> sex 0</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379(TX)&gt; <span class="built_in">exec</span></span><br><span class="line">1) OK</span><br><span class="line">2) OK</span><br><span class="line">3) <span class="string">&quot;zhangsan&quot;</span></span><br><span class="line">4) OK</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<blockquote>
<p>放弃事务</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; MULTI</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379(TX)&gt; <span class="built_in">set</span> k1 v1</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379(TX)&gt; <span class="built_in">set</span> k2 v2</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379(TX)&gt; <span class="built_in">set</span> k3 v3</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379(TX)&gt; discard		<span class="comment">#取消事务</span></span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; get k1</span><br><span class="line">(nil)</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<blockquote>
<p>编译型异常（代码有问题，命令有错误）  		事务中所有的命令都不会被执行！</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; MULTI</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379(TX)&gt; <span class="built_in">set</span> k1 v1</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379(TX)&gt; <span class="built_in">set</span> k2 v2</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379(TX)&gt; <span class="built_in">set</span> k3 v3</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379(TX)&gt; getset k3		<span class="comment">#错误的命令</span></span><br><span class="line">(error) ERR wrong number of arguments <span class="keyword">for</span> <span class="string">&#x27;getset&#x27;</span> <span class="built_in">command</span></span><br><span class="line">127.0.0.1:6379(TX)&gt; <span class="built_in">set</span> k4 v4</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379(TX)&gt; <span class="built_in">set</span> k5 v5</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379(TX)&gt; <span class="built_in">exec</span>			<span class="comment">#执行事务报错</span></span><br><span class="line">(error) EXECABORT Transaction discarded because of previous errors.</span><br><span class="line">127.0.0.1:6379&gt; get k5				<span class="comment">#所有的命令都不会执行！</span></span><br><span class="line">(nil)</span><br></pre></td></tr></table></figure>





<blockquote>
<p>运行时异常（1&#x2F;0），如果事务队列中存在语法性错误，那么执行命令的时候，其他命令正常执行，错误命令抛出异常！</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> k1 <span class="string">&quot;v1&quot;</span>			<span class="comment">#设置一个字符串</span></span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; MULTI				<span class="comment">#进入事务</span></span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379(TX)&gt; INCR k1			<span class="comment">#自增1</span></span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379(TX)&gt; <span class="built_in">set</span> k2 v2</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379(TX)&gt; <span class="built_in">set</span> k3 v3</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379(TX)&gt; get k3</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379(TX)&gt; EXEC			<span class="comment">#执行</span></span><br><span class="line">1) (error) ERR value is not an <span class="built_in">integer</span> or out of range		<span class="comment">#运行时异常，字符串不能自增</span></span><br><span class="line">2) OK								<span class="comment">#其余命令执行成功</span></span><br><span class="line">3) OK</span><br><span class="line">4) <span class="string">&quot;v3&quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<blockquote>
<p>监控！Watch		（面试常问！）</p>
</blockquote>
<p><strong>悲观锁</strong>：</p>
<ul>
<li>很悲观，认为什么时候都会出问题，无论做什么都会加锁！</li>
</ul>
<p><strong>乐观锁</strong>：</p>
<ul>
<li>很乐观，认为什么时候都不会出问题，所以不会上锁！更新数据的时候取判断一下，在此期间是否有人修改过这个数据</li>
<li>获取version</li>
<li>更新的时候比较version</li>
</ul>
<blockquote>
<p>Redis的监视测试</p>
</blockquote>
<p>正常执行成功！</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> money 100</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> out 0</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; WATCH money			<span class="comment">#监视 money 对象</span></span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; multi				<span class="comment">#事务正常结束，数据期间没有发生变动，这时就正常执行成功！</span></span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379(TX)&gt; decrby money 20</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379(TX)&gt; incrby out 20</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379(TX)&gt; <span class="built_in">exec</span></span><br><span class="line">1) (<span class="built_in">integer</span>) 80</span><br><span class="line">2) (<span class="built_in">integer</span>) 20</span><br></pre></td></tr></table></figure>

<blockquote>
<p> 测试多线程修改值，使用watch可以当作redis的乐观锁操作！</p>
</blockquote>
<p>&#x3D;&#x3D;在客户端2监视money，进入事务后，客户端1修改了money，此时客户端2的事务必定执行失败！&#x3D;&#x3D;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#客户端1：</span></span><br><span class="line">127.0.0.1:6379&gt; get money</span><br><span class="line"><span class="string">&quot;80&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> money 1000</span><br><span class="line">OK</span><br><span class="line"></span><br><span class="line"><span class="comment">#客户端2：</span></span><br><span class="line">127.0.0.1:6379&gt; watch money				<span class="comment">#监视  money</span></span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; multi</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379(TX)&gt; decrby money 10</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379(TX)&gt; incrby money 10</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379(TX)&gt; <span class="built_in">exec</span>				<span class="comment">#执行前，另外一个线程修改了我们的值，这个时候，就会导致事务执行失败！</span></span><br><span class="line">(nil)</span><br><span class="line">127.0.0.1:6379&gt; get money</span><br><span class="line"><span class="string">&quot;1000&quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>&#x3D;&#x3D;如果修改失败，重新监视一下就ok&#x3D;&#x3D;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; unwatch</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; watch money</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; multi</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379(TX)&gt; decrby money 1</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379(TX)&gt; incrby out 1</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379(TX)&gt; <span class="built_in">exec</span></span><br><span class="line">1) (<span class="built_in">integer</span>) 999</span><br><span class="line">2) (<span class="built_in">integer</span>) 21</span><br><span class="line"></span><br></pre></td></tr></table></figure>







<h1 id="Jedis"><a href="#Jedis" class="headerlink" title="Jedis"></a>Jedis</h1><blockquote>
<p>Jedis是Redis官方推荐的 java 连接开发工具！ 使用 Java 操作Redis中间件！</p>
</blockquote>
<blockquote>
<p>测试</p>
</blockquote>
<p>1.导入依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--导入jedis依赖--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>redis.clients<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jedis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.6.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>fastjson<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.78<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>2.编码测试</p>
<ul>
<li>连接数据库</li>
<li>操作命令</li>
<li>断开连接</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sec;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> redis.clients.jedis.Jedis;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestPing</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">//1. new Jedis  对象</span></span><br><span class="line">        <span class="type">Jedis</span> <span class="variable">jedis</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Jedis</span>(<span class="string">&quot;127.0.0.1&quot;</span>,<span class="number">6379</span>);</span><br><span class="line">        <span class="comment">//jedis 所有的命令与redis的命令一样</span></span><br><span class="line">        System.out.println(jedis.ping());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>输出：</p>
<p><img src="/../assets/1637388595177.png" alt="1637388595177"></p>
<h2 id="常用的API"><a href="#常用的API" class="headerlink" title="常用的API"></a>常用的API</h2><p>String</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sec.base;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> redis.clients.jedis.Jedis;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeUnit;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestString</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Jedis</span> <span class="variable">jedis</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Jedis</span>(<span class="string">&quot;127.0.0.1&quot;</span>, <span class="number">6379</span>);</span><br><span class="line"></span><br><span class="line">        jedis.flushDB();</span><br><span class="line">        System.out.println(<span class="string">&quot;===========增加数据===========&quot;</span>);</span><br><span class="line">        System.out.println(jedis.set(<span class="string">&quot;key1&quot;</span>,<span class="string">&quot;value1&quot;</span>));<span class="comment">//OK</span></span><br><span class="line">        System.out.println(jedis.set(<span class="string">&quot;key2&quot;</span>,<span class="string">&quot;value2&quot;</span>));<span class="comment">//OK</span></span><br><span class="line">        System.out.println(jedis.set(<span class="string">&quot;key3&quot;</span>, <span class="string">&quot;value3&quot;</span>));<span class="comment">//OK</span></span><br><span class="line">        System.out.println(<span class="string">&quot;删除键key2:&quot;</span>+jedis.del(<span class="string">&quot;key2&quot;</span>));<span class="comment">//1</span></span><br><span class="line">        System.out.println(<span class="string">&quot;获取键key2:&quot;</span>+jedis.get(<span class="string">&quot;key2&quot;</span>));<span class="comment">//null</span></span><br><span class="line">        System.out.println(<span class="string">&quot;修改key1:&quot;</span>+jedis.set(<span class="string">&quot;key1&quot;</span>, <span class="string">&quot;value1Changed&quot;</span>));<span class="comment">//OK</span></span><br><span class="line">        System.out.println(<span class="string">&quot;获取key1的值：&quot;</span>+jedis.get(<span class="string">&quot;key1&quot;</span>));<span class="comment">//value1Changed</span></span><br><span class="line">        System.out.println(<span class="string">&quot;在key3后面加入值：&quot;</span>+jedis.append(<span class="string">&quot;key3&quot;</span>, <span class="string">&quot;End&quot;</span>));<span class="comment">//9</span></span><br><span class="line">        System.out.println(<span class="string">&quot;key3的值：&quot;</span>+jedis.get(<span class="string">&quot;key3&quot;</span>));<span class="comment">//value3End</span></span><br><span class="line">        System.out.println(<span class="string">&quot;增加多个键值对：&quot;</span>+jedis.mset(<span class="string">&quot;key01&quot;</span>,<span class="string">&quot;value01&quot;</span>,<span class="string">&quot;key02&quot;</span>,<span class="string">&quot;value02&quot;</span>,<span class="string">&quot;key03&quot;</span>,<span class="string">&quot;value03&quot;</span>));<span class="comment">//OK</span></span><br><span class="line">        System.out.println(<span class="string">&quot;获取多个键值对：&quot;</span>+jedis.mget(<span class="string">&quot;key01&quot;</span>,<span class="string">&quot;key02&quot;</span>,<span class="string">&quot;key03&quot;</span>));<span class="comment">//[value01, value02, value03]</span></span><br><span class="line">        System.out.println(<span class="string">&quot;获取多个键值对：&quot;</span>+jedis.mget(<span class="string">&quot;key01&quot;</span>,<span class="string">&quot;key02&quot;</span>,<span class="string">&quot;key03&quot;</span>,<span class="string">&quot;key04&quot;</span>));<span class="comment">//[value01, value02, value03, null]</span></span><br><span class="line">        System.out.println(<span class="string">&quot;删除多个键值对：&quot;</span>+jedis.del(<span class="string">&quot;key01&quot;</span>,<span class="string">&quot;key02&quot;</span>));<span class="comment">//2</span></span><br><span class="line">        System.out.println(<span class="string">&quot;获取多个键值对：&quot;</span>+jedis.mget(<span class="string">&quot;key01&quot;</span>,<span class="string">&quot;key02&quot;</span>,<span class="string">&quot;key03&quot;</span>));<span class="comment">//[null, null, value03]</span></span><br><span class="line"></span><br><span class="line">        jedis.flushDB();</span><br><span class="line">        System.out.println(<span class="string">&quot;===========新增键值对防止覆盖原先值==============&quot;</span>);</span><br><span class="line">        System.out.println(jedis.setnx(<span class="string">&quot;key1&quot;</span>, <span class="string">&quot;value1&quot;</span>));<span class="comment">//1</span></span><br><span class="line">        System.out.println(jedis.setnx(<span class="string">&quot;key2&quot;</span>, <span class="string">&quot;value2&quot;</span>));<span class="comment">//1</span></span><br><span class="line">        System.out.println(jedis.setnx(<span class="string">&quot;key2&quot;</span>, <span class="string">&quot;value2-new&quot;</span>));<span class="comment">//0</span></span><br><span class="line">        System.out.println(jedis.get(<span class="string">&quot;key1&quot;</span>));<span class="comment">//value1</span></span><br><span class="line">        System.out.println(jedis.get(<span class="string">&quot;key2&quot;</span>));<span class="comment">//value2</span></span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;===========新增键值对并设置有效时间=============&quot;</span>);</span><br><span class="line">        System.out.println(jedis.setex(<span class="string">&quot;key3&quot;</span>, <span class="number">2</span>, <span class="string">&quot;value3&quot;</span>));</span><br><span class="line">        System.out.println(jedis.get(<span class="string">&quot;key3&quot;</span>));<span class="comment">//value3</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            TimeUnit.SECONDS.sleep(<span class="number">3</span>);<span class="comment">//休眠3秒</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(jedis.get(<span class="string">&quot;key3&quot;</span>));<span class="comment">//null</span></span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;===========获取原值，更新为新值==========&quot;</span>);</span><br><span class="line">        System.out.println(jedis.getSet(<span class="string">&quot;key2&quot;</span>, <span class="string">&quot;key2GetSet&quot;</span>));<span class="comment">//value2</span></span><br><span class="line">        System.out.println(jedis.get(<span class="string">&quot;key2&quot;</span>));<span class="comment">//key2GetSet</span></span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;获得key2的值的字串：&quot;</span>+jedis.getrange(<span class="string">&quot;key2&quot;</span>, <span class="number">2</span>, <span class="number">4</span>));<span class="comment">//y2G</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>List</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sec.base;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> redis.clients.jedis.Jedis;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestList</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Jedis</span> <span class="variable">jedis</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Jedis</span>(<span class="string">&quot;127.0.0.1&quot;</span>, <span class="number">6379</span>);</span><br><span class="line">        jedis.flushDB();</span><br><span class="line">        System.out.println(<span class="string">&quot;===========添加一个list===========&quot;</span>);</span><br><span class="line">        jedis.lpush(<span class="string">&quot;collections&quot;</span>, <span class="string">&quot;ArrayList&quot;</span>, <span class="string">&quot;Vector&quot;</span>, <span class="string">&quot;Stack&quot;</span>, <span class="string">&quot;HashMap&quot;</span>, <span class="string">&quot;WeakHashMap&quot;</span>, <span class="string">&quot;LinkedHashMap&quot;</span>);</span><br><span class="line">        jedis.lpush(<span class="string">&quot;collections&quot;</span>, <span class="string">&quot;HashSet&quot;</span>);</span><br><span class="line">        jedis.lpush(<span class="string">&quot;collections&quot;</span>, <span class="string">&quot;TreeSet&quot;</span>);</span><br><span class="line">        jedis.lpush(<span class="string">&quot;collections&quot;</span>, <span class="string">&quot;TreeMap&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;collections的内容：&quot;</span>+jedis.lrange(<span class="string">&quot;collections&quot;</span>, <span class="number">0</span>, -<span class="number">1</span>));<span class="comment">//-1代表倒数第一个元素，-2代表倒数第二个元素,end为-1表示查询全部</span></span><br><span class="line">        System.out.println(<span class="string">&quot;collections区间0-3的元素：&quot;</span>+jedis.lrange(<span class="string">&quot;collections&quot;</span>,<span class="number">0</span>,<span class="number">3</span>));</span><br><span class="line">        System.out.println(<span class="string">&quot;===============================&quot;</span>);</span><br><span class="line">        <span class="comment">// 删除列表指定的值 ，第二个参数为删除的个数（有重复时），后add进去的值先被删，类似于出栈</span></span><br><span class="line">        System.out.println(<span class="string">&quot;删除指定元素个数：&quot;</span>+jedis.lrem(<span class="string">&quot;collections&quot;</span>, <span class="number">2</span>, <span class="string">&quot;HashMap&quot;</span>));</span><br><span class="line">        System.out.println(<span class="string">&quot;collections的内容：&quot;</span>+jedis.lrange(<span class="string">&quot;collections&quot;</span>, <span class="number">0</span>, -<span class="number">1</span>));</span><br><span class="line">        System.out.println(<span class="string">&quot;删除下表0-3区间之外的元素：&quot;</span>+jedis.ltrim(<span class="string">&quot;collections&quot;</span>, <span class="number">0</span>, <span class="number">3</span>));</span><br><span class="line">        System.out.println(<span class="string">&quot;collections的内容：&quot;</span>+jedis.lrange(<span class="string">&quot;collections&quot;</span>, <span class="number">0</span>, -<span class="number">1</span>));</span><br><span class="line">        System.out.println(<span class="string">&quot;collections列表出栈（左端）：&quot;</span>+jedis.lpop(<span class="string">&quot;collections&quot;</span>));</span><br><span class="line">        System.out.println(<span class="string">&quot;collections的内容：&quot;</span>+jedis.lrange(<span class="string">&quot;collections&quot;</span>, <span class="number">0</span>, -<span class="number">1</span>));</span><br><span class="line">        System.out.println(<span class="string">&quot;collections添加元素，从列表右端，与lpush相对应：&quot;</span>+jedis.rpush(<span class="string">&quot;collections&quot;</span>, <span class="string">&quot;EnumMap&quot;</span>));</span><br><span class="line">        System.out.println(<span class="string">&quot;collections的内容：&quot;</span>+jedis.lrange(<span class="string">&quot;collections&quot;</span>, <span class="number">0</span>, -<span class="number">1</span>));</span><br><span class="line">        System.out.println(<span class="string">&quot;collections列表出栈（右端）：&quot;</span>+jedis.rpop(<span class="string">&quot;collections&quot;</span>));</span><br><span class="line">        System.out.println(<span class="string">&quot;collections的内容：&quot;</span>+jedis.lrange(<span class="string">&quot;collections&quot;</span>, <span class="number">0</span>, -<span class="number">1</span>));</span><br><span class="line">        System.out.println(<span class="string">&quot;修改collections指定下标1的内容：&quot;</span>+jedis.lset(<span class="string">&quot;collections&quot;</span>, <span class="number">1</span>, <span class="string">&quot;LinkedArrayList&quot;</span>));</span><br><span class="line">        System.out.println(<span class="string">&quot;collections的内容：&quot;</span>+jedis.lrange(<span class="string">&quot;collections&quot;</span>, <span class="number">0</span>, -<span class="number">1</span>));</span><br><span class="line">        System.out.println(<span class="string">&quot;===============================&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;collections的长度：&quot;</span>+jedis.llen(<span class="string">&quot;collections&quot;</span>));</span><br><span class="line">        System.out.println(<span class="string">&quot;获取collections下标为2的元素：&quot;</span>+jedis.lindex(<span class="string">&quot;collections&quot;</span>, <span class="number">2</span>));</span><br><span class="line">        System.out.println(<span class="string">&quot;===============================&quot;</span>);</span><br><span class="line">        jedis.lpush(<span class="string">&quot;sortedList&quot;</span>, <span class="string">&quot;3&quot;</span>,<span class="string">&quot;6&quot;</span>,<span class="string">&quot;2&quot;</span>,<span class="string">&quot;0&quot;</span>,<span class="string">&quot;7&quot;</span>,<span class="string">&quot;4&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;sortedList排序前：&quot;</span>+jedis.lrange(<span class="string">&quot;sortedList&quot;</span>, <span class="number">0</span>, -<span class="number">1</span>));</span><br><span class="line">        System.out.println(jedis.sort(<span class="string">&quot;sortedList&quot;</span>));</span><br><span class="line">        System.out.println(<span class="string">&quot;sortedList排序后：&quot;</span>+jedis.lrange(<span class="string">&quot;sortedList&quot;</span>, <span class="number">0</span>, -<span class="number">1</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>Set</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sec.base;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> redis.clients.jedis.Jedis;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestSet</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Jedis</span> <span class="variable">jedis</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Jedis</span>(<span class="string">&quot;127.0.0.1&quot;</span>, <span class="number">6379</span>);</span><br><span class="line">        jedis.flushDB();</span><br><span class="line">        System.out.println(<span class="string">&quot;============向集合中添加元素（不重复）============&quot;</span>);</span><br><span class="line">        System.out.println(jedis.sadd(<span class="string">&quot;eleSet&quot;</span>, <span class="string">&quot;e1&quot;</span>,<span class="string">&quot;e2&quot;</span>,<span class="string">&quot;e4&quot;</span>,<span class="string">&quot;e3&quot;</span>,<span class="string">&quot;e0&quot;</span>,<span class="string">&quot;e8&quot;</span>,<span class="string">&quot;e7&quot;</span>,<span class="string">&quot;e5&quot;</span>));<span class="comment">//8</span></span><br><span class="line">        System.out.println(jedis.sadd(<span class="string">&quot;eleSet&quot;</span>, <span class="string">&quot;e6&quot;</span>));<span class="comment">//1</span></span><br><span class="line">        System.out.println(jedis.sadd(<span class="string">&quot;eleSet&quot;</span>, <span class="string">&quot;e6&quot;</span>));<span class="comment">//1</span></span><br><span class="line">        System.out.println(<span class="string">&quot;eleSet的所有元素为：&quot;</span>+jedis.smembers(<span class="string">&quot;eleSet&quot;</span>));<span class="comment">//[e1, e4, e2, e0, e5, e8, e3, e7, e6]</span></span><br><span class="line">        System.out.println(<span class="string">&quot;删除一个元素e0：&quot;</span>+jedis.srem(<span class="string">&quot;eleSet&quot;</span>, <span class="string">&quot;e0&quot;</span>));<span class="comment">//1</span></span><br><span class="line">        System.out.println(<span class="string">&quot;eleSet的所有元素为：&quot;</span>+jedis.smembers(<span class="string">&quot;eleSet&quot;</span>));<span class="comment">//[e4, e2, e5, e8, e3, e1, e7, e6]</span></span><br><span class="line">        System.out.println(<span class="string">&quot;删除两个元素e7和e6：&quot;</span>+jedis.srem(<span class="string">&quot;eleSet&quot;</span>, <span class="string">&quot;e7&quot;</span>,<span class="string">&quot;e6&quot;</span>));<span class="comment">//2</span></span><br><span class="line">        System.out.println(<span class="string">&quot;eleSet的所有元素为：&quot;</span>+jedis.smembers(<span class="string">&quot;eleSet&quot;</span>));<span class="comment">//[e5, e8, e3, e1, e2, e4]</span></span><br><span class="line">        System.out.println(<span class="string">&quot;随机的移除集合中的一个元素：&quot;</span>+jedis.spop(<span class="string">&quot;eleSet&quot;</span>));<span class="comment">//e4</span></span><br><span class="line">        System.out.println(<span class="string">&quot;随机的移除集合中的一个元素：&quot;</span>+jedis.spop(<span class="string">&quot;eleSet&quot;</span>));<span class="comment">//e1</span></span><br><span class="line">        System.out.println(<span class="string">&quot;eleSet的所有元素为：&quot;</span>+jedis.smembers(<span class="string">&quot;eleSet&quot;</span>));<span class="comment">//[e2, e3, e5, e8]</span></span><br><span class="line">        System.out.println(<span class="string">&quot;eleSet中包含元素的个数：&quot;</span>+jedis.scard(<span class="string">&quot;eleSet&quot;</span>));<span class="comment">//4</span></span><br><span class="line">        System.out.println(<span class="string">&quot;e3是否在eleSet中：&quot;</span>+jedis.sismember(<span class="string">&quot;eleSet&quot;</span>, <span class="string">&quot;e3&quot;</span>));<span class="comment">//true</span></span><br><span class="line">        System.out.println(<span class="string">&quot;e1是否在eleSet中：&quot;</span>+jedis.sismember(<span class="string">&quot;eleSet&quot;</span>, <span class="string">&quot;e1&quot;</span>));<span class="comment">//false</span></span><br><span class="line">        System.out.println(<span class="string">&quot;e1是否在eleSet中：&quot;</span>+jedis.sismember(<span class="string">&quot;eleSet&quot;</span>, <span class="string">&quot;e5&quot;</span>));<span class="comment">//true</span></span><br><span class="line">        System.out.println(<span class="string">&quot;=================================&quot;</span>);</span><br><span class="line">        System.out.println(jedis.sadd(<span class="string">&quot;eleSet1&quot;</span>, <span class="string">&quot;e1&quot;</span>,<span class="string">&quot;e2&quot;</span>,<span class="string">&quot;e4&quot;</span>,<span class="string">&quot;e3&quot;</span>,<span class="string">&quot;e0&quot;</span>,<span class="string">&quot;e8&quot;</span>,<span class="string">&quot;e7&quot;</span>,<span class="string">&quot;e5&quot;</span>));<span class="comment">//8</span></span><br><span class="line">        System.out.println(jedis.sadd(<span class="string">&quot;eleSet2&quot;</span>, <span class="string">&quot;e1&quot;</span>,<span class="string">&quot;e2&quot;</span>,<span class="string">&quot;e4&quot;</span>,<span class="string">&quot;e3&quot;</span>,<span class="string">&quot;e0&quot;</span>,<span class="string">&quot;e8&quot;</span>));<span class="comment">//6</span></span><br><span class="line">        System.out.println(<span class="string">&quot;将eleSet1中删除e1并存入eleSet3中：&quot;</span>+jedis.smove(<span class="string">&quot;eleSet1&quot;</span>, <span class="string">&quot;eleSet3&quot;</span>, <span class="string">&quot;e1&quot;</span>));<span class="comment">//移到集合元素    1</span></span><br><span class="line">        System.out.println(<span class="string">&quot;将eleSet1中删除e2并存入eleSet3中：&quot;</span>+jedis.smove(<span class="string">&quot;eleSet1&quot;</span>, <span class="string">&quot;eleSet3&quot;</span>, <span class="string">&quot;e2&quot;</span>));<span class="comment">//1</span></span><br><span class="line">        System.out.println(<span class="string">&quot;eleSet1中的元素：&quot;</span>+jedis.smembers(<span class="string">&quot;eleSet1&quot;</span>));<span class="comment">//[e7, e4, e0, e5, e8, e3]</span></span><br><span class="line">        System.out.println(<span class="string">&quot;eleSet3中的元素：&quot;</span>+jedis.smembers(<span class="string">&quot;eleSet3&quot;</span>));<span class="comment">//[e2, e1]</span></span><br><span class="line">        System.out.println(<span class="string">&quot;============集合运算=================&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;eleSet1中的元素：&quot;</span>+jedis.smembers(<span class="string">&quot;eleSet1&quot;</span>));<span class="comment">//[e7, e4, e0, e5, e8, e3]</span></span><br><span class="line">        System.out.println(<span class="string">&quot;eleSet2中的元素：&quot;</span>+jedis.smembers(<span class="string">&quot;eleSet2&quot;</span>));<span class="comment">//[e1, e3, e4, e2, e0, e8]</span></span><br><span class="line">        System.out.println(<span class="string">&quot;eleSet1和eleSet2的交集:&quot;</span>+jedis.sinter(<span class="string">&quot;eleSet1&quot;</span>,<span class="string">&quot;eleSet2&quot;</span>));<span class="comment">//[e3, e4, e0, e8]</span></span><br><span class="line">        System.out.println(<span class="string">&quot;eleSet1和eleSet2的并集:&quot;</span>+jedis.sunion(<span class="string">&quot;eleSet1&quot;</span>,<span class="string">&quot;eleSet2&quot;</span>));<span class="comment">//[e1, e4, e2, e0, e5, e8, e3, e7]</span></span><br><span class="line">        System.out.println(<span class="string">&quot;eleSet1和eleSet2的差集:&quot;</span>+jedis.sdiff(<span class="string">&quot;eleSet1&quot;</span>,<span class="string">&quot;eleSet2&quot;</span>));<span class="comment">//eleSet1中有，eleSet2中没有  [e7, e5]</span></span><br><span class="line">        jedis.sinterstore(<span class="string">&quot;eleSet4&quot;</span>,<span class="string">&quot;eleSet1&quot;</span>,<span class="string">&quot;eleSet2&quot;</span>);<span class="comment">//求交集并将交集保存到eleSet4的集合</span></span><br><span class="line">        System.out.println(<span class="string">&quot;eleSet4中的元素：&quot;</span>+jedis.smembers(<span class="string">&quot;eleSet4&quot;</span>));<span class="comment">//[e0, e8, e3, e4]</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>Hash</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sec.base;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> redis.clients.jedis.Jedis;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestHash</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Jedis</span> <span class="variable">jedis</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Jedis</span>(<span class="string">&quot;127.0.0.1&quot;</span>, <span class="number">6379</span>);</span><br><span class="line">        jedis.flushDB();</span><br><span class="line">        Map&lt;String,String&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;String,String&gt;();</span><br><span class="line">        map.put(<span class="string">&quot;key1&quot;</span>,<span class="string">&quot;value1&quot;</span>);</span><br><span class="line">        map.put(<span class="string">&quot;key2&quot;</span>,<span class="string">&quot;value2&quot;</span>);</span><br><span class="line">        map.put(<span class="string">&quot;key3&quot;</span>,<span class="string">&quot;value3&quot;</span>);</span><br><span class="line">        map.put(<span class="string">&quot;key4&quot;</span>,<span class="string">&quot;value4&quot;</span>);</span><br><span class="line">        <span class="comment">//添加名称为hash（key）的hash元素</span></span><br><span class="line">        jedis.hmset(<span class="string">&quot;hash&quot;</span>,map);</span><br><span class="line">        <span class="comment">//向名称为hash的hash中添加key为key5，value为value5元素</span></span><br><span class="line">        jedis.hset(<span class="string">&quot;hash&quot;</span>, <span class="string">&quot;key5&quot;</span>, <span class="string">&quot;value5&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;散列hash的所有键值对为：&quot;</span>+jedis.hgetAll(<span class="string">&quot;hash&quot;</span>));<span class="comment">//return Map&lt;String,String&gt;</span></span><br><span class="line">        System.out.println(<span class="string">&quot;散列hash的所有键为：&quot;</span>+jedis.hkeys(<span class="string">&quot;hash&quot;</span>));<span class="comment">//return Set&lt;String&gt;</span></span><br><span class="line">        System.out.println(<span class="string">&quot;散列hash的所有值为：&quot;</span>+jedis.hvals(<span class="string">&quot;hash&quot;</span>));<span class="comment">//return List&lt;String&gt;</span></span><br><span class="line">        System.out.println(<span class="string">&quot;将key6保存的值加上一个整数，如果key6不存在则添加key6：&quot;</span>+jedis.hincrBy(<span class="string">&quot;hash&quot;</span>, <span class="string">&quot;key6&quot;</span>, <span class="number">6</span>));</span><br><span class="line">        System.out.println(<span class="string">&quot;散列hash的所有键值对为：&quot;</span>+jedis.hgetAll(<span class="string">&quot;hash&quot;</span>));</span><br><span class="line">        System.out.println(<span class="string">&quot;将key6保存的值加上一个整数，如果key6不存在则添加key6：&quot;</span>+jedis.hincrBy(<span class="string">&quot;hash&quot;</span>, <span class="string">&quot;key6&quot;</span>, <span class="number">3</span>));</span><br><span class="line">        System.out.println(<span class="string">&quot;散列hash的所有键值对为：&quot;</span>+jedis.hgetAll(<span class="string">&quot;hash&quot;</span>));</span><br><span class="line">        System.out.println(<span class="string">&quot;删除一个或者多个键值对：&quot;</span>+jedis.hdel(<span class="string">&quot;hash&quot;</span>, <span class="string">&quot;key2&quot;</span>));</span><br><span class="line">        System.out.println(<span class="string">&quot;散列hash的所有键值对为：&quot;</span>+jedis.hgetAll(<span class="string">&quot;hash&quot;</span>));</span><br><span class="line">        System.out.println(<span class="string">&quot;散列hash中键值对的个数：&quot;</span>+jedis.hlen(<span class="string">&quot;hash&quot;</span>));</span><br><span class="line">        System.out.println(<span class="string">&quot;判断hash中是否存在key2：&quot;</span>+jedis.hexists(<span class="string">&quot;hash&quot;</span>,<span class="string">&quot;key2&quot;</span>));</span><br><span class="line">        System.out.println(<span class="string">&quot;判断hash中是否存在key3：&quot;</span>+jedis.hexists(<span class="string">&quot;hash&quot;</span>,<span class="string">&quot;key3&quot;</span>));</span><br><span class="line">        System.out.println(<span class="string">&quot;获取hash中的值：&quot;</span>+jedis.hmget(<span class="string">&quot;hash&quot;</span>,<span class="string">&quot;key3&quot;</span>));</span><br><span class="line">        System.out.println(<span class="string">&quot;获取hash中的值：&quot;</span>+jedis.hmget(<span class="string">&quot;hash&quot;</span>,<span class="string">&quot;key3&quot;</span>,<span class="string">&quot;key4&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>Zset</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sec.base;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> redis.clients.jedis.Jedis;</span><br><span class="line"><span class="keyword">import</span> redis.clients.jedis.params.ZAddParams;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestZset</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Jedis</span> <span class="variable">jedis</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Jedis</span>(<span class="string">&quot;127.0.0.1&quot;</span>, <span class="number">6379</span>);</span><br><span class="line">        jedis.flushDB();</span><br><span class="line">        System.out.println(jedis.zadd(<span class="string">&quot;score&quot;</span>, <span class="number">80</span>, <span class="string">&quot;shuXue&quot;</span>));</span><br><span class="line">        System.out.println(jedis.zadd(<span class="string">&quot;score&quot;</span>, <span class="number">90</span>, <span class="string">&quot;yuWen&quot;</span>));</span><br><span class="line">        System.out.println(jedis.zadd(<span class="string">&quot;score&quot;</span>, <span class="number">120</span>, <span class="string">&quot;yingYu&quot;</span>));</span><br><span class="line">        System.out.println(jedis.zadd(<span class="string">&quot;score&quot;</span>, <span class="number">100</span>, <span class="string">&quot;wuLi&quot;</span>));</span><br><span class="line">        System.out.println(jedis.zadd(<span class="string">&quot;score&quot;</span>, <span class="number">150</span>, <span class="string">&quot;shengWu&quot;</span>));</span><br><span class="line">        System.out.println(<span class="string">&quot;从小到大排序:&quot;</span>+jedis.zrangeByScoreWithScores(<span class="string">&quot;score&quot;</span>,<span class="string">&quot;-inf&quot;</span>,<span class="string">&quot;+inf&quot;</span>));<span class="comment">//从小到大排序  -inf负无穷  +inf正无穷</span></span><br><span class="line">        jedis.zaddIncr(<span class="string">&quot;score&quot;</span>,<span class="number">5</span>,<span class="string">&quot;shuXue&quot;</span>, ZAddParams.zAddParams());<span class="comment">//数学成绩+5</span></span><br><span class="line">        System.out.println(<span class="string">&quot;数学成绩+5后：&quot;</span>+jedis.zrangeByScoreWithScores(<span class="string">&quot;score&quot;</span>,<span class="string">&quot;-inf&quot;</span>,<span class="string">&quot;+inf&quot;</span>));</span><br><span class="line">        System.out.println(<span class="string">&quot;score的个数：&quot;</span>+jedis.zcard(<span class="string">&quot;score&quot;</span>));<span class="comment">//5</span></span><br><span class="line">        System.out.println(<span class="string">&quot;从大到小排序:&quot;</span>+jedis.zrevrangeByScoreWithScores(<span class="string">&quot;score&quot;</span>,<span class="string">&quot;+inf&quot;</span>,<span class="string">&quot;-inf&quot;</span>));<span class="comment">//从大到小排序</span></span><br><span class="line">        System.out.println(<span class="string">&quot;删除一个指定元素shengWu：&quot;</span>+jedis.zrem(<span class="string">&quot;score&quot;</span>,<span class="string">&quot;shengWu&quot;</span>));</span><br><span class="line">        System.out.println(<span class="string">&quot;结果：&quot;</span>+jedis.zrange(<span class="string">&quot;score&quot;</span>,<span class="number">0</span>,-<span class="number">1</span>));</span><br><span class="line">        <span class="comment">//………………</span></span><br><span class="line">        jedis.flushDB();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>







<h1 id="SpringBoot整合"><a href="#SpringBoot整合" class="headerlink" title="SpringBoot整合"></a>SpringBoot整合</h1><p>SpringBoot操作数据︰spring-data jpa jdbc mongodb redis !</p>
<p>SpringData也是和SpringBoot齐名的项目!</p>
<p>说明︰在SpringBoot2.x之后，原来使用的jedis被替换为了lettuce</p>
<p>jedis :采用的直连，多个线程操作的话，是不安全的，如果想要避免不安全的，使用jedis pool连接池!更像BIO模式</p>
<p>lettuce :采用netty，实例可以再多个线程中进行共享，不存在线程不安全的情况!可以减少线程数据了，更像NIO模式</p>
<blockquote>
<p>源码分析:</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="meta">@ConditionalOnMissingBean(name = &quot;redisTemplate&quot;)</span><span class="comment">//我们可以自己定义一个redisTemplate来替换这个默认的!</span></span><br><span class="line"><span class="meta">@ConditionalOnSingleCandidate(RedisConnectionFactory.class)</span></span><br><span class="line"><span class="keyword">public</span> RedisTemplate&lt;Object, Object&gt; <span class="title function_">redisTemplate</span><span class="params">(RedisConnectionFactory redisConnectionFactory)</span> &#123;</span><br><span class="line">    <span class="comment">//默认的 RedisTemplate没有过多的设置，redis对象都是需要序列化!</span></span><br><span class="line">    <span class="comment">//两个泛型都是 object，object的类型，我们后使用需要强制转换&lt;String，object&gt;</span></span><br><span class="line">    RedisTemplate&lt;Object, Object&gt; template = <span class="keyword">new</span> <span class="title class_">RedisTemplate</span>&lt;&gt;();</span><br><span class="line">    template.setConnectionFactory(redisConnectionFactory);</span><br><span class="line">    <span class="keyword">return</span> template;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="meta">@ConditionalOnMissingBean</span>	<span class="comment">//由于string是redis中最常使用的类型，所以说单独提出来了一个bean !</span></span><br><span class="line"><span class="meta">@ConditionalOnSingleCandidate(RedisConnectionFactory.class)</span></span><br><span class="line"><span class="keyword">public</span> StringRedisTemplate <span class="title function_">stringRedisTemplate</span><span class="params">(RedisConnectionFactory redisConnectionFactory)</span> &#123;</span><br><span class="line">    <span class="type">StringRedisTemplate</span> <span class="variable">template</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringRedisTemplate</span>();</span><br><span class="line">    template.setConnectionFactory(redisConnectionFactory);</span><br><span class="line">    <span class="keyword">return</span> template;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>整合测试一下</p>
</blockquote>
<p>1.导入依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-redis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>2.配置连接</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#配置redis</span></span><br><span class="line"><span class="attr">spring.redis.port</span>=<span class="string">6379</span></span><br><span class="line"><span class="attr">spring.redis.host</span>=<span class="string">127.0.0.1</span></span><br></pre></td></tr></table></figure>

<p>3.测试</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Redis02SpringbootApplicationTests</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    RedisTemplate&lt;Object,Object&gt; redisTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">contextLoads</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * redisTempLate操作不同的数据类型，api和我们的指令是一样的opsForVaLue操作字符串类似String</span></span><br><span class="line"><span class="comment">         * opsForList操f作List类似List</span></span><br><span class="line"><span class="comment">         * opsForSet</span></span><br><span class="line"><span class="comment">         * opsForHash</span></span><br><span class="line"><span class="comment">         * opsForZSet</span></span><br><span class="line"><span class="comment">         * opsForGeo</span></span><br><span class="line"><span class="comment">         * opsForHyperLogLog</span></span><br><span class="line"><span class="comment">         *</span></span><br><span class="line"><span class="comment">         * 除了基本的操作，我们常用的方法都可以直接通过 redisTemplate 操作，比如事务，和基本的CRUD</span></span><br><span class="line"><span class="comment">         *</span></span><br><span class="line"><span class="comment">         * 获取redis的连接对象</span></span><br><span class="line"><span class="comment">         *          RedisConnection connection = redisTemplate.getConnectionFactory().getConnection();</span></span><br><span class="line"><span class="comment">         *         connection.flushDb();</span></span><br><span class="line"><span class="comment">         *         connection.flushAll();</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line"></span><br><span class="line">        redisTemplate.opsForValue().set(<span class="string">&quot;springboot-redis&quot;</span>,<span class="string">&quot;haoJiaCheng&quot;</span>);</span><br><span class="line">        System.out.println(redisTemplate.opsForValue().get(<span class="string">&quot;springboot-redis&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p><img src="/../assets/1637403065944.png" alt="1637403065944"></p>
<p><img src="/../assets/1637403261311.png" alt="1637403261311"></p>
<p>关于对象的保存   需要序列化，要么</p>
<p>①</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">jsonUser</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectMapper</span>().writeValueAsString(user);</span><br></pre></td></tr></table></figure>

<p>要么</p>
<p>②：继承Serializable接口</p>
<p><img src="/../assets/1637405907640.png" alt="1637405907640"></p>
<p>要么</p>
<p>③：编写自己的redisTemplate</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RedisConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//  自己定义一个 RedisTemplate</span></span><br><span class="line">    <span class="comment">//  固定的模板</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> RedisTemplate&lt;String, Object&gt; <span class="title function_">myRedisTemplate</span><span class="params">(RedisConnectionFactory redisConnectionFactory)</span> &#123;</span><br><span class="line">        <span class="comment">//  开发中一般使用  &lt;String, Object&gt; 的形式</span></span><br><span class="line">        RedisTemplate&lt;String, Object&gt; template = <span class="keyword">new</span> <span class="title class_">RedisTemplate</span>&lt;&gt;();</span><br><span class="line">        template.setConnectionFactory(redisConnectionFactory);</span><br><span class="line">        <span class="comment">//  Json序列化配置</span></span><br><span class="line">        <span class="type">Jackson2JsonRedisSerializer</span> <span class="variable">jackson2JsonRedisSerializer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Jackson2JsonRedisSerializer</span>(Object.class);</span><br><span class="line">        <span class="type">ObjectMapper</span> <span class="variable">objectMapper</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectMapper</span>();</span><br><span class="line">        objectMapper.setVisibility(PropertyAccessor.ALL, JsonAutoDetect.Visibility.ANY);</span><br><span class="line">        <span class="comment">//objectMapper.enableDefaultTyping(ObjectMapper.DefaultTyping.NON_FINAL);</span></span><br><span class="line">        <span class="comment">//enableDefaultTyping过期  使用activateDefaultTyping代替		objectMapper.activateDefaultTyping(LaissezFaireSubTypeValidator.instance,ObjectMapper.DefaultTyping.NON_FINAL, JsonTypeInfo.As.PROPERTY);</span></span><br><span class="line">        jackson2JsonRedisSerializer.setObjectMapper(objectMapper);</span><br><span class="line">        <span class="comment">//  String的序列化</span></span><br><span class="line">        <span class="type">StringRedisSerializer</span> <span class="variable">stringRedisSerializer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringRedisSerializer</span>();</span><br><span class="line">        <span class="comment">//  key使用String的序列化方式</span></span><br><span class="line">        template.setKeySerializer(stringRedisSerializer);</span><br><span class="line">        <span class="comment">//  hash的key也采用String的序列化方式</span></span><br><span class="line">        template.setHashKeySerializer(stringRedisSerializer);</span><br><span class="line">        <span class="comment">// value序列化方式采用jackson</span></span><br><span class="line">        template.setValueSerializer(jackson2JsonRedisSerializer);</span><br><span class="line">        <span class="comment">//以hash的value序列化方式采用jackson</span></span><br><span class="line">        template.setHashValueSerializer(jackson2JsonRedisSerializer);</span><br><span class="line">        template.afterPropertiesSet();</span><br><span class="line">        <span class="keyword">return</span> template;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<h1 id="Redis-conf详解"><a href="#Redis-conf详解" class="headerlink" title="Redis.conf详解"></a>Redis.conf详解</h1><h2 id="基本配置"><a href="#基本配置" class="headerlink" title="基本配置"></a>基本配置</h2><blockquote>
<p>位置</p>
</blockquote>
<p>Redis 的配置文件位于 Redis 安装目录下，文件名为 redis.conf </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">config get * <span class="comment"># 获取全部的配置</span></span><br></pre></td></tr></table></figure>

<p>我们一般情况下，会单独拷贝出来一份进行操作。来保证初始文件的安全。 </p>
<p>启动的时候，就通过配置文件来启动的！</p>
<blockquote>
<p>单位 	容量单位不区分大小写，G和GB有区别 </p>
</blockquote>
<p>&#x3D;&#x3D;配置文件 unit单位对大小写不敏感&#x3D;&#x3D;</p>
<p><img src="/../assets/1637408016127.png" alt="1637408016127"></p>
<blockquote>
<p>include  包含,组合多个配置 </p>
</blockquote>
<p><img src="/../assets/1637408093417.png" alt="1637408093417"></p>
<p>就好比我们学习Spring、Import、include</p>
<blockquote>
<p>NETWORK  网络</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">bind</span> 127.0.0.1		<span class="comment">#绑定的IP</span></span><br><span class="line">protected-mode <span class="built_in">yes</span> 	<span class="comment">#保护模式</span></span><br><span class="line">port 6379  			<span class="comment">#端口</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>GENERAL 通用</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">daemonize <span class="built_in">yes</span>   	<span class="comment">#以守护进程的方式运行，默认是no，我们需要修改为yes</span></span><br><span class="line"></span><br><span class="line">pidfile /var/run/redis.pid	<span class="comment">#如果以后台的方式运行，我们就需要指定一个 pid 文件</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#Specify: the server verbosity level.# This can be. one of :</span></span><br><span class="line"><span class="comment"># debug (a lot of information, useful for development/testing)</span></span><br><span class="line"><span class="comment"># verbose(many rarely useful info，but not a mess like the debug level)</span></span><br><span class="line"><span class="comment"># notice (moderately verbose,what you want in production probably)		生产环境</span></span><br><span class="line"><span class="comment"># warning (only very important / critical messages are logged)</span></span><br><span class="line">loglevel notice</span><br><span class="line">logfile  <span class="string">&quot;&quot;</span>  	<span class="comment">#日志的文件位置名</span></span><br><span class="line">databases  16	<span class="comment">#数据库的数量，默认是16个</span></span><br><span class="line">always-show-logo  <span class="built_in">yes</span>	<span class="comment">#是否显示logo</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>SNAPSHOPTING  快照，持久化规则 </p>
</blockquote>
<p>持久化，在规定的时间内，执行了多少次操作，则会持久化到文件.rdb. aof</p>
<p>redis是内存数据库，如果没有持久化，那么数据断电及失!</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 如果900s内，如果至少有一个1 key进行了修改，我们就进行持久化操作</span></span><br><span class="line">save 900 1</span><br><span class="line"><span class="comment"># 如果300s内，如果至少10 key进行了修改，我们就进行持久化操作</span></span><br><span class="line">save 300 10</span><br><span class="line"><span class="comment">#如果60s内，如果至少10000 key进行了修改，我们就进行持久化操作</span></span><br><span class="line">save 60 10000</span><br><span class="line"><span class="comment">#我们之后学习持久化，会自己定义这个测试!</span></span><br><span class="line"></span><br><span class="line">stop-writes-on-bgsave-error <span class="built_in">yes</span>	<span class="comment">#持久化如果出错，是否还需要继续工作！</span></span><br><span class="line"></span><br><span class="line">rdbcompression	<span class="built_in">yes</span>	<span class="comment">#是否压缩 rdb 文件，需要消耗一些cpu资源！</span></span><br><span class="line"></span><br><span class="line">rdbchecksum	<span class="built_in">yes</span>	<span class="comment">#保存rdb文件的时候，进行错误的检查校验！</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">dir</span> ./ 	<span class="comment">#rdb 文件保存的目录</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>REPLICATION 复制，我们后面讲解主从复制的，时候再进行讲解</p>
</blockquote>
<blockquote>
<p>SECURITY	安全</p>
</blockquote>
<p>可以在这里设置redis的密码，默认是没有密码的</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; ping</span><br><span class="line">PONG</span><br><span class="line">127.0.0.1:6379&gt; config get requirepass	<span class="comment"># 获取redis的密码</span></span><br><span class="line">1) <span class="string">&quot;requirepass&quot;</span></span><br><span class="line">2) <span class="string">&quot;&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; config <span class="built_in">set</span> requirepass <span class="string">&quot;123456&quot;</span>	<span class="comment"># 设置redis的密码</span></span><br><span class="line">oK</span><br><span class="line">127.0.0.1:6379&gt; config get requirepass <span class="comment">#发现所有的命令都没有权限了</span></span><br><span class="line">(error) NOAUTH Authentication required.</span><br><span class="line">127.0.0.1:6379&gt; ping</span><br><span class="line">(error) NOAUTH Authentication required.</span><br><span class="line">127.0.0.1:6379&gt; auth 123456<span class="comment">#使用密码进行登录!</span></span><br><span class="line">oK</span><br><span class="line">127.0.0.1:6379&gt; config get requirepass</span><br><span class="line">1) <span class="string">&quot;requirepass&quot;</span></span><br><span class="line">2) <span class="string">&quot;123456&quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>限制   CLIENTS</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">maxclients	10000		<span class="comment">#设置能连接上redis的最大客户端数量</span></span><br><span class="line">maxmemory	&lt;bytes&gt;		<span class="comment">#配置redis最大的内存容量</span></span><br><span class="line">maxmemory-policy noeviction	<span class="comment">#内存到达上限之后的处理策略</span></span><br><span class="line">	1、volatile-7ru:		只对设置了过期时间的key进行LRU（默认值)</span><br><span class="line">	2、a7lkeys-7ru :		删除lru算法的key</span><br><span class="line">	3、volatile-random:	随机删除即将过期key</span><br><span class="line">	4、a7lkeys-random:	随机删除</span><br><span class="line">	5、volatile-tt7 :	删除即将过期的</span><br><span class="line">	6、noeviction :		永不过期，返回错误</span><br></pre></td></tr></table></figure>

<blockquote>
<p>APPEND ONLY 	模式 aof配置</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">appendonly  no  <span class="comment">#默认是不开启aof模式的，默认是使用rdb方式持久化的，大部分情况下rdb够用</span></span><br><span class="line">appendfilename  <span class="string">&quot;appendonly.aof&quot;</span>	<span class="comment">#持久化的文件的名字</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#appendfsync  always  #每次修改都会  sync。消耗性能</span></span><br><span class="line">appendfsync  everysec <span class="comment">#每秒执行一次  sync，可能会丢失这1秒的数据！</span></span><br><span class="line"><span class="comment">#appendfsync  no	  #不执行   sync，这个时候操作系统自己同步数据，速度是最快的</span></span><br></pre></td></tr></table></figure>

<p>具体的配置，我们在redis持久化中详细讲解！</p>
<h1 id="Redis持久化"><a href="#Redis持久化" class="headerlink" title="Redis持久化"></a>Redis持久化</h1><p>面试和工作，持久化都是重点！</p>
<p>Redis是内存数据库，如果不将内存中的数据库状态保存到磁盘，那么一旦服务器进程退出，服务器中的数据库状态也会消失。所以Redis提供了持久化功能!</p>
<h2 id="RDB（Redis-DataBase）"><a href="#RDB（Redis-DataBase）" class="headerlink" title="RDB（Redis  DataBase）"></a>RDB（Redis  DataBase）</h2><blockquote>
<p>什么是RDB</p>
</blockquote>
<p>在主从复制中，RDB就是备用了！在从机上面！</p>
<p><img src="/../assets/1637412209507.png" alt="1637412209507"></p>
<p>在指定的时间间隔内将内存中的数据集快照写入磁盘，也就是行话讲的Snapshot快照，它恢复时是将快照文件直接读到内存里。</p>
<p>Redis会单独创建 ( fork )一个子进程来进行持久化，会先将数据写入到一个临时文件中，待持久化过程都结束了，再用这个临时文件替换上次持久化好的文件。整个过程中，主进程是不进行任何IO操作的。这就确保了极高的性能。如果需要进行大规模数据的恢复，且对于数据恢复的完整性不是非常敏感，那RDB方式要比AOF方式更加的高效。RDB的缺点是最后一次持久化后的数据可能丢失。我们默认的就是RDB，一般情况下不需要修改这个配置!</p>
<p>&#x3D;&#x3D;rdb保存的文件是dump.rdb&#x3D;&#x3D;		都是在我们的配置文件中快照中进行配置的!</p>
<p><img src="/../assets/1637411139128.png" alt="1637411139128"></p>
<p><img src="/../assets/1637411238185.png" alt="1637411238185"></p>
<blockquote>
<p>触发机制</p>
</blockquote>
<p>1、save的规则满足的情况下，会自动触发rdb规则</p>
<p>2、执行flushall命令，也会触发我们的rdb规则！</p>
<p>3、退出redis，也会产生rdb文件（dump.rdb）</p>
<p>备份就自动生成一个 dump.rdb</p>
<blockquote>
<p>如何恢复rdb文件！</p>
</blockquote>
<p>1、只需要将rdb文件放在我们redis启动目录就可以，redis启动的时候会自动检查dump.rdb ，恢复其中的数据</p>
<p>2、查看需要存在的位置</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt;  config get <span class="built_in">dir</span></span><br><span class="line">1) <span class="string">&quot;dir&quot;</span></span><br><span class="line">2) <span class="string">&quot;/usr/local/bin&quot;</span>	<span class="comment">#如果在这个目录下存在 dump .rdb文件，启动就会自动恢复其中的数据</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>几乎就他自己默认的配置就够用了，但是我们还是需要取学习！</p>
</blockquote>
<p><strong>优点：</strong></p>
<p>1、适合大规模的数据恢复！</p>
<p>2、对数据的完整性要求不高！</p>
<p><strong>缺点：</strong></p>
<p>1、需要一定的时间间隔进程操作！如果redis意外宕机了，这个最后一次修改数据就没有了！</p>
<p>2、fork进程的时候，会占用一定的内存空间！</p>
<h2 id="AOF（Append-Only-File）"><a href="#AOF（Append-Only-File）" class="headerlink" title="AOF（Append Only File）"></a>AOF（Append Only File）</h2><p>将我们的所有命令都记录下来，恢复的时候把这个文件执行一遍</p>
<blockquote>
<p>AOF是什么</p>
</blockquote>
<p><img src="/../assets/1637463927193.png" alt="1637463927193"></p>
<p>以日志的形式来记录每个写操作，将Redis执特过的所有指令记录下来(<strong>读操作不记录</strong>），只许追加文件但不可以改写文件，redis启动之初会读取该文件重新构建数据，换言之，redis重启的话就根据日志文件的内容将写指令从前到后执行一次以完成数据的恢复工作</p>
<p>&#x3D;&#x3D;AOF保存的文件是 appendonly.aof 文件&#x3D;&#x3D;</p>
<blockquote>
<p>append</p>
</blockquote>
<p><img src="/../assets/1637464071260.png" alt="1637464071260"></p>
<p>默认是不开启的，需要手动修改为yes</p>
<p>重启redis即可生效！</p>
<p>如果aof文件有错误，redis的服务是启动不起来的，我们需要修复aof文件</p>
<p>redis给我们提供了一个工具  <code>redis-check-aof</code>，使用命令<code>redis-check-aof  --fix</code>即可修复aof文件！</p>
<p><img src="/../assets/1637464666620.png" alt="1637464666620"></p>
<p>如果文件正常，重启就可以直接恢复了！（修复文件有一定的&#x3D;&#x3D;容错率&#x3D;&#x3D;，可能会导致一些数据丢失）</p>
<p><img src="/../assets/1637465408979.png" alt="1637465408979"></p>
<blockquote>
<p>重写规则</p>
</blockquote>
<p>aof 默认就是文件的无限追加，文件会越来越大!</p>
<p><img src="/../assets/1637465851437.png" alt="1637465851437"></p>
<p>如果aof文件大小超过mb，太大了，fork一个新的进程来讲我们的文件进行重写！</p>
<blockquote>
<p>优点和缺点！</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">appendonly  no  <span class="comment">#默认是不开启aof模式的，默认是使用rdb方式持久化的，大部分情况下rdb够用</span></span><br><span class="line">appendfilename  <span class="string">&quot;appendonly.aof&quot;</span>	<span class="comment">#持久化的文件的名字</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#appendfsync  always  #每次修改都会  sync。消耗性能</span></span><br><span class="line">appendfsync  everysec <span class="comment">#每秒执行一次  sync，可能会丢失这1秒的数据！</span></span><br><span class="line"><span class="comment">#appendfsync  no	  #不执行   sync，这个时候操作系统自己同步数据，速度是最快的</span></span><br><span class="line"><span class="comment"># rewrite   重写</span></span><br></pre></td></tr></table></figure>



<p><strong>优点：</strong></p>
<ol>
<li>每一次写操作都会同步，数据更加完整！</li>
<li>每秒同步一次，可能会丢失这1秒的数据！</li>
<li>从不同不的话，效率是最高的！</li>
</ol>
<p><strong>缺点：</strong></p>
<ol>
<li>相对于数据文件来说，aof远远大于rdb，修复的速度也比rdb慢！</li>
<li>Aof运行效率也要比rdb慢，所以我们redis默认的配置就是rdb持久化！</li>
</ol>
<p><strong>扩展</strong>：</p>
<p>1、RDB持久化方式能够在指定的时间间隔内对你的数据进行快照存储</p>
<p>2、AOF持久化方式记录每次对服务器写的操作，当服务器重启的时候会重新执行这些命令来恢复原始的数据，AOF命令以Redis 协议追加保存每次写的操作到文件末尾，Redis还能对AOF文件进行后台重写，使得AOF文件的体积不至于过大。</p>
<p>3、&#x3D;&#x3D;只做缓存，如果你只希望你的数据在服务器运行的时候存在，你也可以不使用任何持久化&#x3D;&#x3D;</p>
<p>4、同时开启两种持久化方式</p>
<ul>
<li>在这种情况下，当redis重启的时候会&#x3D;&#x3D;优先载入AOF&#x3D;&#x3D;文件来恢复原始的数据，因为在通常情况下AOF文件保存的数据集要比RDB文件保存的数据集要完整。</li>
<li>RDB的数据不实时，同时使用两者时服务器重启也只会找AOF文件，那要不要只使用AOF呢?作者建议不要，因为RDB更适合用于备份数据库(AOF在不断变化不好备份），快速重启，而且不会有AOF可能潜在的Bug，留着作为一个万一的手段。</li>
</ul>
<p>5、性能建议</p>
<ul>
<li>因为RDB文件只用作后备用途，建议只在Slave上持久化RDB文件，而且只要15分钟备份一次就够了，只保留save 9001这条规则。</li>
<li>如果Enable AOF，好处是在最恶劣情况下也只会丢失不超过两秒数据，启动脚本较简单只load自己的AOF文件就可以了，代价一是带来了持续的lO，二是AOF rewrite 的最后将rewrite过程中产生的新数据写到新文件造成的阻塞几乎是不可避免的。只要硬盘许可，应该尽量减少AOF rewrite的频率，AOF重写的基础大小默认值64M太小了，可以设到5G以上，默认超过原大小100%大小重写可以改到适当的数值。</li>
<li>如果不Enable AOF，仅靠Master-Slave Repllcation实现高可用性也可以，能省掉一大笔(O，也减少了rewrite时带来的系统波动。代价是如果Master&#x2F;Slave同时倒掉，会丢失十几分钟的数据，启动脚本也要比较两个Master&#x2F;Slave 中的RDB文件，载入较新的那个，微博就是这种架构。</li>
</ul>
<h1 id="Redis发布订阅"><a href="#Redis发布订阅" class="headerlink" title="Redis发布订阅"></a>Redis发布订阅</h1><p>Redis发布订阅(pub&#x2F;sub)是一种消息通信模式∶发送者(pub)发送消息，订阅者(sub)接收消息。</p>
<p>Redis 客户端可以订阅任意数量的频道。</p>
<p>订阅&#x2F;发布消息图:</p>
<p><img src="/../assets/1637466638473.png" alt="1637466638473"></p>
<p>下图展示了频道channel1，以及订阅这个频道的三个客户端―—client2、 client5和client1之间的关系∶</p>
<p><img src="/../assets/1637466705639.png" alt="1637466705639"></p>
<p>当有新消息通过 PUBLISH 命令发送给频道 channel1 时， 这个消息就会被发送给订阅它的三个客户端： </p>
<p><img src="/../assets/1637467169517.png" alt="1637467169517"></p>
<blockquote>
<p>命令</p>
</blockquote>
<p>这些命令被广泛用于构建即时通信应用，比如网络聊天室(chatroom)和实时广播、实时提醒等。</p>
<p><img src="/../assets/1637467257656.png" alt="1637467257656"></p>
<blockquote>
<p>测试</p>
</blockquote>
<p><strong>订阅端：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; SUBSCRIBE feichidesuyi		<span class="comment">#订阅一个频道	feichidesuyi</span></span><br><span class="line">Reading messages... (press Ctrl-C to quit)</span><br><span class="line">1) <span class="string">&quot;subscribe&quot;</span></span><br><span class="line">2) <span class="string">&quot;feichidesuyi&quot;</span></span><br><span class="line">3) (<span class="built_in">integer</span>) 1</span><br><span class="line"><span class="comment">#等待读取推送的信息</span></span><br><span class="line">1) <span class="string">&quot;message&quot;</span>	<span class="comment">#消息</span></span><br><span class="line">2) <span class="string">&quot;feichidesuyi&quot;</span>	<span class="comment">#消息的频道</span></span><br><span class="line">3) <span class="string">&quot;Hello,SuYi&quot;</span>		<span class="comment">#消息的内容</span></span><br></pre></td></tr></table></figure>

<p><strong>发布端：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; PUBLISH feichidesuyi <span class="string">&quot;Hello,SuYi&quot;</span>	<span class="comment">#发布者发布消息到feichidesuyi 频道</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br></pre></td></tr></table></figure>

<p>Pub&#x2F;Sub从字面上理解就是发布( Publish )与订阅( Subscribe )，在Redis中，你可以设定对某一个key值进行消息发布及消息订阅，当一个key值上进行了消息发布后，所有订阅它的客户端都会收到相应的消息。这一功能最明显的用法就是用作实时消息系统，比如普通的即时聊天，群聊等功能。</p>
<p><strong>使用场景：</strong></p>
<ol>
<li>实时消息系统</li>
<li>实时聊天（频道当作聊天室，将信息回显给所有人即可）</li>
<li>订阅，关注系统</li>
</ol>
<p>稍微复杂一点的场景，我们会使用，消息中间件MQ（）</p>
<h1 id="Redis主从复制"><a href="#Redis主从复制" class="headerlink" title="Redis主从复制"></a>Redis主从复制</h1><h2 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h2><p>主从复制，是指将一台Redis服务器的数据，复制到其他的Redis服务器。前者称为主节点(master&#x2F;leader)，后者称为从节点(slave&#x2F;follower);数据的复制是单向的，只能由主节点到从节点。Master以写为主，Slave以读为主。</p>
<p>默认情况下，每台Redis服务器都是主节点;且一个主节点可以有多个从节点(或没有从节点)，但一个从节点只能有一个主节点。</p>
<p><strong>主从复制的作用主要包括︰</strong></p>
<p>1、数据冗余∶主从复制实现了数据的热备份，是持久化之外的一种数据冗余方式。<br>2、故障恢复︰当主节点出现问题时，可以由从节点提供服务，实现快速的故障恢复;实际上是一种服务的冗余。</p>
<p>3、负载均衡︰在主从复制的基础上，配合读写分离，可以由主节点提供写服务，由从节点提供读服务即写Redis数据时应用连接主节点，读Redis数据时应用连接从节点），分担服务器负载﹔尤其是在写少读多的场景下，通过多个从节点分担读负载，可以大大提高Redis服务器的并发量。</p>
<p>4、高可用（集群）基石︰除了上述作用以外，主从复制还是哨兵和集群能够实施的基础，因此说主从复制是Redis高可用的基础。</p>
<p>一般来说，要将Redis运用于工程项目中，只使用一台Redis是万万不能的（宕机，一主二从），原因如下︰</p>
<p>1、从结构上，单个Redis服务器会发生单点故障，并且一台服务器需要处理所有的请求负载，压力较大;</p>
<p>2、从容量上，单个Redis服务器内存容量有限，就算一台Redis服务器内存容量为256G，也不能将所有内存用作Redis存储内存，一般来说，&#x3D;&#x3D;单台Redis最大使用内存不应该超过20G&#x3D;&#x3D;。</p>
<p>电商网站上的商品，一般都是一次上传，无数次浏览的，说专业点也就是”多读少写”。</p>
<p>对于这种场景，我们可以使如下这种架构∶</p>
<p><img src="/../assets/1637469069556.png" alt="1637469069556"></p>
<p>主从复制，读写分离，80%的情况下都是在进行读操作！减缓服务器的压力，架构中经常使用！一主二从！</p>
<p>只要在公司中，主从复制就是必须要使用的，因为在真实的项目中不可能单机使用Redis !</p>
<h2 id="环境配置"><a href="#环境配置" class="headerlink" title="环境配置"></a>环境配置</h2><p>只配置从库，不用配置主库！</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; info replication		<span class="comment">#查看当前库的信息</span></span><br><span class="line"><span class="comment"># Replication</span></span><br><span class="line">role:master	<span class="comment">#角色	master</span></span><br><span class="line">connected_slaves:0	<span class="comment">#没有从机</span></span><br><span class="line">master_failover_state:no-failover</span><br><span class="line">master_replid:20506729ff7cf5007efc95bd0548684d1f9758f2</span><br><span class="line">master_replid2:0000000000000000000000000000000000000000</span><br><span class="line">master_repl_offset:0</span><br><span class="line">second_repl_offset:-1</span><br><span class="line">repl_backlog_active:0</span><br><span class="line">repl_backlog_size:1048576</span><br><span class="line">repl_backlog_first_byte_offset:0</span><br><span class="line">repl_backlog_histlen:0</span><br></pre></td></tr></table></figure>

<p><strong>复制3个配置文件，然后修改对应的信息</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@VM-8-8-centos redis]<span class="comment"># cp redis.conf redis79.conf</span></span><br><span class="line">[root@VM-8-8-centos redis]<span class="comment"># cp redis.conf redis80.conf</span></span><br><span class="line">[root@VM-8-8-centos redis]<span class="comment"># cp redis.conf redis81.conf</span></span><br></pre></td></tr></table></figure>



<p><img src="/../assets/1637474714104.png" alt="1637474714104"></p>
<p>1、端口		79（主） 	80	 81</p>
<p><img src="/../assets/1637474950820.png" alt="1637474950820"></p>
<p>2、pid 名字</p>
<p><img src="/../assets/1637474964319.png" alt="1637474964319"></p>
<p>3、log文件名字</p>
<p><img src="/../assets/1637475212805.png" alt="1637475212805"></p>
<p>4、dump.rdb 名字</p>
<p><img src="/../assets/1637475222116.png" alt="1637475222116"></p>
<p>服务启动：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">redis-server redis79.conf</span><br><span class="line">redis-server redis80.conf</span><br><span class="line">redis-server redis81.conf</span><br></pre></td></tr></table></figure>

<p><img src="/../assets/1637475373992.png" alt="1637475373992"></p>
<h2 id="一主二从（第一种）"><a href="#一主二从（第一种）" class="headerlink" title="一主二从（第一种）"></a>一主二从（第一种）</h2><p><img src="/../assets/1637477718851.png" alt="1637477718851"></p>
<p>&#x3D;&#x3D;默认情况下，每台Redis服务器都是主节点；&#x3D;&#x3D; 	</p>
<p>我们一般情况下只用配置从机就好了！ </p>
<p>认老大！一主（79）二从（80，81） </p>
<p>使用<code>SLAVEOF host port</code>就可以为从机配置主机了。 </p>
<p>客户端连接：</p>
<p>79:<img src="/../assets/1637475597283.png" alt="1637475597283"></p>
<p>80:<img src="/../assets/1637475635748.png" alt="1637475635748"></p>
<p>81:<img src="/../assets/1637475664508.png" alt="1637475664508"></p>
<p>从机配置（80，81）</p>
<p><img src="/../assets/1637475685618.png" alt="1637475685618"></p>
<p>成功后，查看信息</p>
<p><img src="/../assets/1637475842925.png" alt="1637475842925"></p>
<p>真实的从主配置应该在配置文件中配置，这样的话是永久的，我们这里使用的是命令，暂时的!</p>
<blockquote>
<p>细节</p>
</blockquote>
<p>主机负责写（也可以读）</p>
<p><img src="/../assets/1637476419150.png" alt="1637476419150"></p>
<p>从机负责读（只能读）</p>
<p><img src="/../assets/1637476450168.png" alt="1637476450168"></p>
<blockquote>
<p>测试		（高可用）</p>
</blockquote>
<ul>
<li><p>主机断开后，从机依然可以获取值，但是这时没有写操作了。如果主机又回来了，从机依旧可以获取主机写进去的数据</p>
</li>
<li><p>如果是用命令行配置的主从复制，这时，从机断开又重连后，从机将成为主机，此时也拿不到在断开期间，主机写进去的数据，除非再次将它变为从机，即可重新获取到主机的所有值</p>
</li>
</ul>
<blockquote>
<p>复制原理</p>
</blockquote>
<p>slave启动成功连接到master后会发送一个sync命令</p>
<p>Master接到命令，启动后台的存盘进程，同时收集所有接收到的用于修改数据集命令，在后台进程执行完毕之后，&#x3D;&#x3D;master将传送整个数据文件到slave，并完成一次完全同步。&#x3D;&#x3D;</p>
<p>&#x3D;&#x3D;全量复制&#x3D;&#x3D;:而slave服务在接收到数据库文件数据后，将其存盘并加载到内存中。</p>
<p>&#x3D;&#x3D;增量复制&#x3D;&#x3D;:Master继续将新的所有收集到的修改命令依次传给slave，完成同步</p>
<p>但是只要是重新连接master，一次完全同步（全量复制）将被自动执行</p>
<h2 id="层层链路（第二种）"><a href="#层层链路（第二种）" class="headerlink" title="层层链路（第二种）"></a>层层链路（第二种）</h2><p><img src="/../assets/1637477767479.png" alt="1637477767479"></p>
<p>这时也可以完成我们的主从复制</p>
<blockquote>
<p>测试		</p>
</blockquote>
<p>&#x3D;&#x3D;<strong>谋朝篡位</strong>&#x3D;&#x3D;</p>
<p>如果在层层链路的情况下，主机断开了，这时可以使用 <code>slaveof no one</code>来使自己变成主机，如果自己之前还有从机连接着，则连接关系不变。如果这个时候真正的主机恢复了，真正的主机也没有从机了，需要重新手动连接；</p>
<h2 id="哨兵模式"><a href="#哨兵模式" class="headerlink" title="哨兵模式"></a>哨兵模式</h2><p>（自动选举老大的模式）</p>
<blockquote>
<p>概述</p>
</blockquote>
<p>主从切换技术的方法是∶当主服务器宕机后，需要手动把一台从服务器切换为主服务器，这就需要人工干预，费事费力，还会造成一段时间内服务不可用。这不是一种推荐的方式，更多时候，我们优先考虑哨兵模式。Redis从2.8开始正式提供了Sentinel (哨兵）架构来解决这个问题。</p>
<p>谋朝篡位的自动版，能够后台监控主机是否故障，如果故障了根据投票数自动将从库转换为主库。</p>
<p>哨兵模式是一种特殊的模式，首先Redis提供了哨兵的命令，哨兵是一个独立的进程，作为进程，它会独立运行。<strong>其原理是哨兵通过发送命令，等待Redis服务器响应，从而监控运行的多个Redis实例。</strong></p>
<p><img src="/../assets/1637559953072.png" alt="1637559953072"></p>
<p>这里的哨兵有两个作用</p>
<ol>
<li>通过发送命令，让Redis服务器返回监控其运行状态，包括主服务器和从服务器。</li>
<li>当哨兵监测到master宕机，会自动将slave切换成master，然后通过发布订阅模式通知其他的从服务器，修改配置文件，让它们切换主机。</li>
</ol>
<p>然而一个哨兵进程对Redis服务器进行监控，可能会出现问题，为此，我们可以使用多个哨兵进行监控。各个哨兵之间还会进行监<br>控，这样就形成了多哨兵模式。</p>
<p><img src="/../assets/1637560056785.png" alt="1637560056785"></p>
<p>假设主服务器宕机，哨兵1先检测到这个结果，系统并不会马上进行failover过程，仅仅是哨兵1主观的认为主服务器不可用，这个现象成为<strong>主观下线</strong>。当后面的哨兵也检测到主服务器不可用，并且数量达到一定值时，那么哨兵之间就会进行一次投票，投票的结果由一个哨兵发起，进行failover[故障转移]操作。切换成功后，就会通过发布订阅模式，让各个哨兵把自己监控的从服务器实现切换主机，这个过程称为<strong>客观下线</strong>。</p>
<blockquote>
<p>测试</p>
</blockquote>
<p>我们目前的状态是一主二从</p>
<p>1、配置哨兵配置文件	sentinel.conf</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#sentinel monitor 被监控的名称 host port 1</span></span><br><span class="line">sentinel monitor myredis 127.0.0.1 6379 1</span><br></pre></td></tr></table></figure>

<p>后面的1代表，主机挂了，salve投票看让谁接替成为主机，票数最多的，就会成为主机！</p>
<p>2、启动哨兵</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">[root@VM-8-8-centos src]<span class="comment"># redis-sentinel sentinel.conf</span></span><br><span class="line">2808:X 22 Nov 2021 14:10:07.614 <span class="comment"># oO0OoO0OoO0Oo Redis is starting oO0OoO0OoO0Oo</span></span><br><span class="line">2808:X 22 Nov 2021 14:10:07.614 <span class="comment"># Redis version=6.2.4, bits=64, commit=00000000, modified=0, pid=2808, just started</span></span><br><span class="line">2808:X 22 Nov 2021 14:10:07.614 <span class="comment"># Configuration loaded</span></span><br><span class="line">2808:X 22 Nov 2021 14:10:07.615 * monotonic clock: POSIX clock_gettime</span><br><span class="line">                _._                                                  </span><br><span class="line">           _.-``__ <span class="string">&#x27;&#x27;</span>-._                                             </span><br><span class="line">      _.-``    `.  `_.  <span class="string">&#x27;&#x27;</span>-._           Redis 6.2.4 (00000000/0) 64 bit</span><br><span class="line">  .-`` .-```.  ```\/    _.,_ <span class="string">&#x27;&#x27;</span>-._                                  </span><br><span class="line"> (    <span class="string">&#x27;      ,       .-`  | `,    )     Running in sentinel mode</span></span><br><span class="line"><span class="string"> |`-._`-...-` __...-.``-._|&#x27;</span>` _.-<span class="string">&#x27;|     Port: 26379</span></span><br><span class="line"><span class="string"> |    `-._   `._    /     _.-&#x27;</span>    |     PID: 2808</span><br><span class="line">  `-._    `-._  `-./  _.-<span class="string">&#x27;    _.-&#x27;</span>                                   </span><br><span class="line"> |`-._`-._    `-.__.-<span class="string">&#x27;    _.-&#x27;</span>_.-<span class="string">&#x27;|                                  </span></span><br><span class="line"><span class="string"> |    `-._`-._        _.-&#x27;</span>_.-<span class="string">&#x27;    |           https://redis.io       </span></span><br><span class="line"><span class="string">  `-._    `-._`-.__.-&#x27;</span>_.-<span class="string">&#x27;    _.-&#x27;</span>                                   </span><br><span class="line"> |`-._`-._    `-.__.-<span class="string">&#x27;    _.-&#x27;</span>_.-<span class="string">&#x27;|                                  </span></span><br><span class="line"><span class="string"> |    `-._`-._        _.-&#x27;</span>_.-<span class="string">&#x27;    |                                  </span></span><br><span class="line"><span class="string">  `-._    `-._`-.__.-&#x27;</span>_.-<span class="string">&#x27;    _.-&#x27;</span>                                   </span><br><span class="line">      `-._    `-.__.-<span class="string">&#x27;    _.-&#x27;</span>                                       </span><br><span class="line">          `-._        _.-<span class="string">&#x27;                                           </span></span><br><span class="line"><span class="string">              `-.__.-&#x27;</span>                                               </span><br><span class="line"></span><br><span class="line">2808:X 22 Nov 2021 14:10:07.621 <span class="comment"># Sentinel ID is 2d14dac2e1d9a113b782c01050f441fab229476c</span></span><br><span class="line">2808:X 22 Nov 2021 14:10:07.621 <span class="comment"># +monitor master myredis 127.0.0.1 6379 quorum 1</span></span><br><span class="line">2808:X 22 Nov 2021 14:10:07.622 * +slave slave 127.0.0.1:6380 127.0.0.1 6380 @ myredis 127.0.0.1 6379</span><br><span class="line">2808:X 22 Nov 2021 14:10:07.628 * +slave slave 127.0.0.1:6381 127.0.0.1 6381 @ myredis 127.0.0.1 6379</span><br></pre></td></tr></table></figure>

<p>如果Master节点断开了，这个时候就会从从机中随机选择一个服务器!（这里面有一个投票算法!)</p>
<p><img src="/../assets/1637561714121.png" alt="1637561714121"></p>
<p>哨兵日志</p>
<p><img src="/../assets/1637561686213.png" alt="1637561686213"></p>
<p>此时如果真正的主机回来了，它也只能成为6380的从机</p>
<p><img src="/../assets/1637561805307.png" alt="1637561805307"></p>
<p>哨兵日志</p>
<p><img src="/../assets/1637561952057.png" alt="1637561952057"></p>
<blockquote>
<p>哨兵模式的全部配置</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Example sentinel.conf</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># 哨兵sentinel实例运行的端口 默认26379</span></span><br><span class="line">port 26379</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 哨兵sentinel的工作目录</span></span><br><span class="line"><span class="built_in">dir</span> /tmp</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 哨兵sentinel监控的redis主节点的 ip port </span></span><br><span class="line"><span class="comment"># master-name  可以自己命名的主节点名字 只能由字母A-z、数字0-9 、这三个字符&quot;.-_&quot;组成。</span></span><br><span class="line"><span class="comment"># quorum 当这些quorum个数sentinel哨兵认为master主节点失联 那么这时 客观上认为主节点失联了</span></span><br><span class="line"><span class="comment"># sentinel monitor &lt;master-name&gt; &lt;ip&gt; &lt;redis-port&gt; &lt;quorum&gt;</span></span><br><span class="line">sentinel monitor mymaster 127.0.0.1 6379 1</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 当在Redis实例中开启了requirepass foobared 授权密码 这样所有连接Redis实例的客户端都要提供密码</span></span><br><span class="line"><span class="comment"># 设置哨兵sentinel 连接主从的密码 注意必须为主从设置一样的验证密码</span></span><br><span class="line"><span class="comment"># sentinel auth-pass &lt;master-name&gt; &lt;password&gt;</span></span><br><span class="line">sentinel auth-pass mymaster MySUPER--secret-0123passw0rd</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment"># 指定多少毫秒之后 主节点没有应答哨兵sentinel 此时 哨兵主观上认为主节点下线 默认30秒</span></span><br><span class="line"><span class="comment"># sentinel down-after-milliseconds &lt;master-name&gt; &lt;milliseconds&gt;</span></span><br><span class="line">sentinel down-after-milliseconds mymaster 30000</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 这个配置项指定了在发生failover主备切换时最多可以有多少个slave同时对新的master进行 同步，</span></span><br><span class="line">这个数字越小，完成failover所需的时间就越长，</span><br><span class="line">但是如果这个数字越大，就意味着越 多的slave因为replication而不可用。</span><br><span class="line">可以通过将这个值设为 1 来保证每次只有一个slave 处于不能处理命令请求的状态。</span><br><span class="line"><span class="comment"># sentinel parallel-syncs &lt;master-name&gt; &lt;numslaves&gt;</span></span><br><span class="line">sentinel parallel-syncs mymaster 1</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment"># 故障转移的超时时间 failover-timeout 可以用在以下这些方面： </span></span><br><span class="line"><span class="comment">#1. 同一个sentinel对同一个master两次failover之间的间隔时间。</span></span><br><span class="line"><span class="comment">#2. 当一个slave从一个错误的master那里同步数据开始计算时间。直到slave被纠正为向正确的master那里同步数据时。</span></span><br><span class="line"><span class="comment">#3.当想要取消一个正在进行的failover所需要的时间。  </span></span><br><span class="line"><span class="comment">#4.当进行failover时，配置所有slaves指向新的master所需的最大时间。不过，即使过了这个超时，slaves依然会被正确配置为指向master，但是就不按parallel-syncs所配置的规则来了</span></span><br><span class="line"><span class="comment"># 默认三分钟</span></span><br><span class="line"><span class="comment"># sentinel failover-timeout &lt;master-name&gt; &lt;milliseconds&gt;</span></span><br><span class="line">sentinel failover-timeout mymaster 180000</span><br><span class="line"> </span><br><span class="line"><span class="comment"># SCRIPTS EXECUTION</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">#配置当某一事件发生时所需要执行的脚本，可以通过脚本来通知管理员，例如当系统运行不正常时发邮件通知相关人员。</span></span><br><span class="line"><span class="comment">#对于脚本的运行结果有以下规则：</span></span><br><span class="line"><span class="comment">#若脚本执行后返回1，那么该脚本稍后将会被再次执行，重复次数目前默认为10</span></span><br><span class="line"><span class="comment">#若脚本执行后返回2，或者比2更高的一个返回值，脚本将不会重复执行。</span></span><br><span class="line"><span class="comment">#如果脚本在执行过程中由于收到系统中断信号被终止了，则同返回值为1时的行为相同。</span></span><br><span class="line"><span class="comment">#一个脚本的最大执行时间为60s，如果超过这个时间，脚本将会被一个SIGKILL信号终止，之后重新执行。</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">#通知型脚本:当sentinel有任何警告级别的事件发生时（比如说redis实例的主观失效和客观失效等等），将会去调用这个脚本，</span></span><br><span class="line"><span class="comment">#这时这个脚本应该通过邮件，SMS等方式去通知系统管理员关于系统不正常运行的信息。调用该脚本时，将传给脚本两个参数，</span></span><br><span class="line"><span class="comment">#一个是事件的类型，</span></span><br><span class="line"><span class="comment">#一个是事件的描述。</span></span><br><span class="line"><span class="comment">#如果sentinel.conf配置文件中配置了这个脚本路径，那么必须保证这个脚本存在于这个路径，并且是可执行的，否则sentinel无法正常启动成功。</span></span><br><span class="line"><span class="comment">#通知脚本</span></span><br><span class="line"><span class="comment"># sentinel notification-script &lt;master-name&gt; &lt;script-path&gt;</span></span><br><span class="line">  sentinel notification-script mymaster /var/redis/notify.sh</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 客户端重新配置主节点参数脚本</span></span><br><span class="line"><span class="comment"># 当一个master由于failover而发生改变时，这个脚本将会被调用，通知相关的客户端关于master地址已经发生改变的信息。</span></span><br><span class="line"><span class="comment"># 以下参数将会在调用脚本时传给脚本:</span></span><br><span class="line"><span class="comment"># &lt;master-name&gt; &lt;role&gt; &lt;state&gt; &lt;from-ip&gt; &lt;from-port&gt; &lt;to-ip&gt; &lt;to-port&gt;</span></span><br><span class="line"><span class="comment"># 目前&lt;state&gt;总是“failover”,</span></span><br><span class="line"><span class="comment"># &lt;role&gt;是“leader”或者“observer”中的一个。 </span></span><br><span class="line"><span class="comment"># 参数 from-ip, from-port, to-ip, to-port是用来和旧的master和新的master(即旧的slave)通信的</span></span><br><span class="line"><span class="comment"># 这个脚本应该是通用的，能被多次调用，不是针对性的。</span></span><br><span class="line"><span class="comment"># sentinel client-reconfig-script &lt;master-name&gt; &lt;script-path&gt;</span></span><br><span class="line">sentinel client-reconfig-script mymaster /var/redis/reconfig.sh</span><br></pre></td></tr></table></figure>





<h1 id="Redis缓存穿透和雪崩"><a href="#Redis缓存穿透和雪崩" class="headerlink" title="Redis缓存穿透和雪崩"></a>Redis缓存穿透和雪崩</h1><blockquote>
<p>服务的高可用问题！</p>
</blockquote>
<p>Redis缓存的使用，极大的提升了应用程序的性能和效率，特别是数据查询方面。但同时，它也带来了一些问题。其中，最要害的问题，就是数据的一致性问题，从严格意义上讲，这个问题无解。如果对数据的一致性要求很高，那么就不能使用缓存。</p>
<p>另外的一些典型问题就是，缓存穿透、缓存雪崩和缓存击穿。目前，业界也都有比较流行的解决方案。</p>
<p><img src="/../assets/1637563518763.png" alt="1637563518763"></p>
<h2 id="缓存穿透（查不到）"><a href="#缓存穿透（查不到）" class="headerlink" title="缓存穿透（查不到）"></a>缓存穿透（查不到）</h2><blockquote>
<p>概念</p>
</blockquote>
<p>缓存穿透的概念很简单，用户想要查询一个数据，发现redis内存数据库没有，也就是缓存没有命中，于是向持久层数据库查询。发现也没有，于是本次查询失败。当用户很多的时候，缓存都没有命中(商品的秒杀!），于是都去请求了持久层数据库。这会给持久层数据库造成很大的压力，这时候就相当于出现了缓存穿透。</p>
<blockquote>
<p>解决方案</p>
</blockquote>
<p><strong>布隆过滤器</strong></p>
<p>布隆过滤器是一种数据结构，对所有可能查询的参数以hash形式存储，在控制层先进行校验，不符合则丢弃，从而避免了对底层存储系统的查询压力</p>
<p><img src="/../assets/1637564180150.png" alt="1637564180150"></p>
<p><strong>缓存空对象</strong></p>
<p>当存储层不命中后，即使返回的空对象也将其缓存起来，同时会设置一个过期时间，之后再访问这个数据将会从缓存中获取，保护了后端数据源</p>
<p><img src="/../assets/1637564231452.png" alt="1637564231452"></p>
<p>但是这种方法会存在两个问题:<br>1、如果空值能够被缓存起来，这就意味着缓存需要更多的空间存储更多的键，因为这当中可能会有很多的空值的键；</p>
<p>2、即使对空值设置了过期时间，还是会存在缓存层和存储层的数据会有一段时间窗口的不一致，这对于需要保持一致性的业务会有影响。</p>
<h2 id="缓存击穿（量太大，缓存过期）"><a href="#缓存击穿（量太大，缓存过期）" class="headerlink" title="缓存击穿（量太大，缓存过期）"></a>缓存击穿（量太大，缓存过期）</h2><blockquote>
<p>概述</p>
</blockquote>
<p>这里需要注意和缓存击穿的区别，缓存击穿，是指一个key非常热点，在不停的扛着大并发，大并发集中对这一个点进行访问，当这个key在失效的瞬间，持续的大并发就穿破缓存，直接请求数据库，就像在一个屏障上凿开了一个洞。</p>
<p>当某个key在过期的瞬间，有大量的请求并发访问，这类数据一般是热点数据，由于缓存过期，会同时访问数据库来查询最新数据，并且回写缓存，会导使数据库瞬间压力过大。</p>
<blockquote>
<p>解决方案</p>
</blockquote>
<p><strong>设置热点数据永不过期</strong></p>
<p>从缓存层面来看，没有设置过期时间，所以不会出现热点 key过期后产生的问题。</p>
<p><strong>加互斥锁</strong></p>
<p>分布式锁∶使用分布式锁，保证对于每个key同时只有一个线程去查询后端服务，其他线程没有获得分布式锁的权限，因此只需要等待即可。这种方式将高并发的压力转移到了分布式锁，因此对分布式锁的考验很大。</p>
<p><img src="/../assets/1637563718042.png" alt="1637563718042"></p>
<h2 id="缓存雪崩"><a href="#缓存雪崩" class="headerlink" title="缓存雪崩"></a>缓存雪崩</h2><blockquote>
<p>概念</p>
</blockquote>
<p>缓存雪崩，是指在某一个时间段，缓存集中过期失效。Redis 宕机!</p>
<p>产生雪崩的原因之一，比如在写本文的时候，马上就要到双十二零点，很快就会迎来一波抢购，这波商品时间比较集中的放入了缓存，假设缓存一个小时。那么到了凌晨一点钟的时候，这批商品的缓存就都过期了。而对这批商品的访问查询，都落到了数据库上，对于数据库而言，就会产生周期性的压力波峰。于是所有的请求都会达到存储层，存储层的调用量会暴增，造成存储层也会挂掉的情况。</p>
<p><img src="/../assets/1637563796998.png" alt="1637563796998"></p>
<p>其实集中过期，倒不是非常致命，比较致命的缓存雪崩，是缓存服务器某个节点宕机或断网。因为自然形成的缓存雪崩，一定是在某个时间段集中创建缓存，这个时候，数据库也是可以顶住压力的。无非就是对数据库产生周期性的压力而已。而缓存服务节点的宕机，对数据库服务器造成的压力是不可预知的，很有可能瞬间就把数据库压垮。</p>
<blockquote>
<p>解决方案</p>
</blockquote>
<p><strong>redis高可用</strong></p>
<p>这个思想的含义是，既然redis有可能挂掉，那我多增设几台redis ，这样一台挂掉之后其他的还可以继续工作，其实就是搭建的集群。</p>
<p><strong>限流降级</strong></p>
<p>这个解决方案的思想是，在缓存失效后，通过加锁或者队列来控制读数据库写缓存的线程数量。比如对某个key只允许一个线程查询数据和写缓存，其他线程等待。</p>
<p><strong>数据预热</strong></p>
<p>数据加热的含义就是在正式部署之前，我先把可能的数据先预先访问一遍，这样部分可能大量访问的数据就会加载到缓存中。在即将发生大并发访问前手动触发加载缓存不同的key，设置不同的过期时间，让缓存失效的时间点尽量均匀。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://suyiharris.github.io/2023/10/24/2023-10-24-Redis/" data-id="clo4h2l41000tnso9f06vfw62" data-title="Redis" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-2023-10-23-flyway-util" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/10/23/2023-10-23-flyway-util/" class="article-date">
  <time class="dt-published" datetime="2023-10-23T04:12:12.000Z" itemprop="datePublished">2023-10-23</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2023/10/23/2023-10-23-flyway-util/">A flyway Util</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="flyway学习笔记"><a href="#flyway学习笔记" class="headerlink" title="flyway学习笔记"></a>flyway学习笔记</h1><h2 id="一、flyway工作流程"><a href="#一、flyway工作流程" class="headerlink" title="一、flyway工作流程"></a>一、flyway工作流程</h2><ol>
<li>项目启动，应用程序完成数据库连接池的建立后，Flyway自动运行。</li>
<li>初次使用时，flyway会创建一个 flyway_schema_history 表，用于记录sql执行记录。</li>
<li>Flyway会扫描项目指定路径下(默认是 classpath:db&#x2F;migration )的所有sql脚本，与 flyway_schema_history 表脚本记录进行比对。如果数据库记录执行过的脚本记录，与项目中的sql脚本不一致，Flyway会报错并停止项目执行。</li>
<li>如果校验通过，则根据表中的sql记录最大版本号，忽略所有版本号不大于该版本的脚本。再按照版本号从小到大，逐个执行其余脚本。</li>
</ol>
<h2 id="二、如何使用"><a href="#二、如何使用" class="headerlink" title="二、如何使用"></a>二、如何使用</h2><h3 id="1、导入maven依赖"><a href="#1、导入maven依赖" class="headerlink" title="1、导入maven依赖"></a>1、导入maven依赖</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.flywaydb<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>flyway-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>6.1.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="2、在yml中配置"><a href="#2、在yml中配置" class="headerlink" title="2、在yml中配置"></a>2、在yml中配置</h3><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="comment"># 数据库连接配置</span></span><br><span class="line">  <span class="attr">datasource:</span></span><br><span class="line">    <span class="attr">driver-class-name:</span> <span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">jdbc:mysql://localhost:3306/flyway-demo?characterEncoding=utf-8&amp;useSSL=false&amp;serverTimezone=Asia/Shanghai</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">root</span></span><br><span class="line">    <span class="attr">password:</span> <span class="string">root</span></span><br><span class="line">  <span class="attr">flyway:</span></span><br><span class="line">    <span class="comment"># 是否启用flyway</span></span><br><span class="line">    <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line">    <span class="comment"># 编码格式，默认UTF-8</span></span><br><span class="line">    <span class="attr">encoding:</span> <span class="string">UTF-8</span></span><br><span class="line">    <span class="comment"># 迁移sql脚本文件存放路径，默认db/migration</span></span><br><span class="line">    <span class="attr">locations:</span> <span class="string">classpath:db/migration</span></span><br><span class="line">    <span class="comment"># 迁移sql脚本文件名称的前缀，默认V</span></span><br><span class="line">    <span class="attr">sql-migration-prefix:</span> <span class="string">V</span></span><br><span class="line">    <span class="comment"># 迁移sql脚本文件名称的分隔符，默认2个下划线__</span></span><br><span class="line">    <span class="attr">sql-migration-separator:</span> <span class="string">__</span></span><br><span class="line">    <span class="comment"># 迁移sql脚本文件名称的后缀</span></span><br><span class="line">    <span class="attr">sql-migration-suffixes:</span> <span class="string">.sql</span></span><br><span class="line">    <span class="comment"># 迁移时是否进行校验，默认true</span></span><br><span class="line">    <span class="attr">validate-on-migrate:</span> <span class="literal">true</span></span><br><span class="line">    <span class="comment"># 当迁移发现数据库非空且存在没有元数据的表时，自动执行基准迁移，新建schema_version表</span></span><br><span class="line">    <span class="attr">baseline-on-migrate:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<h3 id="3、根据配置文件中的SQL脚本文件存放路径，创建对应的目录"><a href="#3、根据配置文件中的SQL脚本文件存放路径，创建对应的目录" class="headerlink" title="3、根据配置文件中的SQL脚本文件存放路径，创建对应的目录"></a>3、根据配置文件中的SQL脚本文件存放路径，创建对应的目录</h3><p>resources&#x2F;db&#x2F;migration</p>
<h3 id="4、添加SQL脚本，创建时注意命名规范"><a href="#4、添加SQL脚本，创建时注意命名规范" class="headerlink" title="4、添加SQL脚本，创建时注意命名规范"></a>4、添加SQL脚本，创建时注意命名规范</h3><ul>
<li><p>sql脚本的命名有两种，一种是以V开头的+版本号+两段下划线+文件名.sql，这种以V开头的脚本是只执行一次的，另一种是R开头的，命名方式类似，这种脚本可以重复执行，但不建议修改执行过的sql语句</p>
</li>
<li><p>V开头的sql文件比R开头的sql文件优先级高</p>
</li>
</ul>
<h3 id="5、启动项目后可以在flyway-schema-history表中查看相关语句执行记录"><a href="#5、启动项目后可以在flyway-schema-history表中查看相关语句执行记录" class="headerlink" title="5、启动项目后可以在flyway_schema_history表中查看相关语句执行记录"></a>5、启动项目后可以在flyway_schema_history表中查看相关语句执行记录</h3><p><img src="https://pic.imgdb.cn/item/6537ce38c458853aef669346.jpg"></p>
<p><img src="https://pic.imgdb.cn/item/6537ce47c458853aef66cfcb.jpg"></p>
<p><img src="https://pic.imgdb.cn/item/6537ce57c458853aef670fae.jpg"></p>
<h3 id="6、说明"><a href="#6、说明" class="headerlink" title="6、说明"></a>6、说明</h3><p>如果我们修改V2__add_user.sql中的内容，再次执行的话，就会报错，提示信息如下：</p>
<p> 　　[ERROR] Migration checksum mismatch for migration version 2 </p>
<p>　　如果我们修改了R__add_unknown_user.sql，再次执行的话，该脚本就会再次得到执行，并且flyway的历史记录表中也会增加本次执行的记录。 </p>
<h2 id="三、Maven插件"><a href="#三、Maven插件" class="headerlink" title="三、Maven插件"></a>三、Maven插件</h2><h3 id="1、配置"><a href="#1、配置" class="headerlink" title="1、配置"></a>1、配置</h3><p>以上步骤中，每次想要migration都需要运行整个springboot项目，并且只能执行migrate一种命令，其实flyway还是有很多其它命令的。maven插件给了我们不需要启动项目就能执行flyway各种命令的机会。</p>
<p>在pom.xml中引入flyway的插件，同时配置好对应的数据库连接。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.flywaydb<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>flyway-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.2.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">url</span>&gt;</span>jdbc:mysql://localhost:3306/flyway-demo?characterEncoding=utf-8<span class="symbol">&amp;amp;</span>useSSL=false<span class="symbol">&amp;amp;</span>serverTimezone=Asia/Shanghai</span><br><span class="line">                <span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">user</span>&gt;</span>root<span class="tag">&lt;/<span class="name">user</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">password</span>&gt;</span>root<span class="tag">&lt;/<span class="name">password</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">driver</span>&gt;</span>com.mysql.cj.jdbc.Driver<span class="tag">&lt;/<span class="name">driver</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure>


<p><img src="https://pic.imgdb.cn/item/6537ce66c458853aef676645.jpg"></p>
<h3 id="2、命令说明"><a href="#2、命令说明" class="headerlink" title="2、命令说明"></a>2、命令说明</h3><ol>
<li><p>baseline</p>
<p>对已经存在数据库Schema结构的数据库一种解决方案。实现在非空数据库新建MetaData表，并把Migrations应用到该数据库；也可以在已有表结构的数据库中实现添加Metadata表。</p>
</li>
<li><p>clean</p>
<p>清除掉对应数据库Schema中所有的对象，包括表结构，视图，存储过程等，clean操作在dev 和 test阶段很好用，但在生产环境务必禁用。</p>
</li>
<li><p>info</p>
<p>用于打印所有的Migrations的详细和状态信息，也是通过MetaData和Migrations完成的，可以快速定位当前的数据库版本。</p>
</li>
<li><p>repair</p>
<p>repair操作能够修复metaData表，该操作在metadata出现错误时很有用。</p>
</li>
<li><p>undo</p>
<p>撤销操作，社区版不支持。</p>
</li>
<li><p>migrate</p>
<p>迁移。</p>
</li>
<li><p>validate</p>
<p>验证已经apply的Migrations是否有变更，默认开启的，原理是对比MetaData表与本地Migrations的checkNum值，如果值相同则验证通过，否则失败。</p>
</li>
</ol>
<h2 id="四、知识补充"><a href="#四、知识补充" class="headerlink" title="四、知识补充"></a>四、知识补充</h2><ol>
<li>flyway执行migrate必须在空白的数据库上进行，否则报错。</li>
<li>对于已经有数据的数据库，必须先baseline，然后才能migrate。</li>
<li>clean操作是删除数据库的所有内容，包括baseline之前的内容。</li>
<li>尽量不要修改已经执行过的SQL，即便是R开头的可反复执行的SQL，它们会不利于数据迁移。</li>
<li>当需要做数据迁移的时候，更换一个新的空白数据库，执行下migrate命令，所有的数据库更改都可以一步到位地迁移过去。</li>
</ol>
<h2 id="五、配置清单"><a href="#五、配置清单" class="headerlink" title="五、配置清单"></a>五、配置清单</h2><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">flyway.baseline-description对执行迁移时基准版本的描述.</span></span><br><span class="line"><span class="attr">flyway.baseline-on-migrate当迁移时发现目标schema非空，而且带有没有元数据的表时，是否自动执行基准迁移，默认false.</span></span><br><span class="line"><span class="attr">flyway.baseline-version开始执行基准迁移时对现有的schema的版本打标签，默认值为1.</span></span><br><span class="line"><span class="attr">flyway.check-location检查迁移脚本的位置是否存在，默认false.</span></span><br><span class="line"><span class="attr">flyway.clean-on-validation-error当发现校验错误时是否自动调用clean，默认false.</span></span><br><span class="line"><span class="attr">flyway.enabled是否开启flywary，默认true.</span></span><br><span class="line"><span class="attr">flyway.encoding设置迁移时的编码，默认UTF-8.</span></span><br><span class="line"><span class="attr">flyway.ignore-failed-future-migration当读取元数据表时是否忽略错误的迁移，默认false.</span></span><br><span class="line"><span class="attr">flyway.init-sqls当初始化好连接时要执行的SQL.</span></span><br><span class="line"><span class="attr">flyway.locations迁移脚本的位置，默认db/migration.</span></span><br><span class="line"><span class="attr">flyway.out-of-order是否允许无序的迁移，默认false.</span></span><br><span class="line"><span class="attr">flyway.password目标数据库的密码.</span></span><br><span class="line"><span class="attr">flyway.placeholder-prefix设置每个placeholder的前缀，默认$&#123;.</span></span><br><span class="line"><span class="attr">flyway.placeholder-replacementplaceholders是否要被替换，默认true.</span></span><br><span class="line"><span class="attr">flyway.placeholder-suffix设置每个placeholder的后缀，默认&#125;.</span></span><br><span class="line"><span class="attr">flyway.placeholders.[placeholder</span> <span class="string">name]设置placeholder的value</span></span><br><span class="line"><span class="attr">flyway.schemas设定需要flywary迁移的schema，大小写敏感，默认为连接默认的schema.</span></span><br><span class="line"><span class="attr">flyway.sql-migration-prefix迁移文件的前缀，默认为V.</span></span><br><span class="line"><span class="attr">flyway.sql-migration-separator迁移脚本的文件名分隔符，默认__</span></span><br><span class="line"><span class="attr">flyway.sql-migration-suffix迁移脚本的后缀，默认为.sql</span></span><br><span class="line"><span class="attr">flyway.tableflyway使用的元数据表名，默认为schema_version</span></span><br><span class="line"><span class="attr">flyway.target迁移时使用的目标版本，默认为latest</span> <span class="string">version</span></span><br><span class="line"><span class="attr">flyway.url迁移时使用的JDBC</span> <span class="string">URL，如果没有指定的话，将使用配置的主数据源</span></span><br><span class="line"><span class="attr">flyway.user迁移数据库的用户名</span></span><br><span class="line"><span class="attr">flyway.validate-on-migrate迁移时是否校验，默认为true</span></span><br></pre></td></tr></table></figure>


<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_41378597/article/details/124134146">原文链接</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://suyiharris.github.io/2023/10/23/2023-10-23-flyway-util/" data-id="clo4h2l3f0001nso92z2767e1" data-title="A flyway Util" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-2023-09-22-拦截器-java" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/09/22/2023-09-22-%E6%8B%A6%E6%88%AA%E5%99%A8-java/" class="article-date">
  <time class="dt-published" datetime="2023-09-22T04:12:12.000Z" itemprop="datePublished">2023-09-22</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2023/09/22/2023-09-22-%E6%8B%A6%E6%88%AA%E5%99%A8-java/">拦截器-java</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>myLanJieQi.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sec.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.databind.ObjectMapper;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.HandlerInterceptor;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">myLanJieQi</span> <span class="keyword">implements</span> <span class="title class_">HandlerInterceptor</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">preHandle</span><span class="params">(HttpServletRequest request,HttpServletResponse response, Object handler)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">token</span> <span class="operator">=</span> request.getHeader(<span class="string">&quot;token&quot;</span>);</span><br><span class="line">        <span class="type">ObjectMapper</span> <span class="variable">objectMapper</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectMapper</span>();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(token==<span class="literal">null</span>||token==<span class="string">&quot;&quot;</span>||<span class="string">&quot;&quot;</span>.equals(token))&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;token不存在&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">error</span> <span class="operator">=</span> objectMapper.writeValueAsString(<span class="string">&quot;error&quot;</span>);</span><br><span class="line">            response.getWriter().write(error);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>myWebMvcConfigurer.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sec.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.config.annotation.EnableWebMvc;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.config.annotation.InterceptorRegistry;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.config.annotation.WebMvcConfigurer;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.annotation.Resource;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@EnableWebMvc</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">myWebMvcConfigurer</span> <span class="keyword">implements</span> <span class="title class_">WebMvcConfigurer</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    myLanJieQi myLanJieQi;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addInterceptors</span><span class="params">(InterceptorRegistry registry)</span> &#123;</span><br><span class="line">        ArrayList&lt;String&gt; arrayList = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        arrayList.add(<span class="string">&quot;/bootstrap3/**&quot;</span>);</span><br><span class="line">        arrayList.add(<span class="string">&quot;/css/**&quot;</span>);</span><br><span class="line">        arrayList.add(<span class="string">&quot;/images/**&quot;</span>);</span><br><span class="line">        arrayList.add(<span class="string">&quot;/js/**&quot;</span>);</span><br><span class="line">        arrayList.add(<span class="string">&quot;/web/register.html&quot;</span>);</span><br><span class="line">        arrayList.add(<span class="string">&quot;/web/login.html&quot;</span>);</span><br><span class="line">        arrayList.add(<span class="string">&quot;/web/index.html&quot;</span>);</span><br><span class="line">        arrayList.add(<span class="string">&quot;/web/product.html&quot;</span>);</span><br><span class="line">        arrayList.add(<span class="string">&quot;/users/register&quot;</span>);</span><br><span class="line">        arrayList.add(<span class="string">&quot;/users/login&quot;</span>);</span><br><span class="line">        arrayList.add(<span class="string">&quot;/districts/**&quot;</span>);</span><br><span class="line">        arrayList.add(<span class="string">&quot;/products/**&quot;</span>);</span><br><span class="line"></span><br><span class="line">        registry.addInterceptor(myLanJieQi)<span class="comment">//添加自己写好的拦截器</span></span><br><span class="line">                .addPathPatterns(<span class="string">&quot;/**&quot;</span>)<span class="comment">//所有路径都拦截</span></span><br><span class="line">                .excludePathPatterns(arrayList);<span class="comment">//这些路径不拦截</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://suyiharris.github.io/2023/09/22/2023-09-22-%E6%8B%A6%E6%88%AA%E5%99%A8-java/" data-id="clo4h2l3a0000nso9c6pk5nxf" data-title="拦截器-java" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/2/">&laquo; 上一页</a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/10/">十月 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/09/">九月 2023</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2023/10/24/2023-10-24-hello-world/">Hello World</a>
          </li>
        
          <li>
            <a href="/2023/10/24/2023-10-24-Git%E5%AD%A6%E4%B9%A0/">2023-10-24-Git学习</a>
          </li>
        
          <li>
            <a href="/2023/10/24/2023-10-24-Jwt%E7%9A%84%E9%89%B4%E6%9D%83%E7%99%BB%E5%BD%95-%E6%8B%A6%E6%88%AA%E5%99%A8-%E6%B3%A8%E5%86%8C%E6%8B%A6%E6%88%AA%E5%99%A8/">Jwt的鉴权登录-拦截器-注册拦截器</a>
          </li>
        
          <li>
            <a href="/2023/10/24/2023-10-24-Linux%E7%B3%BB%E7%BB%9F%E9%83%A8%E7%BD%B2SpringBoot%E9%A1%B9%E7%9B%AE/">Linux系统部署SpringBoot项目</a>
          </li>
        
          <li>
            <a href="/2023/10/24/2023-10-24-SVN%E5%AD%A6%E4%B9%A0/">SVN学习</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2023 SuYi<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>